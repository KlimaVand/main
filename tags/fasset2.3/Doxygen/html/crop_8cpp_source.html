<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Fasset: C:/main/trunk/src/fields/crops/crop.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.4 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Fasset</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">C:/main/trunk/src/fields/crops/crop.cpp</div>  </div>
</div>
<div class="contents">
<a href="crop_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/****************************************************************************\</span>
<a name="l00002"></a>00002 <span class="comment"> $URL$</span>
<a name="l00003"></a>00003 <span class="comment"> $LastChangedDate$</span>
<a name="l00004"></a>00004 <span class="comment"> $LastChangedRevision$</span>
<a name="l00005"></a>00005 <span class="comment"> $LastChangedBy$</span>
<a name="l00006"></a>00006 <span class="comment">\****************************************************************************/</span>
<a name="l00007"></a>00007 <span class="preprocessor">#include &quot;../../base/common.h&quot;</span>
<a name="l00008"></a>00008 <span class="preprocessor">#include &quot;<a class="code" href="crop_8h.html">crop.h</a>&quot;</span>
<a name="l00009"></a>00009 <span class="preprocessor">#include &quot;../../base/bstime.h&quot;</span>
<a name="l00010"></a>00010 <span class="preprocessor">#include &quot;../../base/base.h&quot;</span>
<a name="l00011"></a>00011 <span class="preprocessor">#include &quot;../../data/outputData.h&quot;</span>
<a name="l00012"></a>00012 
<a name="l00013"></a>00013 <span class="preprocessor">#include &quot;../../base/climate.h&quot;</span>
<a name="l00014"></a>00014 <span class="preprocessor">#include &quot;../../products/products.h&quot;</span>
<a name="l00015"></a>00015 <span class="preprocessor">#include &quot;../../base/nixcbits.h&quot;</span>
<a name="l00016"></a>00016 <span class="preprocessor">#include &quot;<a class="code" href="phenology_8h.html">phenology.h</a>&quot;</span>
<a name="l00017"></a>00017 <span class="preprocessor">#include &quot;../../base/typer.h&quot;</span>
<a name="l00018"></a>00018 <span class="preprocessor">#include &quot;../../data/commonData.h&quot;</span>
<a name="l00019"></a>00019 <span class="preprocessor">#include &quot;../../tools/compare.h&quot;</span>
<a name="l00020"></a>00020 <span class="preprocessor">#include &quot;../../data/cropParametersData.h&quot;</span>
<a name="l00021"></a>00021 <span class="comment">/****************************************************************************\</span>
<a name="l00022"></a>00022 <span class="comment">\****************************************************************************/</span>
<a name="l00023"></a><a class="code" href="classcrop.html#a29466e9f80e27f8e7b62c3236d441f72">00023</a> crop::crop(<span class="keyword">const</span> <span class="keywordtype">char</span> * aName, <span class="keyword">const</span> <span class="keywordtype">int</span> aIndex, <span class="keyword">const</span> <a class="code" href="classbase.html">base</a> * aOwner, <span class="keywordtype">string</span> cropName)
<a name="l00024"></a>00024    :<a class="code" href="classbase.html">base</a>(aName,aIndex,aOwner)
<a name="l00025"></a>00025 {
<a name="l00026"></a>00026    <span class="comment">// Parameters</span>
<a name="l00027"></a>00027 
<a name="l00028"></a>00028    <a class="code" href="classcrop.html#af852d2f62dd22411199ae8e164536a7d">CropName</a> = cropName;
<a name="l00029"></a>00029    <a class="code" href="crop_parameters_data_8h.html#af71819066527a8ec2b9968375a84c8c3">theCropData</a>-&gt;<a class="code" href="classcrop_parameters_data.html#a600551eb78096c055b66ecf00948f17d">setCrop</a>(<a class="code" href="classcrop.html#af852d2f62dd22411199ae8e164536a7d">CropName</a>);
<a name="l00030"></a>00030    <a class="code" href="classcrop.html#af982befddb79f8aedfa207bce540c47a">PlantItemName</a> = <span class="stringliteral">&quot;&quot;</span>;                   <span class="comment">// These names maps to products.dat !</span>
<a name="l00031"></a>00031    <a class="code" href="classcrop.html#aa2aceced21d0fee166e40a836c2ee9cc">StrawItemName</a> = <span class="stringliteral">&quot;&quot;</span>;                   <span class="comment">// These names maps to products.dat !</span>
<a name="l00032"></a>00032    <a class="code" href="classcrop.html#aef5d855a21b1f0227b429764dea1c8fe" title="Describe if the crop is a C4 crop (CO2 effect only on C3 crops)">C4Photosynthesis</a> = <span class="keyword">false</span>;
<a name="l00033"></a>00033    <a class="code" href="classcrop.html#a6af7b95c4e451b425aeed60156151e9d">UnderSown</a> = <span class="keyword">false</span>;                    <span class="comment">// indicates if a crop are not going to be harvested (i.e. undersown crops)</span>
<a name="l00034"></a>00034         <a class="code" href="classcrop.html#af82f3b3de55473a22e08c2b07d6e0645">GrowthContinue</a> = <span class="keyword">false</span>;
<a name="l00035"></a>00035         <a class="code" href="classcrop.html#a7b2a38633965734c3298a4da248c6d53" title="Describe if a plan can grow trough winter.">WinterSeed</a> = <span class="keyword">true</span>;                    <span class="comment">// Is the present crop a wintercrop</span>
<a name="l00036"></a>00036    <a class="code" href="classcrop.html#af94e599e6f05fae15099673485d28e88" title="Describe if a plan is dead(true) or alive(false)">terminated</a>=<span class="keyword">false</span>;
<a name="l00037"></a>00037    <a class="code" href="classcrop.html#a8e7d3a42d931c8c1d95f92bb2669f2ef" title="Describe if a plan has been cut or harvested.">CutOrHarvested</a> = <span class="keyword">false</span>;
<a name="l00038"></a>00038 
<a name="l00039"></a>00039    <span class="comment">//-------------------------- Parameters usually unchanged -------------------</span>
<a name="l00040"></a>00040    <span class="comment">// These parameters may not be changed here in class &#39;crop&#39; at all !</span>
<a name="l00041"></a>00041    <a class="code" href="classcrop.html#af06dc09d391a57692b440c7c492dbc41">DMCostPerN</a>                           = <a class="code" href="crop_parameters_data_8h.html#af71819066527a8ec2b9968375a84c8c3">theCropData</a>-&gt;<a class="code" href="classcrop_parameters_data.html#ae41a21c2cf2aa9df8ac69da5a9d0a272">getDMCostPerN</a>();
<a name="l00042"></a>00042 
<a name="l00043"></a>00043    <a class="code" href="classcrop.html#acd7a9182db99895de016c87785b58cc9">MaxFixPerDM</a>                          = <a class="code" href="crop_parameters_data_8h.html#af71819066527a8ec2b9968375a84c8c3">theCropData</a>-&gt;<a class="code" href="classcrop_parameters_data.html#a2dc4610381ce4a5a5ff369b06557679a">getMaxFixPerDM</a>();
<a name="l00044"></a>00044    <span class="comment">// Root</span>
<a name="l00045"></a>00045         <a class="code" href="classcrop.html#a6ea7c6dccd7cf399d9276d0328c142cb">RootpF</a>               = <a class="code" href="crop_parameters_data_8h.html#af71819066527a8ec2b9968375a84c8c3">theCropData</a>-&gt;<a class="code" href="classcrop_parameters_data.html#a9c722199b68380d4d7d89fec3dbaf640">getRootpF</a>();          <span class="comment">// Water potential at wilting point</span>
<a name="l00046"></a>00046    <a class="code" href="classcrop.html#ac3e7efec04f1437634c82c1c3d045924">RootPentrRate</a>        = <a class="code" href="crop_parameters_data_8h.html#af71819066527a8ec2b9968375a84c8c3">theCropData</a>-&gt;<a class="code" href="classcrop_parameters_data.html#a559520f3b2128a0355a0bfd417aae508">getRootPentrRate</a>();        <span class="comment">// Root penetration rate (m d-1 deg C-1)</span>
<a name="l00047"></a>00047         <a class="code" href="classcrop.html#a5c8bcec383225ccfa1997ed7de4b2446">RootDistrParm</a>        = <a class="code" href="crop_parameters_data_8h.html#af71819066527a8ec2b9968375a84c8c3">theCropData</a>-&gt;<a class="code" href="classcrop_parameters_data.html#a2e57f173cc7c78baeafdbd9f79fab8e2">getRootDistrParm</a>();          <span class="comment">// Root density distribution parameter</span>
<a name="l00048"></a>00048         <a class="code" href="classcrop.html#aab8805ada2711ddb5996d9e87376eb21">TempRootMin</a>          = <a class="code" href="crop_parameters_data_8h.html#af71819066527a8ec2b9968375a84c8c3">theCropData</a>-&gt;<a class="code" href="classcrop_parameters_data.html#a0970bae1b41330f0903e5f926ddfa7c1">getTempRootMin</a>();          <span class="comment">// Minimum temperature for root growth  new value by JB 19_3_3</span>
<a name="l00049"></a>00049         <a class="code" href="classcrop.html#a56cef92be3d0cb8376b13f1666c469e2">SpecificRootLength</a>   = <a class="code" href="crop_parameters_data_8h.html#af71819066527a8ec2b9968375a84c8c3">theCropData</a>-&gt;<a class="code" href="classcrop_parameters_data.html#aa6a879a5f1c890e69f475b7f51f7b839">getSpecificRootLength</a>(); <span class="comment">//191;   // Specific root length, m pr. kg.</span>
<a name="l00050"></a>00050         <a class="code" href="classcrop.html#a3bd248dac15a2aefd7289240ffeeb879">RootDensAtBottom</a>     = <a class="code" href="crop_parameters_data_8h.html#af71819066527a8ec2b9968375a84c8c3">theCropData</a>-&gt;<a class="code" href="classcrop_parameters_data.html#a1f9c5e372ff20fd16f92ba924eb992ac">getRootDensAtBottom</a>(); <span class="comment">//191;   // Rootdensity at rootdepth (100*191/100)</span>
<a name="l00051"></a>00051 
<a name="l00052"></a>00052    <a class="code" href="classcrop.html#a94dedacaf228ed611dd4a9c43fcf1140">MinimumRootDens</a>      = <a class="code" href="crop_parameters_data_8h.html#af71819066527a8ec2b9968375a84c8c3">theCropData</a>-&gt;<a class="code" href="classcrop_parameters_data.html#a9866b30b3d9070b13e33a299d3d4f8ad">getMinimumRootDens</a>(); <span class="comment">//500;   BMP: why zero ???!!!</span>
<a name="l00053"></a>00053         <a class="code" href="classcrop.html#ac51148719f4b421963566a281b04c0cf">InitialRootDepth</a>     = <a class="code" href="crop_parameters_data_8h.html#af71819066527a8ec2b9968375a84c8c3">theCropData</a>-&gt;<a class="code" href="classcrop_parameters_data.html#acebfe47ab51231924099d44059d34eff">getInitialRootDepth</a>();             <span class="comment">// Root depth by germination</span>
<a name="l00054"></a>00054    <a class="code" href="classcrop.html#a0cbba1c8f072c0ae99c9465f5eadf2cb">NitrateUptakeRate</a>    = <a class="code" href="crop_parameters_data_8h.html#af71819066527a8ec2b9968375a84c8c3">theCropData</a>-&gt;<a class="code" href="classcrop_parameters_data.html#ab567eeacf0d9e1783cd1b48f4b04494c">getNitrateUptakeRate</a>();     <span class="comment">// Uptake rate for nitrate-N g/m/d (m root length)</span>
<a name="l00055"></a>00055         <a class="code" href="classcrop.html#a1707be6e4080e9ca3c3f24d6ffe0d6fa">AmmoniumUptakeRate</a>   = <a class="code" href="crop_parameters_data_8h.html#af71819066527a8ec2b9968375a84c8c3">theCropData</a>-&gt;<a class="code" href="classcrop_parameters_data.html#ab0b7f22d9b8b0c76ae24935f1b02fc9b">getAmmoniumUptakeRate</a>();       <span class="comment">// NEW value from DAISY (JB 2002-8) 0.0031;       // Uptake rate for ammonium-N g/m/d (m root length)    0.06*100/191</span>
<a name="l00056"></a>00056    <a class="code" href="classcrop.html#af1ec4e9a12abd41e5f5b39c87cfc2349">MinimumSoilNitrate</a>   = <a class="code" href="crop_parameters_data_8h.html#af71819066527a8ec2b9968375a84c8c3">theCropData</a>-&gt;<a class="code" href="classcrop_parameters_data.html#ad7c23c609557f5077478dc3a1c74aa13">getMinimumSoilNitrate</a>();          <span class="comment">// Minimum concentration of nitrate-N left in soil water (g/l)</span>
<a name="l00057"></a>00057    <a class="code" href="classcrop.html#af11b53bf326f21dc1628289175ecb6d7">MinimumSoilAmmonium</a>  = <a class="code" href="crop_parameters_data_8h.html#af71819066527a8ec2b9968375a84c8c3">theCropData</a>-&gt;<a class="code" href="classcrop_parameters_data.html#ab63eb5d623659f86ef958e759edf8ae6">getMinimumSoilAmmonium</a>();          <span class="comment">// Minimum concentration of ammonium-N left in soil water (g/l)</span>
<a name="l00058"></a>00058    <a class="code" href="classcrop.html#afe8c6c11905d19aca8f9623180b8462f">DecayRoot</a>            = <a class="code" href="crop_parameters_data_8h.html#af71819066527a8ec2b9968375a84c8c3">theCropData</a>-&gt;<a class="code" href="classcrop_parameters_data.html#aefd135fa2df2e42d3d380ba5aeb5fcb8">getDecayRoot</a>();          <span class="comment">// Root decay given as a daily fraction of DM at 10 deg. Celsius</span>
<a name="l00059"></a>00059    <a class="code" href="classcrop.html#aa37b1e6e7ca46537edb64086518d5088">MaxRootDepthCrop</a>     = <a class="code" href="crop_parameters_data_8h.html#af71819066527a8ec2b9968375a84c8c3">theCropData</a>-&gt;<a class="code" href="classcrop_parameters_data.html#a4372c4b5a88d45d588fe5a21305ce945">getMaxRootDepth</a>();          <span class="comment">// Maximal root depth for this crop</span>
<a name="l00060"></a>00060 
<a name="l00061"></a>00061    <span class="comment">// DM production and translocation</span>
<a name="l00062"></a>00062    <a class="code" href="classcrop.html#a158a4f00952108fdc19727bdc90765f9">TopFraction</a>           = <a class="code" href="crop_parameters_data_8h.html#af71819066527a8ec2b9968375a84c8c3">theCropData</a>-&gt;<a class="code" href="classcrop_parameters_data.html#a1ed1b0b86a2a7730e10b8a4d677c7eb2">getTopFraction</a>();        <span class="comment">// Fraction of seed that goes into top</span>
<a name="l00063"></a>00063         <a class="code" href="classcrop.html#ab60ba190cccea48dbc2b7112b663545e">ConversionCoefficient</a> = <a class="code" href="crop_parameters_data_8h.html#af71819066527a8ec2b9968375a84c8c3">theCropData</a>-&gt;<a class="code" href="classcrop_parameters_data.html#a9a0560580450889bb27503f78caae741">getConversionCoefficient</a>();         <span class="comment">// Coefficent of DM conversion from vegetative to storage</span>
<a name="l00064"></a>00064    <a class="code" href="classcrop.html#a134737bfb7ce5b5c558f15a19232181f">GerminationConversion</a> = <a class="code" href="crop_parameters_data_8h.html#af71819066527a8ec2b9968375a84c8c3">theCropData</a>-&gt;<a class="code" href="classcrop_parameters_data.html#aba5b7978c63607e2dfaec0455aae777a">getGerminationConversion</a>();         <span class="comment">// Conversion factor seed DM -&gt; plant DM</span>
<a name="l00065"></a>00065    <a class="code" href="classcrop.html#a366215bb50374cc375870081f55df157">MinAllocToRoot</a>        =  <a class="code" href="crop_parameters_data_8h.html#af71819066527a8ec2b9968375a84c8c3">theCropData</a>-&gt;<a class="code" href="classcrop_parameters_data.html#a264f59cf1e9fe6bbf459f1c7c4667bf1">getMinAllocToRoot</a>();;         <span class="comment">// Minimal fraction of dry matter production that is allocated to the root</span>
<a name="l00066"></a>00066         <a class="code" href="classcrop.html#a8ee0da1040a104bfc08b4618d3574db1">MaxAllocToRoot</a>        = <a class="code" href="crop_parameters_data_8h.html#af71819066527a8ec2b9968375a84c8c3">theCropData</a>-&gt;<a class="code" href="classcrop_parameters_data.html#ac17682e97eefc403621043ec4a107687">getMaxAllocToRoot</a>();         <span class="comment">// Maximal fraction of dry matter production that is allocated to the root</span>
<a name="l00067"></a>00067    <a class="code" href="classcrop.html#ace1e4d77fd9e80f3cd5c301927e03630">MaxRadUseEff</a>          = <a class="code" href="crop_parameters_data_8h.html#af71819066527a8ec2b9968375a84c8c3">theCropData</a>-&gt;<a class="code" href="classcrop_parameters_data.html#af9a40a9aea28a44839fe0f8dba95f729">getMaxRadUseEff</a>();        <span class="comment">// Maximum radiation use efficiency (g/MJ)</span>
<a name="l00068"></a>00068         <a class="code" href="classcrop.html#aea1414f901f3fc6d6ad5e8d2936ea409">MinDMtemp</a>             = <a class="code" href="crop_parameters_data_8h.html#af71819066527a8ec2b9968375a84c8c3">theCropData</a>-&gt;<a class="code" href="classcrop_parameters_data.html#a7bb26cc78e3316144fa100873fd810d6">getMinDMtemp</a>();           <span class="comment">// Minimum temperature for dry matter production (4 in Hansen et al)</span>
<a name="l00069"></a>00069         <a class="code" href="classcrop.html#a6c3d05934ce21df6acb4161c3baab56e">MaxDMtemp</a>             = <a class="code" href="crop_parameters_data_8h.html#af71819066527a8ec2b9968375a84c8c3">theCropData</a>-&gt;<a class="code" href="classcrop_parameters_data.html#a18f579c04b75b117433553594f81f99e">getMaxDMtemp</a>();          <span class="comment">// Maximum temperature for dry matter production</span>
<a name="l00070"></a>00070    <a class="code" href="classcrop.html#adf0da70c2a7dc063b5bcb09730e155c6">StoreForFilling</a>               = <a class="code" href="crop_parameters_data_8h.html#af71819066527a8ec2b9968375a84c8c3">theCropData</a>-&gt;<a class="code" href="classcrop_parameters_data.html#ae48ace2f62dc6a275d3b56ae399329f9">getStoreForFilling</a>();        <span class="comment">// Fraction of DM present at initiation of grain filling that is translocated to grain</span>
<a name="l00071"></a>00071                                         <span class="comment">// Estimated fra JEO data, but fits with 0.4 reported by de Vries et. al. &quot;Simulation of ecophysiologival processes of growht in several annual crops&quot;</span>
<a name="l00072"></a>00072 
<a name="l00073"></a>00073    <span class="comment">// Nitrogen</span>
<a name="l00074"></a>00074         <a class="code" href="classcrop.html#ad789899ed1b1f807e992d207dceaa192">NCurveParam</a>                     = <a class="code" href="crop_parameters_data_8h.html#af71819066527a8ec2b9968375a84c8c3">theCropData</a>-&gt;<a class="code" href="classcrop_parameters_data.html#ab1f2ff4bff7f24ee6aee9f994cb9a5b2">getNCurveParam</a>();                    <span class="comment">// Parameter giving the N-curve shape</span>
<a name="l00075"></a>00075 
<a name="l00076"></a>00076    <a class="code" href="classcrop.html#a3a411cb751e18aaf088d266ee47c9420">MinN_Store</a>                           = <a class="code" href="crop_parameters_data_8h.html#af71819066527a8ec2b9968375a84c8c3">theCropData</a>-&gt;<a class="code" href="classcrop_parameters_data.html#acea6e063a4ccc11682bcaae78809a420">getMinN_Store</a>();               <span class="comment">// Minimum content of nitrogen i storage organs (Estimeret fra Elly&#39;s data)</span>
<a name="l00077"></a>00077         <a class="code" href="classcrop.html#a9f5ab366fce6f1259588cf5087cdb4c2">MaxN_Store</a>                      = <a class="code" href="crop_parameters_data_8h.html#af71819066527a8ec2b9968375a84c8c3">theCropData</a>-&gt;<a class="code" href="classcrop_parameters_data.html#a8b11c9be84156bd9aded6febc1040781">getMaxN_Store</a>();               <span class="comment">// Maximum content of nitrogen i storage organs</span>
<a name="l00078"></a>00078         <a class="code" href="classcrop.html#a4ec1369c2adcd701d7c4676fce24310c">MinN_Root</a>                       = <a class="code" href="crop_parameters_data_8h.html#af71819066527a8ec2b9968375a84c8c3">theCropData</a>-&gt;<a class="code" href="classcrop_parameters_data.html#a37d389712256ea1a79ba22e5794b3eae">getMinN_Root</a>();                   <span class="comment">// Minimum content of nitrogen i root organs</span>
<a name="l00079"></a>00079         <a class="code" href="classcrop.html#a62361ade607f9cc57e226c1134ad0eb2">MaxN_Root</a>                       = <a class="code" href="crop_parameters_data_8h.html#af71819066527a8ec2b9968375a84c8c3">theCropData</a>-&gt;<a class="code" href="classcrop_parameters_data.html#a400e4c30a75229fb85fd5120e232414b">getMaxN_Root</a>();                   <span class="comment">// Maximum content of nitrogen i root organs</span>
<a name="l00080"></a>00080         <a class="code" href="classcrop.html#a69df1a97a358dff8c354b08cb93908ec">PowDM</a>                           = <a class="code" href="crop_parameters_data_8h.html#af71819066527a8ec2b9968375a84c8c3">theCropData</a>-&gt;<a class="code" href="classcrop_parameters_data.html#a8131c368d67f6c94685a84f456f4d2be">getPowDM</a>();               <span class="comment">// Power of dry matter in nitrogen status calculation  (Justes et al., 1994)</span>
<a name="l00081"></a>00081    <a class="code" href="classcrop.html#ab71cf78ab9ac2779deeb032e7b36e47d">NPctMax</a>                              = <a class="code" href="crop_parameters_data_8h.html#af71819066527a8ec2b9968375a84c8c3">theCropData</a>-&gt;<a class="code" href="classcrop_parameters_data.html#ad9df23f1a6fb2f5959a8dcf4cb835352">getNPctMax</a>();                     <span class="comment">// Following Justes concept (Justes et al., 1994)</span>
<a name="l00082"></a>00082    <a class="code" href="classcrop.html#a64b16d0f5b047dbd1c1fcdde7fd09a87">NPctMin</a>                              = <a class="code" href="crop_parameters_data_8h.html#af71819066527a8ec2b9968375a84c8c3">theCropData</a>-&gt;<a class="code" href="classcrop_parameters_data.html#ac16281245acd4fdc57dbedc0e3ca225c">getNPctMin</a>();                             <span class="comment">// Following Justes concept (Justes et al., 1994)</span>
<a name="l00083"></a>00083    <a class="code" href="classcrop.html#a0bbe1011a2b6d4224bd986f26d5a1d39">ReducedNInYellow</a>     = <a class="code" href="crop_parameters_data_8h.html#af71819066527a8ec2b9968375a84c8c3">theCropData</a>-&gt;<a class="code" href="classcrop_parameters_data.html#a45d6fab5c38ee95bac5d722ceea2e2ae">getReducedNInYellow</a>();             <span class="comment">// The min and max N for yellow VegTop is reduced with this parameter</span>
<a name="l00084"></a>00084 
<a name="l00085"></a>00085         <span class="comment">// LAI and canopy structure</span>
<a name="l00086"></a>00086         <a class="code" href="classcrop.html#a9836313fa9dae417e0d3a41850209e37">k</a>                       = <a class="code" href="crop_parameters_data_8h.html#af71819066527a8ec2b9968375a84c8c3">theCropData</a>-&gt;<a class="code" href="classcrop_parameters_data.html#abd661d341db0122060a843746afa1d3a">getk</a>();            <span class="comment">// Extinction coefficient for photosynthetic active radiation</span>
<a name="l00087"></a>00087    <a class="code" href="classcrop.html#a068c7be7b71c0b4581ec57ffd204766b">InterceptCoeff</a>       = <a class="code" href="crop_parameters_data_8h.html#af71819066527a8ec2b9968375a84c8c3">theCropData</a>-&gt;<a class="code" href="classcrop_parameters_data.html#ac3a24c7c082146eca6879a4a9243dc5b">getInterceptCoeff</a>();             <span class="comment">// Coeff. for interceptioncapacity.</span>
<a name="l00088"></a>00088    <a class="code" href="classcrop.html#a23c5f9e6bead96515b31e977405637d8">PhotoSyntActPart</a>     = <a class="code" href="crop_parameters_data_8h.html#af71819066527a8ec2b9968375a84c8c3">theCropData</a>-&gt;<a class="code" href="classcrop_parameters_data.html#a974234ed057f31576b86794c04d78916">getPhotoSyntActPart</a>();            <span class="comment">// Photosynthetic active part of total global radiation</span>
<a name="l00089"></a>00089    <a class="code" href="classcrop.html#a668a3be41e3f465357ee7ad27e261a02">CoeffGreenIdx</a>                = <a class="code" href="crop_parameters_data_8h.html#af71819066527a8ec2b9968375a84c8c3">theCropData</a>-&gt;<a class="code" href="classcrop_parameters_data.html#ac5f8c1553dc2bf86f388f716a3ee120c">getCoeffGreenIdx</a>();          <span class="comment">// Coefficient for leaf growth</span>
<a name="l00090"></a>00090    <a class="code" href="classcrop.html#aa53e9f0b5c21a1dafb1d78291820350d">LAINitrogenRatio</a>             =<a class="code" href="crop_parameters_data_8h.html#af71819066527a8ec2b9968375a84c8c3">theCropData</a>-&gt;<a class="code" href="classcrop_parameters_data.html#ad820ac4fb35ccbb6840d70dfef1dcb0c">getLAINitrogenRatio</a>();             <span class="comment">// Maximum ratio between LAI and nitrogen in veg top</span>
<a name="l00091"></a>00091    <a class="code" href="classcrop.html#ac84c4bfe32722d43f1edf0f3954bf6d9">LAIDMRatio</a>                   = <a class="code" href="crop_parameters_data_8h.html#af71819066527a8ec2b9968375a84c8c3">theCropData</a>-&gt;<a class="code" href="classcrop_parameters_data.html#a1d3996b7496bd36243b71a45b0bef44f">getLAIDMRatio</a>();           <span class="comment">// Maximum ratio between LAI and DM in veg top</span>
<a name="l00092"></a>00092    <a class="code" href="classcrop.html#af3aac84af1f2d62509c26dfe15d1756c">InitialCAI</a>                   = <a class="code" href="crop_parameters_data_8h.html#af71819066527a8ec2b9968375a84c8c3">theCropData</a>-&gt;<a class="code" href="classcrop_parameters_data.html#ad28cad4f7d95f19f23a7e300ecf96307">getInitialCAI</a>();            <span class="comment">// Initial green leaf area index after 200 degree days</span>
<a name="l00093"></a>00093    <a class="code" href="classcrop.html#a99a529deb646061aa62fcb9953844de2">MinimumSenescense</a>            = <a class="code" href="crop_parameters_data_8h.html#af71819066527a8ec2b9968375a84c8c3">theCropData</a>-&gt;<a class="code" href="classcrop_parameters_data.html#ad825c1deaa19c31534f6afde1d61d1be">getMinimumSenescense</a>();            <span class="comment">// Used to calculate minimum senescense - value as calibrated for winter wheat</span>
<a name="l00094"></a>00094    <a class="code" href="classcrop.html#a211a8242464133985cb2f26964b0f782">MaxPlantHeight</a>               = <a class="code" href="crop_parameters_data_8h.html#af71819066527a8ec2b9968375a84c8c3">theCropData</a>-&gt;<a class="code" href="classcrop_parameters_data.html#adf91433805863b5a337eb95d356c01b8">getMaxPlantHeight</a>();             <span class="comment">// Max plant height (m)</span>
<a name="l00095"></a>00095    <a class="code" href="classcrop.html#a94bdf58b80c10956d690e55f9dfc3bf8">LAIDistributionPar</a>           = <a class="code" href="crop_parameters_data_8h.html#af71819066527a8ec2b9968375a84c8c3">theCropData</a>-&gt;<a class="code" href="classcrop_parameters_data.html#a79ea69f9298d94620cf598266e733904">getLAIDistributionPar</a>();             <span class="comment">// Distribution of LAI in canopy</span>
<a name="l00096"></a>00096    <a class="code" href="classcrop.html#a3a262508a417bdfee36e9961ec283d96">Conversfactor</a>                = <a class="code" href="crop_parameters_data_8h.html#af71819066527a8ec2b9968375a84c8c3">theCropData</a>-&gt;<a class="code" href="classcrop_parameters_data.html#acdfddaf79e12dc108b62126177033594">getConversfactor</a>();             <span class="comment">// Part of green leaf that is converted to yellow leaf by wilting</span>
<a name="l00097"></a>00097 
<a name="l00098"></a>00098    <a class="code" href="classcrop.html#a787dec1e35057a17b4837bc01fc34350">ColonialisationRate</a>          = <a class="code" href="crop_parameters_data_8h.html#af71819066527a8ec2b9968375a84c8c3">theCropData</a>-&gt;<a class="code" href="classcrop_parameters_data.html#acba11ee1ba2dbd8854b368d02fc45032">getColonialisationRate</a>();           <span class="comment">// Expansion of fraction area occupied (per day per degree Celcius)</span>
<a name="l00099"></a>00099 
<a name="l00100"></a>00100    <a class="code" href="classcrop.html#a5eb2d5b9554ecd6e8f7f32b229509b67">WaterDeficitVegGrowth</a>        = <a class="code" href="crop_parameters_data_8h.html#af71819066527a8ec2b9968375a84c8c3">theCropData</a>-&gt;<a class="code" href="classcrop_parameters_data.html#afa681d8abf6169e0d613645ecd20e0f7">getWaterDeficitVegGrowth</a>();
<a name="l00101"></a>00101    <a class="code" href="classcrop.html#a4a332805f2e6027e5e2e18e2bf7cae17">WaterDeficitLagPhase</a>         = <a class="code" href="crop_parameters_data_8h.html#af71819066527a8ec2b9968375a84c8c3">theCropData</a>-&gt;<a class="code" href="classcrop_parameters_data.html#ab2c98971d22f1097fd98250e2198420f">getWaterDeficitLagPhase</a>();
<a name="l00102"></a>00102    <a class="code" href="classcrop.html#abcc0955968163247c126f91191a4c782">WaterDeficitGrainFill</a>        = <a class="code" href="crop_parameters_data_8h.html#af71819066527a8ec2b9968375a84c8c3">theCropData</a>-&gt;<a class="code" href="classcrop_parameters_data.html#a00e2a45489b9ef0b36d8d0c85df1ab68">getWaterDeficitGrainFill</a>();
<a name="l00103"></a>00103 
<a name="l00104"></a>00104         <a class="code" href="classcrop.html#a86b3309065f886170bff7ad71c0a853f">FractionNminInRoots</a>             = <a class="code" href="crop_parameters_data_8h.html#af71819066527a8ec2b9968375a84c8c3">theCropData</a>-&gt;<a class="code" href="classcrop_parameters_data.html#a9c4ed1c0b4f79977b2753916c9a87e5f">getFractionNminInRoots</a>();        <span class="comment">//Fraction of N in roots present as mineral N</span>
<a name="l00105"></a>00105    <a class="code" href="classcrop.html#a3ac764feb8fb805863a89f3fbda9f831">FractionNminInVegTop</a>         = <a class="code" href="crop_parameters_data_8h.html#af71819066527a8ec2b9968375a84c8c3">theCropData</a>-&gt;<a class="code" href="classcrop_parameters_data.html#a73c9a4640b7a670266be0ce577a2abf1">getFractionNminInVegTop</a>();       <span class="comment">//Fraction of N in VegTop present as mineral N</span>
<a name="l00106"></a>00106    <a class="code" href="classcrop.html#a40992582378c797a8b5a4b8d9aef6d2b">CO2Effect</a>                                    = <a class="code" href="crop_parameters_data_8h.html#af71819066527a8ec2b9968375a84c8c3">theCropData</a>-&gt;<a class="code" href="classcrop_parameters_data.html#afb5f62d967d7956fef454cd4a7baedac">getCO2Effect</a>();
<a name="l00107"></a>00107         <a class="code" href="classcrop.html#a79905dd2d78bdaafd9569f9ecdd43665">MaxGLAICrop</a>                             = <a class="code" href="crop_parameters_data_8h.html#af71819066527a8ec2b9968375a84c8c3">theCropData</a>-&gt;<a class="code" href="classcrop_parameters_data.html#ab6e1eaf3c0a691966cce47d06309621b">getMaxGLAICrop</a>();
<a name="l00108"></a>00108 
<a name="l00109"></a>00109 
<a name="l00110"></a>00110 
<a name="l00111"></a>00111 
<a name="l00112"></a>00112    <a class="code" href="classcrop.html#a252ade240154c71d644732abc9304f79">RhizoDepositFraction</a>         = <a class="code" href="crop_parameters_data_8h.html#af71819066527a8ec2b9968375a84c8c3">theCropData</a>-&gt;<a class="code" href="classcrop_parameters_data.html#a2aa8da3142a9596b5770653c70b94bd0">getRhizoDepositFraction</a>();
<a name="l00113"></a>00113    <a class="code" href="classcrop.html#ab94a62632b347617f4f62b317a16ff73">FillFactor</a>                                   = <a class="code" href="crop_parameters_data_8h.html#af71819066527a8ec2b9968375a84c8c3">theCropData</a>-&gt;<a class="code" href="classcrop_parameters_data.html#a49aee90af022f2746e88a04dfad5ccd4">getFillFactor</a>();                  <span class="comment">// Fraction of net production after anthesis that goes into grain</span>
<a name="l00114"></a>00114 
<a name="l00115"></a>00115    <a class="code" href="classcrop.html#aa050617ad81407650b6bd3150b8c5b93" title="How much Nitrogen that the plant has given to the soil via roots.">AccumulatedRootNDeposit</a>.<a class="code" href="classnitrogen.html#a706b101d934ddb44c4bff07761c8dfef">Clear</a>();  <span class="comment">// Accumulated root N deposition (state variable)</span>
<a name="l00116"></a>00116    <a class="code" href="classcrop.html#ad9583ee2f76a5141a1a54ebea83627fe" title="How much Nitrogen that the plant gives to the ground via dead leafs.">AccumulatedTopNDeposit</a>.<a class="code" href="classnitrogen.html#a706b101d934ddb44c4bff07761c8dfef">Clear</a>();   <span class="comment">// Accumulated root N deposition (state variable)</span>
<a name="l00117"></a>00117    <a class="code" href="classcrop.html#ac99038132c4676e35b98265edb34a213" title="Noone knows that this is.">AccumulatedNProduction</a>.<a class="code" href="classnitrogen.html#a706b101d934ddb44c4bff07761c8dfef">Clear</a>();   <span class="comment">// Accumulated N production</span>
<a name="l00118"></a>00118 
<a name="l00119"></a>00119 
<a name="l00120"></a>00120         <span class="comment">// State variables</span>
<a name="l00121"></a>00121    <a class="code" href="classcrop.html#ac9e8384797116e758558faff120ae56d">AccumulatedDMProduction</a> = 0.0;    <span class="comment">// Accumulated DM production</span>
<a name="l00122"></a>00122    <a class="code" href="classcrop.html#ad4c7a7759997919efa9c9befb53cab69">AccumulatedNFixation</a> = 0.0;       <span class="comment">// Accumulated N fixation (used for output)</span>
<a name="l00123"></a>00123    <a class="code" href="classcrop.html#a29dcfc8e28d3f6689a94184c968a1882">AccumulatedRootDeposit</a> = 0.0;     <span class="comment">// Accumulated root deposition (state variable)</span>
<a name="l00124"></a>00124    <a class="code" href="classcrop.html#a9342a07dc579e1e3169eba7060741339">AccumulatedRootRespiration</a> = 0.0; <span class="comment">// Measured in DM</span>
<a name="l00125"></a>00125    <a class="code" href="classcrop.html#a9bf4f47a0a193df878aa15b364dbec14">AccumulatedTopDeposit</a> = 0.0;      <span class="comment">// Accumulated root deposition (state variable)</span>
<a name="l00126"></a>00126    <a class="code" href="classcrop.html#a0491b172b4874adcd1b3930cb3be00fe">DeltaDMTop</a>           = 0.0;       <span class="comment">// Daily top DM increase (used for output)</span>
<a name="l00127"></a>00127    <a class="code" href="classcrop.html#a3c5f4942cf46d45168caf4da80b79537">DryMatterRoot</a>        = 0.0;       <span class="comment">// Dry matter in root.</span>
<a name="l00128"></a>00128    <a class="code" href="classcrop.html#a4a2803c0618d2f662abfa8d230c811df">DryMatterStorage</a>     = 0.0;       <span class="comment">// Dry matter in storage organs.</span>
<a name="l00129"></a>00129    <a class="code" href="classcrop.html#ae5c58459f879a52a543bc517918513fd">DryMatterTotalStandVegTop</a> = 0.0;  <span class="comment">// Presently unused</span>
<a name="l00130"></a>00130    <a class="code" href="classcrop.html#a755b12e801a538bb34a8c7b829047e76">DryMatterVegTop</a>      = 0.0;       <span class="comment">// Dry matter in veg. parts above soil surface.</span>
<a name="l00131"></a>00131    <a class="code" href="classcrop.html#ac8a4c50c9066688c48f1d8fc6df8561c">fNitrogenAfterRipe</a>   = 0.0;
<a name="l00132"></a>00132    <a class="code" href="classcrop.html#a394d3da7bbc4c297a68b5c6f575c5ecc">fractionOfSpace</a>      = 1.0;       <span class="comment">// Fraction of total area occupied by crop</span>
<a name="l00133"></a>00133    <a class="code" href="classcrop.html#a2691a60a48a5166469df5da0e0e824fb">GreenCropAreaIndex</a>   = 0.0;       <span class="comment">// Green leaf crop index.</span>
<a name="l00134"></a>00134    <a class="code" href="classcrop.html#a86aa841b9bfef88701e24c3a1922bba5">InitialSeedDM</a>        = 0.0;       <span class="comment">// The initial DM in seed</span>
<a name="l00135"></a>00135    <a class="code" href="classcrop.html#af42802c05fc1e8dcba94d04bcb41f163">InterceptedRadiation</a> = 0.0;       <span class="comment">// Radiation intercepted</span>
<a name="l00136"></a>00136    <a class="code" href="classcrop.html#a7cc6a117013deeda470335c166066615">maxGLAI</a>              = 0.0;       <span class="comment">// Maximum green crop area index reached</span>
<a name="l00137"></a>00137         <a class="code" href="classcrop.html#a10ecc3d91cd9e62af94a5b889587d3f4">MaxRootDepth</a>=<a class="code" href="classcrop.html#aa37b1e6e7ca46537edb64086518d5088">MaxRootDepthCrop</a>;    <span class="comment">// Max. root depth. May be reduced later, depending on soil.</span>
<a name="l00138"></a>00138    <a class="code" href="classcrop.html#a3f40980535ac184d9cced18aff1a0f8c">PlantHeight</a>          = 0.0;       <span class="comment">// Height (m)</span>
<a name="l00139"></a>00139    <a class="code" href="classcrop.html#aa4666fdd11920e05003bfeefc5518ddf">RelativeDensity</a>      = 1.0;
<a name="l00140"></a>00140    <a class="code" href="classcrop.html#a089361fdbd7eedb3b84e501ebc4f7221">Rg</a>                   = 0.0;
<a name="l00141"></a>00141    <a class="code" href="classcrop.html#a512f2450d70fb9f2a84d046d5a090a94">RootDensAtSurf</a>       = 0.0;       <span class="comment">// Root density at soil surface.</span>
<a name="l00142"></a>00142    <a class="code" href="classcrop.html#aefe9049cee98b6ac81f4362c4a1190a9">RootDepth</a>            = 0.0;       <span class="comment">// Root depth.</span>
<a name="l00143"></a>00143    <a class="code" href="classcrop.html#ab27528bd7fd066f3c4e028de1fbc70e1">RootRespiration</a>      = 0.0;       <span class="comment">// Daily root respiration (DM m-2)</span>
<a name="l00144"></a>00144    <a class="code" href="classcrop.html#a15b020b5308e854371c7919b1ebe64ab">RootTranslocation</a>    = 0.0;       <span class="comment">// Accumulated root translocation (state variable)</span>
<a name="l00145"></a>00145    <a class="code" href="classcrop.html#a2dfb21c27aff36f3049be9a39e7c6538">SeedDM</a>               = 0.0;       <span class="comment">// The DM content of seed</span>
<a name="l00146"></a>00146    <a class="code" href="classcrop.html#abfc8df1469f20d8084f744da461d1df5">temp</a>                 = 0.0;       <span class="comment">// temperature</span>
<a name="l00147"></a>00147    <a class="code" href="classcrop.html#a362d42d586668dca552ec4d8cd381b68">TempSumRoot</a>          = 0.0;       <span class="comment">// Temperature sum, root.</span>
<a name="l00148"></a>00148    <a class="code" href="classcrop.html#ac25231ecf44f1c5ffb8bf60c45334929">totalLAIStand</a>        = 0.0;       <span class="comment">// Sum of leaf area index for all plants</span>
<a name="l00149"></a>00149    <a class="code" href="classcrop.html#a1f0aa4443cf11cdf5776454bd056fa28">TotalRootLength</a>      = 0.0;       <span class="comment">// Total root length.</span>
<a name="l00150"></a>00150    <a class="code" href="classcrop.html#a0c55583d4613cc09bb912de3078aae49">TransferableStorage</a>  = 0.0;       <span class="comment">// Amount to be transfer from vegetative parts to storage</span>
<a name="l00151"></a>00151    <a class="code" href="classcrop.html#ab1133e34965bc17531d6bbf675cfa240">TransferedDMToStorage</a>= 0.0;       <span class="comment">// Actual amount to be transfer from vegetavive parts to storage</span>
<a name="l00152"></a>00152    <a class="code" href="classcrop.html#a461228045f8a07f1f12a06acd12adf89">TranspirationRatio</a>   = 1.0;
<a name="l00153"></a>00153    <a class="code" href="classcrop.html#a7acb3fa412808c819f4d9b662cc2148c">YellowCropAreaIndex</a>  = 0.0;       <span class="comment">// Yellow leaf crop index.</span>
<a name="l00154"></a>00154 
<a name="l00155"></a>00155         <a class="code" href="classcrop.html#adabbdde8753e5ae0ecd238e221429d88" title="How much Nitrogen that is in the plant.">Nitrogen</a>.<a class="code" href="classnitrogen.html#a706b101d934ddb44c4bff07761c8dfef">Clear</a>();                 <span class="comment">// Nitrogen content (g/m^2).</span>
<a name="l00156"></a>00156 <span class="comment">//   FractionInStorage    = 0.0;       // Fraction of dry matter constituting of storage organs.</span>
<a name="l00157"></a>00157 <span class="comment">//   CurrentNPct          = 10.0;</span>
<a name="l00158"></a>00158 <span class="comment">//   rootMatter = NULL;                // Transfered to soil</span>
<a name="l00159"></a>00159    <span class="comment">//next three lines added by NJH March 2009</span>
<a name="l00160"></a>00160               <a class="code" href="classcrop.html#a2ca05aa427979d52b8fbbba1cc5150cf">rootMatter</a> = <span class="keyword">new</span> <a class="code" href="classdecomposable.html">decomposable</a>; <span class="comment">// Remark: rootmatter is transfered to soil in patch.cpp !</span>
<a name="l00161"></a>00161               <a class="code" href="classcrop.html#a2ca05aa427979d52b8fbbba1cc5150cf">rootMatter</a>-&gt;<a class="code" href="classproduct.html#a0219cde65dc26376f3371a0138199ba8">Setname</a>(<span class="stringliteral">&quot;ROOTMATTER&quot;</span>);
<a name="l00162"></a>00162               <a class="code" href="_new_main_8cpp.html#af1019990138497f1f18cc7294737d140">theProducts</a>-&gt;<a class="code" href="classproducts.html#a8bd239aabc0a167741c02882e305d65d">GiveProductInformation</a>(<a class="code" href="classcrop.html#a2ca05aa427979d52b8fbbba1cc5150cf">rootMatter</a>);
<a name="l00163"></a>00163    <a class="code" href="classcrop.html#a4a8b0a766947fe8b0dfc6a59a24b9bef">topMatter</a>  = NULL;                <span class="comment">// Transfered to soil</span>
<a name="l00164"></a>00164         <a class="code" href="classcrop.html#add8f384e82643550fa78abd7382abc4f" title="Describe how many layers a plan has. It is use to distribute sunlight.">NumOfLayers</a>=<a class="code" href="typer_8h.html#a61dadd085c1777f559549e05962b2c9ea489863aec95253fced254923e4cb8148">MaxSoilLayers</a>;        <span class="comment">// Number of soil layers.</span>
<a name="l00165"></a>00165    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;<a class="code" href="typer_8h.html#a61dadd085c1777f559549e05962b2c9ea489863aec95253fced254923e4cb8148">MaxSoilLayers</a>;i++)
<a name="l00166"></a>00166    {
<a name="l00167"></a>00167                 <a class="code" href="classcrop.html#ad629acdfd462323490f91ad3ce9a7b59">RootLengthList</a>[i]=0.0;         <span class="comment">// &#39;RootLengthList&#39; contains the root length (m) per layer.</span>
<a name="l00168"></a>00168         <a class="code" href="classcrop.html#a26eb467869df5fc16784e0b42798cc4b">LayerThickness</a>[i]=-1;          <span class="comment">// Thickness (mm) per layer.</span>
<a name="l00169"></a>00169    }
<a name="l00170"></a>00170    <a class="code" href="classcrop.html#af7ae14fac12af3efa728e789155983fb">Nbudget</a>.<a class="code" href="classbudget.html#ada0ca75f0dd9d8a6d0dfd5fcbd666653">SetNames</a>(<span class="stringliteral">&quot;crop&quot;</span>,<span class="stringliteral">&quot;N&quot;</span>);
<a name="l00171"></a>00171    <a class="code" href="classcrop.html#a3e5fad944be35152e933b5e50f928f5a">N15budget</a>.<a class="code" href="classbudget.html#ada0ca75f0dd9d8a6d0dfd5fcbd666653">SetNames</a>(<span class="stringliteral">&quot;crop&quot;</span>,<span class="stringliteral">&quot;N15&quot;</span>);
<a name="l00172"></a>00172    <a class="code" href="classcrop.html#a46844fd0540eb7627555f21afa8545e8">DMbudget</a>.<a class="code" href="classbudget.html#ada0ca75f0dd9d8a6d0dfd5fcbd666653">SetNames</a>(<span class="stringliteral">&quot;crop&quot;</span>,<span class="stringliteral">&quot;DM&quot;</span>);
<a name="l00173"></a>00173    <a class="code" href="classcrop.html#aaf7bdd66e714b1ad4057bad5a46e6772">aSoil</a>                = NULL;
<a name="l00174"></a>00174    <a class="code" href="classcrop.html#a38f05d3f77cfc67ff755eb8c0d79e301">Phenology</a>            = <span class="keyword">new</span> <a class="code" href="classphenology.html">phenology</a>;
<a name="l00175"></a>00175 }
<a name="l00176"></a>00176 
<a name="l00177"></a>00177 <span class="comment">/****************************************************************************\</span>
<a name="l00178"></a>00178 <span class="comment">Destructor.</span>
<a name="l00179"></a>00179 <span class="comment">\****************************************************************************/</span>
<a name="l00180"></a><a class="code" href="classcrop.html#a87d279e2be25081212cf17871c177388">00180</a> <a class="code" href="classcrop.html#a87d279e2be25081212cf17871c177388">crop::~crop</a>()
<a name="l00181"></a>00181 {
<a name="l00182"></a>00182         <span class="keywordflow">if</span> (<a class="code" href="classcrop.html#a4a8b0a766947fe8b0dfc6a59a24b9bef">topMatter</a>)
<a name="l00183"></a>00183       <span class="keyword">delete</span> <a class="code" href="classcrop.html#a4a8b0a766947fe8b0dfc6a59a24b9bef">topMatter</a>;
<a name="l00184"></a>00184    <span class="keywordflow">if</span> (<a class="code" href="classcrop.html#a2ca05aa427979d52b8fbbba1cc5150cf">rootMatter</a>)
<a name="l00185"></a>00185       <span class="keyword">delete</span> <a class="code" href="classcrop.html#a2ca05aa427979d52b8fbbba1cc5150cf">rootMatter</a>;
<a name="l00186"></a>00186    <span class="keywordflow">if</span> (<a class="code" href="classcrop.html#a38f05d3f77cfc67ff755eb8c0d79e301">Phenology</a>)
<a name="l00187"></a>00187       <span class="keyword">delete</span> <a class="code" href="classcrop.html#a38f05d3f77cfc67ff755eb8c0d79e301">Phenology</a>;
<a name="l00188"></a>00188    <a class="code" href="classcrop.html#a4a8b0a766947fe8b0dfc6a59a24b9bef">topMatter</a>  = NULL;
<a name="l00189"></a>00189    <a class="code" href="classcrop.html#a2ca05aa427979d52b8fbbba1cc5150cf">rootMatter</a> = NULL;
<a name="l00190"></a>00190    <a class="code" href="classcrop.html#a38f05d3f77cfc67ff755eb8c0d79e301">Phenology</a>  = NULL;
<a name="l00191"></a>00191 }
<a name="l00192"></a>00192 
<a name="l00193"></a>00193 <span class="comment">/****************************************************************************\</span>
<a name="l00194"></a>00194 <span class="comment">\****************************************************************************/</span>
<a name="l00195"></a><a class="code" href="classcrop.html#ae21f526e78ac3bcfe9f71a58d785b7bf">00195</a> crop::crop(<span class="keyword">const</span> <a class="code" href="classcrop.html">crop</a>&amp; acrop)
<a name="l00196"></a>00196 {
<a name="l00197"></a>00197    <a class="code" href="classcrop.html#af852d2f62dd22411199ae8e164536a7d">CropName</a>                 = acrop.<a class="code" href="classcrop.html#af852d2f62dd22411199ae8e164536a7d">CropName</a>;
<a name="l00198"></a>00198         <a class="code" href="classcrop.html#af982befddb79f8aedfa207bce540c47a">PlantItemName</a>                            = acrop.<a class="code" href="classcrop.html#af982befddb79f8aedfa207bce540c47a">PlantItemName</a>;
<a name="l00199"></a>00199    <a class="code" href="classcrop.html#aa2aceced21d0fee166e40a836c2ee9cc">StrawItemName</a>            = acrop.<a class="code" href="classcrop.html#aa2aceced21d0fee166e40a836c2ee9cc">StrawItemName</a>;
<a name="l00200"></a>00200    <a class="code" href="classcrop.html#af94e599e6f05fae15099673485d28e88" title="Describe if a plan is dead(true) or alive(false)">terminated</a>               = acrop.<a class="code" href="classcrop.html#af94e599e6f05fae15099673485d28e88" title="Describe if a plan is dead(true) or alive(false)">terminated</a>;
<a name="l00201"></a>00201    <a class="code" href="classcrop.html#a23c5f9e6bead96515b31e977405637d8">PhotoSyntActPart</a>         = acrop.<a class="code" href="classcrop.html#a23c5f9e6bead96515b31e977405637d8">PhotoSyntActPart</a>;           <span class="comment">// Photosynthetic active part of total global radiation</span>
<a name="l00202"></a>00202         <a class="code" href="classcrop.html#a6ea7c6dccd7cf399d9276d0328c142cb">RootpF</a>                   = acrop.<a class="code" href="classcrop.html#a6ea7c6dccd7cf399d9276d0328c142cb">RootpF</a>;                     <span class="comment">// Water potential at wilting point</span>
<a name="l00203"></a>00203         <a class="code" href="classcrop.html#aea1414f901f3fc6d6ad5e8d2936ea409">MinDMtemp</a>                = acrop.<a class="code" href="classcrop.html#aea1414f901f3fc6d6ad5e8d2936ea409">MinDMtemp</a>;                  <span class="comment">// Minimum temperature for dry matter production</span>
<a name="l00204"></a>00204         <a class="code" href="classcrop.html#a6c3d05934ce21df6acb4161c3baab56e">MaxDMtemp</a>                = acrop.<a class="code" href="classcrop.html#a6c3d05934ce21df6acb4161c3baab56e">MaxDMtemp</a>;                  <span class="comment">// Maximum temperature for dry matter production</span>
<a name="l00205"></a>00205         <a class="code" href="classcrop.html#ace1e4d77fd9e80f3cd5c301927e03630">MaxRadUseEff</a>             = acrop.<a class="code" href="classcrop.html#ace1e4d77fd9e80f3cd5c301927e03630">MaxRadUseEff</a>;               <span class="comment">// Maximum radiation use efficiency (g/MJ)</span>
<a name="l00206"></a>00206         <a class="code" href="classcrop.html#a668a3be41e3f465357ee7ad27e261a02">CoeffGreenIdx</a>            = acrop.<a class="code" href="classcrop.html#a668a3be41e3f465357ee7ad27e261a02">CoeffGreenIdx</a>;              <span class="comment">// Coefficient for leaf growth, exp. phase</span>
<a name="l00207"></a>00207    <a class="code" href="classcrop.html#aa53e9f0b5c21a1dafb1d78291820350d">LAINitrogenRatio</a>         = acrop.<a class="code" href="classcrop.html#aa53e9f0b5c21a1dafb1d78291820350d">LAINitrogenRatio</a>;           <span class="comment">// Maximum ratio between LAI and nitrogen in veg top</span>
<a name="l00208"></a>00208    <a class="code" href="classcrop.html#ac84c4bfe32722d43f1edf0f3954bf6d9">LAIDMRatio</a>               = acrop.<a class="code" href="classcrop.html#ac84c4bfe32722d43f1edf0f3954bf6d9">LAIDMRatio</a>;                 <span class="comment">// Maximum ratio between LAI and DM in veg top</span>
<a name="l00209"></a>00209    <a class="code" href="classcrop.html#a99a529deb646061aa62fcb9953844de2">MinimumSenescense</a>        = acrop.<a class="code" href="classcrop.html#a99a529deb646061aa62fcb9953844de2">MinimumSenescense</a>;          <span class="comment">// Used to calculate minimum senescense</span>
<a name="l00210"></a>00210    <a class="code" href="classcrop.html#a9836313fa9dae417e0d3a41850209e37">k</a>                        = acrop.<a class="code" href="classcrop.html#a9836313fa9dae417e0d3a41850209e37">k</a>;
<a name="l00211"></a>00211 
<a name="l00212"></a>00212         <a class="code" href="classcrop.html#ad789899ed1b1f807e992d207dceaa192">NCurveParam</a>              = acrop.<a class="code" href="classcrop.html#ad789899ed1b1f807e992d207dceaa192">NCurveParam</a>;              <span class="comment">// Power parameter of nitrogen fraction</span>
<a name="l00213"></a>00213    <a class="code" href="classcrop.html#a3a411cb751e18aaf088d266ee47c9420">MinN_Store</a>               = acrop.<a class="code" href="classcrop.html#a3a411cb751e18aaf088d266ee47c9420">MinN_Store</a>;               <span class="comment">// Minimum content of nitrogen i storage organs</span>
<a name="l00214"></a>00214         <a class="code" href="classcrop.html#a9f5ab366fce6f1259588cf5087cdb4c2">MaxN_Store</a>               = acrop.<a class="code" href="classcrop.html#a9f5ab366fce6f1259588cf5087cdb4c2">MaxN_Store</a>;               <span class="comment">// Maximum content of nitrogen i storage organs</span>
<a name="l00215"></a>00215         <a class="code" href="classcrop.html#a4ec1369c2adcd701d7c4676fce24310c">MinN_Root</a>                                = acrop.<a class="code" href="classcrop.html#a4ec1369c2adcd701d7c4676fce24310c">MinN_Root</a>;                <span class="comment">// Minimum content of nitrogen i root organs</span>
<a name="l00216"></a>00216         <a class="code" href="classcrop.html#a62361ade607f9cc57e226c1134ad0eb2">MaxN_Root</a>                                = acrop.<a class="code" href="classcrop.html#a62361ade607f9cc57e226c1134ad0eb2">MaxN_Root</a>;                <span class="comment">// Maximum content of nitrogen i root organs</span>
<a name="l00217"></a>00217    <a class="code" href="classcrop.html#a69df1a97a358dff8c354b08cb93908ec">PowDM</a>                                 = acrop.<a class="code" href="classcrop.html#a69df1a97a358dff8c354b08cb93908ec">PowDM</a>;                    <span class="comment">// Power of dry matter in nitrogen status calculation</span>
<a name="l00218"></a>00218    <a class="code" href="classcrop.html#ab71cf78ab9ac2779deeb032e7b36e47d">NPctMax</a>                                       = acrop.<a class="code" href="classcrop.html#ab71cf78ab9ac2779deeb032e7b36e47d">NPctMax</a>;                  <span class="comment">// Following Justes concept</span>
<a name="l00219"></a>00219    <a class="code" href="classcrop.html#a64b16d0f5b047dbd1c1fcdde7fd09a87">NPctMin</a>                                       = acrop.<a class="code" href="classcrop.html#a64b16d0f5b047dbd1c1fcdde7fd09a87">NPctMin</a>;                  <span class="comment">// Following Justes concept</span>
<a name="l00220"></a>00220    <a class="code" href="classcrop.html#ae5c58459f879a52a543bc517918513fd">DryMatterTotalStandVegTop</a>= acrop.<a class="code" href="classcrop.html#ae5c58459f879a52a543bc517918513fd">DryMatterTotalStandVegTop</a>;
<a name="l00221"></a>00221    <a class="code" href="classcrop.html#a3a262508a417bdfee36e9961ec283d96">Conversfactor</a>            = acrop.<a class="code" href="classcrop.html#a3a262508a417bdfee36e9961ec283d96">Conversfactor</a>;             <span class="comment">// Part of green leaf that is converted to yellow leaf by wilting</span>
<a name="l00222"></a>00222         <a class="code" href="classcrop.html#ac51148719f4b421963566a281b04c0cf">InitialRootDepth</a>         = acrop.<a class="code" href="classcrop.html#ac51148719f4b421963566a281b04c0cf">InitialRootDepth</a>;          <span class="comment">// Root depth by germination</span>
<a name="l00223"></a>00223         <a class="code" href="classcrop.html#ac3e7efec04f1437634c82c1c3d045924">RootPentrRate</a>            = acrop.<a class="code" href="classcrop.html#ac3e7efec04f1437634c82c1c3d045924">RootPentrRate</a>;             <span class="comment">// Root penetration rate</span>
<a name="l00224"></a>00224         <a class="code" href="classcrop.html#aab8805ada2711ddb5996d9e87376eb21">TempRootMin</a>              = acrop.<a class="code" href="classcrop.html#aab8805ada2711ddb5996d9e87376eb21">TempRootMin</a>;               <span class="comment">// Minimum temperature for root growth</span>
<a name="l00225"></a>00225         <a class="code" href="classcrop.html#a56cef92be3d0cb8376b13f1666c469e2">SpecificRootLength</a>       = acrop.<a class="code" href="classcrop.html#a56cef92be3d0cb8376b13f1666c469e2">SpecificRootLength</a>;        <span class="comment">// Specific root length, m pr. kg.</span>
<a name="l00226"></a>00226         <a class="code" href="classcrop.html#a8ee0da1040a104bfc08b4618d3574db1">MaxAllocToRoot</a>           = acrop.<a class="code" href="classcrop.html#a8ee0da1040a104bfc08b4618d3574db1">MaxAllocToRoot</a>;            <span class="comment">// Maximal fraction of dry matter production that is allocated to the root</span>
<a name="l00227"></a>00227         <a class="code" href="classcrop.html#a366215bb50374cc375870081f55df157">MinAllocToRoot</a>           = acrop.<a class="code" href="classcrop.html#a366215bb50374cc375870081f55df157">MinAllocToRoot</a>;            <span class="comment">// Minimal fraction of dry matter production that is allocated to the root</span>
<a name="l00228"></a>00228         <a class="code" href="classcrop.html#aa37b1e6e7ca46537edb64086518d5088">MaxRootDepthCrop</a>         = acrop.<a class="code" href="classcrop.html#aa37b1e6e7ca46537edb64086518d5088">MaxRootDepthCrop</a>;          <span class="comment">// Maximal root depth for this crop</span>
<a name="l00229"></a>00229    <a class="code" href="classcrop.html#afe8c6c11905d19aca8f9623180b8462f">DecayRoot</a>                = acrop.<a class="code" href="classcrop.html#afe8c6c11905d19aca8f9623180b8462f">DecayRoot</a>;
<a name="l00230"></a>00230         <a class="code" href="classcrop.html#a38f05d3f77cfc67ff755eb8c0d79e301">Phenology</a>                = <span class="keyword">new</span> <a class="code" href="classphenology.html">phenology</a>(*acrop.<a class="code" href="classcrop.html#a38f05d3f77cfc67ff755eb8c0d79e301">Phenology</a>); <span class="comment">// Phenology</span>
<a name="l00231"></a>00231 
<a name="l00232"></a>00232    <a class="code" href="classcrop.html#a5eb2d5b9554ecd6e8f7f32b229509b67">WaterDeficitVegGrowth</a> = acrop.<a class="code" href="classcrop.html#a5eb2d5b9554ecd6e8f7f32b229509b67">WaterDeficitVegGrowth</a>;
<a name="l00233"></a>00233    <a class="code" href="classcrop.html#a4a332805f2e6027e5e2e18e2bf7cae17">WaterDeficitLagPhase</a>  = acrop.<a class="code" href="classcrop.html#a4a332805f2e6027e5e2e18e2bf7cae17">WaterDeficitLagPhase</a>;
<a name="l00234"></a>00234    <a class="code" href="classcrop.html#abcc0955968163247c126f91191a4c782">WaterDeficitGrainFill</a> = acrop.<a class="code" href="classcrop.html#abcc0955968163247c126f91191a4c782">WaterDeficitGrainFill</a>;
<a name="l00235"></a>00235 
<a name="l00236"></a>00236    <a class="code" href="classcrop.html#a86b3309065f886170bff7ad71c0a853f">FractionNminInRoots</a> = acrop.<a class="code" href="classcrop.html#a86b3309065f886170bff7ad71c0a853f">FractionNminInRoots</a>;
<a name="l00237"></a>00237    <a class="code" href="classcrop.html#a3ac764feb8fb805863a89f3fbda9f831">FractionNminInVegTop</a> = acrop.<a class="code" href="classcrop.html#a3ac764feb8fb805863a89f3fbda9f831">FractionNminInVegTop</a>;
<a name="l00238"></a>00238 
<a name="l00239"></a>00239 <span class="comment">// TempSumR1  = acrop.TempSumR1;                               //     See p. 160 in DAISY-description</span>
<a name="l00240"></a>00240 <span class="comment">//      TempSumR2  = acrop.TempSumR2;                               //     See p. 160 in DAISY-description</span>
<a name="l00241"></a>00241         <a class="code" href="classcrop.html#abfc8df1469f20d8084f744da461d1df5">temp</a>       = acrop.<a class="code" href="classcrop.html#abfc8df1469f20d8084f744da461d1df5">temp</a>;
<a name="l00242"></a>00242 
<a name="l00243"></a>00243    <a class="code" href="classcrop.html#a211a8242464133985cb2f26964b0f782">MaxPlantHeight</a>         = acrop.<a class="code" href="classcrop.html#a211a8242464133985cb2f26964b0f782">MaxPlantHeight</a>;
<a name="l00244"></a>00244 <span class="comment">//   DryMatterVegTopLinear  = acrop.DryMatterVegTopLinear;</span>
<a name="l00245"></a>00245    <a class="code" href="classcrop.html#a86aa841b9bfef88701e24c3a1922bba5">InitialSeedDM</a>          = acrop.<a class="code" href="classcrop.html#a86aa841b9bfef88701e24c3a1922bba5">InitialSeedDM</a>;
<a name="l00246"></a>00246    <a class="code" href="classcrop.html#af3aac84af1f2d62509c26dfe15d1756c">InitialCAI</a>             = acrop.<a class="code" href="classcrop.html#af3aac84af1f2d62509c26dfe15d1756c">InitialCAI</a>;
<a name="l00247"></a>00247    <a class="code" href="classcrop.html#a94dedacaf228ed611dd4a9c43fcf1140">MinimumRootDens</a>        = acrop.<a class="code" href="classcrop.html#a94dedacaf228ed611dd4a9c43fcf1140">MinimumRootDens</a>;
<a name="l00248"></a>00248    <a class="code" href="classcrop.html#a0bbe1011a2b6d4224bd986f26d5a1d39">ReducedNInYellow</a>       = acrop.<a class="code" href="classcrop.html#a0bbe1011a2b6d4224bd986f26d5a1d39">ReducedNInYellow</a>;
<a name="l00249"></a>00249 
<a name="l00250"></a>00250         <a class="code" href="classcrop.html#a068c7be7b71c0b4581ec57ffd204766b">InterceptCoeff</a>         = acrop.<a class="code" href="classcrop.html#a068c7be7b71c0b4581ec57ffd204766b">InterceptCoeff</a>;                           <span class="comment">// Coeff. for interceptioncapacity.</span>
<a name="l00251"></a>00251         <a class="code" href="classcrop.html#a0cbba1c8f072c0ae99c9465f5eadf2cb">NitrateUptakeRate</a>      = acrop.<a class="code" href="classcrop.html#a0cbba1c8f072c0ae99c9465f5eadf2cb">NitrateUptakeRate</a>;            <span class="comment">// Uptake rate for nitrate-N g/m/d (m root length)</span>
<a name="l00252"></a>00252         <a class="code" href="classcrop.html#a1707be6e4080e9ca3c3f24d6ffe0d6fa">AmmoniumUptakeRate</a>     = acrop.<a class="code" href="classcrop.html#a1707be6e4080e9ca3c3f24d6ffe0d6fa">AmmoniumUptakeRate</a>;           <span class="comment">// Uptake rate for ammonium-N g/m/d (m root length)</span>
<a name="l00253"></a>00253    <a class="code" href="classcrop.html#af1ec4e9a12abd41e5f5b39c87cfc2349">MinimumSoilNitrate</a>     = acrop.<a class="code" href="classcrop.html#af1ec4e9a12abd41e5f5b39c87cfc2349">MinimumSoilNitrate</a>;           <span class="comment">// Minimum concentration of nitrate-N left in soil water (g/l)</span>
<a name="l00254"></a>00254    <a class="code" href="classcrop.html#af11b53bf326f21dc1628289175ecb6d7">MinimumSoilAmmonium</a>    = acrop.<a class="code" href="classcrop.html#af11b53bf326f21dc1628289175ecb6d7">MinimumSoilAmmonium</a>;          <span class="comment">// Minimum concentration of ammonium-N left in soil water (g/l)</span>
<a name="l00255"></a>00255         <a class="code" href="classcrop.html#a7b2a38633965734c3298a4da248c6d53" title="Describe if a plan can grow trough winter.">WinterSeed</a>             = acrop.<a class="code" href="classcrop.html#a7b2a38633965734c3298a4da248c6d53" title="Describe if a plan can grow trough winter.">WinterSeed</a>;                   <span class="comment">// Is the present crop a wintercrop.</span>
<a name="l00256"></a>00256    <a class="code" href="classcrop.html#ab60ba190cccea48dbc2b7112b663545e">ConversionCoefficient</a>  = acrop.<a class="code" href="classcrop.html#ab60ba190cccea48dbc2b7112b663545e">ConversionCoefficient</a>;        <span class="comment">// Coefficent of DM conversion from vegetative to storage</span>
<a name="l00257"></a>00257    <a class="code" href="classcrop.html#ab94a62632b347617f4f62b317a16ff73">FillFactor</a>             = acrop.<a class="code" href="classcrop.html#ab94a62632b347617f4f62b317a16ff73">FillFactor</a>;
<a name="l00258"></a>00258    <a class="code" href="classcrop.html#a134737bfb7ce5b5c558f15a19232181f">GerminationConversion</a>  = acrop.<a class="code" href="classcrop.html#a134737bfb7ce5b5c558f15a19232181f">GerminationConversion</a>;
<a name="l00259"></a>00259    <a class="code" href="classcrop.html#ac8a4c50c9066688c48f1d8fc6df8561c">fNitrogenAfterRipe</a>     = acrop.<a class="code" href="classcrop.html#ac8a4c50c9066688c48f1d8fc6df8561c">fNitrogenAfterRipe</a>;
<a name="l00260"></a>00260 <span class="comment">//   fNitrogenAtFlowering   = acrop.fNitrogenAtFlowering;</span>
<a name="l00261"></a>00261    <a class="code" href="classcrop.html#a252ade240154c71d644732abc9304f79">RhizoDepositFraction</a>   = acrop.<a class="code" href="classcrop.html#a252ade240154c71d644732abc9304f79">RhizoDepositFraction</a>;
<a name="l00262"></a>00262    <a class="code" href="classcrop.html#a40992582378c797a8b5a4b8d9aef6d2b">CO2Effect</a>                      = acrop.<a class="code" href="classcrop.html#a40992582378c797a8b5a4b8d9aef6d2b">CO2Effect</a>;
<a name="l00263"></a>00263    <a class="code" href="classcrop.html#a79905dd2d78bdaafd9569f9ecdd43665">MaxGLAICrop</a>            = acrop.<a class="code" href="classcrop.html#a79905dd2d78bdaafd9569f9ecdd43665">MaxGLAICrop</a>;
<a name="l00264"></a>00264    <a class="code" href="classcrop.html#aa4666fdd11920e05003bfeefc5518ddf">RelativeDensity</a>        = acrop.<a class="code" href="classcrop.html#aa4666fdd11920e05003bfeefc5518ddf">RelativeDensity</a>;
<a name="l00265"></a>00265    <a class="code" href="classcrop.html#a158a4f00952108fdc19727bdc90765f9">TopFraction</a>            = acrop.<a class="code" href="classcrop.html#a158a4f00952108fdc19727bdc90765f9">TopFraction</a>;
<a name="l00266"></a>00266    <a class="code" href="classcrop.html#a15b020b5308e854371c7919b1ebe64ab">RootTranslocation</a>      = acrop.<a class="code" href="classcrop.html#a15b020b5308e854371c7919b1ebe64ab">RootTranslocation</a>;
<a name="l00267"></a>00267    <a class="code" href="classcrop.html#ac9e8384797116e758558faff120ae56d">AccumulatedDMProduction</a>= acrop.<a class="code" href="classcrop.html#ac9e8384797116e758558faff120ae56d">AccumulatedDMProduction</a>;
<a name="l00268"></a>00268    <a class="code" href="classcrop.html#a9bf4f47a0a193df878aa15b364dbec14">AccumulatedTopDeposit</a>  = acrop.<a class="code" href="classcrop.html#a9bf4f47a0a193df878aa15b364dbec14">AccumulatedTopDeposit</a>;
<a name="l00269"></a>00269    <a class="code" href="classcrop.html#af42802c05fc1e8dcba94d04bcb41f163">InterceptedRadiation</a>   = acrop.<a class="code" href="classcrop.html#af42802c05fc1e8dcba94d04bcb41f163">InterceptedRadiation</a>;
<a name="l00270"></a>00270    <a class="code" href="classcrop.html#adf0da70c2a7dc063b5bcb09730e155c6">StoreForFilling</a>        = acrop.<a class="code" href="classcrop.html#adf0da70c2a7dc063b5bcb09730e155c6">StoreForFilling</a>;
<a name="l00271"></a>00271 <span class="comment">//   CurrentNPct            = acrop.CurrentNPct;</span>
<a name="l00272"></a>00272    <a class="code" href="classcrop.html#ab1133e34965bc17531d6bbf675cfa240">TransferedDMToStorage</a>  = acrop.<a class="code" href="classcrop.html#ab1133e34965bc17531d6bbf675cfa240">TransferedDMToStorage</a>;
<a name="l00273"></a>00273         <a class="code" href="classcrop.html#aa050617ad81407650b6bd3150b8c5b93" title="How much Nitrogen that the plant has given to the soil via roots.">AccumulatedRootNDeposit</a>= acrop.<a class="code" href="classcrop.html#aa050617ad81407650b6bd3150b8c5b93" title="How much Nitrogen that the plant has given to the soil via roots.">AccumulatedRootNDeposit</a>;
<a name="l00274"></a>00274    <a class="code" href="classcrop.html#ad9583ee2f76a5141a1a54ebea83627fe" title="How much Nitrogen that the plant gives to the ground via dead leafs.">AccumulatedTopNDeposit</a> = acrop.<a class="code" href="classcrop.html#ad9583ee2f76a5141a1a54ebea83627fe" title="How much Nitrogen that the plant gives to the ground via dead leafs.">AccumulatedTopNDeposit</a>;
<a name="l00275"></a>00275         <a class="code" href="classcrop.html#ac99038132c4676e35b98265edb34a213" title="Noone knows that this is.">AccumulatedNProduction</a> = acrop.<a class="code" href="classcrop.html#ac99038132c4676e35b98265edb34a213" title="Noone knows that this is.">AccumulatedNProduction</a>;
<a name="l00276"></a>00276    <a class="code" href="classcrop.html#a8e7d3a42d931c8c1d95f92bb2669f2ef" title="Describe if a plan has been cut or harvested.">CutOrHarvested</a>         = acrop.<a class="code" href="classcrop.html#a8e7d3a42d931c8c1d95f92bb2669f2ef" title="Describe if a plan has been cut or harvested.">CutOrHarvested</a>;
<a name="l00277"></a>00277    <a class="code" href="classcrop.html#ac85050f76b5416047499dcdc854d6f41" title="Describe if a plan can fill.">FillFlag</a>               = acrop.<a class="code" href="classcrop.html#ac85050f76b5416047499dcdc854d6f41" title="Describe if a plan can fill.">FillFlag</a>;
<a name="l00278"></a>00278    <a class="code" href="classcrop.html#aef5d855a21b1f0227b429764dea1c8fe" title="Describe if the crop is a C4 crop (CO2 effect only on C3 crops)">C4Photosynthesis</a>       = acrop.<a class="code" href="classcrop.html#aef5d855a21b1f0227b429764dea1c8fe" title="Describe if the crop is a C4 crop (CO2 effect only on C3 crops)">C4Photosynthesis</a>;
<a name="l00279"></a>00279         <span class="comment">// State variables</span>
<a name="l00280"></a>00280    <a class="code" href="classcrop.html#a7cc6a117013deeda470335c166066615">maxGLAI</a>              =acrop.<a class="code" href="classcrop.html#a7cc6a117013deeda470335c166066615">maxGLAI</a>;                      <span class="comment">// Maximum green crop area index reached</span>
<a name="l00281"></a>00281         <a class="code" href="classcrop.html#a3bd248dac15a2aefd7289240ffeeb879">RootDensAtBottom</a>     =acrop.<a class="code" href="classcrop.html#a3bd248dac15a2aefd7289240ffeeb879">RootDensAtBottom</a>;             <span class="comment">// Rootdensity at rootdepth. Changes with seed density.</span>
<a name="l00282"></a>00282         <a class="code" href="classcrop.html#a10ecc3d91cd9e62af94a5b889587d3f4">MaxRootDepth</a>         =acrop.<a class="code" href="classcrop.html#a10ecc3d91cd9e62af94a5b889587d3f4">MaxRootDepth</a>;                 <span class="comment">// Max. root depth at actual soil type.</span>
<a name="l00283"></a>00283         <a class="code" href="classcrop.html#a5c8bcec383225ccfa1997ed7de4b2446">RootDistrParm</a>        =acrop.<a class="code" href="classcrop.html#a5c8bcec383225ccfa1997ed7de4b2446">RootDistrParm</a>;                <span class="comment">// Root density distribution parameter</span>
<a name="l00284"></a>00284         <a class="code" href="classcrop.html#adabbdde8753e5ae0ecd238e221429d88" title="How much Nitrogen that is in the plant.">Nitrogen</a>             =acrop.<a class="code" href="classcrop.html#adabbdde8753e5ae0ecd238e221429d88" title="How much Nitrogen that is in the plant.">Nitrogen</a>;                     <span class="comment">// Nitrogen content (g/m^2).</span>
<a name="l00285"></a>00285         <a class="code" href="classcrop.html#a362d42d586668dca552ec4d8cd381b68">TempSumRoot</a>          =acrop.<a class="code" href="classcrop.html#a362d42d586668dca552ec4d8cd381b68">TempSumRoot</a>;                  <span class="comment">// Temperature sum, root.</span>
<a name="l00286"></a>00286         <a class="code" href="classcrop.html#a512f2450d70fb9f2a84d046d5a090a94">RootDensAtSurf</a>       =acrop.<a class="code" href="classcrop.html#a512f2450d70fb9f2a84d046d5a090a94">RootDensAtSurf</a>;               <span class="comment">// Root density at soil surface.</span>
<a name="l00287"></a>00287         <a class="code" href="classcrop.html#a1f0aa4443cf11cdf5776454bd056fa28">TotalRootLength</a>      =acrop.<a class="code" href="classcrop.html#a1f0aa4443cf11cdf5776454bd056fa28">TotalRootLength</a>;              <span class="comment">// Total root length.</span>
<a name="l00288"></a>00288         <a class="code" href="classcrop.html#aefe9049cee98b6ac81f4362c4a1190a9">RootDepth</a>            =acrop.<a class="code" href="classcrop.html#aefe9049cee98b6ac81f4362c4a1190a9">RootDepth</a>;                    <span class="comment">// Root depth.</span>
<a name="l00289"></a>00289    <a class="code" href="classcrop.html#a755b12e801a538bb34a8c7b829047e76">DryMatterVegTop</a>      =acrop.<a class="code" href="classcrop.html#a755b12e801a538bb34a8c7b829047e76">DryMatterVegTop</a>;              <span class="comment">// Dry matter in veg. parts above soil surface.</span>
<a name="l00290"></a>00290         <a class="code" href="classcrop.html#a3c5f4942cf46d45168caf4da80b79537">DryMatterRoot</a>        =acrop.<a class="code" href="classcrop.html#a3c5f4942cf46d45168caf4da80b79537">DryMatterRoot</a>;                <span class="comment">// Dry matter in root.</span>
<a name="l00291"></a>00291         <a class="code" href="classcrop.html#a4a2803c0618d2f662abfa8d230c811df">DryMatterStorage</a>     =acrop.<a class="code" href="classcrop.html#a4a2803c0618d2f662abfa8d230c811df">DryMatterStorage</a>;             <span class="comment">// Dry matter in storage organs.</span>
<a name="l00292"></a>00292    <a class="code" href="classcrop.html#a787dec1e35057a17b4837bc01fc34350">ColonialisationRate</a>  =acrop.<a class="code" href="classcrop.html#a787dec1e35057a17b4837bc01fc34350">ColonialisationRate</a>;
<a name="l00293"></a>00293    <a class="code" href="classcrop.html#ac25231ecf44f1c5ffb8bf60c45334929">totalLAIStand</a>        =acrop.<a class="code" href="classcrop.html#ac25231ecf44f1c5ffb8bf60c45334929">totalLAIStand</a>;
<a name="l00294"></a>00294    <a class="code" href="classcrop.html#a394d3da7bbc4c297a68b5c6f575c5ecc">fractionOfSpace</a>      = acrop.<a class="code" href="classcrop.html#a394d3da7bbc4c297a68b5c6f575c5ecc">fractionOfSpace</a>;
<a name="l00295"></a>00295 <span class="comment">//      FractionInStorage    =acrop.FractionInStorage;            // Fraction of dry matter constituting of storage organs.</span>
<a name="l00296"></a>00296         <a class="code" href="classcrop.html#a2691a60a48a5166469df5da0e0e824fb">GreenCropAreaIndex</a>   =acrop.<a class="code" href="classcrop.html#a2691a60a48a5166469df5da0e0e824fb">GreenCropAreaIndex</a>;           <span class="comment">// Green leaf crop index.</span>
<a name="l00297"></a>00297         <a class="code" href="classcrop.html#a7acb3fa412808c819f4d9b662cc2148c">YellowCropAreaIndex</a>  =acrop.<a class="code" href="classcrop.html#a7acb3fa412808c819f4d9b662cc2148c">YellowCropAreaIndex</a>;          <span class="comment">// Yellow leaf crop index.</span>
<a name="l00298"></a>00298         <a class="code" href="classcrop.html#add8f384e82643550fa78abd7382abc4f" title="Describe how many layers a plan has. It is use to distribute sunlight.">NumOfLayers</a>          =acrop.<a class="code" href="classcrop.html#add8f384e82643550fa78abd7382abc4f" title="Describe how many layers a plan has. It is use to distribute sunlight.">NumOfLayers</a>;                  <span class="comment">// Number of soil layers.</span>
<a name="l00299"></a>00299    <a class="code" href="classcrop.html#a6af7b95c4e451b425aeed60156151e9d">UnderSown</a>            =acrop.<a class="code" href="classcrop.html#a6af7b95c4e451b425aeed60156151e9d">UnderSown</a>;                    <span class="comment">// indicates if a crop are not going to be harvested (i.e. undersown crops)</span>
<a name="l00300"></a>00300         <a class="code" href="classcrop.html#af82f3b3de55473a22e08c2b07d6e0645">GrowthContinue</a>       =acrop.<a class="code" href="classcrop.html#af82f3b3de55473a22e08c2b07d6e0645">GrowthContinue</a>;
<a name="l00301"></a>00301    <a class="code" href="classcrop.html#a3f40980535ac184d9cced18aff1a0f8c">PlantHeight</a>          =acrop.<a class="code" href="classcrop.html#a3f40980535ac184d9cced18aff1a0f8c">PlantHeight</a>;
<a name="l00302"></a>00302    <a class="code" href="classcrop.html#a94bdf58b80c10956d690e55f9dfc3bf8">LAIDistributionPar</a>   =acrop.<a class="code" href="classcrop.html#a94bdf58b80c10956d690e55f9dfc3bf8">LAIDistributionPar</a>;
<a name="l00303"></a>00303    <span class="keywordflow">if</span> (acrop.<a class="code" href="classcrop.html#a2ca05aa427979d52b8fbbba1cc5150cf">rootMatter</a>==NULL)
<a name="l00304"></a>00304         <a class="code" href="classcrop.html#a2ca05aa427979d52b8fbbba1cc5150cf">rootMatter</a>      = NULL;
<a name="l00305"></a>00305    <span class="keywordflow">else</span>
<a name="l00306"></a>00306       <a class="code" href="classcrop.html#a2ca05aa427979d52b8fbbba1cc5150cf">rootMatter</a>        =       <span class="keyword">new</span> <a class="code" href="classdecomposable.html">decomposable</a>(*acrop.<a class="code" href="classcrop.html#a2ca05aa427979d52b8fbbba1cc5150cf">rootMatter</a>);
<a name="l00307"></a>00307    <span class="keywordflow">if</span> (acrop.<a class="code" href="classcrop.html#a4a8b0a766947fe8b0dfc6a59a24b9bef">topMatter</a>==NULL)
<a name="l00308"></a>00308       <a class="code" href="classcrop.html#a4a8b0a766947fe8b0dfc6a59a24b9bef">topMatter</a>         = NULL;
<a name="l00309"></a>00309    <span class="keywordflow">else</span>
<a name="l00310"></a>00310       <a class="code" href="classcrop.html#a4a8b0a766947fe8b0dfc6a59a24b9bef">topMatter</a>         =<span class="keyword">new</span> <a class="code" href="classdecomposable.html">decomposable</a>(*acrop.<a class="code" href="classcrop.html#a4a8b0a766947fe8b0dfc6a59a24b9bef">topMatter</a>);
<a name="l00311"></a>00311    <a class="code" href="classcrop.html#a2dfb21c27aff36f3049be9a39e7c6538">SeedDM</a>               =acrop.<a class="code" href="classcrop.html#a2dfb21c27aff36f3049be9a39e7c6538">SeedDM</a>;
<a name="l00312"></a>00312    <a class="code" href="classcrop.html#a461228045f8a07f1f12a06acd12adf89">TranspirationRatio</a>   =acrop.<a class="code" href="classcrop.html#a461228045f8a07f1f12a06acd12adf89">TranspirationRatio</a>;
<a name="l00313"></a>00313    <a class="code" href="classcrop.html#a0c55583d4613cc09bb912de3078aae49">TransferableStorage</a>  =acrop.<a class="code" href="classcrop.html#a0c55583d4613cc09bb912de3078aae49">TransferableStorage</a>;
<a name="l00314"></a>00314    <a class="code" href="classcrop.html#ad4c7a7759997919efa9c9befb53cab69">AccumulatedNFixation</a> =acrop.<a class="code" href="classcrop.html#ad4c7a7759997919efa9c9befb53cab69">AccumulatedNFixation</a>;         <span class="comment">// Accumulated N fixation (used for output)</span>
<a name="l00315"></a>00315    <a class="code" href="classcrop.html#a0491b172b4874adcd1b3930cb3be00fe">DeltaDMTop</a>           =acrop.<a class="code" href="classcrop.html#a0491b172b4874adcd1b3930cb3be00fe">DeltaDMTop</a>;                   <span class="comment">// Daily top DM increase (used for output)</span>
<a name="l00316"></a>00316 
<a name="l00317"></a>00317    <span class="comment">/* Ignored for now !!!!!!!!!!!!!!!</span>
<a name="l00318"></a>00318 <span class="comment">   DateMeasured[MaxMeasuredPoints];</span>
<a name="l00319"></a>00319 <span class="comment">   DMmeasured[MaxMeasuredPoints]</span>
<a name="l00320"></a>00320 <span class="comment">   GLAIMeasured[MaxMeasuredPoints]</span>
<a name="l00321"></a>00321 <span class="comment">   NTopMeasured[MaxMeasuredPoints]</span>
<a name="l00322"></a>00322 <span class="comment">   DMmeasuredDeriv[MaxMeasuredPoints]</span>
<a name="l00323"></a>00323 <span class="comment">   GLAIMeasuredDeriv[MaxMeasuredPoints]</span>
<a name="l00324"></a>00324 <span class="comment">   NTopMeasuredDeriv[MaxMeasuredPoints];</span>
<a name="l00325"></a>00325 <span class="comment">   */</span>
<a name="l00326"></a>00326 
<a name="l00327"></a>00327         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;<a class="code" href="typer_8h.html#a61dadd085c1777f559549e05962b2c9ea489863aec95253fced254923e4cb8148">MaxSoilLayers</a>;i++)
<a name="l00328"></a>00328    {
<a name="l00329"></a>00329                 <a class="code" href="classcrop.html#ad629acdfd462323490f91ad3ce9a7b59">RootLengthList</a>[i]=acrop.<a class="code" href="classcrop.html#ad629acdfd462323490f91ad3ce9a7b59">RootLengthList</a>[i];             <span class="comment">// &#39;RootLengthList&#39; contains the root length (m) per layer.</span>
<a name="l00330"></a>00330                 <a class="code" href="classcrop.html#a26eb467869df5fc16784e0b42798cc4b">LayerThickness</a>[i]=acrop.<a class="code" href="classcrop.html#a26eb467869df5fc16784e0b42798cc4b">LayerThickness</a>[i];
<a name="l00331"></a>00331    }
<a name="l00332"></a>00332 
<a name="l00333"></a>00333         <a class="code" href="classcrop.html#a089361fdbd7eedb3b84e501ebc4f7221">Rg</a>         = acrop.<a class="code" href="classcrop.html#a089361fdbd7eedb3b84e501ebc4f7221">Rg</a>;
<a name="l00334"></a>00334    <a class="code" href="classcrop.html#aaf7bdd66e714b1ad4057bad5a46e6772">aSoil</a>      = NULL;                                                                                           <span class="comment">// Set subsequently</span>
<a name="l00335"></a>00335    <a class="code" href="classcrop.html#af7ae14fac12af3efa728e789155983fb">Nbudget</a>    = acrop.<a class="code" href="classcrop.html#af7ae14fac12af3efa728e789155983fb">Nbudget</a>;
<a name="l00336"></a>00336    <a class="code" href="classcrop.html#a3e5fad944be35152e933b5e50f928f5a">N15budget</a>  = acrop.<a class="code" href="classcrop.html#a3e5fad944be35152e933b5e50f928f5a">N15budget</a>;
<a name="l00337"></a>00337    <a class="code" href="classcrop.html#a46844fd0540eb7627555f21afa8545e8">DMbudget</a>   = acrop.<a class="code" href="classcrop.html#a46844fd0540eb7627555f21afa8545e8">DMbudget</a>;
<a name="l00338"></a>00338 }
<a name="l00339"></a>00339 
<a name="l00344"></a><a class="code" href="classcrop.html#a750cc1981b6d1fcb6e1a1e43bb22accf">00344</a> <span class="keywordtype">void</span> <a class="code" href="classcrop.html#a750cc1981b6d1fcb6e1a1e43bb22accf">crop::SetRUEfactor</a>(<span class="keywordtype">double</span> f)
<a name="l00345"></a>00345 {
<a name="l00346"></a>00346    <span class="keywordflow">if</span> (f&gt;1.0 || f&lt;0.0)
<a name="l00347"></a>00347       <a class="code" href="message_8h.html#a8ad29009121a629982c6ade0bd332470">theMessage</a>-&gt;<a class="code" href="classmessage.html#af9891cb7111375e6a36363afffb09d63">FatalError</a>(<span class="stringliteral">&quot;crop::SetRUEfactor - factor outside legal range&quot;</span>);
<a name="l00348"></a>00348    <a class="code" href="classcrop.html#ace1e4d77fd9e80f3cd5c301927e03630">MaxRadUseEff</a>=<a class="code" href="classcrop.html#ace1e4d77fd9e80f3cd5c301927e03630">MaxRadUseEff</a>*f;
<a name="l00349"></a>00349 }
<a name="l00350"></a>00350 
<a name="l00351"></a>00351 
<a name="l00352"></a>00352 
<a name="l00356"></a><a class="code" href="classcrop.html#a09c265a1590e65269b0f767da95dc85f">00356</a> <span class="keywordtype">void</span> <a class="code" href="classcrop.html#a09c265a1590e65269b0f767da95dc85f">crop::Add</a>(<a class="code" href="classcrop.html">crop</a>* aCrop, <span class="keywordtype">double</span> <a class="code" href="typer_8h.html#ae4c405e5c68c6ec2c44bb6d6adfc2f6cab10366ecc76133a0a4a4712a5ee26f65">fraction</a>)
<a name="l00357"></a>00357 {
<a name="l00358"></a>00358         <a class="code" href="message_8h.html#a8ad29009121a629982c6ade0bd332470">theMessage</a>-&gt;<a class="code" href="classmessage.html#af9891cb7111375e6a36363afffb09d63">FatalError</a>(<span class="stringliteral">&quot;crop::Add Function is incomplete and needs update before use&quot;</span>);
<a name="l00359"></a>00359    <a class="code" href="classcrop.html#af7ae14fac12af3efa728e789155983fb">Nbudget</a>.<a class="code" href="classbudget.html#a2f378ac0b5f670cc9ec42b4e9ceb3c51">Add</a>(aCrop-&gt;<a class="code" href="classcrop.html#af7ae14fac12af3efa728e789155983fb">Nbudget</a>,fraction);
<a name="l00360"></a>00360    <a class="code" href="classcrop.html#a3e5fad944be35152e933b5e50f928f5a">N15budget</a>.<a class="code" href="classbudget.html#a2f378ac0b5f670cc9ec42b4e9ceb3c51">Add</a>(aCrop-&gt;<a class="code" href="classcrop.html#a3e5fad944be35152e933b5e50f928f5a">N15budget</a>,fraction);
<a name="l00361"></a>00361    <a class="code" href="classcrop.html#a46844fd0540eb7627555f21afa8545e8">DMbudget</a>.<a class="code" href="classbudget.html#a2f378ac0b5f670cc9ec42b4e9ceb3c51">Add</a>(aCrop-&gt;<a class="code" href="classcrop.html#a46844fd0540eb7627555f21afa8545e8">DMbudget</a>,fraction);
<a name="l00362"></a>00362         <span class="keywordflow">if</span> (<a class="code" href="classcrop.html#af852d2f62dd22411199ae8e164536a7d">CropName</a>!=aCrop-&gt;<a class="code" href="classcrop.html#a9410b9d5cb1b537736a52d426b682f93">GetCropName</a>())
<a name="l00363"></a>00363         <a class="code" href="message_8h.html#a8ad29009121a629982c6ade0bd332470">theMessage</a>-&gt;<a class="code" href="classmessage.html#af9891cb7111375e6a36363afffb09d63">FatalError</a>(<span class="stringliteral">&quot;crop::Add - Different crops can not be added&quot;</span>);
<a name="l00364"></a>00364    <span class="keywordflow">else</span>
<a name="l00365"></a>00365    {
<a name="l00366"></a>00366                 <a class="code" href="classcrop.html#adabbdde8753e5ae0ecd238e221429d88" title="How much Nitrogen that is in the plant.">Nitrogen</a>            = <a class="code" href="classcrop.html#adabbdde8753e5ae0ecd238e221429d88" title="How much Nitrogen that is in the plant.">Nitrogen</a>*(1-<a class="code" href="typer_8h.html#ae4c405e5c68c6ec2c44bb6d6adfc2f6cab10366ecc76133a0a4a4712a5ee26f65">fraction</a>) + aCrop-&gt;<a class="code" href="classcrop.html#adabbdde8753e5ae0ecd238e221429d88" title="How much Nitrogen that is in the plant.">Nitrogen</a>*fraction;
<a name="l00367"></a>00367                 <a class="code" href="classcrop.html#a7cc6a117013deeda470335c166066615">maxGLAI</a>             = (1-fraction)*<a class="code" href="classcrop.html#a7cc6a117013deeda470335c166066615">maxGLAI</a> + fraction*aCrop-&gt;<a class="code" href="classcrop.html#a7cc6a117013deeda470335c166066615">maxGLAI</a>;
<a name="l00368"></a>00368                 <a class="code" href="classcrop.html#a3bd248dac15a2aefd7289240ffeeb879">RootDensAtBottom</a>    = (1-<a class="code" href="typer_8h.html#ae4c405e5c68c6ec2c44bb6d6adfc2f6cab10366ecc76133a0a4a4712a5ee26f65">fraction</a>)*<a class="code" href="classcrop.html#a3bd248dac15a2aefd7289240ffeeb879">RootDensAtBottom</a> + fraction*aCrop-&gt;<a class="code" href="classcrop.html#a3bd248dac15a2aefd7289240ffeeb879">RootDensAtBottom</a>;
<a name="l00369"></a>00369                 <a class="code" href="classcrop.html#a512f2450d70fb9f2a84d046d5a090a94">RootDensAtSurf</a>      = (1-fraction)*<a class="code" href="classcrop.html#a512f2450d70fb9f2a84d046d5a090a94">RootDensAtSurf</a> + fraction*aCrop-&gt;<a class="code" href="classcrop.html#a512f2450d70fb9f2a84d046d5a090a94">RootDensAtSurf</a>;
<a name="l00370"></a>00370                 <a class="code" href="classcrop.html#a10ecc3d91cd9e62af94a5b889587d3f4">MaxRootDepth</a>        = (1-<a class="code" href="typer_8h.html#ae4c405e5c68c6ec2c44bb6d6adfc2f6cab10366ecc76133a0a4a4712a5ee26f65">fraction</a>)*<a class="code" href="classcrop.html#a10ecc3d91cd9e62af94a5b889587d3f4">MaxRootDepth</a> + fraction*aCrop-&gt;<a class="code" href="classcrop.html#a10ecc3d91cd9e62af94a5b889587d3f4">MaxRootDepth</a>;
<a name="l00371"></a>00371                 <a class="code" href="classcrop.html#a5c8bcec383225ccfa1997ed7de4b2446">RootDistrParm</a>       = (1-fraction)*<a class="code" href="classcrop.html#a5c8bcec383225ccfa1997ed7de4b2446">RootDistrParm</a> + fraction*aCrop-&gt;<a class="code" href="classcrop.html#a5c8bcec383225ccfa1997ed7de4b2446">RootDistrParm</a>;
<a name="l00372"></a>00372         <a class="code" href="classcrop.html#afe8c6c11905d19aca8f9623180b8462f">DecayRoot</a>                         = (1-<a class="code" href="typer_8h.html#ae4c405e5c68c6ec2c44bb6d6adfc2f6cab10366ecc76133a0a4a4712a5ee26f65">fraction</a>)*<a class="code" href="classcrop.html#afe8c6c11905d19aca8f9623180b8462f">DecayRoot</a> + fraction*aCrop-&gt;<a class="code" href="classcrop.html#afe8c6c11905d19aca8f9623180b8462f">DecayRoot</a>;
<a name="l00373"></a>00373       <a class="code" href="classcrop.html#a362d42d586668dca552ec4d8cd381b68">TempSumRoot</a>         = (1-fraction)*<a class="code" href="classcrop.html#a362d42d586668dca552ec4d8cd381b68">TempSumRoot</a> + fraction*aCrop-&gt;<a class="code" href="classcrop.html#a362d42d586668dca552ec4d8cd381b68">TempSumRoot</a>;
<a name="l00374"></a>00374                 <a class="code" href="classcrop.html#a1f0aa4443cf11cdf5776454bd056fa28">TotalRootLength</a>     = (1-<a class="code" href="typer_8h.html#ae4c405e5c68c6ec2c44bb6d6adfc2f6cab10366ecc76133a0a4a4712a5ee26f65">fraction</a>)*<a class="code" href="classcrop.html#a1f0aa4443cf11cdf5776454bd056fa28">TotalRootLength</a> + fraction*aCrop-&gt;<a class="code" href="classcrop.html#a1f0aa4443cf11cdf5776454bd056fa28">TotalRootLength</a>;
<a name="l00375"></a>00375                 <a class="code" href="classcrop.html#aefe9049cee98b6ac81f4362c4a1190a9">RootDepth</a>           = (1-fraction)*<a class="code" href="classcrop.html#aefe9049cee98b6ac81f4362c4a1190a9">RootDepth</a> + fraction*aCrop-&gt;<a class="code" href="classcrop.html#aefe9049cee98b6ac81f4362c4a1190a9">RootDepth</a>;
<a name="l00376"></a>00376                 <a class="code" href="classcrop.html#a755b12e801a538bb34a8c7b829047e76">DryMatterVegTop</a>     = (1-<a class="code" href="typer_8h.html#ae4c405e5c68c6ec2c44bb6d6adfc2f6cab10366ecc76133a0a4a4712a5ee26f65">fraction</a>)*<a class="code" href="classcrop.html#a755b12e801a538bb34a8c7b829047e76">DryMatterVegTop</a> + fraction*aCrop-&gt;<a class="code" href="classcrop.html#a755b12e801a538bb34a8c7b829047e76">DryMatterVegTop</a>;
<a name="l00377"></a>00377                 <a class="code" href="classcrop.html#a3c5f4942cf46d45168caf4da80b79537">DryMatterRoot</a>       = (1-fraction)*<a class="code" href="classcrop.html#a3c5f4942cf46d45168caf4da80b79537">DryMatterRoot</a> + fraction*aCrop-&gt;<a class="code" href="classcrop.html#a3c5f4942cf46d45168caf4da80b79537">DryMatterRoot</a>;
<a name="l00378"></a>00378                 <a class="code" href="classcrop.html#a4a2803c0618d2f662abfa8d230c811df">DryMatterStorage</a>    = (1-<a class="code" href="typer_8h.html#ae4c405e5c68c6ec2c44bb6d6adfc2f6cab10366ecc76133a0a4a4712a5ee26f65">fraction</a>)*<a class="code" href="classcrop.html#a4a2803c0618d2f662abfa8d230c811df">DryMatterStorage</a> + fraction*aCrop-&gt;<a class="code" href="classcrop.html#a4a2803c0618d2f662abfa8d230c811df">DryMatterStorage</a>;
<a name="l00379"></a>00379 <span class="comment">//              FractionInStorage   = (1-fraction)*FractionInStorage + fraction*aCrop-&gt;FractionInStorage;</span>
<a name="l00380"></a>00380                 <a class="code" href="classcrop.html#a2691a60a48a5166469df5da0e0e824fb">GreenCropAreaIndex</a>  = (1-fraction)*<a class="code" href="classcrop.html#a2691a60a48a5166469df5da0e0e824fb">GreenCropAreaIndex</a> + fraction*aCrop-&gt;<a class="code" href="classcrop.html#a2691a60a48a5166469df5da0e0e824fb">GreenCropAreaIndex</a>;
<a name="l00381"></a>00381                 <a class="code" href="classcrop.html#a7acb3fa412808c819f4d9b662cc2148c">YellowCropAreaIndex</a> = (1-<a class="code" href="typer_8h.html#ae4c405e5c68c6ec2c44bb6d6adfc2f6cab10366ecc76133a0a4a4712a5ee26f65">fraction</a>)*<a class="code" href="classcrop.html#a7acb3fa412808c819f4d9b662cc2148c">YellowCropAreaIndex</a> + fraction*aCrop-&gt;<a class="code" href="classcrop.html#a7acb3fa412808c819f4d9b662cc2148c">YellowCropAreaIndex</a>;
<a name="l00382"></a>00382                 for (<span class="keywordtype">int</span> i=0;i&lt;<a class="code" href="typer_8h.html#a61dadd085c1777f559549e05962b2c9ea489863aec95253fced254923e4cb8148">MaxSoilLayers</a>;i++)
<a name="l00383"></a>00383                         <a class="code" href="classcrop.html#ad629acdfd462323490f91ad3ce9a7b59">RootLengthList</a>[i] = (1-fraction)*<a class="code" href="classcrop.html#ad629acdfd462323490f91ad3ce9a7b59">RootLengthList</a>[i] + fraction*aCrop-&gt;<a class="code" href="classcrop.html#ad629acdfd462323490f91ad3ce9a7b59">RootLengthList</a>[i];
<a name="l00384"></a>00384 
<a name="l00385"></a>00385         <a class="code" href="classcrop.html#a38f05d3f77cfc67ff755eb8c0d79e301">Phenology</a>-&gt;<a class="code" href="classphenology.html#ad33769d1f209f2cccb78c26d4127161e">Add</a>(aCrop-&gt;<a class="code" href="classcrop.html#a38f05d3f77cfc67ff755eb8c0d79e301">Phenology</a>,fraction);
<a name="l00386"></a>00386    }
<a name="l00387"></a>00387 
<a name="l00388"></a>00388 }
<a name="l00389"></a>00389 
<a name="l00394"></a><a class="code" href="classcrop.html#af01aa0fd15613a9e2fcb2a23ca089d5f">00394</a> <span class="keywordtype">double</span> <a class="code" href="classcrop.html#af01aa0fd15613a9e2fcb2a23ca089d5f">crop::TemperatureEffect</a>(<span class="keywordtype">double</span> <a class="code" href="typer_8h.html#ae4c405e5c68c6ec2c44bb6d6adfc2f6ca0247320c476fffeaa81ffa7836e08dee">t</a>)
<a name="l00395"></a>00395 {
<a name="l00396"></a>00396    <span class="keywordtype">double</span> f = 0.0;
<a name="l00397"></a>00397    <span class="keywordflow">if</span> (t&gt;0.0 &amp;&amp; t&lt;=20.0)
<a name="l00398"></a>00398       f = 0.1*<a class="code" href="typer_8h.html#ae4c405e5c68c6ec2c44bb6d6adfc2f6ca0247320c476fffeaa81ffa7836e08dee">t</a>;
<a name="l00399"></a>00399    <span class="keywordflow">if</span> (t&gt;20.0)
<a name="l00400"></a>00400       f = exp(0.47-0.027*t+0.00193*t*t);
<a name="l00401"></a>00401    <span class="keywordflow">return</span> f;
<a name="l00402"></a>00402 }
<a name="l00403"></a>00403 
<a name="l00407"></a><a class="code" href="classcrop.html#aa3ce4d26c1cdce101dfe72adc793ebf2">00407</a> <span class="keywordtype">double</span> <a class="code" href="classcrop.html#aa3ce4d26c1cdce101dfe72adc793ebf2">crop::GiveExtCoeff</a>()<span class="keyword"> const</span>
<a name="l00408"></a>00408 <span class="keyword"></span>{
<a name="l00409"></a>00409         <span class="keywordflow">return</span> <a class="code" href="classcrop.html#a9836313fa9dae417e0d3a41850209e37">k</a>;
<a name="l00410"></a>00410 }
<a name="l00411"></a>00411 
<a name="l00415"></a><a class="code" href="classcrop.html#aeccf3077c6ad647769145b8064ba426b">00415</a> <span class="keywordtype">void</span> <a class="code" href="classcrop.html#aeccf3077c6ad647769145b8064ba426b">crop::UpdateHeight</a>()
<a name="l00416"></a>00416 {
<a name="l00417"></a>00417    <span class="keywordflow">if</span> (<a class="code" href="classcrop.html#a38f05d3f77cfc67ff755eb8c0d79e301">Phenology</a>-&gt;<a class="code" href="classphenology.html#a514ca53b35d3dfc3e8dc1b4841d221cf" title="return true if crop has emerged">Emerged</a>())
<a name="l00418"></a>00418                 <a class="code" href="classcrop.html#a3f40980535ac184d9cced18aff1a0f8c">PlantHeight</a> = <a class="code" href="classcrop.html#a211a8242464133985cb2f26964b0f782">MaxPlantHeight</a>*(1.0-<a class="code" href="classcrop.html#a38f05d3f77cfc67ff755eb8c0d79e301">Phenology</a>-&gt;<a class="code" href="classphenology.html#aad2f655d897ddb69dadb719ce046f74f">GetFractionToAnthesis</a>());
<a name="l00419"></a>00419    <a class="code" href="classcrop.html#a3f40980535ac184d9cced18aff1a0f8c">PlantHeight</a> = min(<a class="code" href="classcrop.html#a3f40980535ac184d9cced18aff1a0f8c">PlantHeight</a>,<a class="code" href="classcrop.html#a211a8242464133985cb2f26964b0f782">MaxPlantHeight</a>);
<a name="l00420"></a>00420 }
<a name="l00421"></a>00421 
<a name="l00425"></a><a class="code" href="classcrop.html#a8e4c60317adb0f14a2f21462c2eb9a6c">00425</a> <span class="keywordtype">double</span> <a class="code" href="classcrop.html#a8e4c60317adb0f14a2f21462c2eb9a6c">crop::LeafAreaFraction</a>(<span class="keywordtype">double</span> height)<span class="keyword"> const</span>
<a name="l00426"></a>00426 <span class="keyword"></span>{
<a name="l00427"></a>00427    <span class="keywordtype">double</span> a=<a class="code" href="classcrop.html#a94bdf58b80c10956d690e55f9dfc3bf8">LAIDistributionPar</a>;
<a name="l00428"></a>00428    <span class="keywordflow">if</span> (<a class="code" href="classcrop.html#a3f40980535ac184d9cced18aff1a0f8c">PlantHeight</a>==0)
<a name="l00429"></a>00429       <span class="keywordflow">return</span> 0;
<a name="l00430"></a>00430    <span class="keywordflow">if</span> (height&gt;=<a class="code" href="classcrop.html#a3f40980535ac184d9cced18aff1a0f8c">PlantHeight</a>)
<a name="l00431"></a>00431       <span class="keywordflow">return</span> 1.0;
<a name="l00432"></a>00432    <span class="keywordflow">return</span> (a+1)*(a+2)*(pow(height,a+1))/(pow(<a class="code" href="classcrop.html#a3f40980535ac184d9cced18aff1a0f8c">PlantHeight</a>,a+1))*(1/(a+1)-height/((a+2)*<a class="code" href="classcrop.html#a3f40980535ac184d9cced18aff1a0f8c">PlantHeight</a>));
<a name="l00433"></a>00433 
<a name="l00434"></a>00434 }
<a name="l00435"></a>00435 
<a name="l00439"></a><a class="code" href="classcrop.html#aef3e13efa427477cd8ce5aa070c3e2cb">00439</a> <span class="keywordtype">double</span> <a class="code" href="classcrop.html#aef3e13efa427477cd8ce5aa070c3e2cb">crop::TotalLeafAreaIndex</a>(<span class="keywordtype">double</span> height,<span class="keywordtype">double</span> thickness)<span class="keyword"> const</span>
<a name="l00440"></a>00440 <span class="keyword"></span>{
<a name="l00441"></a>00441         <span class="keywordflow">return</span> (<a class="code" href="classcrop.html#a2691a60a48a5166469df5da0e0e824fb">GreenCropAreaIndex</a>+<a class="code" href="classcrop.html#a7acb3fa412808c819f4d9b662cc2148c">YellowCropAreaIndex</a>)*(<a class="code" href="classcrop.html#a8e4c60317adb0f14a2f21462c2eb9a6c">LeafAreaFraction</a>(height+thickness)-<a class="code" href="classcrop.html#a8e4c60317adb0f14a2f21462c2eb9a6c">LeafAreaFraction</a>(height));
<a name="l00442"></a>00442 }
<a name="l00443"></a>00443 
<a name="l00448"></a><a class="code" href="classcrop.html#a5c3e9f999f957f7bebe6cca43f569eab">00448</a> <span class="keywordtype">double</span> <a class="code" href="classcrop.html#a5c3e9f999f957f7bebe6cca43f569eab">crop::GreenLeafAreaIndex</a>(<span class="keywordtype">double</span> height,<span class="keywordtype">double</span> thickness)
<a name="l00449"></a>00449 {
<a name="l00450"></a>00450    <span class="comment">// assumes that all yellow area are situated at the bottom of the canopy below the green area</span>
<a name="l00451"></a>00451    <span class="keywordtype">double</span> UpperArea = max(0.0,(<a class="code" href="classcrop.html#a2691a60a48a5166469df5da0e0e824fb">GreenCropAreaIndex</a>+<a class="code" href="classcrop.html#a7acb3fa412808c819f4d9b662cc2148c">YellowCropAreaIndex</a>)*<a class="code" href="classcrop.html#a8e4c60317adb0f14a2f21462c2eb9a6c">LeafAreaFraction</a>(height+thickness)-<a class="code" href="classcrop.html#a7acb3fa412808c819f4d9b662cc2148c">YellowCropAreaIndex</a>);
<a name="l00452"></a>00452    <span class="keywordtype">double</span> LowerArea = max(0.0,(<a class="code" href="classcrop.html#a2691a60a48a5166469df5da0e0e824fb">GreenCropAreaIndex</a>+<a class="code" href="classcrop.html#a7acb3fa412808c819f4d9b662cc2148c">YellowCropAreaIndex</a>)*<a class="code" href="classcrop.html#a8e4c60317adb0f14a2f21462c2eb9a6c">LeafAreaFraction</a>(height)-<a class="code" href="classcrop.html#a7acb3fa412808c819f4d9b662cc2148c">YellowCropAreaIndex</a>);
<a name="l00453"></a>00453    <span class="keywordtype">double</span> value=UpperArea-LowerArea;
<a name="l00454"></a>00454       <span class="keywordflow">if</span>(value&lt;0.00001)
<a name="l00455"></a>00455       {
<a name="l00456"></a>00456            <span class="keywordflow">return</span> 0;
<a name="l00457"></a>00457       }
<a name="l00458"></a>00458       <span class="keywordflow">else</span>
<a name="l00459"></a>00459       {
<a name="l00460"></a>00460           <span class="keywordflow">return</span> value;
<a name="l00461"></a>00461       }
<a name="l00462"></a>00462 }
<a name="l00463"></a>00463 
<a name="l00464"></a>00464 
<a name="l00468"></a><a class="code" href="classcrop.html#a8c2110cc2b12fed93031787f6c557fcb">00468</a> <span class="keywordtype">void</span> <a class="code" href="classcrop.html#a8c2110cc2b12fed93031787f6c557fcb">crop::AssignRootParameters</a>(<a class="code" href="classsoil.html">soil</a>* CropSoil)
<a name="l00469"></a>00469 {
<a name="l00470"></a>00470    <a class="code" href="classcrop.html#aaf7bdd66e714b1ad4057bad5a46e6772">aSoil</a>        = CropSoil;
<a name="l00471"></a>00471    <a class="code" href="classcrop.html#add8f384e82643550fa78abd7382abc4f" title="Describe how many layers a plan has. It is use to distribute sunlight.">NumOfLayers</a>  = min(<a class="code" href="classcrop.html#aaf7bdd66e714b1ad4057bad5a46e6772">aSoil</a>-&gt;<a class="code" href="classsoil.html#a815f1ebcaf7c7fa7a11c91ebf6edf800" title="returns number of soil layers and">GetLayers</a>(),(int) <a class="code" href="typer_8h.html#a61dadd085c1777f559549e05962b2c9ea489863aec95253fced254923e4cb8148">MaxSoilLayers</a>);
<a name="l00472"></a>00472         <a class="code" href="classcrop.html#a10ecc3d91cd9e62af94a5b889587d3f4">MaxRootDepth</a> = min(<a class="code" href="classcrop.html#aaf7bdd66e714b1ad4057bad5a46e6772">aSoil</a>-&gt;<a class="code" href="classsoil.html#a9f4bafd4dfed43438f4310e06dac6933">GetMaxRootDepth</a>()/1000,<a class="code" href="classcrop.html#aa37b1e6e7ca46537edb64086518d5088">MaxRootDepthCrop</a>);
<a name="l00473"></a>00473 }
<a name="l00474"></a>00474 
<a name="l00479"></a><a class="code" href="classcrop.html#a2c5df235a96a1daa3ab122baf17518d4">00479</a> <span class="keywordtype">void</span> <a class="code" href="classcrop.html#a2c5df235a96a1daa3ab122baf17518d4">crop::Sow</a>(<span class="keywordtype">double</span> SeedDensDryMatt,<span class="keywordtype">double</span> aRelativeDensity,<span class="keywordtype">double</span> NitrogenInSeed)
<a name="l00480"></a>00480 {
<a name="l00481"></a>00481         <span class="keywordflow">if</span> (<a class="code" href="classcrop.html#a38f05d3f77cfc67ff755eb8c0d79e301">Phenology</a>-&gt;<a class="code" href="classphenology.html#aa4986dd79d0fc195c3f1c21833171906" title="return true if the crop is sown">Sown</a>())
<a name="l00482"></a>00482       <a class="code" href="message_8h.html#a8ad29009121a629982c6ade0bd332470">theMessage</a>-&gt;<a class="code" href="classmessage.html#af9891cb7111375e6a36363afffb09d63">FatalError</a>(<span class="stringliteral">&quot;crop::Sow - this crop instance has already been sown&quot;</span>);
<a name="l00483"></a>00483    <span class="comment">//if (fabs(aRelativeDensity)&lt;1e-5)</span>
<a name="l00484"></a>00484    <span class="comment">//   theMessage-&gt;FatalError(&quot;crop::Sow - density to low&quot;);</span>
<a name="l00485"></a>00485 
<a name="l00486"></a>00486    <a class="code" href="classcrop.html#a38f05d3f77cfc67ff755eb8c0d79e301">Phenology</a>-&gt;<a class="code" href="classphenology.html#a2962099feafa721d4ee6db7131b6ca3e">Sow</a>();
<a name="l00487"></a>00487         <a class="code" href="classcrop.html#a1f0aa4443cf11cdf5776454bd056fa28">TotalRootLength</a>   = 0.0;
<a name="l00488"></a>00488         <a class="code" href="classcrop.html#a2dfb21c27aff36f3049be9a39e7c6538">SeedDM</a>            = SeedDensDryMatt*<a class="code" href="classcrop.html#a134737bfb7ce5b5c558f15a19232181f">GerminationConversion</a>;
<a name="l00489"></a>00489    <a class="code" href="classcrop.html#a86aa841b9bfef88701e24c3a1922bba5">InitialSeedDM</a>     = <a class="code" href="classcrop.html#a2dfb21c27aff36f3049be9a39e7c6538">SeedDM</a>;
<a name="l00490"></a>00490         <a class="code" href="classcrop.html#aefe9049cee98b6ac81f4362c4a1190a9">RootDepth</a>         = <a class="code" href="classcrop.html#ac51148719f4b421963566a281b04c0cf">InitialRootDepth</a>;
<a name="l00491"></a>00491         <a class="code" href="classcrop.html#a3c5f4942cf46d45168caf4da80b79537">DryMatterRoot</a>     = 0.0;
<a name="l00492"></a>00492         <a class="code" href="classcrop.html#a755b12e801a538bb34a8c7b829047e76">DryMatterVegTop</a>   = 0;
<a name="l00493"></a>00493         <a class="code" href="classcrop.html#a4a2803c0618d2f662abfa8d230c811df">DryMatterStorage</a>  = 0.0;
<a name="l00494"></a>00494         <a class="code" href="classcrop.html#a2691a60a48a5166469df5da0e0e824fb">GreenCropAreaIndex</a>= 0.0;
<a name="l00495"></a>00495 
<a name="l00496"></a>00496         <a class="code" href="classcrop.html#ac85050f76b5416047499dcdc854d6f41" title="Describe if a plan can fill.">FillFlag</a>=0;
<a name="l00497"></a>00497         <a class="code" href="classcrop.html#adabbdde8753e5ae0ecd238e221429d88" title="How much Nitrogen that is in the plant.">Nitrogen</a>.<a class="code" href="classnitrogen.html#a49bebcba4c40f3c0a6abb24f590b2c8c">SetBoth</a>(NitrogenInSeed,0.0);
<a name="l00498"></a>00498    <a class="code" href="classcrop.html#aa4666fdd11920e05003bfeefc5518ddf">RelativeDensity</a> = aRelativeDensity;
<a name="l00499"></a>00499 
<a name="l00500"></a>00500    <a class="code" href="classcrop.html#af7ae14fac12af3efa728e789155983fb">Nbudget</a>.<a class="code" href="classbudget.html#a885260b83f245dee43a1e6ee70a4c68d">SetInput</a>(NitrogenInSeed);             <span class="comment">// Budgets</span>
<a name="l00501"></a>00501    <a class="code" href="classcrop.html#a46844fd0540eb7627555f21afa8545e8">DMbudget</a>.<a class="code" href="classbudget.html#a885260b83f245dee43a1e6ee70a4c68d">SetInput</a>(SeedDensDryMatt*GerminationConversion);
<a name="l00502"></a>00502    <a class="code" href="classcrop.html#af7ae14fac12af3efa728e789155983fb">Nbudget</a>.<a class="code" href="classbudget.html#a28fc928b65aef6475ad0dee374bbb7f2">SetOutput</a>(0);
<a name="l00503"></a>00503    <a class="code" href="classcrop.html#a3e5fad944be35152e933b5e50f928f5a">N15budget</a>.<a class="code" href="classbudget.html#a28fc928b65aef6475ad0dee374bbb7f2">SetOutput</a>(0);
<a name="l00504"></a>00504    <a class="code" href="classcrop.html#a46844fd0540eb7627555f21afa8545e8">DMbudget</a>.<a class="code" href="classbudget.html#a28fc928b65aef6475ad0dee374bbb7f2">SetOutput</a>(0);
<a name="l00505"></a>00505 }
<a name="l00506"></a>00506 
<a name="l00511"></a><a class="code" href="classcrop.html#a387dc393ee7cd05a40874739cff8579e">00511</a> <span class="keywordtype">void</span> <a class="code" href="classcrop.html#a387dc393ee7cd05a40874739cff8579e" title="harvests all aboveground dry matter. Is used for harvesting non-forage crops">crop::Harvest</a>(<a class="code" href="classdecomposable.html">decomposable</a>* Storage, <a class="code" href="classdecomposable.html">decomposable</a>* Straw)
<a name="l00512"></a>00512 {
<a name="l00513"></a>00513   <a class="code" href="classcrop.html#a8e7d3a42d931c8c1d95f92bb2669f2ef" title="Describe if a plan has been cut or harvested.">CutOrHarvested</a> = <span class="keyword">true</span>;
<a name="l00514"></a>00514    Storage-&gt;<a class="code" href="classproduct.html#a0219cde65dc26376f3371a0138199ba8">Setname</a>(<a class="code" href="classcrop.html#af982befddb79f8aedfa207bce540c47a">PlantItemName</a>);
<a name="l00515"></a>00515    <span class="keywordflow">if</span> (<a class="code" href="classcrop.html#af982befddb79f8aedfa207bce540c47a">PlantItemName</a>!=<span class="stringliteral">&quot;&quot;</span>)
<a name="l00516"></a>00516    {
<a name="l00517"></a>00517            <a class="code" href="_new_main_8cpp.html#af1019990138497f1f18cc7294737d140">theProducts</a>-&gt;<a class="code" href="classproducts.html#a8bd239aabc0a167741c02882e305d65d">GiveProductInformation</a>(Storage);
<a name="l00518"></a>00518            <span class="comment">//converting from drymatter to fresh weight</span>
<a name="l00519"></a>00519            Storage-&gt;<a class="code" href="classproduct.html#a18ec2e96f1d9b7cef74c4b2800ebdca1">Setamount</a>(<a class="code" href="classcrop.html#a4a2803c0618d2f662abfa8d230c811df">DryMatterStorage</a>/Storage-&gt;<a class="code" href="classlive_matter.html#ad3d05f1e8ceedc99e214adca94638de0">GetdryMatter</a>());<span class="comment">//??</span>
<a name="l00520"></a>00520    }
<a name="l00521"></a>00521 
<a name="l00522"></a>00522    Straw-&gt;<a class="code" href="classproduct.html#a0219cde65dc26376f3371a0138199ba8">Setname</a>(<a class="code" href="classcrop.html#aa2aceced21d0fee166e40a836c2ee9cc">StrawItemName</a>);
<a name="l00523"></a>00523    <a class="code" href="_new_main_8cpp.html#af1019990138497f1f18cc7294737d140">theProducts</a>-&gt;<a class="code" href="classproducts.html#a8bd239aabc0a167741c02882e305d65d">GiveProductInformation</a>(Straw);
<a name="l00524"></a>00524    <span class="comment">//converting from drymatter to fresh weight</span>
<a name="l00525"></a>00525    Straw-&gt;<a class="code" href="classproduct.html#a18ec2e96f1d9b7cef74c4b2800ebdca1">Setamount</a>(<a class="code" href="classcrop.html#a755b12e801a538bb34a8c7b829047e76">DryMatterVegTop</a>/Straw-&gt;<a class="code" href="classlive_matter.html#ad3d05f1e8ceedc99e214adca94638de0">GetdryMatter</a>()); <span class="comment">//??</span>
<a name="l00526"></a>00526 
<a name="l00527"></a>00527    <span class="comment">// Nitrogen</span>
<a name="l00528"></a>00528         <a class="code" href="classnitrogen.html">nitrogen</a> RootN, StorageN, StrawN;
<a name="l00529"></a>00529 
<a name="l00530"></a>00530    <span class="comment">//check amount of nitrogen at harvest</span>
<a name="l00531"></a>00531    <span class="keywordtype">double</span> minimumN = <a class="code" href="classcrop.html#adc9f2a384dfd4be26746b822c4324f37">Nmin</a>();
<a name="l00532"></a>00532    <span class="keywordtype">double</span> maximumN = <a class="code" href="classcrop.html#a6416f0baf1364f2cf28f312584c39f73">Nmax</a>();
<a name="l00533"></a>00533 
<a name="l00534"></a>00534    <span class="keywordflow">if</span> (minimumN &gt; <a class="code" href="classcrop.html#adabbdde8753e5ae0ecd238e221429d88" title="How much Nitrogen that is in the plant.">Nitrogen</a>.<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a> * 1.25)  <span class="comment">//Corrected MEL 2009</span>
<a name="l00535"></a>00535    {
<a name="l00536"></a>00536      <span class="comment">// cout &lt;&lt; GetLongName() &lt;&lt; endl;</span>
<a name="l00537"></a>00537         <a class="code" href="message_8h.html#a8ad29009121a629982c6ade0bd332470">theMessage</a>-&gt;<a class="code" href="classmessage.html#afed66d0552f90b4385c5169cf5929907">WarningWithDisplay</a>(<span class="stringliteral">&quot;crop::Harvest - not enough nitrogen in plant at harvest&quot;</span>);
<a name="l00538"></a>00538    }
<a name="l00539"></a>00539    <span class="keywordflow">if</span> (maximumN &lt; <a class="code" href="classcrop.html#adabbdde8753e5ae0ecd238e221429d88" title="How much Nitrogen that is in the plant.">Nitrogen</a>.<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a> * 0.75)  <span class="comment">//Corrected MEL 2009</span>
<a name="l00540"></a>00540    {
<a name="l00541"></a>00541       <span class="comment">//cout &lt;&lt; GetLongName() &lt;&lt; endl;</span>
<a name="l00542"></a>00542            <a class="code" href="message_8h.html#a8ad29009121a629982c6ade0bd332470">theMessage</a>-&gt;<a class="code" href="classmessage.html#afed66d0552f90b4385c5169cf5929907">WarningWithDisplay</a>(<span class="stringliteral">&quot;crop::Harvest - too much nitrogen in plant at harvest&quot;</span>);
<a name="l00543"></a>00543    }
<a name="l00544"></a>00544    <span class="comment">//partition between compartments</span>
<a name="l00545"></a>00545    <span class="keywordtype">double</span> fN = <a class="code" href="classcrop.html#a602622ac2c0de6432e6b9438dbbb646b">fNitrogen</a>();
<a name="l00546"></a>00546    <span class="keywordtype">double</span> TotalRootN  = (<a class="code" href="classcrop.html#acc16e034b1484f87bbc3ec3863418f83">CorrectedMinN_Root</a>()+fN*(<a class="code" href="classcrop.html#a70d49c552a110f0fef57e068575974c9">CorrectedMaxN_Root</a>()-<a class="code" href="classcrop.html#acc16e034b1484f87bbc3ec3863418f83">CorrectedMinN_Root</a>()))*<a class="code" href="classcrop.html#a3c5f4942cf46d45168caf4da80b79537">DryMatterRoot</a>;
<a name="l00547"></a>00547       <span class="keywordtype">double</span> TotStorageN = (<a class="code" href="classcrop.html#a2ada3fe40027a182b0861c7ae2fd4a8f">CorrectedMinN_Store</a>()+fN*(<a class="code" href="classcrop.html#ace0698df7604e46f0330a08494227bf2">CorrectedMaxN_Store</a>()-<a class="code" href="classcrop.html#a2ada3fe40027a182b0861c7ae2fd4a8f">CorrectedMinN_Store</a>()))*<a class="code" href="classcrop.html#a4a2803c0618d2f662abfa8d230c811df">DryMatterStorage</a>;
<a name="l00548"></a>00548    <span class="keywordtype">double</span> N15Ratio    = <a class="code" href="classcrop.html#adabbdde8753e5ae0ecd238e221429d88" title="How much Nitrogen that is in the plant.">Nitrogen</a>.<a class="code" href="classnitrogen.html#ac97f3ebad4801a13a7c444bab3b3a886">Get15NRatio</a>();
<a name="l00549"></a>00549    <span class="keywordtype">double</span> TotalStrawN =  (<a class="code" href="classcrop.html#a10c59f3f5b94ba41a4678e68d6e559b2">NpctMinVegTop</a>()/100+fN*(<a class="code" href="classcrop.html#a32e4925865c2310ccc9efc0df1cec1bb">NpctMaxVegTop</a>()-<a class="code" href="classcrop.html#a10c59f3f5b94ba41a4678e68d6e559b2">NpctMinVegTop</a>())/100)*<a class="code" href="classcrop.html#a755b12e801a538bb34a8c7b829047e76">DryMatterVegTop</a>;
<a name="l00550"></a>00550    <span class="keywordtype">double</span> Nrest = <a class="code" href="classcrop.html#adabbdde8753e5ae0ecd238e221429d88" title="How much Nitrogen that is in the plant.">Nitrogen</a>.<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a> - TotalRootN - TotStorageN - TotalStrawN;
<a name="l00551"></a>00551 
<a name="l00552"></a>00552    <span class="comment">//rest of N is allocated to root</span>
<a name="l00553"></a>00553    <span class="keywordflow">if</span> ((Nrest&lt;-0.01)||(Nrest&gt;0.01))   <span class="comment">//if Nrest positive: there is some unallocated N in the plant</span>
<a name="l00554"></a>00554    {
<a name="l00555"></a>00555       <a class="code" href="message_8h.html#a8ad29009121a629982c6ade0bd332470">theMessage</a>-&gt;<a class="code" href="classmessage.html#afed66d0552f90b4385c5169cf5929907">WarningWithDisplay</a>(<span class="stringliteral">&quot;crop::Harvest - Nitrogen content adjusted&quot;</span>);
<a name="l00556"></a>00556       TotalRootN = TotalRootN+Nrest;
<a name="l00557"></a>00557    }
<a name="l00558"></a>00558 
<a name="l00559"></a>00559 
<a name="l00560"></a>00560    RootN.<a class="code" href="classnitrogen.html#a49bebcba4c40f3c0a6abb24f590b2c8c">SetBoth</a>(TotalRootN,N15Ratio*TotalRootN);
<a name="l00561"></a>00561    StorageN.<a class="code" href="classnitrogen.html#a49bebcba4c40f3c0a6abb24f590b2c8c">SetBoth</a>(TotStorageN,N15Ratio*TotStorageN);
<a name="l00562"></a>00562    StrawN = <a class="code" href="classcrop.html#adabbdde8753e5ae0ecd238e221429d88" title="How much Nitrogen that is in the plant.">Nitrogen</a> - RootN - StorageN;
<a name="l00563"></a>00563    <span class="keywordflow">if</span> (Storage-&gt;<a class="code" href="classproduct.html#a021ebef2da57e1d977cfe57e62c6e38b">GetAmount</a>()&gt;0)
<a name="l00564"></a>00564         Storage-&gt;<a class="code" href="classlive_matter.html#adbb45be219dd863cfad2b5e97cde1508">SetorgN_content</a>(StorageN/Storage-&gt;<a class="code" href="classproduct.html#a021ebef2da57e1d977cfe57e62c6e38b">GetAmount</a>());
<a name="l00565"></a>00565    <span class="keywordflow">if</span> (Straw-&gt;<a class="code" href="classproduct.html#a021ebef2da57e1d977cfe57e62c6e38b">GetAmount</a>()&gt;0)
<a name="l00566"></a>00566    {
<a name="l00567"></a>00567                 Straw-&gt;<a class="code" href="classlive_matter.html#a59f7f829cb7bfe4f8de9d39921d2d63e">SetNO3_content</a>(StrawN/Straw-&gt;<a class="code" href="classproduct.html#a021ebef2da57e1d977cfe57e62c6e38b">GetAmount</a>()*(0.5*<a class="code" href="classcrop.html#a3ac764feb8fb805863a89f3fbda9f831">FractionNminInVegTop</a>));
<a name="l00568"></a>00568         Straw-&gt;<a class="code" href="classlive_matter.html#ae1c5d6b2f85882a85817e26a8fc9391f">SetNH4_content</a>(StrawN/Straw-&gt;<a class="code" href="classproduct.html#a021ebef2da57e1d977cfe57e62c6e38b">GetAmount</a>()*(0.5*<a class="code" href="classcrop.html#a3ac764feb8fb805863a89f3fbda9f831">FractionNminInVegTop</a>));
<a name="l00569"></a>00569         Straw-&gt;<a class="code" href="classlive_matter.html#adbb45be219dd863cfad2b5e97cde1508">SetorgN_content</a>(StrawN/Straw-&gt;<a class="code" href="classproduct.html#a021ebef2da57e1d977cfe57e62c6e38b">GetAmount</a>()*(1.0-<a class="code" href="classcrop.html#a3ac764feb8fb805863a89f3fbda9f831">FractionNminInVegTop</a>));
<a name="l00570"></a>00570      }
<a name="l00571"></a>00571 
<a name="l00572"></a>00572         <a class="code" href="classcrop.html#adabbdde8753e5ae0ecd238e221429d88" title="How much Nitrogen that is in the plant.">Nitrogen</a> = <a class="code" href="classcrop.html#adabbdde8753e5ae0ecd238e221429d88" title="How much Nitrogen that is in the plant.">Nitrogen</a>-StorageN-StrawN;
<a name="l00573"></a>00573         <span class="keywordflow">if</span> (!<a class="code" href="classcrop.html#a38f05d3f77cfc67ff755eb8c0d79e301">Phenology</a>-&gt;<a class="code" href="classphenology.html#a906583e45eeda4d8a6e1cec487a272cc" title="return true if planed is ready to be ripped">Ripe</a>())
<a name="l00574"></a>00574       <a class="code" href="message_8h.html#a8ad29009121a629982c6ade0bd332470">theMessage</a>-&gt;<a class="code" href="classmessage.html#aacaa1466698a349689502491cf089f72">Warning</a>(<span class="stringliteral">&quot;crop::Harvest - crop not ready for harvest&quot;</span>);
<a name="l00575"></a>00575    <span class="keywordflow">if</span> (<a class="code" href="classcrop.html#a755b12e801a538bb34a8c7b829047e76">DryMatterVegTop</a>&lt;0 || <a class="code" href="classcrop.html#a4a2803c0618d2f662abfa8d230c811df">DryMatterStorage</a>&lt;0 || StorageN.n&lt;0 || StrawN.n&lt;0 || <a class="code" href="classcrop.html#adabbdde8753e5ae0ecd238e221429d88" title="How much Nitrogen that is in the plant.">Nitrogen</a>.<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a>&lt;0)
<a name="l00576"></a>00576    {
<a name="l00577"></a>00577            <a class="code" href="message_8h.html#a8ad29009121a629982c6ade0bd332470">theMessage</a>-&gt;<a class="code" href="classmessage.html#afed66d0552f90b4385c5169cf5929907">WarningWithDisplay</a>(<span class="stringliteral">&quot;crop:: Harvest values should not be negative&quot;</span>);
<a name="l00578"></a>00578       StorageN.n = max(0.0,StorageN.n);
<a name="l00579"></a>00579       StrawN.n = max(0.0,StrawN.n);
<a name="l00580"></a>00580         }
<a name="l00581"></a>00581 
<a name="l00582"></a>00582    <a class="code" href="classcrop.html#af7ae14fac12af3efa728e789155983fb">Nbudget</a>.<a class="code" href="classbudget.html#a47bfa9740186f2be18a10dd3423a5eea">AddOutput</a>(StorageN.n+StrawN.n);                    <span class="comment">// Budgets</span>
<a name="l00583"></a>00583    <a class="code" href="classcrop.html#a3e5fad944be35152e933b5e50f928f5a">N15budget</a>.<a class="code" href="classbudget.html#a47bfa9740186f2be18a10dd3423a5eea">AddOutput</a>(StorageN.n15+StrawN.n15);                    <span class="comment">// Budgets</span>
<a name="l00584"></a>00584    <a class="code" href="classcrop.html#a46844fd0540eb7627555f21afa8545e8">DMbudget</a>.<a class="code" href="classbudget.html#a47bfa9740186f2be18a10dd3423a5eea">AddOutput</a>(<a class="code" href="classcrop.html#a755b12e801a538bb34a8c7b829047e76">DryMatterVegTop</a>+<a class="code" href="classcrop.html#a4a2803c0618d2f662abfa8d230c811df">DryMatterStorage</a>);
<a name="l00585"></a>00585 
<a name="l00586"></a>00586         <a class="code" href="classcrop.html#a755b12e801a538bb34a8c7b829047e76">DryMatterVegTop</a>    = 0.0;
<a name="l00587"></a>00587         <a class="code" href="classcrop.html#a4a2803c0618d2f662abfa8d230c811df">DryMatterStorage</a>   = 0.0;
<a name="l00588"></a>00588         <a class="code" href="classcrop.html#a2691a60a48a5166469df5da0e0e824fb">GreenCropAreaIndex</a> = 0.0;
<a name="l00589"></a>00589         <a class="code" href="classcrop.html#a7acb3fa412808c819f4d9b662cc2148c">YellowCropAreaIndex</a>= 0.0;
<a name="l00590"></a>00590 <span class="comment">//      FractionInStorage  = 0.0;</span>
<a name="l00591"></a>00591    <a class="code" href="classcrop.html#a3f40980535ac184d9cced18aff1a0f8c">PlantHeight</a>        = 0.1;                      <span class="comment">// Modify to real cutting height!!!!!</span>
<a name="l00592"></a>00592         <a class="code" href="classcrop.html#a4a8b0a766947fe8b0dfc6a59a24b9bef">topMatter</a>          = NULL;
<a name="l00593"></a>00593 <span class="comment">//   rootMatter         = NULL;</span>
<a name="l00594"></a>00594 
<a name="l00595"></a>00595    <span class="keywordtype">double</span> NRemain, DMRemain;
<a name="l00596"></a>00596    <a class="code" href="classcrop.html#aaacb9f08e608ce328d60a25813a49ca5">EndBudget</a>(&amp;NRemain,&amp;DMRemain);
<a name="l00597"></a>00597 }
<a name="l00598"></a>00598 
<a name="l00602"></a><a class="code" href="classcrop.html#a8b5cf5b385f82405af121592f7106fc2">00602</a> <span class="keywordtype">void</span> <a class="code" href="classcrop.html#a8b5cf5b385f82405af121592f7106fc2" title="kills the crop">crop::Terminate</a>(<a class="code" href="classdecomposable.html">decomposable</a>* Straw,<a class="code" href="classdecomposable.html">decomposable</a>* DeadRoot,<span class="keywordtype">double</span> *&amp; RootLengthList)
<a name="l00603"></a>00603 {
<a name="l00604"></a>00604         <span class="keywordflow">if</span> (!<a class="code" href="classcrop.html#a38f05d3f77cfc67ff755eb8c0d79e301">Phenology</a>-&gt;<a class="code" href="classphenology.html#a906583e45eeda4d8a6e1cec487a272cc" title="return true if planed is ready to be ripped">Ripe</a>() &amp;&amp; !<a class="code" href="classcrop.html#af82f3b3de55473a22e08c2b07d6e0645">GrowthContinue</a> &amp;&amp; !<a class="code" href="classcrop.html#af94e599e6f05fae15099673485d28e88" title="Describe if a plan is dead(true) or alive(false)">terminated</a>)               <span class="comment">// warning if a non-permanent crop is not ripe</span>
<a name="l00605"></a>00605       <a class="code" href="message_8h.html#a8ad29009121a629982c6ade0bd332470">theMessage</a>-&gt;<a class="code" href="classmessage.html#aacaa1466698a349689502491cf089f72">Warning</a>(<span class="stringliteral">&quot;crop::Terminate - should not terminate crop at this phase&quot;</span>);
<a name="l00606"></a>00606    <span class="keywordflow">if</span> (!<a class="code" href="classcrop.html#a38f05d3f77cfc67ff755eb8c0d79e301">Phenology</a>-&gt;<a class="code" href="classphenology.html#a514ca53b35d3dfc3e8dc1b4841d221cf" title="return true if crop has emerged">Emerged</a>())
<a name="l00607"></a>00607       <a class="code" href="message_8h.html#a8ad29009121a629982c6ade0bd332470">theMessage</a>-&gt;<a class="code" href="classmessage.html#afed66d0552f90b4385c5169cf5929907">WarningWithDisplay</a>(<span class="stringliteral">&quot;crop::Terminate - attempt to terminate a crop that has not even emerged!!!&quot;</span>);
<a name="l00608"></a>00608 
<a name="l00609"></a>00609    <span class="keywordflow">if</span> (<a class="code" href="classcrop.html#a755b12e801a538bb34a8c7b829047e76">DryMatterVegTop</a>+<a class="code" href="classcrop.html#a4a2803c0618d2f662abfa8d230c811df">DryMatterStorage</a>&gt;0.0)
<a name="l00610"></a>00610    {
<a name="l00611"></a>00611         Straw-&gt;<a class="code" href="classproduct.html#a0219cde65dc26376f3371a0138199ba8">Setname</a>(<a class="code" href="classcrop.html#aa2aceced21d0fee166e40a836c2ee9cc">StrawItemName</a>);
<a name="l00612"></a>00612            <a class="code" href="_new_main_8cpp.html#af1019990138497f1f18cc7294737d140">theProducts</a>-&gt;<a class="code" href="classproducts.html#a8bd239aabc0a167741c02882e305d65d">GiveProductInformation</a>(Straw);
<a name="l00613"></a>00613       Straw-&gt;<a class="code" href="classproduct.html#a18ec2e96f1d9b7cef74c4b2800ebdca1">Setamount</a>((<a class="code" href="classcrop.html#a755b12e801a538bb34a8c7b829047e76">DryMatterVegTop</a>+<a class="code" href="classcrop.html#a4a2803c0618d2f662abfa8d230c811df">DryMatterStorage</a>)/Straw-&gt;<a class="code" href="classlive_matter.html#ad3d05f1e8ceedc99e214adca94638de0">GetdryMatter</a>());
<a name="l00614"></a>00614 
<a name="l00615"></a>00615            <a class="code" href="classnitrogen.html">nitrogen</a> StrawN = <a class="code" href="classcrop.html#adabbdde8753e5ae0ecd238e221429d88" title="How much Nitrogen that is in the plant.">Nitrogen</a> - <a class="code" href="classcrop.html#ad0404629e0ae80c88ae7b99ff50cfdca">NitrogenInRoot</a>();
<a name="l00616"></a>00616            <span class="keywordflow">if</span> (Straw-&gt;<a class="code" href="classproduct.html#a021ebef2da57e1d977cfe57e62c6e38b">GetAmount</a>()&gt;0)
<a name="l00617"></a>00617       {
<a name="l00618"></a>00618                         Straw-&gt;<a class="code" href="classlive_matter.html#a59f7f829cb7bfe4f8de9d39921d2d63e">SetNO3_content</a>(StrawN/Straw-&gt;<a class="code" href="classproduct.html#a021ebef2da57e1d977cfe57e62c6e38b">GetAmount</a>()*(0.5*<a class="code" href="classcrop.html#a3ac764feb8fb805863a89f3fbda9f831">FractionNminInVegTop</a>));
<a name="l00619"></a>00619          Straw-&gt;<a class="code" href="classlive_matter.html#ae1c5d6b2f85882a85817e26a8fc9391f">SetNH4_content</a>(StrawN/Straw-&gt;<a class="code" href="classproduct.html#a021ebef2da57e1d977cfe57e62c6e38b">GetAmount</a>()*(0.5*<a class="code" href="classcrop.html#a3ac764feb8fb805863a89f3fbda9f831">FractionNminInVegTop</a>));
<a name="l00620"></a>00620          Straw-&gt;<a class="code" href="classlive_matter.html#adbb45be219dd863cfad2b5e97cde1508">SetorgN_content</a>(StrawN/Straw-&gt;<a class="code" href="classproduct.html#a021ebef2da57e1d977cfe57e62c6e38b">GetAmount</a>()*(1.0-<a class="code" href="classcrop.html#a3ac764feb8fb805863a89f3fbda9f831">FractionNminInVegTop</a>));
<a name="l00621"></a>00621            }
<a name="l00622"></a>00622            <a class="code" href="classcrop.html#adabbdde8753e5ae0ecd238e221429d88" title="How much Nitrogen that is in the plant.">Nitrogen</a> = <a class="code" href="classcrop.html#adabbdde8753e5ae0ecd238e221429d88" title="How much Nitrogen that is in the plant.">Nitrogen</a>-StrawN;
<a name="l00623"></a>00623    }
<a name="l00624"></a>00624 
<a name="l00625"></a>00625    RootLengthList= <a class="code" href="classcrop.html#a17c3bc93f8a3a6c784f9e30e9d17fbef">GiveRootLengthList</a>();
<a name="l00626"></a>00626 
<a name="l00627"></a>00627    DeadRoot-&gt;<a class="code" href="classproduct.html#a0219cde65dc26376f3371a0138199ba8">Setname</a>(<span class="stringliteral">&quot;ROOTMATTER&quot;</span>);
<a name="l00628"></a>00628    <a class="code" href="_new_main_8cpp.html#af1019990138497f1f18cc7294737d140">theProducts</a>-&gt;<a class="code" href="classproducts.html#a8bd239aabc0a167741c02882e305d65d">GiveProductInformation</a>(DeadRoot);
<a name="l00629"></a>00629 
<a name="l00630"></a>00630    DeadRoot-&gt;<a class="code" href="classproduct.html#a18ec2e96f1d9b7cef74c4b2800ebdca1">Setamount</a>(<a class="code" href="classcrop.html#a3c5f4942cf46d45168caf4da80b79537">DryMatterRoot</a>/DeadRoot-&gt;<a class="code" href="classlive_matter.html#ad3d05f1e8ceedc99e214adca94638de0">GetdryMatter</a>());
<a name="l00631"></a>00631    <span class="keywordflow">if</span> (<a class="code" href="classcrop.html#a3c5f4942cf46d45168caf4da80b79537">DryMatterRoot</a>&gt;0)
<a name="l00632"></a>00632    {
<a name="l00633"></a>00633         DeadRoot-&gt;<a class="code" href="classlive_matter.html#ae1c5d6b2f85882a85817e26a8fc9391f">SetNH4_content</a>(<a class="code" href="classcrop.html#adabbdde8753e5ae0ecd238e221429d88" title="How much Nitrogen that is in the plant.">Nitrogen</a>/DeadRoot-&gt;<a class="code" href="classproduct.html#a021ebef2da57e1d977cfe57e62c6e38b">GetAmount</a>()*0.5*<a class="code" href="classcrop.html#a86b3309065f886170bff7ad71c0a853f">FractionNminInRoots</a>);
<a name="l00634"></a>00634         DeadRoot-&gt;<a class="code" href="classlive_matter.html#a59f7f829cb7bfe4f8de9d39921d2d63e">SetNO3_content</a>(<a class="code" href="classcrop.html#adabbdde8753e5ae0ecd238e221429d88" title="How much Nitrogen that is in the plant.">Nitrogen</a>/DeadRoot-&gt;<a class="code" href="classproduct.html#a021ebef2da57e1d977cfe57e62c6e38b">GetAmount</a>()*0.5*<a class="code" href="classcrop.html#a86b3309065f886170bff7ad71c0a853f">FractionNminInRoots</a>);
<a name="l00635"></a>00635         DeadRoot-&gt;<a class="code" href="classlive_matter.html#adbb45be219dd863cfad2b5e97cde1508">SetorgN_content</a>(<a class="code" href="classcrop.html#adabbdde8753e5ae0ecd238e221429d88" title="How much Nitrogen that is in the plant.">Nitrogen</a>/DeadRoot-&gt;<a class="code" href="classproduct.html#a021ebef2da57e1d977cfe57e62c6e38b">GetAmount</a>()*(1.0 - <a class="code" href="classcrop.html#a86b3309065f886170bff7ad71c0a853f">FractionNminInRoots</a>));
<a name="l00636"></a>00636    }
<a name="l00637"></a>00637 
<a name="l00638"></a>00638    <a class="code" href="classcrop.html#af7ae14fac12af3efa728e789155983fb">Nbudget</a>.<a class="code" href="classbudget.html#a47bfa9740186f2be18a10dd3423a5eea">AddOutput</a>(<a class="code" href="classcrop.html#adabbdde8753e5ae0ecd238e221429d88" title="How much Nitrogen that is in the plant.">Nitrogen</a>.<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a>);                    <span class="comment">// Budgets</span>
<a name="l00639"></a>00639    <a class="code" href="classcrop.html#a3e5fad944be35152e933b5e50f928f5a">N15budget</a>.<a class="code" href="classbudget.html#a47bfa9740186f2be18a10dd3423a5eea">AddOutput</a>(<a class="code" href="classcrop.html#adabbdde8753e5ae0ecd238e221429d88" title="How much Nitrogen that is in the plant.">Nitrogen</a>.<a class="code" href="classnitrogen.html#a2d537cc848da50f09b7580539f261dfc">n15</a>);
<a name="l00640"></a>00640    <a class="code" href="classcrop.html#a46844fd0540eb7627555f21afa8545e8">DMbudget</a>.<a class="code" href="classbudget.html#a47bfa9740186f2be18a10dd3423a5eea">AddOutput</a>(<a class="code" href="classcrop.html#a3c5f4942cf46d45168caf4da80b79537">DryMatterRoot</a>);
<a name="l00641"></a>00641 
<a name="l00642"></a>00642         <a class="code" href="classcrop.html#adabbdde8753e5ae0ecd238e221429d88" title="How much Nitrogen that is in the plant.">Nitrogen</a>.<a class="code" href="classnitrogen.html#a706b101d934ddb44c4bff07761c8dfef">Clear</a>();
<a name="l00643"></a>00643         <a class="code" href="classcrop.html#a512f2450d70fb9f2a84d046d5a090a94">RootDensAtSurf</a> = 0.0;
<a name="l00644"></a>00644         <a class="code" href="classcrop.html#a1f0aa4443cf11cdf5776454bd056fa28">TotalRootLength</a>= 0.0;
<a name="l00645"></a>00645         <a class="code" href="classcrop.html#aefe9049cee98b6ac81f4362c4a1190a9">RootDepth</a>      = 0.0;
<a name="l00646"></a>00646         <a class="code" href="classcrop.html#a3c5f4942cf46d45168caf4da80b79537">DryMatterRoot</a>  = 0.0;
<a name="l00647"></a>00647    <a class="code" href="classcrop.html#a3f40980535ac184d9cced18aff1a0f8c">PlantHeight</a>    = 0.0;
<a name="l00648"></a>00648 
<a name="l00649"></a>00649    <a class="code" href="classcrop.html#af94e599e6f05fae15099673485d28e88" title="Describe if a plan is dead(true) or alive(false)">terminated</a>     = <span class="keyword">true</span>;
<a name="l00650"></a>00650 }
<a name="l00651"></a>00651 
<a name="l00655"></a><a class="code" href="classcrop.html#a4acf198494d9c34cf42f27e5a9f11032">00655</a> <span class="keywordtype">void</span> <a class="code" href="classcrop.html#a4acf198494d9c34cf42f27e5a9f11032">crop::Graze</a>(<a class="code" href="classplant_item.html">plantItem</a> * cutPlantMaterial,<span class="keywordtype">double</span> cut_height)
<a name="l00656"></a>00656 {
<a name="l00657"></a>00657    <span class="comment">// CutOrHarvested = true;</span>
<a name="l00658"></a>00658    <span class="keywordflow">if</span> (!<a class="code" href="classcrop.html#af94e599e6f05fae15099673485d28e88" title="Describe if a plan is dead(true) or alive(false)">terminated</a>)
<a name="l00659"></a>00659       <a class="code" href="message_8h.html#a8ad29009121a629982c6ade0bd332470">theMessage</a>-&gt;<a class="code" href="classmessage.html#afed66d0552f90b4385c5169cf5929907">WarningWithDisplay</a>(<span class="stringliteral">&quot;crop::Graze - this crop can not be grazed, operation ignored!&quot;</span>);
<a name="l00660"></a>00660 }
<a name="l00661"></a>00661 
<a name="l00665"></a><a class="code" href="classcrop.html#aac8ad06adb13f585cfde7cd3f2661618">00665</a> <span class="keywordtype">double</span> <a class="code" href="classcrop.html#aac8ad06adb13f585cfde7cd3f2661618">crop::GiveEvapFactor</a>()
<a name="l00666"></a>00666 {
<a name="l00667"></a>00667         <span class="comment">// New method according to Joergen Olesen, et al. Clim. Res. (2000)</span>
<a name="l00668"></a>00668    <span class="keywordflow">return</span> 1.0+0.02*(<a class="code" href="classcrop.html#a2691a60a48a5166469df5da0e0e824fb">GreenCropAreaIndex</a>+<a class="code" href="classcrop.html#a7acb3fa412808c819f4d9b662cc2148c">YellowCropAreaIndex</a>);
<a name="l00669"></a>00669 }
<a name="l00670"></a>00670 
<a name="l00674"></a><a class="code" href="classcrop.html#a609b719943e334677b04110be1e1a566">00674</a> <span class="keywordtype">double</span> <a class="code" href="classcrop.html#a609b719943e334677b04110be1e1a566">crop::GiveNitrogenResponseCO2</a>()
<a name="l00675"></a>00675 {
<a name="l00676"></a>00676 <span class="keywordtype">double</span> CO2 = <a class="code" href="climate_8h.html#ad05fb99191dc4a9cb94e7f8c99280389">theClimate</a>-&gt;<a class="code" href="classclimate.html#a14e9a0d27f51b514217508b04f53ca04">GetCO2Concentration</a>();
<a name="l00677"></a>00677   <span class="keywordflow">return</span> max(1.0,0.6+141/CO2);
<a name="l00678"></a>00678 }
<a name="l00679"></a>00679 
<a name="l00683"></a><a class="code" href="classcrop.html#a2ada3fe40027a182b0861c7ae2fd4a8f">00683</a> <span class="keywordtype">double</span> <a class="code" href="classcrop.html#a2ada3fe40027a182b0861c7ae2fd4a8f">crop::CorrectedMinN_Store</a>()
<a name="l00684"></a>00684 {
<a name="l00685"></a>00685         <span class="keywordtype">double</span> NCO2 = <a class="code" href="classcrop.html#a609b719943e334677b04110be1e1a566">GiveNitrogenResponseCO2</a>();
<a name="l00686"></a>00686    <span class="keywordtype">double</span> NminVal = NCO2*<a class="code" href="classcrop.html#a3a411cb751e18aaf088d266ee47c9420">MinN_Store</a>;
<a name="l00687"></a>00687         <span class="keywordflow">return</span> NminVal;
<a name="l00688"></a>00688 }
<a name="l00689"></a>00689 
<a name="l00693"></a><a class="code" href="classcrop.html#acc16e034b1484f87bbc3ec3863418f83">00693</a> <span class="keywordtype">double</span> <a class="code" href="classcrop.html#acc16e034b1484f87bbc3ec3863418f83">crop::CorrectedMinN_Root</a>()
<a name="l00694"></a>00694 {
<a name="l00695"></a>00695         <span class="keywordtype">double</span> NCO2 = <a class="code" href="classcrop.html#a609b719943e334677b04110be1e1a566">GiveNitrogenResponseCO2</a>();
<a name="l00696"></a>00696    <span class="keywordtype">double</span> NminVal = NCO2*<a class="code" href="classcrop.html#a4ec1369c2adcd701d7c4676fce24310c">MinN_Root</a>;
<a name="l00697"></a>00697         <span class="keywordflow">return</span> NminVal;
<a name="l00698"></a>00698 }
<a name="l00699"></a>00699 
<a name="l00703"></a><a class="code" href="classcrop.html#ace0698df7604e46f0330a08494227bf2">00703</a> <span class="keywordtype">double</span> <a class="code" href="classcrop.html#ace0698df7604e46f0330a08494227bf2">crop::CorrectedMaxN_Store</a>()
<a name="l00704"></a>00704 {
<a name="l00705"></a>00705         <span class="keywordtype">double</span> NCO2 = <a class="code" href="classcrop.html#a609b719943e334677b04110be1e1a566">GiveNitrogenResponseCO2</a>();
<a name="l00706"></a>00706    <span class="keywordtype">double</span> NminVal = NCO2*<a class="code" href="classcrop.html#a9f5ab366fce6f1259588cf5087cdb4c2">MaxN_Store</a>;
<a name="l00707"></a>00707         <span class="keywordflow">return</span> NminVal;
<a name="l00708"></a>00708 }
<a name="l00709"></a>00709 
<a name="l00713"></a><a class="code" href="classcrop.html#a70d49c552a110f0fef57e068575974c9">00713</a> <span class="keywordtype">double</span> <a class="code" href="classcrop.html#a70d49c552a110f0fef57e068575974c9">crop::CorrectedMaxN_Root</a>()
<a name="l00714"></a>00714 {
<a name="l00715"></a>00715         <span class="keywordtype">double</span> NCO2 = <a class="code" href="classcrop.html#a609b719943e334677b04110be1e1a566">GiveNitrogenResponseCO2</a>();
<a name="l00716"></a>00716    <span class="keywordtype">double</span> NminVal = NCO2*<a class="code" href="classcrop.html#a62361ade607f9cc57e226c1134ad0eb2">MaxN_Root</a>;
<a name="l00717"></a>00717         <span class="keywordflow">return</span> NminVal;
<a name="l00718"></a>00718 }
<a name="l00719"></a>00719 
<a name="l00720"></a>00720 
<a name="l00721"></a>00721 
<a name="l00725"></a><a class="code" href="classcrop.html#adc9f2a384dfd4be26746b822c4324f37">00725</a> <span class="keywordtype">double</span> <a class="code" href="classcrop.html#adc9f2a384dfd4be26746b822c4324f37">crop::Nmin</a>()
<a name="l00726"></a>00726 {
<a name="l00727"></a>00727          <span class="keywordtype">double</span> NminVal = <a class="code" href="classcrop.html#acc16e034b1484f87bbc3ec3863418f83">CorrectedMinN_Root</a>()*max(0.0,<a class="code" href="classcrop.html#a3c5f4942cf46d45168caf4da80b79537">DryMatterRoot</a>)+<a class="code" href="classcrop.html#a2ada3fe40027a182b0861c7ae2fd4a8f">CorrectedMinN_Store</a>()*max(0.0,<a class="code" href="classcrop.html#a4a2803c0618d2f662abfa8d230c811df">DryMatterStorage</a>)
<a name="l00728"></a>00728                                                         +<a class="code" href="classcrop.html#a10c59f3f5b94ba41a4678e68d6e559b2">NpctMinVegTop</a>()/100*max(0.0,<a class="code" href="classcrop.html#a755b12e801a538bb34a8c7b829047e76">DryMatterVegTop</a>);
<a name="l00729"></a>00729         <span class="keywordflow">return</span> NminVal;
<a name="l00730"></a>00730 }
<a name="l00731"></a>00731 
<a name="l00735"></a><a class="code" href="classcrop.html#a6416f0baf1364f2cf28f312584c39f73">00735</a> <span class="keywordtype">double</span> <a class="code" href="classcrop.html#a6416f0baf1364f2cf28f312584c39f73">crop::Nmax</a>()
<a name="l00736"></a>00736 {
<a name="l00737"></a>00737         <span class="keywordtype">double</span> NmaxVal = 0.0;
<a name="l00738"></a>00738         <span class="keywordtype">double</span> N = 0.0;
<a name="l00739"></a>00739 
<a name="l00740"></a>00740    <span class="keywordflow">if</span> (<a class="code" href="classcrop.html#a2691a60a48a5166469df5da0e0e824fb">GreenCropAreaIndex</a>&lt;0.0)
<a name="l00741"></a>00741    {
<a name="l00742"></a>00742       <a class="code" href="message_8h.html#a8ad29009121a629982c6ade0bd332470">theMessage</a>-&gt;<a class="code" href="classmessage.html#afed66d0552f90b4385c5169cf5929907">WarningWithDisplay</a>(<span class="stringliteral">&quot;crop::Nmax() - GreenCropAreaIndex negative&quot;</span>);
<a name="l00743"></a>00743       <a class="code" href="classcrop.html#a2691a60a48a5166469df5da0e0e824fb">GreenCropAreaIndex</a>=0.0;
<a name="l00744"></a>00744    }
<a name="l00745"></a>00745    <span class="keywordtype">double</span> NPVTMax=<a class="code" href="classcrop.html#a32e4925865c2310ccc9efc0df1cec1bb">NpctMaxVegTop</a>();
<a name="l00746"></a>00746         N = max(0.0,<a class="code" href="classcrop.html#a755b12e801a538bb34a8c7b829047e76">DryMatterVegTop</a>)*NPVTMax/100.0;                                     <span class="comment">// g N in VegTop/m^2</span>
<a name="l00747"></a>00747         NmaxVal = N+<a class="code" href="classcrop.html#a70d49c552a110f0fef57e068575974c9">CorrectedMaxN_Root</a>()*max(0.0,<a class="code" href="classcrop.html#a3c5f4942cf46d45168caf4da80b79537">DryMatterRoot</a>)+<a class="code" href="classcrop.html#ace0698df7604e46f0330a08494227bf2">CorrectedMaxN_Store</a>()*max(0.0,<a class="code" href="classcrop.html#a4a2803c0618d2f662abfa8d230c811df">DryMatterStorage</a>);
<a name="l00748"></a>00748 
<a name="l00749"></a>00749                 <span class="keywordflow">return</span> NmaxVal;
<a name="l00750"></a>00750 }
<a name="l00751"></a>00751 
<a name="l00755"></a><a class="code" href="classcrop.html#a32e4925865c2310ccc9efc0df1cec1bb">00755</a> <span class="keywordtype">double</span> <a class="code" href="classcrop.html#a32e4925865c2310ccc9efc0df1cec1bb">crop::NpctMaxVegTop</a>()
<a name="l00756"></a>00756 {
<a name="l00757"></a>00757 
<a name="l00758"></a>00758    <span class="keywordtype">double</span> NpctVal;
<a name="l00759"></a>00759    <span class="keywordflow">if</span> (!(<a class="code" href="classcrop.html#a394d3da7bbc4c297a68b5c6f575c5ecc">fractionOfSpace</a>&lt;1E-36))
<a name="l00760"></a>00760            NpctVal = <a class="code" href="classcrop.html#ab71cf78ab9ac2779deeb032e7b36e47d">NPctMax</a>*pow(1.5/<a class="code" href="classcrop.html#a394d3da7bbc4c297a68b5c6f575c5ecc">fractionOfSpace</a>,<a class="code" href="classcrop.html#a69df1a97a358dff8c354b08cb93908ec">PowDM</a>);
<a name="l00761"></a>00761    <span class="keywordflow">else</span>
<a name="l00762"></a>00762            NpctVal = <a class="code" href="classcrop.html#ab71cf78ab9ac2779deeb032e7b36e47d">NPctMax</a>*pow(1.5,<a class="code" href="classcrop.html#a69df1a97a358dff8c354b08cb93908ec">PowDM</a>);
<a name="l00763"></a>00763    <span class="keywordtype">double</span> NCO2 = <a class="code" href="classcrop.html#a609b719943e334677b04110be1e1a566">GiveNitrogenResponseCO2</a>();
<a name="l00764"></a>00764    <span class="keywordflow">if</span> (!(<a class="code" href="classcrop.html#a394d3da7bbc4c297a68b5c6f575c5ecc">fractionOfSpace</a>&lt;1E-36))
<a name="l00765"></a>00765    {
<a name="l00766"></a>00766            <span class="keywordflow">if</span> (<a class="code" href="classcrop.html#a755b12e801a538bb34a8c7b829047e76">DryMatterVegTop</a>/<a class="code" href="classcrop.html#a394d3da7bbc4c297a68b5c6f575c5ecc">fractionOfSpace</a>&gt;150)
<a name="l00767"></a>00767            {
<a name="l00768"></a>00768                    NpctVal = <a class="code" href="classcrop.html#ab71cf78ab9ac2779deeb032e7b36e47d">NPctMax</a>*pow(<a class="code" href="classcrop.html#a755b12e801a538bb34a8c7b829047e76">DryMatterVegTop</a>/(100.0*<a class="code" href="classcrop.html#a394d3da7bbc4c297a68b5c6f575c5ecc">fractionOfSpace</a>),<a class="code" href="classcrop.html#a69df1a97a358dff8c354b08cb93908ec">PowDM</a>);        <span class="comment">//for the green leafs and stem</span>
<a name="l00769"></a>00769            }
<a name="l00770"></a>00770    }
<a name="l00771"></a>00771         <span class="keywordflow">if</span> (<a class="code" href="classcrop.html#a7acb3fa412808c819f4d9b662cc2148c">YellowCropAreaIndex</a> &gt; 0.0)
<a name="l00772"></a>00772    {
<a name="l00773"></a>00773                 <span class="comment">//Corrected MEL 2009</span>
<a name="l00774"></a>00774       <span class="keywordtype">double</span> RedFac = (<a class="code" href="classcrop.html#a0bbe1011a2b6d4224bd986f26d5a1d39">ReducedNInYellow</a>*<a class="code" href="classcrop.html#a7acb3fa412808c819f4d9b662cc2148c">YellowCropAreaIndex</a>+<a class="code" href="classcrop.html#a2691a60a48a5166469df5da0e0e824fb">GreenCropAreaIndex</a>)/
<a name="l00775"></a>00775                         (<a class="code" href="classcrop.html#a7acb3fa412808c819f4d9b662cc2148c">YellowCropAreaIndex</a>+<a class="code" href="classcrop.html#a2691a60a48a5166469df5da0e0e824fb">GreenCropAreaIndex</a>);
<a name="l00776"></a>00776       NpctVal = NpctVal*RedFac;                                                                                         <span class="comment">//for all leaf and stem</span>
<a name="l00777"></a>00777    }
<a name="l00778"></a>00778          <span class="keywordflow">return</span> NpctVal*NCO2;
<a name="l00779"></a>00779 }
<a name="l00780"></a>00780 
<a name="l00784"></a><a class="code" href="classcrop.html#a10c59f3f5b94ba41a4678e68d6e559b2">00784</a> <span class="keywordtype">double</span> <a class="code" href="classcrop.html#a10c59f3f5b94ba41a4678e68d6e559b2">crop::NpctMinVegTop</a>()
<a name="l00785"></a>00785 {
<a name="l00786"></a>00786 
<a name="l00787"></a>00787    <span class="keywordtype">double</span> NpctVal;
<a name="l00788"></a>00788       <span class="keywordflow">if</span> (!(<a class="code" href="classcrop.html#a394d3da7bbc4c297a68b5c6f575c5ecc">fractionOfSpace</a>&lt;1E-36))
<a name="l00789"></a>00789            NpctVal = <a class="code" href="classcrop.html#a64b16d0f5b047dbd1c1fcdde7fd09a87">NPctMin</a>*pow(1.5/<a class="code" href="classcrop.html#a394d3da7bbc4c297a68b5c6f575c5ecc">fractionOfSpace</a>,<a class="code" href="classcrop.html#a69df1a97a358dff8c354b08cb93908ec">PowDM</a>);
<a name="l00790"></a>00790       <span class="keywordflow">else</span>
<a name="l00791"></a>00791            NpctVal = <a class="code" href="classcrop.html#a64b16d0f5b047dbd1c1fcdde7fd09a87">NPctMin</a>*pow(1.5,<a class="code" href="classcrop.html#a69df1a97a358dff8c354b08cb93908ec">PowDM</a>);
<a name="l00792"></a>00792       <span class="keywordtype">double</span> NCO2 = <a class="code" href="classcrop.html#a609b719943e334677b04110be1e1a566">GiveNitrogenResponseCO2</a>();
<a name="l00793"></a>00793       <span class="keywordflow">if</span> (!(<a class="code" href="classcrop.html#a394d3da7bbc4c297a68b5c6f575c5ecc">fractionOfSpace</a>&lt;1E-36))
<a name="l00794"></a>00794       {
<a name="l00795"></a>00795            <span class="keywordflow">if</span> (<a class="code" href="classcrop.html#a755b12e801a538bb34a8c7b829047e76">DryMatterVegTop</a>/<a class="code" href="classcrop.html#a394d3da7bbc4c297a68b5c6f575c5ecc">fractionOfSpace</a>&gt;150)
<a name="l00796"></a>00796            {
<a name="l00797"></a>00797                    NpctVal = <a class="code" href="classcrop.html#a64b16d0f5b047dbd1c1fcdde7fd09a87">NPctMin</a>*pow(<a class="code" href="classcrop.html#a755b12e801a538bb34a8c7b829047e76">DryMatterVegTop</a>/(100.0*<a class="code" href="classcrop.html#a394d3da7bbc4c297a68b5c6f575c5ecc">fractionOfSpace</a>),<a class="code" href="classcrop.html#a69df1a97a358dff8c354b08cb93908ec">PowDM</a>); <span class="comment">//for the green leafs and stem</span>
<a name="l00798"></a>00798            }
<a name="l00799"></a>00799       }
<a name="l00800"></a>00800         <span class="keywordflow">if</span> (<a class="code" href="classcrop.html#a7acb3fa412808c819f4d9b662cc2148c">YellowCropAreaIndex</a> &gt; 0.0)
<a name="l00801"></a>00801    {
<a name="l00802"></a>00802         <span class="comment">//the exsistance of yellow parts reduces the concentration of N in the vegtop</span>
<a name="l00803"></a>00803       <span class="keywordtype">double</span> RedFac = (<a class="code" href="classcrop.html#a0bbe1011a2b6d4224bd986f26d5a1d39">ReducedNInYellow</a>*<a class="code" href="classcrop.html#a7acb3fa412808c819f4d9b662cc2148c">YellowCropAreaIndex</a>+<a class="code" href="classcrop.html#a2691a60a48a5166469df5da0e0e824fb">GreenCropAreaIndex</a>)/
<a name="l00804"></a>00804                         (<a class="code" href="classcrop.html#a7acb3fa412808c819f4d9b662cc2148c">YellowCropAreaIndex</a>+<a class="code" href="classcrop.html#a2691a60a48a5166469df5da0e0e824fb">GreenCropAreaIndex</a>);
<a name="l00805"></a>00805       NpctVal = NpctVal*RedFac;
<a name="l00806"></a>00806    }
<a name="l00807"></a>00807    <span class="keywordflow">return</span> NpctVal*NCO2;
<a name="l00808"></a>00808 }
<a name="l00809"></a>00809 
<a name="l00813"></a><a class="code" href="classcrop.html#a82bef6e98553aa173173b0ea454a3e0a">00813</a> <a class="code" href="classnitrogen.html">nitrogen</a> <a class="code" href="classcrop.html#a82bef6e98553aa173173b0ea454a3e0a">crop::NitrogenInVegTop</a>()
<a name="l00814"></a>00814 {
<a name="l00815"></a>00815         <a class="code" href="classnitrogen.html">nitrogen</a> ninRootVal=<a class="code" href="classcrop.html#ad0404629e0ae80c88ae7b99ff50cfdca">NitrogenInRoot</a>();
<a name="l00816"></a>00816         <a class="code" href="classnitrogen.html">nitrogen</a> ninstorageVal=<a class="code" href="classcrop.html#a4f4f31c68a905ef3fef26b9d7456cb36">NitrogenInStorage</a>();
<a name="l00817"></a>00817    <a class="code" href="classnitrogen.html">nitrogen</a> retVal=<a class="code" href="classcrop.html#adabbdde8753e5ae0ecd238e221429d88" title="How much Nitrogen that is in the plant.">Nitrogen</a>-<a class="code" href="classcrop.html#ad0404629e0ae80c88ae7b99ff50cfdca">NitrogenInRoot</a>()-<a class="code" href="classcrop.html#a4f4f31c68a905ef3fef26b9d7456cb36">NitrogenInStorage</a>();
<a name="l00818"></a>00818 
<a name="l00819"></a>00819    <span class="keywordflow">if</span> (retVal&gt;<a class="code" href="classcrop.html#adabbdde8753e5ae0ecd238e221429d88" title="How much Nitrogen that is in the plant.">Nitrogen</a>)
<a name="l00820"></a>00820       <a class="code" href="message_8h.html#a8ad29009121a629982c6ade0bd332470">theMessage</a>-&gt;<a class="code" href="classmessage.html#aacaa1466698a349689502491cf089f72">Warning</a>(<span class="stringliteral">&quot;crop::NitrogenInVegTop - N content in veg. top is above normal range&quot;</span>);
<a name="l00821"></a>00821    <span class="keywordflow">if</span> (retVal.<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a>&lt;-1E-4)
<a name="l00822"></a>00822    {
<a name="l00823"></a>00823         <a class="code" href="message_8h.html#a8ad29009121a629982c6ade0bd332470">theMessage</a>-&gt;<a class="code" href="classmessage.html#afed66d0552f90b4385c5169cf5929907">WarningWithDisplay</a>(<span class="stringliteral">&quot;crop::NitrogenInVegTop - N content in veg. top is below possible range!!!!!!!!!!!!!!!&quot;</span>);
<a name="l00824"></a>00824    }
<a name="l00825"></a>00825         <span class="keywordflow">return</span> retVal;
<a name="l00826"></a>00826 }
<a name="l00827"></a>00827 
<a name="l00831"></a><a class="code" href="classcrop.html#ad0404629e0ae80c88ae7b99ff50cfdca">00831</a> <a class="code" href="classnitrogen.html">nitrogen</a> <a class="code" href="classcrop.html#ad0404629e0ae80c88ae7b99ff50cfdca">crop::NitrogenInRoot</a>()
<a name="l00832"></a>00832 {
<a name="l00833"></a>00833         <span class="keywordtype">double</span> fN = <a class="code" href="classcrop.html#a602622ac2c0de6432e6b9438dbbb646b">fNitrogen</a>();
<a name="l00834"></a>00834           <span class="keywordtype">double</span> NContent = (<a class="code" href="classcrop.html#acc16e034b1484f87bbc3ec3863418f83">CorrectedMinN_Root</a>()+fN*(<a class="code" href="classcrop.html#a70d49c552a110f0fef57e068575974c9">CorrectedMaxN_Root</a>()-<a class="code" href="classcrop.html#acc16e034b1484f87bbc3ec3863418f83">CorrectedMinN_Root</a>()))*<a class="code" href="classcrop.html#a3c5f4942cf46d45168caf4da80b79537">DryMatterRoot</a>;
<a name="l00835"></a>00835    <span class="keywordtype">double</span> N15Ratio = <a class="code" href="classcrop.html#adabbdde8753e5ae0ecd238e221429d88" title="How much Nitrogen that is in the plant.">Nitrogen</a>.<a class="code" href="classnitrogen.html#ac97f3ebad4801a13a7c444bab3b3a886">Get15NRatio</a>();
<a name="l00836"></a>00836    <span class="keywordflow">if</span> (NContent&gt;(0.99999*<a class="code" href="classcrop.html#adabbdde8753e5ae0ecd238e221429d88" title="How much Nitrogen that is in the plant.">Nitrogen</a>.<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a>)) <span class="comment">// Not the outmost elegance!!!</span>
<a name="l00837"></a>00837    {
<a name="l00838"></a>00838       <span class="keywordflow">if</span> (<a class="code" href="classcrop.html#adabbdde8753e5ae0ecd238e221429d88" title="How much Nitrogen that is in the plant.">Nitrogen</a>.<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a>&lt;1E-30 &amp;&amp; <a class="code" href="classcrop.html#a3c5f4942cf46d45168caf4da80b79537">DryMatterRoot</a>&gt;1E-3)
<a name="l00839"></a>00839       {
<a name="l00840"></a>00840        <span class="comment">//  cout &lt;&lt; endl &lt;&lt; &quot;Crop object path : &quot; &lt;&lt; GetLongName() &lt;&lt; endl;</span>
<a name="l00841"></a>00841          cout &lt;&lt; <span class="stringliteral">&quot;N in plant: &quot;</span> &lt;&lt; <a class="code" href="classcrop.html#adabbdde8753e5ae0ecd238e221429d88" title="How much Nitrogen that is in the plant.">Nitrogen</a>.<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a> &lt;&lt; endl;
<a name="l00842"></a>00842          cout &lt;&lt; <span class="stringliteral">&quot;DM in root: &quot;</span> &lt;&lt; <a class="code" href="classcrop.html#a3c5f4942cf46d45168caf4da80b79537">DryMatterRoot</a>;
<a name="l00843"></a>00843          <a class="code" href="message_8h.html#a8ad29009121a629982c6ade0bd332470">theMessage</a>-&gt;<a class="code" href="classmessage.html#af9891cb7111375e6a36363afffb09d63">FatalError</a>(<span class="stringliteral">&quot;crop::NitrogenInRoot - no N but still dry matter in root&quot;</span>);
<a name="l00844"></a>00844       }
<a name="l00845"></a>00845       <span class="keywordflow">else</span>
<a name="l00846"></a>00846       {
<a name="l00847"></a>00847         <a class="code" href="message_8h.html#a8ad29009121a629982c6ade0bd332470">theMessage</a>-&gt;<a class="code" href="classmessage.html#aacaa1466698a349689502491cf089f72">Warning</a>(<span class="stringliteral">&quot;crop::NitrogenInRoot - N content in root is to high - postadjusted&quot;</span>);
<a name="l00848"></a>00848          NContent=0.99999*<a class="code" href="classcrop.html#adabbdde8753e5ae0ecd238e221429d88" title="How much Nitrogen that is in the plant.">Nitrogen</a>.<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a>;
<a name="l00849"></a>00849       }
<a name="l00850"></a>00850    }
<a name="l00851"></a>00851    <a class="code" href="classnitrogen.html">nitrogen</a> retVal;
<a name="l00852"></a>00852    retVal.<a class="code" href="classnitrogen.html#a49bebcba4c40f3c0a6abb24f590b2c8c">SetBoth</a>(NContent,N15Ratio*NContent);
<a name="l00853"></a>00853    <span class="keywordflow">if</span> (retVal.<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a>&gt;(<a class="code" href="classcrop.html#adabbdde8753e5ae0ecd238e221429d88" title="How much Nitrogen that is in the plant.">Nitrogen</a>.<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a>+0.00001))
<a name="l00854"></a>00854    {
<a name="l00855"></a>00855         <a class="code" href="message_8h.html#a8ad29009121a629982c6ade0bd332470">theMessage</a>-&gt;<a class="code" href="classmessage.html#afed66d0552f90b4385c5169cf5929907">WarningWithDisplay</a>(<span class="stringliteral">&quot;crop::NitrogenInRoot nitrogen in root exceeds nitrogen in plant&quot;</span>);
<a name="l00856"></a>00856         retVal = <a class="code" href="classcrop.html#acc16e034b1484f87bbc3ec3863418f83">CorrectedMinN_Root</a>()*<a class="code" href="classcrop.html#a3c5f4942cf46d45168caf4da80b79537">DryMatterRoot</a>;
<a name="l00857"></a>00857    }
<a name="l00858"></a>00858    <span class="keywordflow">return</span> retVal;
<a name="l00859"></a>00859 }
<a name="l00860"></a>00860 
<a name="l00861"></a>00861 <span class="comment">/****************************************************************************\</span>
<a name="l00862"></a>00862 <span class="comment">\****************************************************************************/</span>
<a name="l00863"></a><a class="code" href="classcrop.html#a4f4f31c68a905ef3fef26b9d7456cb36">00863</a> <a class="code" href="classnitrogen.html">nitrogen</a> <a class="code" href="classcrop.html#a4f4f31c68a905ef3fef26b9d7456cb36">crop::NitrogenInStorage</a>()
<a name="l00864"></a>00864 {
<a name="l00865"></a>00865         <span class="keywordtype">double</span> fN = <a class="code" href="classcrop.html#a602622ac2c0de6432e6b9438dbbb646b">fNitrogen</a>();
<a name="l00866"></a>00866           <span class="keywordtype">double</span> NContent = (<a class="code" href="classcrop.html#a2ada3fe40027a182b0861c7ae2fd4a8f">CorrectedMinN_Store</a>()+fN*(<a class="code" href="classcrop.html#ace0698df7604e46f0330a08494227bf2">CorrectedMaxN_Store</a>()-<a class="code" href="classcrop.html#a2ada3fe40027a182b0861c7ae2fd4a8f">CorrectedMinN_Store</a>()))*<a class="code" href="classcrop.html#a4a2803c0618d2f662abfa8d230c811df">DryMatterStorage</a>;
<a name="l00867"></a>00867    <span class="keywordtype">double</span> N15Ratio = <a class="code" href="classcrop.html#adabbdde8753e5ae0ecd238e221429d88" title="How much Nitrogen that is in the plant.">Nitrogen</a>.<a class="code" href="classnitrogen.html#ac97f3ebad4801a13a7c444bab3b3a886">Get15NRatio</a>();
<a name="l00868"></a>00868    <a class="code" href="classnitrogen.html">nitrogen</a> retVal;
<a name="l00869"></a>00869    retVal.<a class="code" href="classnitrogen.html#a49bebcba4c40f3c0a6abb24f590b2c8c">SetBoth</a>(NContent,N15Ratio*NContent);
<a name="l00870"></a>00870    <span class="keywordflow">return</span> retVal;
<a name="l00871"></a>00871 }
<a name="l00872"></a>00872 
<a name="l00873"></a>00873 <span class="comment">/****************************************************************************\</span>
<a name="l00874"></a>00874 <span class="comment">\****************************************************************************/</span>
<a name="l00875"></a><a class="code" href="classcrop.html#aa0e3e053a447eb7b6389099e9e93e672">00875</a> <span class="keywordtype">double</span> <a class="code" href="classcrop.html#aa0e3e053a447eb7b6389099e9e93e672">crop::InterceptionCapacity</a>()
<a name="l00876"></a>00876 {
<a name="l00877"></a>00877         <span class="keywordflow">return</span> <a class="code" href="classcrop.html#a068c7be7b71c0b4581ec57ffd204766b">InterceptCoeff</a>*(<a class="code" href="classcrop.html#a2691a60a48a5166469df5da0e0e824fb">GreenCropAreaIndex</a>+<a class="code" href="classcrop.html#a7acb3fa412808c819f4d9b662cc2148c">YellowCropAreaIndex</a>);
<a name="l00878"></a>00878 }
<a name="l00879"></a>00879 
<a name="l00880"></a>00880 <span class="comment">/****************************************************************************\</span>
<a name="l00881"></a>00881 <span class="comment">\****************************************************************************/</span>
<a name="l00882"></a><a class="code" href="classcrop.html#a9ff0b086b54afd4c235cb80a9a080d05">00882</a> <span class="keywordtype">double</span> <a class="code" href="classcrop.html#a9ff0b086b54afd4c235cb80a9a080d05">crop::fTW</a>()
<a name="l00883"></a>00883 {
<a name="l00884"></a>00884         <span class="keywordflow">return</span> <a class="code" href="classcrop.html#a9ff0b086b54afd4c235cb80a9a080d05">fTW</a>(<a class="code" href="classcrop.html#abfc8df1469f20d8084f744da461d1df5">temp</a>);
<a name="l00885"></a>00885 }
<a name="l00886"></a>00886 
<a name="l00887"></a>00887 <span class="comment">/****************************************************************************\</span>
<a name="l00888"></a>00888 <span class="comment">\****************************************************************************/</span>
<a name="l00889"></a><a class="code" href="classcrop.html#a4697bfc911fdbf7ffb8c8bc5af5eaaeb">00889</a> <span class="keywordtype">double</span> <a class="code" href="classcrop.html#a9ff0b086b54afd4c235cb80a9a080d05">crop::fTW</a>(<span class="keywordtype">double</span> temperature)
<a name="l00890"></a>00890 {
<a name="l00891"></a>00891    <span class="keywordflow">if</span> (temperature&lt;=<a class="code" href="classcrop.html#aea1414f901f3fc6d6ad5e8d2936ea409">MinDMtemp</a>)
<a name="l00892"></a>00892                 <span class="keywordflow">return</span> 0.0;
<a name="l00893"></a>00893    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (temperature&gt;=<a class="code" href="classcrop.html#a6c3d05934ce21df6acb4161c3baab56e">MaxDMtemp</a>)
<a name="l00894"></a>00894                 <span class="keywordflow">return</span> 1.0;
<a name="l00895"></a>00895    <span class="keywordflow">else</span>
<a name="l00896"></a>00896                 <span class="keywordflow">return</span> (temperature-<a class="code" href="classcrop.html#aea1414f901f3fc6d6ad5e8d2936ea409">MinDMtemp</a>)/(<a class="code" href="classcrop.html#a6c3d05934ce21df6acb4161c3baab56e">MaxDMtemp</a>-<a class="code" href="classcrop.html#aea1414f901f3fc6d6ad5e8d2936ea409">MinDMtemp</a>);
<a name="l00897"></a>00897 }
<a name="l00898"></a>00898 
<a name="l00902"></a><a class="code" href="classcrop.html#a602622ac2c0de6432e6b9438dbbb646b">00902</a> <span class="keywordtype">double</span> <a class="code" href="classcrop.html#a602622ac2c0de6432e6b9438dbbb646b">crop::fNitrogen</a>()
<a name="l00903"></a>00903 {
<a name="l00904"></a>00904         <span class="keywordtype">double</span> N= <a class="code" href="classcrop.html#adabbdde8753e5ae0ecd238e221429d88" title="How much Nitrogen that is in the plant.">Nitrogen</a>.<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a>;
<a name="l00905"></a>00905         <span class="keywordtype">double</span> retVal=1.0;
<a name="l00906"></a>00906    <span class="keywordflow">if</span> (!<a class="code" href="classcrop.html#a38f05d3f77cfc67ff755eb8c0d79e301">Phenology</a>-&gt;<a class="code" href="classphenology.html#a906583e45eeda4d8a6e1cec487a272cc" title="return true if planed is ready to be ripped">Ripe</a>())
<a name="l00907"></a>00907    {
<a name="l00908"></a>00908         <span class="keywordflow">if</span> (N&gt;0.0 &amp;&amp; <a class="code" href="classcrop.html#a6416f0baf1364f2cf28f312584c39f73">Nmax</a>()&gt;<a class="code" href="classcrop.html#adc9f2a384dfd4be26746b822c4324f37">Nmin</a>())
<a name="l00909"></a>00909         retVal = max(0.0,min(1.0,(N-<a class="code" href="classcrop.html#adc9f2a384dfd4be26746b822c4324f37">Nmin</a>())/(<a class="code" href="classcrop.html#a6416f0baf1364f2cf28f312584c39f73">Nmax</a>()-<a class="code" href="classcrop.html#adc9f2a384dfd4be26746b822c4324f37">Nmin</a>())));
<a name="l00910"></a>00910 
<a name="l00911"></a>00911    <a class="code" href="classcrop.html#ac8a4c50c9066688c48f1d8fc6df8561c">fNitrogenAfterRipe</a> = retVal;
<a name="l00912"></a>00912    }
<a name="l00913"></a>00913    <span class="keywordflow">else</span>
<a name="l00914"></a>00914         retVal = <a class="code" href="classcrop.html#ac8a4c50c9066688c48f1d8fc6df8561c">fNitrogenAfterRipe</a>;
<a name="l00915"></a>00915    <span class="keywordflow">return</span> retVal;
<a name="l00916"></a>00916 }
<a name="l00917"></a>00917 
<a name="l00918"></a>00918 <span class="comment">/****************************************************************************\</span>
<a name="l00919"></a>00919 <span class="comment">\****************************************************************************/</span>
<a name="l00920"></a><a class="code" href="classcrop.html#a3bcfac5c51663141e42b2d6bd17a2cb6">00920</a> <span class="keywordtype">double</span> <a class="code" href="classcrop.html#a3bcfac5c51663141e42b2d6bd17a2cb6">crop::fNitrogenCurve</a>()
<a name="l00921"></a>00921 {
<a name="l00922"></a>00922         <span class="keywordtype">double</span> fN =<a class="code" href="classcrop.html#a602622ac2c0de6432e6b9438dbbb646b">fNitrogen</a>();
<a name="l00923"></a>00923    <span class="keywordtype">double</span> ScaleFactor = 1.05;  <span class="comment">//according to Olesen et al., 2002 MEL 2009</span>
<a name="l00924"></a>00924         <span class="keywordtype">double</span> Nstress = ScaleFactor*(1.0-exp(<a class="code" href="classcrop.html#ad789899ed1b1f807e992d207dceaa192">NCurveParam</a>*fN));
<a name="l00925"></a>00925    <span class="keywordflow">return</span> max(0.0,min(1.0,Nstress));
<a name="l00926"></a>00926 }
<a name="l00927"></a>00927 
<a name="l00928"></a>00928 <span class="comment">/****************************************************************************\</span>
<a name="l00929"></a>00929 <span class="comment">\****************************************************************************/</span>
<a name="l00930"></a><a class="code" href="classcrop.html#a0d276aec35091a517cc117546cf8c9f9">00930</a> <a class="code" href="classnitrogen.html">nitrogen</a> <a class="code" href="classcrop.html#a0d276aec35091a517cc117546cf8c9f9">crop::GiveTotalNitrogen</a>()
<a name="l00931"></a>00931 {
<a name="l00932"></a>00932         <span class="keywordflow">return</span> <a class="code" href="classcrop.html#adabbdde8753e5ae0ecd238e221429d88" title="How much Nitrogen that is in the plant.">Nitrogen</a>;
<a name="l00933"></a>00933 }
<a name="l00934"></a>00934 
<a name="l00935"></a>00935 <span class="comment">/****************************************************************************\</span>
<a name="l00936"></a>00936 <span class="comment">\****************************************************************************/</span>
<a name="l00937"></a><a class="code" href="classcrop.html#aa94e2f14b2e8e72c893ab67ad1123e14">00937</a> <span class="keywordtype">double</span> <a class="code" href="classcrop.html#aa94e2f14b2e8e72c893ab67ad1123e14">crop::GiveLeafAreaIndex</a>()
<a name="l00938"></a>00938 {
<a name="l00939"></a>00939         <span class="keywordflow">return</span> <a class="code" href="classcrop.html#a2691a60a48a5166469df5da0e0e824fb">GreenCropAreaIndex</a>;
<a name="l00940"></a>00940 }
<a name="l00941"></a>00941 
<a name="l00942"></a>00942 <span class="comment">/****************************************************************************\</span>
<a name="l00943"></a>00943 <span class="comment">\****************************************************************************/</span>
<a name="l00944"></a><a class="code" href="classcrop.html#a86c3888357b5ca286bfaede7fa64c1e4">00944</a> <span class="keywordtype">double</span> <a class="code" href="classcrop.html#a86c3888357b5ca286bfaede7fa64c1e4">crop::GiveYellowLeafAreaIndex</a>()
<a name="l00945"></a>00945 {
<a name="l00946"></a>00946         <span class="keywordflow">return</span> <a class="code" href="classcrop.html#a7acb3fa412808c819f4d9b662cc2148c">YellowCropAreaIndex</a>;
<a name="l00947"></a>00947 }
<a name="l00948"></a>00948 
<a name="l00949"></a>00949 <span class="comment">/****************************************************************************\</span>
<a name="l00950"></a>00950 <span class="comment">\****************************************************************************/</span>
<a name="l00951"></a><a class="code" href="classcrop.html#ab8db7f88fbd260a4e8b7dbb735490753">00951</a> <span class="keywordtype">double</span> <a class="code" href="classcrop.html#ab8db7f88fbd260a4e8b7dbb735490753">crop::GiveDryMatterStorage</a>()
<a name="l00952"></a>00952 {
<a name="l00953"></a>00953         <span class="keywordflow">return</span> <a class="code" href="classcrop.html#a4a2803c0618d2f662abfa8d230c811df">DryMatterStorage</a>;
<a name="l00954"></a>00954 }
<a name="l00955"></a>00955 
<a name="l00956"></a>00956 <span class="comment">/****************************************************************************\</span>
<a name="l00957"></a>00957 <span class="comment">\****************************************************************************/</span>
<a name="l00958"></a><a class="code" href="classcrop.html#a8442897ed98c68b6821a17ce3adc38e8">00958</a> <span class="keywordtype">double</span> <a class="code" href="classcrop.html#a8442897ed98c68b6821a17ce3adc38e8">crop::GiveDryMatterVegTop</a>()
<a name="l00959"></a>00959 {
<a name="l00960"></a>00960         <span class="keywordflow">return</span> <a class="code" href="classcrop.html#a755b12e801a538bb34a8c7b829047e76">DryMatterVegTop</a>;
<a name="l00961"></a>00961 }
<a name="l00962"></a>00962 
<a name="l00963"></a>00963 <span class="comment">/****************************************************************************\</span>
<a name="l00964"></a>00964 <span class="comment">\****************************************************************************/</span>
<a name="l00965"></a><a class="code" href="classcrop.html#aceebd864d8c9058698b7f93ae413c45d">00965</a> <span class="keywordtype">double</span> <a class="code" href="classcrop.html#aceebd864d8c9058698b7f93ae413c45d">crop::GiveDryMatterRoot</a>()
<a name="l00966"></a>00966 {
<a name="l00967"></a>00967         <span class="keywordflow">return</span> <a class="code" href="classcrop.html#a3c5f4942cf46d45168caf4da80b79537">DryMatterRoot</a>;
<a name="l00968"></a>00968 }
<a name="l00969"></a><a class="code" href="classcrop.html#ad51058813f249a5090fb77442eeca2bf">00969</a> <span class="keywordtype">double</span> <a class="code" href="classcrop.html#ad51058813f249a5090fb77442eeca2bf">crop::GiveRootDepth</a>()
<a name="l00970"></a>00970 {
<a name="l00971"></a>00971         <span class="keywordflow">return</span> <a class="code" href="classcrop.html#aefe9049cee98b6ac81f4362c4a1190a9">RootDepth</a>;
<a name="l00972"></a>00972 }
<a name="l00976"></a><a class="code" href="classcrop.html#a45017219012e2e4865e53c406ca32756">00976</a> <span class="keywordtype">double</span> <a class="code" href="classcrop.html#a45017219012e2e4865e53c406ca32756">crop::GiveRootInInterval</a>(<span class="keywordtype">double</span> startDep, <span class="keywordtype">double</span> thick, <span class="keywordtype">double</span> input)
<a name="l00977"></a>00977 {
<a name="l00978"></a>00978         <span class="keywordtype">double</span> TopOfLayer=0.0;
<a name="l00979"></a>00979    <span class="keywordtype">double</span> BottomOfLayer=0.0;
<a name="l00980"></a>00980    <span class="keywordtype">double</span> Sum=0.0;
<a name="l00981"></a>00981         <span class="keywordtype">double</span> Total=0.0;
<a name="l00982"></a>00982         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;<a class="code" href="typer_8h.html#a61dadd085c1777f559549e05962b2c9ea489863aec95253fced254923e4cb8148">MaxSoilLayers</a>;i++)
<a name="l00983"></a>00983       Total+=<a class="code" href="classcrop.html#ad629acdfd462323490f91ad3ce9a7b59">RootLengthList</a>[i];
<a name="l00984"></a>00984    <span class="keywordflow">if</span> (Total==0.0)
<a name="l00985"></a>00985       <span class="keywordflow">return</span> 0.0;
<a name="l00986"></a>00986    <span class="keywordflow">else</span>
<a name="l00987"></a>00987                 <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;<a class="code" href="typer_8h.html#a61dadd085c1777f559549e05962b2c9ea489863aec95253fced254923e4cb8148">MaxSoilLayers</a>;i++)
<a name="l00988"></a>00988         {
<a name="l00989"></a>00989         TopOfLayer=BottomOfLayer;
<a name="l00990"></a>00990         BottomOfLayer=TopOfLayer+0.05;
<a name="l00991"></a>00991         <span class="keywordflow">if</span> (<a class="code" href="compare_8cpp.html#a25f3a514ece50d360338a392f70f8609">doubleGreater</a>(TopOfLayer, startDep,0.0001,<span class="keyword">true</span>) &amp;&amp; <a class="code" href="compare_8cpp.html#aa01f0fa6e5951da14ee8774259233c39">doubleLess</a>(BottomOfLayer,(startDep+thick), 0.0001, <span class="keyword">true</span>)) <span class="comment">// Simple case</span>
<a name="l00992"></a>00992         {
<a name="l00993"></a>00993                 Sum+=<a class="code" href="classcrop.html#ad629acdfd462323490f91ad3ce9a7b59">RootLengthList</a>[i];
<a name="l00994"></a>00994         }
<a name="l00995"></a>00995         <span class="keywordflow">else</span>
<a name="l00996"></a>00996         {
<a name="l00997"></a>00997                 <span class="keywordflow">if</span> (<a class="code" href="compare_8cpp.html#aa01f0fa6e5951da14ee8774259233c39">doubleLess</a>(TopOfLayer, startDep,0.0001,<span class="keyword">false</span>)  &amp;&amp;   <a class="code" href="compare_8cpp.html#a25f3a514ece50d360338a392f70f8609">doubleGreater</a>(BottomOfLayer,(startDep+thick), 0.0001, <span class="keyword">true</span>)) <span class="comment">// Only bottom of layer no i is in interval</span>
<a name="l00998"></a>00998                 {
<a name="l00999"></a>00999                 <span class="keywordtype">double</span> <a class="code" href="typer_8h.html#ae4c405e5c68c6ec2c44bb6d6adfc2f6cab10366ecc76133a0a4a4712a5ee26f65">fraction</a>=(BottomOfLayer-startDep)/0.05;
<a name="l01000"></a>01000                 Sum+=fraction*<a class="code" href="classcrop.html#ad629acdfd462323490f91ad3ce9a7b59">RootLengthList</a>[i];
<a name="l01001"></a>01001                 }
<a name="l01002"></a>01002                 <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="compare_8cpp.html#aa01f0fa6e5951da14ee8774259233c39">doubleLess</a>(TopOfLayer, startDep,0.0001,<span class="keyword">true</span>)  &amp;&amp; <a class="code" href="compare_8cpp.html#a25f3a514ece50d360338a392f70f8609">doubleGreater</a>(BottomOfLayer,(startDep+thick), 0.0001, <span class="keyword">false</span>)) <span class="comment">// Only top of layer no i is in interval</span>
<a name="l01003"></a>01003             {
<a name="l01004"></a>01004                 <span class="keywordtype">double</span> <a class="code" href="typer_8h.html#ae4c405e5c68c6ec2c44bb6d6adfc2f6cab10366ecc76133a0a4a4712a5ee26f65">fraction</a>=(startDep+thick-TopOfLayer)/0.05;
<a name="l01005"></a>01005                 Sum+=fraction*<a class="code" href="classcrop.html#ad629acdfd462323490f91ad3ce9a7b59">RootLengthList</a>[i];
<a name="l01006"></a>01006             }
<a name="l01007"></a>01007         }
<a name="l01008"></a>01008         }
<a name="l01009"></a>01009                 <span class="keywordflow">return</span> Sum*input/Total;
<a name="l01010"></a>01010 }
<a name="l01011"></a>01011 
<a name="l01012"></a>01012 
<a name="l01013"></a>01013 <span class="comment">/****************************************************************************\</span>
<a name="l01014"></a>01014 <span class="comment">\****************************************************************************/</span>
<a name="l01015"></a><a class="code" href="classcrop.html#a06cb6f783d002e20c7e19938b30dca54">01015</a> <span class="keywordtype">double</span> <a class="code" href="classcrop.html#a06cb6f783d002e20c7e19938b30dca54">crop::RootPenetrationReduction</a>()
<a name="l01016"></a>01016 {
<a name="l01017"></a>01017         <span class="keywordtype">double</span> clay = <a class="code" href="classcrop.html#aaf7bdd66e714b1ad4057bad5a46e6772">aSoil</a>-&gt;<a class="code" href="classsoil.html#a07a04782ac233c63f2f2246f89fb15c6">GetSoilProfile</a>()-&gt;<a class="code" href="classsoil_profile.html#a27959c28ab4031f581b0e17142a45b7f">GetClayContent</a>(250,500);
<a name="l01018"></a>01018    <span class="keywordtype">double</span> f = min(1.0,max(0.5,0.5+(clay-0.02)*0.5/(0.08-0.02)));
<a name="l01019"></a>01019    <span class="keywordflow">return</span> f;
<a name="l01020"></a>01020 }
<a name="l01021"></a>01021 
<a name="l01022"></a>01022 <span class="comment">/****************************************************************************\</span>
<a name="l01023"></a>01023 <span class="comment">\****************************************************************************/</span>
<a name="l01024"></a><a class="code" href="classcrop.html#a022c14d2c183c8d21c622c225bb763d8">01024</a> <span class="keywordtype">void</span> <a class="code" href="classcrop.html#a022c14d2c183c8d21c622c225bb763d8">crop::CalcRootGrowth</a>()
<a name="l01025"></a>01025 {
<a name="l01026"></a>01026         <span class="keywordflow">if</span> (<a class="code" href="classcrop.html#a38f05d3f77cfc67ff755eb8c0d79e301">Phenology</a>-&gt;<a class="code" href="classphenology.html#aa4986dd79d0fc195c3f1c21833171906" title="return true if the crop is sown">Sown</a>())
<a name="l01027"></a>01027    {
<a name="l01028"></a>01028                 <span class="keywordflow">if</span> (<a class="code" href="classcrop.html#abfc8df1469f20d8084f744da461d1df5">temp</a>&gt;<a class="code" href="classcrop.html#aab8805ada2711ddb5996d9e87376eb21">TempRootMin</a>) <span class="comment">// &amp;&amp; GreenCropAreaIndex&gt;0.2)</span>
<a name="l01029"></a>01029                         <a class="code" href="classcrop.html#aefe9049cee98b6ac81f4362c4a1190a9">RootDepth</a> += <a class="code" href="classcrop.html#ac3e7efec04f1437634c82c1c3d045924">RootPentrRate</a>*<a class="code" href="classcrop.html#a06cb6f783d002e20c7e19938b30dca54">RootPenetrationReduction</a>()*(<a class="code" href="classcrop.html#abfc8df1469f20d8084f744da461d1df5">temp</a>-<a class="code" href="classcrop.html#aab8805ada2711ddb5996d9e87376eb21">TempRootMin</a>);
<a name="l01030"></a>01030                 <span class="keywordflow">if</span> (<a class="code" href="classcrop.html#aefe9049cee98b6ac81f4362c4a1190a9">RootDepth</a>&gt;<a class="code" href="classcrop.html#a10ecc3d91cd9e62af94a5b889587d3f4">MaxRootDepth</a>)
<a name="l01031"></a>01031                         <a class="code" href="classcrop.html#aefe9049cee98b6ac81f4362c4a1190a9">RootDepth</a> = <a class="code" href="classcrop.html#a10ecc3d91cd9e62af94a5b889587d3f4">MaxRootDepth</a>;
<a name="l01032"></a>01032                 <a class="code" href="classcrop.html#a1f0aa4443cf11cdf5776454bd056fa28">TotalRootLength</a> = <a class="code" href="classcrop.html#a3c5f4942cf46d45168caf4da80b79537">DryMatterRoot</a>*<a class="code" href="classcrop.html#a56cef92be3d0cb8376b13f1666c469e2">SpecificRootLength</a>;
<a name="l01033"></a>01033                 <a class="code" href="classcrop.html#a512f2450d70fb9f2a84d046d5a090a94">RootDensAtSurf</a> = <a class="code" href="classcrop.html#a50355c2424f5c5f1a7bfc1b8f91c500f">CalcRootDensAtSurf</a>(<a class="code" href="classcrop.html#a5c8bcec383225ccfa1997ed7de4b2446">RootDistrParm</a>,<a class="code" href="classcrop.html#aefe9049cee98b6ac81f4362c4a1190a9">RootDepth</a>,<a class="code" href="classcrop.html#a3bd248dac15a2aefd7289240ffeeb879">RootDensAtBottom</a>);
<a name="l01034"></a>01034       <a class="code" href="classcrop.html#a3bd248dac15a2aefd7289240ffeeb879">RootDensAtBottom</a> = <a class="code" href="classcrop.html#a512f2450d70fb9f2a84d046d5a090a94">RootDensAtSurf</a>*exp(-<a class="code" href="classcrop.html#a5c8bcec383225ccfa1997ed7de4b2446">RootDistrParm</a>*<a class="code" href="classcrop.html#aefe9049cee98b6ac81f4362c4a1190a9">RootDepth</a>);
<a name="l01035"></a>01035       <a class="code" href="classcrop.html#a84819af6b3132d798a56acd9c78dfbe1">CalcRootDistribution</a>();
<a name="l01036"></a>01036         }
<a name="l01037"></a>01037 }
<a name="l01038"></a>01038 
<a name="l01039"></a>01039 <span class="comment">/****************************************************************************\</span>
<a name="l01040"></a>01040 <span class="comment">\****************************************************************************/</span>
<a name="l01041"></a><a class="code" href="classcrop.html#abfdb2b5e795f4843b14de933386afac9">01041</a> <span class="keywordtype">double</span> <a class="code" href="classcrop.html#abfdb2b5e795f4843b14de933386afac9">crop::TargetFunction</a>(<span class="keywordtype">double</span> RootDistrParm,<span class="keywordtype">double</span> RootDepth,<span class="keywordtype">double</span> TotalRootLength,<span class="keywordtype">double</span> RootDensAtBottom)
<a name="l01042"></a>01042 {
<a name="l01043"></a>01043         <span class="keywordflow">if</span> (RootDistrParm&gt;(1E-19))
<a name="l01044"></a>01044                 <span class="keywordflow">return</span> ((TotalRootLength*RootDistrParm)/(1-exp(-RootDistrParm*RootDepth)))-(RootDensAtBottom/exp(-RootDistrParm*RootDepth));
<a name="l01045"></a>01045         <span class="keywordflow">else</span>
<a name="l01046"></a>01046                 <span class="keywordflow">return</span> 1E+30;
<a name="l01047"></a>01047 }
<a name="l01048"></a>01048 
<a name="l01052"></a><a class="code" href="classcrop.html#a47f0d5b8da50f8daae81b4897d11cda5">01052</a> <span class="keywordtype">int</span> <a class="code" href="classcrop.html#a47f0d5b8da50f8daae81b4897d11cda5">crop::RootDistrIsLinear</a>()
<a name="l01053"></a>01053 {
<a name="l01054"></a>01054         <span class="keywordflow">return</span> 0;
<a name="l01055"></a>01055 
<a name="l01056"></a>01056 }
<a name="l01057"></a>01057 
<a name="l01058"></a>01058 <span class="comment">/****************************************************************************\</span>
<a name="l01059"></a>01059 <span class="comment">\****************************************************************************/</span>
<a name="l01060"></a><a class="code" href="classcrop.html#a50355c2424f5c5f1a7bfc1b8f91c500f">01060</a> <span class="keywordtype">double</span> <a class="code" href="classcrop.html#a50355c2424f5c5f1a7bfc1b8f91c500f">crop::CalcRootDensAtSurf</a>(<span class="keywordtype">long</span> <span class="keywordtype">double</span> RootDistrParm,<span class="keywordtype">double</span> RootDepth,<span class="keywordtype">double</span> RootDensAtBottom)
<a name="l01061"></a>01061 {
<a name="l01062"></a>01062         <span class="keywordtype">double</span> a = (1-exp(-RootDistrParm*RootDepth))/RootDistrParm+0.5*0.3*RootDepth*exp(-RootDistrParm*RootDepth);
<a name="l01063"></a>01063    <span class="keywordflow">if</span> (a==0) <span class="keywordflow">return</span> <a class="code" href="classcrop.html#a3bd248dac15a2aefd7289240ffeeb879">RootDensAtBottom</a>;
<a name="l01064"></a>01064    <span class="keywordtype">double</span> RootDensSurf = <a class="code" href="classcrop.html#a1f0aa4443cf11cdf5776454bd056fa28">TotalRootLength</a>/a;
<a name="l01065"></a>01065    <span class="keywordflow">return</span> RootDensSurf;
<a name="l01066"></a>01066 <span class="comment">/* Old root growth code -----------------------------------------</span>
<a name="l01067"></a>01067 <span class="comment">        if (RootDepth&gt;0.0)</span>
<a name="l01068"></a>01068 <span class="comment">   {</span>
<a name="l01069"></a>01069 <span class="comment">                if (RootDistrIsLinear())</span>
<a name="l01070"></a>01070 <span class="comment">      {</span>
<a name="l01071"></a>01071 <span class="comment">         if ((TotalRootLength/RootDepth)&lt;=RootDensAtBottom)</span>
<a name="l01072"></a>01072 <span class="comment">            return TotalRootLength/RootDepth;                              // =&gt; same density at bottom and surface</span>
<a name="l01073"></a>01073 <span class="comment">                        else</span>
<a name="l01074"></a>01074 <span class="comment">            return RootDensAtBottom+2.0*(TotalRootLength-RootDepth*RootDensAtBottom)/RootDepth; // BMP corrected this 05.11.1999</span>
<a name="l01075"></a>01075 <span class="comment">      }</span>
<a name="l01076"></a>01076 <span class="comment">                else</span>
<a name="l01077"></a>01077 <span class="comment">                        return RootDensAtBottom/exp(-RootDistrParm*RootDepth);</span>
<a name="l01078"></a>01078 <span class="comment">        }</span>
<a name="l01079"></a>01079 <span class="comment">        else</span>
<a name="l01080"></a>01080 <span class="comment">                return 0.0;</span>
<a name="l01081"></a>01081 <span class="comment">---------------------------------------------------------------*/</span>
<a name="l01082"></a>01082 }
<a name="l01083"></a>01083 
<a name="l01087"></a><a class="code" href="classcrop.html#a72e68283aa65578e991092da749c6f44">01087</a> <span class="keywordtype">double</span> <a class="code" href="classcrop.html#a72e68283aa65578e991092da749c6f44">crop::RootLengthInInterval</a>(<span class="keywordtype">double</span> startdepth,<span class="keywordtype">double</span> thickness)
<a name="l01088"></a>01088 {
<a name="l01089"></a>01089         <span class="keywordflow">if</span> (<a class="code" href="classcrop.html#a38f05d3f77cfc67ff755eb8c0d79e301">Phenology</a>-&gt;<a class="code" href="classphenology.html#aa4986dd79d0fc195c3f1c21833171906" title="return true if the crop is sown">Sown</a>() &amp;&amp; <a class="code" href="classcrop.html#aefe9049cee98b6ac81f4362c4a1190a9">RootDepth</a>&gt;0)
<a name="l01090"></a>01090    {
<a name="l01091"></a>01091       <span class="keywordflow">if</span> (<a class="code" href="classcrop.html#a47f0d5b8da50f8daae81b4897d11cda5">RootDistrIsLinear</a>())
<a name="l01092"></a>01092       {
<a name="l01093"></a>01093                         <span class="keywordflow">if</span> ((<a class="code" href="classcrop.html#a1f0aa4443cf11cdf5776454bd056fa28">TotalRootLength</a>/<a class="code" href="classcrop.html#aefe9049cee98b6ac81f4362c4a1190a9">RootDepth</a>)&lt;=<a class="code" href="classcrop.html#a3bd248dac15a2aefd7289240ffeeb879">RootDensAtBottom</a>)
<a name="l01094"></a>01094                                 <span class="keywordflow">return</span> <a class="code" href="classcrop.html#a1f0aa4443cf11cdf5776454bd056fa28">TotalRootLength</a>*thickness/<a class="code" href="classcrop.html#aefe9049cee98b6ac81f4362c4a1190a9">RootDepth</a>;
<a name="l01095"></a>01095                         <span class="keywordflow">else</span>
<a name="l01096"></a>01096          {
<a name="l01097"></a>01097             <span class="keywordtype">double</span> depth=startdepth+(thickness/2.0);
<a name="l01098"></a>01098                                 <span class="keywordflow">return</span> thickness*(<a class="code" href="classcrop.html#a512f2450d70fb9f2a84d046d5a090a94">RootDensAtSurf</a>-(<a class="code" href="classcrop.html#a512f2450d70fb9f2a84d046d5a090a94">RootDensAtSurf</a>-<a class="code" href="classcrop.html#a3bd248dac15a2aefd7289240ffeeb879">RootDensAtBottom</a>)*depth/<a class="code" href="classcrop.html#aefe9049cee98b6ac81f4362c4a1190a9">RootDepth</a>); <span class="comment">// BMP corrected this 05.11.1999</span>
<a name="l01099"></a>01099          }
<a name="l01100"></a>01100       }
<a name="l01101"></a>01101 
<a name="l01102"></a>01102       <span class="comment">// Length in exponential curve</span>
<a name="l01103"></a>01103       <span class="keywordtype">double</span> ExtraRootDepth = 0.3;
<a name="l01104"></a>01104 
<a name="l01105"></a>01105       <span class="keywordtype">double</span> EndDepth1 = min(<a class="code" href="classcrop.html#aefe9049cee98b6ac81f4362c4a1190a9">RootDepth</a>,startdepth+thickness);
<a name="l01106"></a>01106       <span class="keywordtype">double</span> EndDepth2 = min((1.0+ExtraRootDepth)*<a class="code" href="classcrop.html#aefe9049cee98b6ac81f4362c4a1190a9">RootDepth</a>,startdepth+thickness);
<a name="l01107"></a>01107       <span class="keywordtype">double</span> StartDepth2 = max(startdepth,RootDepth);
<a name="l01108"></a>01108       <span class="keywordtype">double</span> Length1 = 0.0;
<a name="l01109"></a>01109       <span class="keywordtype">double</span> Length2 = 0.0;
<a name="l01110"></a>01110 
<a name="l01111"></a>01111                 <span class="keywordflow">if</span> (startdepth&lt;RootDepth)
<a name="l01112"></a>01112                         Length1 = <a class="code" href="classcrop.html#a512f2450d70fb9f2a84d046d5a090a94">RootDensAtSurf</a>*(exp(-<a class="code" href="classcrop.html#a5c8bcec383225ccfa1997ed7de4b2446">RootDistrParm</a>*startdepth)-exp(-<a class="code" href="classcrop.html#a5c8bcec383225ccfa1997ed7de4b2446">RootDistrParm</a>*EndDepth1))/<a class="code" href="classcrop.html#a5c8bcec383225ccfa1997ed7de4b2446">RootDistrParm</a>+
<a name="l01113"></a>01113                                      (EndDepth1-startdepth)*<a class="code" href="classcrop.html#a94dedacaf228ed611dd4a9c43fcf1140">MinimumRootDens</a>;
<a name="l01114"></a>01114 
<a name="l01115"></a>01115       <span class="comment">// Length in linear declining curve</span>
<a name="l01116"></a>01116         <span class="keywordflow">if</span> (startdepth+thickness&gt;RootDepth &amp;&amp; startdepth&lt;(1.0+ExtraRootDepth)*<a class="code" href="classcrop.html#aefe9049cee98b6ac81f4362c4a1190a9">RootDepth</a>)
<a name="l01117"></a>01117                 {
<a name="l01118"></a>01118          <span class="keywordtype">double</span> DensAtBottom = <a class="code" href="classcrop.html#a512f2450d70fb9f2a84d046d5a090a94">RootDensAtSurf</a>*(exp(-<a class="code" href="classcrop.html#a5c8bcec383225ccfa1997ed7de4b2446">RootDistrParm</a>*RootDepth));
<a name="l01119"></a>01119               <span class="keywordtype">double</span> Dens1 = DensAtBottom*(1.0-(StartDepth2-<a class="code" href="classcrop.html#aefe9049cee98b6ac81f4362c4a1190a9">RootDepth</a>)/(ExtraRootDepth*RootDepth));        <span class="comment">// Note assumes that root systems extends 30% further than rootdepth</span>
<a name="l01120"></a>01120               <span class="keywordtype">double</span> Dens2 = DensAtBottom*(1.0-(EndDepth2-<a class="code" href="classcrop.html#aefe9049cee98b6ac81f4362c4a1190a9">RootDepth</a>)/(ExtraRootDepth*RootDepth));        <span class="comment">// Note assumes that root systems extends 30% further than rootdepth</span>
<a name="l01121"></a>01121          Length2 = 0.5*(EndDepth2-StartDepth2)*(Dens1+Dens2);
<a name="l01122"></a>01122       }
<a name="l01123"></a>01123       <span class="keywordflow">return</span> Length1+Length2;
<a name="l01124"></a>01124         }
<a name="l01125"></a>01125         <span class="keywordflow">else</span>
<a name="l01126"></a>01126                 <span class="keywordflow">return</span> 0.0;
<a name="l01127"></a>01127 }
<a name="l01128"></a>01128 
<a name="l01134"></a><a class="code" href="classcrop.html#a2dbc56666f949042e5d0c80dbbd66325">01134</a> <span class="keywordtype">double</span> <a class="code" href="classcrop.html#a2dbc56666f949042e5d0c80dbbd66325">crop::DeltaDryMatter</a>()
<a name="l01135"></a>01135 {
<a name="l01136"></a>01136         <span class="keywordtype">double</span> CO2conc = <a class="code" href="climate_8h.html#ad05fb99191dc4a9cb94e7f8c99280389">theClimate</a>-&gt;<a class="code" href="classclimate.html#a14e9a0d27f51b514217508b04f53ca04">GetCO2Concentration</a>();
<a name="l01137"></a>01137          <span class="keywordtype">double</span> CO2PhotEffect = 1.0;
<a name="l01138"></a>01138            <span class="keywordflow">if</span>(!<a class="code" href="classcrop.html#aef5d855a21b1f0227b429764dea1c8fe" title="Describe if the crop is a C4 crop (CO2 effect only on C3 crops)">C4Photosynthesis</a>)
<a name="l01139"></a>01139               CO2PhotEffect = <a class="code" href="classcrop.html#a40992582378c797a8b5a4b8d9aef6d2b">CO2Effect</a>*exp(0.4537-170.97/CO2conc);
<a name="l01140"></a>01140         <a class="code" href="classcrop.html#af42802c05fc1e8dcba94d04bcb41f163">InterceptedRadiation</a> += <a class="code" href="classcrop.html#a089361fdbd7eedb3b84e501ebc4f7221">Rg</a>*<a class="code" href="classcrop.html#a23c5f9e6bead96515b31e977405637d8">PhotoSyntActPart</a>;
<a name="l01141"></a>01141 
<a name="l01142"></a>01142         <span class="keywordtype">double</span> retVal;
<a name="l01143"></a>01143    <span class="keywordtype">double</span> PAR_Reduction = min(1.0,1.0-0.0445*(<a class="code" href="classcrop.html#a089361fdbd7eedb3b84e501ebc4f7221">Rg</a>*PhotoSyntActPart-5.0));
<a name="l01144"></a>01144    retVal=<a class="code" href="classcrop.html#a089361fdbd7eedb3b84e501ebc4f7221">Rg</a>*PhotoSyntActPart*<a class="code" href="classcrop.html#ace1e4d77fd9e80f3cd5c301927e03630">MaxRadUseEff</a>
<a name="l01145"></a>01145           *CO2PhotEffect<span class="comment">// CO2 effect</span>
<a name="l01146"></a>01146           *<a class="code" href="classcrop.html#a461228045f8a07f1f12a06acd12adf89">TranspirationRatio</a>
<a name="l01147"></a>01147                     *<a class="code" href="classcrop.html#a3bcfac5c51663141e42b2d6bd17a2cb6">fNitrogenCurve</a>()
<a name="l01148"></a>01148           *<a class="code" href="classcrop.html#a9ff0b086b54afd4c235cb80a9a080d05">fTW</a>()
<a name="l01149"></a>01149           *PAR_Reduction;
<a name="l01150"></a>01150 
<a name="l01151"></a>01151    <span class="keywordflow">return</span> retVal;
<a name="l01152"></a>01152 }
<a name="l01153"></a>01153 
<a name="l01154"></a>01154 
<a name="l01155"></a>01155 <span class="comment">/****************************************************************************\</span>
<a name="l01156"></a>01156 <span class="comment">\****************************************************************************/</span>
<a name="l01157"></a><a class="code" href="classcrop.html#a210e5515e11a5b705e0d3cd99a12e581">01157</a> <span class="keywordtype">double</span> <a class="code" href="classcrop.html#a210e5515e11a5b705e0d3cd99a12e581">crop::FractionToRoot</a>()
<a name="l01158"></a>01158 {
<a name="l01159"></a>01159         <span class="keywordtype">double</span> ret=<a class="code" href="classcrop.html#a366215bb50374cc375870081f55df157">MinAllocToRoot</a>;
<a name="l01160"></a>01160    <span class="keywordflow">if</span> (!<a class="code" href="classcrop.html#a38f05d3f77cfc67ff755eb8c0d79e301">Phenology</a>-&gt;<a class="code" href="classphenology.html#a514ca53b35d3dfc3e8dc1b4841d221cf" title="return true if crop has emerged">Emerged</a>())   <span class="comment">//MEL 2009 - only cosmetic</span>
<a name="l01161"></a>01161         ret=<a class="code" href="classcrop.html#a8ee0da1040a104bfc08b4618d3574db1">MaxAllocToRoot</a>;
<a name="l01162"></a>01162    <span class="keywordflow">if</span> (<a class="code" href="classcrop.html#a38f05d3f77cfc67ff755eb8c0d79e301">Phenology</a>-&gt;<a class="code" href="classphenology.html#a514ca53b35d3dfc3e8dc1b4841d221cf" title="return true if crop has emerged">Emerged</a>() &amp;&amp; !<a class="code" href="classcrop.html#a38f05d3f77cfc67ff755eb8c0d79e301">Phenology</a>-&gt;<a class="code" href="classphenology.html#a9f571608ca2e2eaf7d1a79715afa8e0c" title="return true if crop has reached anthesis">Anthesis</a>())
<a name="l01163"></a>01163       ret =  <a class="code" href="classcrop.html#a366215bb50374cc375870081f55df157">MinAllocToRoot</a>+(<a class="code" href="classcrop.html#a8ee0da1040a104bfc08b4618d3574db1">MaxAllocToRoot</a>-<a class="code" href="classcrop.html#a366215bb50374cc375870081f55df157">MinAllocToRoot</a>)*<a class="code" href="classcrop.html#a38f05d3f77cfc67ff755eb8c0d79e301">Phenology</a>-&gt;<a class="code" href="classphenology.html#aad2f655d897ddb69dadb719ce046f74f">GetFractionToAnthesis</a>();
<a name="l01164"></a>01164    <span class="keywordflow">if</span> (<a class="code" href="classcrop.html#a38f05d3f77cfc67ff755eb8c0d79e301">Phenology</a>-&gt;<a class="code" href="classphenology.html#a9f571608ca2e2eaf7d1a79715afa8e0c" title="return true if crop has reached anthesis">Anthesis</a>() &amp;&amp; !<a class="code" href="classcrop.html#a38f05d3f77cfc67ff755eb8c0d79e301">Phenology</a>-&gt;<a class="code" href="classphenology.html#aa2966766123b0b7b2d948fd74ecd057b" title="return true if the grains is fully developed">GrainFillEnd</a>())
<a name="l01165"></a>01165       ret =  max(0.0,<a class="code" href="classcrop.html#a366215bb50374cc375870081f55df157">MinAllocToRoot</a>*(<a class="code" href="classcrop.html#a38f05d3f77cfc67ff755eb8c0d79e301">Phenology</a>-&gt;<a class="code" href="classphenology.html#aea2f0be3503256d007d5b1ee391e98e0" title="Developing System scale for start of grainfill (is it a scale??">DS_StartFill</a> - <a class="code" href="classcrop.html#a38f05d3f77cfc67ff755eb8c0d79e301">Phenology</a>-&gt;<a class="code" href="classphenology.html#afdc8ea11c9fcb90491341ed8e70d2927" title="development stage">DS</a>));
<a name="l01166"></a>01166    <span class="keywordflow">return</span> ret;
<a name="l01167"></a>01167 }
<a name="l01168"></a>01168 
<a name="l01169"></a>01169 <span class="comment">/****************************************************************************\</span>
<a name="l01170"></a>01170 <span class="comment">\****************************************************************************/</span>
<a name="l01171"></a><a class="code" href="classcrop.html#aeb0993f2a6d2f21d30a5c24bbd46833e">01171</a> <span class="keywordtype">void</span> <a class="code" href="classcrop.html#aeb0993f2a6d2f21d30a5c24bbd46833e">crop::TransferDryMatterToRoot</a>(<span class="keywordtype">double</span> *dDryMatt)
<a name="l01172"></a>01172 {
<a name="l01173"></a>01173 
<a name="l01174"></a>01174         <span class="keywordtype">double</span> newDeltaRoot= max(0.0,*dDryMatt*<a class="code" href="classcrop.html#a210e5515e11a5b705e0d3cd99a12e581">FractionToRoot</a>());
<a name="l01175"></a>01175         <a class="code" href="classcrop.html#a15b020b5308e854371c7919b1ebe64ab">RootTranslocation</a> += newDeltaRoot;
<a name="l01176"></a>01176         *dDryMatt-=newDeltaRoot;
<a name="l01177"></a>01177         <a class="code" href="classcrop.html#a3c5f4942cf46d45168caf4da80b79537">DryMatterRoot</a>+=newDeltaRoot;
<a name="l01178"></a>01178         <a class="code" href="classcrop.html#ae8be0fd1bc438d926ce68942cb0886a0">RootDecay</a>(newDeltaRoot);
<a name="l01179"></a>01179 
<a name="l01180"></a>01180 }
<a name="l01181"></a>01181 
<a name="l01182"></a>01182 
<a name="l01183"></a>01183 
<a name="l01188"></a><a class="code" href="classcrop.html#aa93103e69836afc4fb23c1a29b15584f">01188</a> <span class="keywordtype">void</span> <a class="code" href="classcrop.html#aa93103e69836afc4fb23c1a29b15584f">crop::TransferDryMatterToStorage</a>(<span class="keywordtype">double</span> * dDryMatt)
<a name="l01189"></a>01189 {
<a name="l01190"></a>01190    <span class="keywordtype">double</span> Store = min(0.9,<a class="code" href="classcrop.html#adf0da70c2a7dc063b5bcb09730e155c6">StoreForFilling</a>);
<a name="l01191"></a>01191    <span class="keywordtype">double</span> Fill = min(0.9,<a class="code" href="classcrop.html#ab94a62632b347617f4f62b317a16ff73">FillFactor</a>);
<a name="l01192"></a>01192         <span class="keywordflow">if</span> (<a class="code" href="classcrop.html#a38f05d3f77cfc67ff755eb8c0d79e301">Phenology</a>-&gt;<a class="code" href="classphenology.html#a9f571608ca2e2eaf7d1a79715afa8e0c" title="return true if crop has reached anthesis">Anthesis</a>() &amp;&amp; <a class="code" href="classcrop.html#ac85050f76b5416047499dcdc854d6f41" title="Describe if a plan can fill.">FillFlag</a>==0)
<a name="l01193"></a>01193    {
<a name="l01194"></a>01194         <span class="keywordflow">if</span> (<a class="code" href="classcrop.html#a0c55583d4613cc09bb912de3078aae49">TransferableStorage</a>&lt;1E-8)
<a name="l01195"></a>01195         <a class="code" href="classcrop.html#a0c55583d4613cc09bb912de3078aae49">TransferableStorage</a> = <a class="code" href="classcrop.html#a755b12e801a538bb34a8c7b829047e76">DryMatterVegTop</a>*Store;
<a name="l01196"></a>01196       <a class="code" href="classcrop.html#a0c55583d4613cc09bb912de3078aae49">TransferableStorage</a> += *dDryMatt*Fill;
<a name="l01197"></a>01197       <a class="code" href="classcrop.html#ab1133e34965bc17531d6bbf675cfa240">TransferedDMToStorage</a> = <a class="code" href="classcrop.html#a0c55583d4613cc09bb912de3078aae49">TransferableStorage</a>;
<a name="l01198"></a>01198    }
<a name="l01199"></a>01199    <span class="comment">// MEL 2009</span>
<a name="l01200"></a>01200    <span class="keywordflow">if</span> (<a class="code" href="classcrop.html#a38f05d3f77cfc67ff755eb8c0d79e301">Phenology</a>-&gt;<a class="code" href="classphenology.html#a8cae850ebecaff9242a27d529ab72e09" title="return true if the grain has started to develop">GrainFillStart</a>())
<a name="l01201"></a>01201    {
<a name="l01202"></a>01202         <a class="code" href="classcrop.html#ac85050f76b5416047499dcdc854d6f41" title="Describe if a plan can fill.">FillFlag</a> = 1;
<a name="l01203"></a>01203       <span class="keywordflow">if</span> (<a class="code" href="classcrop.html#a602622ac2c0de6432e6b9438dbbb646b">fNitrogen</a>() &gt; 0.0)
<a name="l01204"></a>01204       {
<a name="l01205"></a>01205         <span class="keywordtype">double</span> transfer = min(<a class="code" href="classcrop.html#a755b12e801a538bb34a8c7b829047e76">DryMatterVegTop</a>,max(0.0,<a class="code" href="classcrop.html#a0c55583d4613cc09bb912de3078aae49">TransferableStorage</a>*<a class="code" href="classcrop.html#a38f05d3f77cfc67ff755eb8c0d79e301">Phenology</a>-&gt;<a class="code" href="classphenology.html#ae1e41d673ae323dc45240665b167b14e">GetFractionOfGrainFill</a>()));     <span class="comment">// linear fill of DM stored during lag phase</span>
<a name="l01206"></a>01206 
<a name="l01207"></a>01207          <a class="code" href="classcrop.html#a755b12e801a538bb34a8c7b829047e76">DryMatterVegTop</a> -= transfer;
<a name="l01208"></a>01208          <a class="code" href="classcrop.html#a4a2803c0618d2f662abfa8d230c811df">DryMatterStorage</a> += transfer+*dDryMatt*Fill*<a class="code" href="classcrop.html#ab60ba190cccea48dbc2b7112b663545e">ConversionCoefficient</a>;
<a name="l01209"></a>01209         <span class="keywordflow">if</span> (<a class="code" href="classcrop.html#a755b12e801a538bb34a8c7b829047e76">DryMatterVegTop</a> &lt; <a class="code" href="classcrop.html#a0c55583d4613cc09bb912de3078aae49">TransferableStorage</a>)
<a name="l01210"></a>01210                 <a class="code" href="classcrop.html#a0c55583d4613cc09bb912de3078aae49">TransferableStorage</a> = 0.9* <a class="code" href="classcrop.html#a755b12e801a538bb34a8c7b829047e76">DryMatterVegTop</a>;
<a name="l01211"></a>01211 
<a name="l01212"></a>01212                 <span class="keywordtype">double</span> minimumN = <a class="code" href="classcrop.html#adc9f2a384dfd4be26746b822c4324f37">Nmin</a>();
<a name="l01213"></a>01213                 <span class="keywordtype">double</span> maximumN = <a class="code" href="classcrop.html#a6416f0baf1364f2cf28f312584c39f73">Nmax</a>();
<a name="l01214"></a>01214         <span class="keywordflow">if</span> (minimumN &gt; <a class="code" href="classcrop.html#adabbdde8753e5ae0ecd238e221429d88" title="How much Nitrogen that is in the plant.">Nitrogen</a>.<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a> + 0.01)
<a name="l01215"></a>01215          {
<a name="l01216"></a>01216             <span class="keywordtype">double</span> transferBack = max(0.0,min(transfer,(minimumN - <a class="code" href="classcrop.html#adabbdde8753e5ae0ecd238e221429d88" title="How much Nitrogen that is in the plant.">Nitrogen</a>.<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a>)/<a class="code" href="classcrop.html#a2ada3fe40027a182b0861c7ae2fd4a8f">CorrectedMinN_Store</a>()));
<a name="l01217"></a>01217                 <a class="code" href="classcrop.html#a755b12e801a538bb34a8c7b829047e76">DryMatterVegTop</a> += transferBack;
<a name="l01218"></a>01218                 <a class="code" href="classcrop.html#a4a2803c0618d2f662abfa8d230c811df">DryMatterStorage</a> -= transferBack;
<a name="l01219"></a>01219                 transfer = transfer - transferBack;
<a name="l01220"></a>01220          }
<a name="l01221"></a>01221                 <span class="keywordflow">if</span> (maximumN &lt; <a class="code" href="classcrop.html#adabbdde8753e5ae0ecd238e221429d88" title="How much Nitrogen that is in the plant.">Nitrogen</a>.<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a> - 0.01)
<a name="l01222"></a>01222                 {
<a name="l01223"></a>01223             <span class="keywordtype">double</span> transferBack = max(0.0,min(transfer,(<a class="code" href="classcrop.html#adabbdde8753e5ae0ecd238e221429d88" title="How much Nitrogen that is in the plant.">Nitrogen</a>.<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a> - maximumN)/<a class="code" href="classcrop.html#ace0698df7604e46f0330a08494227bf2">CorrectedMaxN_Store</a>()));
<a name="l01224"></a>01224                 <a class="code" href="classcrop.html#a755b12e801a538bb34a8c7b829047e76">DryMatterVegTop</a> += transferBack;
<a name="l01225"></a>01225                 <a class="code" href="classcrop.html#a4a2803c0618d2f662abfa8d230c811df">DryMatterStorage</a> -= transferBack;
<a name="l01226"></a>01226                 transfer = transfer - transferBack;
<a name="l01227"></a>01227                 }
<a name="l01228"></a>01228 
<a name="l01229"></a>01229          <a class="code" href="classcrop.html#a46844fd0540eb7627555f21afa8545e8">DMbudget</a>.<a class="code" href="classbudget.html#a47bfa9740186f2be18a10dd3423a5eea">AddOutput</a>((*dDryMatt*Fill)*(1-ConversionCoefficient));
<a name="l01230"></a>01230          *dDryMatt = *dDryMatt*(1-Fill);
<a name="l01231"></a>01231          <a class="code" href="classcrop.html#ab1133e34965bc17531d6bbf675cfa240">TransferedDMToStorage</a> -= transfer;
<a name="l01232"></a>01232       }
<a name="l01233"></a>01233    }
<a name="l01234"></a>01234    <span class="keywordflow">if</span> (<a class="code" href="classcrop.html#a38f05d3f77cfc67ff755eb8c0d79e301">Phenology</a>-&gt;<a class="code" href="classphenology.html#aa2966766123b0b7b2d948fd74ecd057b" title="return true if the grains is fully developed">GrainFillEnd</a>() &amp;&amp; <a class="code" href="classcrop.html#ab1133e34965bc17531d6bbf675cfa240">TransferedDMToStorage</a>&gt;0)             <span class="comment">// Check to see if all transferable storage is transfered</span>
<a name="l01235"></a>01235    {
<a name="l01236"></a>01236       <span class="keywordtype">double</span> transfer=max(0.0,<a class="code" href="classcrop.html#ab1133e34965bc17531d6bbf675cfa240">TransferedDMToStorage</a>);
<a name="l01237"></a>01237         <a class="code" href="classcrop.html#a4a2803c0618d2f662abfa8d230c811df">DryMatterStorage</a> += transfer;
<a name="l01238"></a>01238       <a class="code" href="classcrop.html#a755b12e801a538bb34a8c7b829047e76">DryMatterVegTop</a> -=  transfer;
<a name="l01239"></a>01239       <span class="keywordtype">double</span> minimumN = <a class="code" href="classcrop.html#adc9f2a384dfd4be26746b822c4324f37">Nmin</a>();
<a name="l01240"></a>01240         <span class="keywordtype">double</span> maximumN = <a class="code" href="classcrop.html#a6416f0baf1364f2cf28f312584c39f73">Nmax</a>();
<a name="l01241"></a>01241       <span class="keywordflow">if</span> (minimumN &gt; <a class="code" href="classcrop.html#adabbdde8753e5ae0ecd238e221429d88" title="How much Nitrogen that is in the plant.">Nitrogen</a>.<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a> + 0.01)
<a name="l01242"></a>01242       {
<a name="l01243"></a>01243          <span class="keywordtype">double</span> transferBack = max(0.0,min(transfer,(minimumN - <a class="code" href="classcrop.html#adabbdde8753e5ae0ecd238e221429d88" title="How much Nitrogen that is in the plant.">Nitrogen</a>.<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a>)/<a class="code" href="classcrop.html#a2ada3fe40027a182b0861c7ae2fd4a8f">CorrectedMinN_Store</a>()));
<a name="l01244"></a>01244         <a class="code" href="classcrop.html#a755b12e801a538bb34a8c7b829047e76">DryMatterVegTop</a> += transferBack;
<a name="l01245"></a>01245                 <a class="code" href="classcrop.html#a4a2803c0618d2f662abfa8d230c811df">DryMatterStorage</a> -= transferBack;
<a name="l01246"></a>01246          transfer = transfer - transferBack;
<a name="l01247"></a>01247       }
<a name="l01248"></a>01248         <span class="keywordflow">if</span> (maximumN &lt; <a class="code" href="classcrop.html#adabbdde8753e5ae0ecd238e221429d88" title="How much Nitrogen that is in the plant.">Nitrogen</a>.<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a> - 0.01)
<a name="l01249"></a>01249         {
<a name="l01250"></a>01250          <span class="keywordtype">double</span> transferBack = max(0.0,min(transfer,(<a class="code" href="classcrop.html#adabbdde8753e5ae0ecd238e221429d88" title="How much Nitrogen that is in the plant.">Nitrogen</a>.<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a> - maximumN)/<a class="code" href="classcrop.html#ace0698df7604e46f0330a08494227bf2">CorrectedMaxN_Store</a>()));
<a name="l01251"></a>01251         <a class="code" href="classcrop.html#a755b12e801a538bb34a8c7b829047e76">DryMatterVegTop</a> += transferBack;
<a name="l01252"></a>01252                 <a class="code" href="classcrop.html#a4a2803c0618d2f662abfa8d230c811df">DryMatterStorage</a> -= transferBack;
<a name="l01253"></a>01253          transfer = transfer - transferBack;
<a name="l01254"></a>01254       }
<a name="l01255"></a>01255       <a class="code" href="classcrop.html#ab1133e34965bc17531d6bbf675cfa240">TransferedDMToStorage</a> = 0.0;
<a name="l01256"></a>01256    }
<a name="l01257"></a>01257 }
<a name="l01258"></a>01258 
<a name="l01259"></a>01259 <span class="comment">/****************************************************************************\</span>
<a name="l01260"></a>01260 <span class="comment">\****************************************************************************/</span>
<a name="l01261"></a><a class="code" href="classcrop.html#a14395e2b72c28aaf9dc729fcd0d3b1c8">01261</a> <span class="keywordtype">void</span> <a class="code" href="classcrop.html#a14395e2b72c28aaf9dc729fcd0d3b1c8">crop::CalcLeafAreaIndices</a>()
<a name="l01262"></a>01262 {
<a name="l01263"></a>01263    <span class="keywordflow">if</span> (<a class="code" href="classcrop.html#a2691a60a48a5166469df5da0e0e824fb">GreenCropAreaIndex</a>&gt;<a class="code" href="classcrop.html#a7cc6a117013deeda470335c166066615">maxGLAI</a>)
<a name="l01264"></a>01264       <a class="code" href="classcrop.html#a7cc6a117013deeda470335c166066615">maxGLAI</a>=<a class="code" href="classcrop.html#a2691a60a48a5166469df5da0e0e824fb">GreenCropAreaIndex</a>;     <span class="comment">//state variable that holds the maximum achieved green LAI</span>
<a name="l01265"></a>01265    <span class="keywordflow">if</span> (<a class="code" href="classcrop.html#a38f05d3f77cfc67ff755eb8c0d79e301">Phenology</a>-&gt;<a class="code" href="classphenology.html#a514ca53b35d3dfc3e8dc1b4841d221cf" title="return true if crop has emerged">Emerged</a>())
<a name="l01266"></a>01266    {
<a name="l01267"></a>01267         <span class="keywordflow">if</span> (<a class="code" href="classcrop.html#a38f05d3f77cfc67ff755eb8c0d79e301">Phenology</a>-&gt;<a class="code" href="classphenology.html#ac59e649ce2b4cede632496fbc6de53e1" title="Temperature sum for leaf expansion (used in linear growth)">TempSumForLeaf</a>&lt;=<a class="code" href="classcrop.html#a38f05d3f77cfc67ff755eb8c0d79e301">Phenology</a>-&gt;<a class="code" href="classphenology.html#a88c5292d2d713236a2403cb0a100655c" title="Growth phase for linear leaf growth (related to TempSumForLeaf!)">LinearLeafPhase</a>)
<a name="l01268"></a>01268  <span class="comment">//             GreenCropAreaIndex =  InitialCAI*RelativeDensity*(Phenology-&gt;TempSumForLeaf/Phenology-&gt;LinearLeafPhase);      /Deleted MEL 2010 due to very large LAI at high sowing rates</span>
<a name="l01269"></a>01269         <a class="code" href="classcrop.html#a2691a60a48a5166469df5da0e0e824fb">GreenCropAreaIndex</a> =  <a class="code" href="classcrop.html#af3aac84af1f2d62509c26dfe15d1756c">InitialCAI</a>*(<a class="code" href="classcrop.html#a38f05d3f77cfc67ff755eb8c0d79e301">Phenology</a>-&gt;<a class="code" href="classphenology.html#ac59e649ce2b4cede632496fbc6de53e1" title="Temperature sum for leaf expansion (used in linear growth)">TempSumForLeaf</a>/<a class="code" href="classcrop.html#a38f05d3f77cfc67ff755eb8c0d79e301">Phenology</a>-&gt;<a class="code" href="classphenology.html#a88c5292d2d713236a2403cb0a100655c" title="Growth phase for linear leaf growth (related to TempSumForLeaf!)">LinearLeafPhase</a>);      <span class="comment">// value from Porter ....</span>
<a name="l01270"></a>01270       <span class="keywordflow">else</span>
<a name="l01271"></a>01271       {
<a name="l01272"></a>01272           <span class="keywordtype">double</span> DS_num = 1.3;
<a name="l01273"></a>01273          <span class="keywordflow">if</span> (<a class="code" href="classcrop.html#af852d2f62dd22411199ae8e164536a7d">CropName</a> == <span class="stringliteral">&quot;WinterWheat&quot;</span>)
<a name="l01274"></a>01274            DS_num =1.0;
<a name="l01275"></a>01275          <span class="keywordflow">if</span> (<a class="code" href="classcrop.html#a38f05d3f77cfc67ff755eb8c0d79e301">Phenology</a>-&gt;<a class="code" href="classphenology.html#afdc8ea11c9fcb90491341ed8e70d2927" title="development stage">DS</a>&lt;DS_num)
<a name="l01276"></a>01276          {
<a name="l01277"></a>01277                                 <span class="keywordtype">double</span> reducedGrowth = <a class="code" href="classcrop.html#a38f05d3f77cfc67ff755eb8c0d79e301">Phenology</a>-&gt;<a class="code" href="classphenology.html#a1745a1f68ead72820ce0b9bb3272e7b1">GetFractionToFlagLigule</a>();                 <span class="comment">// Correct later</span>
<a name="l01278"></a>01278             reducedGrowth = 1.0/(1.0+pow(reducedGrowth,10));
<a name="l01279"></a>01279             <span class="keywordtype">double</span> expLeafExt = <a class="code" href="classcrop.html#a668a3be41e3f465357ee7ad27e261a02">CoeffGreenIdx</a>*<a class="code" href="classcrop.html#a2691a60a48a5166469df5da0e0e824fb">GreenCropAreaIndex</a>*max(0.0,<a class="code" href="classcrop.html#abfc8df1469f20d8084f744da461d1df5">temp</a>);
<a name="l01280"></a>01280             <span class="keywordtype">double</span> expL = expLeafExt*min(1.0,<a class="code" href="classcrop.html#a461228045f8a07f1f12a06acd12adf89">TranspirationRatio</a>/0.6)*reducedGrowth;
<a name="l01281"></a>01281 
<a name="l01282"></a>01282             <span class="keywordtype">double</span> dmL  = <a class="code" href="classcrop.html#ac84c4bfe32722d43f1edf0f3954bf6d9">LAIDMRatio</a>*<a class="code" href="classcrop.html#a755b12e801a538bb34a8c7b829047e76">DryMatterVegTop</a>-<a class="code" href="classcrop.html#a2691a60a48a5166469df5da0e0e824fb">GreenCropAreaIndex</a>;
<a name="l01283"></a>01283 
<a name="l01284"></a>01284                 <span class="keywordtype">double</span> NL   = <a class="code" href="classcrop.html#a82bef6e98553aa173173b0ea454a3e0a">NitrogenInVegTop</a>().<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a>*<a class="code" href="classcrop.html#aa53e9f0b5c21a1dafb1d78291820350d">LAINitrogenRatio</a>-<a class="code" href="classcrop.html#a2691a60a48a5166469df5da0e0e824fb">GreenCropAreaIndex</a>;
<a name="l01285"></a>01285             <span class="keywordtype">double</span> potDGLAI = max(0.0,<a class="code" href="classcrop.html#a79905dd2d78bdaafd9569f9ecdd43665">MaxGLAICrop</a>-GreenCropAreaIndex);
<a name="l01286"></a>01286                 <span class="keywordtype">double</span> DGLAI = max(0.0,min(expL,min(dmL,min(NL,potDGLAI))));
<a name="l01287"></a>01287 
<a name="l01288"></a>01288             GreenCropAreaIndex += DGLAI;
<a name="l01289"></a>01289          }
<a name="l01290"></a>01290          <span class="keywordflow">if</span> ((<a class="code" href="classcrop.html#a38f05d3f77cfc67ff755eb8c0d79e301">Phenology</a>-&gt;<a class="code" href="classphenology.html#ad15943ccbe565731b9ddb338ca6384bf">LeafSenesence</a>()&gt;0) || (<a class="code" href="classcrop.html#abfc8df1469f20d8084f744da461d1df5">temp</a> &lt; 0.0))
<a name="l01291"></a>01291          {
<a name="l01292"></a>01292 
<a name="l01293"></a>01293             <span class="keywordtype">double</span> senescense = 1.0/(1.0-<a class="code" href="classcrop.html#a99a529deb646061aa62fcb9953844de2">MinimumSenescense</a>)*<a class="code" href="classcrop.html#a38f05d3f77cfc67ff755eb8c0d79e301">Phenology</a>-&gt;<a class="code" href="classphenology.html#ad15943ccbe565731b9ddb338ca6384bf">LeafSenesence</a>();  <span class="comment">// Correct later</span>
<a name="l01294"></a>01294             <span class="keywordflow">if</span> (<a class="code" href="classcrop.html#abfc8df1469f20d8084f744da461d1df5">temp</a> &lt; 0.0)  <span class="comment">//if mean temp is below zero enhanced senescense MEL 2009</span>
<a name="l01295"></a>01295                 senescense=1.0/(1.0-<a class="code" href="classcrop.html#a99a529deb646061aa62fcb9953844de2">MinimumSenescense</a>)*0.005;
<a name="l01296"></a>01296             <span class="keywordtype">double</span> deltaCAIg=-max(0.0,senescense*<a class="code" href="classcrop.html#a7cc6a117013deeda470335c166066615">maxGLAI</a>*(1.0-<a class="code" href="classcrop.html#a461228045f8a07f1f12a06acd12adf89">TranspirationRatio</a>*<a class="code" href="classcrop.html#a99a529deb646061aa62fcb9953844de2">MinimumSenescense</a>));
<a name="l01297"></a>01297 
<a name="l01298"></a>01298             <span class="keywordflow">if</span> ((<a class="code" href="classcrop.html#a7acb3fa412808c819f4d9b662cc2148c">YellowCropAreaIndex</a>&gt;=0.0) || (<a class="code" href="classcrop.html#a2691a60a48a5166469df5da0e0e824fb">GreenCropAreaIndex</a>&gt;=0.0))
<a name="l01299"></a>01299             {
<a name="l01300"></a>01300                 <a class="code" href="classcrop.html#a2691a60a48a5166469df5da0e0e824fb">GreenCropAreaIndex</a>+=deltaCAIg;
<a name="l01301"></a>01301                <span class="keywordflow">if</span> (<a class="code" href="classcrop.html#a2691a60a48a5166469df5da0e0e824fb">GreenCropAreaIndex</a>&lt;0.0)
<a name="l01302"></a>01302                {
<a name="l01303"></a>01303                 deltaCAIg-=<a class="code" href="classcrop.html#a2691a60a48a5166469df5da0e0e824fb">GreenCropAreaIndex</a>;
<a name="l01304"></a>01304                   <a class="code" href="classcrop.html#a2691a60a48a5166469df5da0e0e824fb">GreenCropAreaIndex</a>=0.0;
<a name="l01305"></a>01305                }
<a name="l01306"></a>01306                <a class="code" href="classcrop.html#a7acb3fa412808c819f4d9b662cc2148c">YellowCropAreaIndex</a>-=deltaCAIg*<a class="code" href="classcrop.html#a3a262508a417bdfee36e9961ec283d96">Conversfactor</a>;
<a name="l01307"></a>01307             }
<a name="l01308"></a>01308             <span class="keywordflow">else</span>
<a name="l01309"></a>01309                 <a class="code" href="message_8h.html#a8ad29009121a629982c6ade0bd332470">theMessage</a>-&gt;<a class="code" href="classmessage.html#afed66d0552f90b4385c5169cf5929907">WarningWithDisplay</a>(<span class="stringliteral">&quot;crop::CalcLeafAreaIndices - variables in undefined state&quot;</span>);
<a name="l01310"></a>01310          }
<a name="l01311"></a>01311       }
<a name="l01312"></a>01312         }
<a name="l01313"></a>01313 }
<a name="l01314"></a>01314 
<a name="l01315"></a>01315 <span class="comment">/****************************************************************************\</span>
<a name="l01316"></a>01316 <span class="comment">\****************************************************************************/</span>
<a name="l01317"></a><a class="code" href="classcrop.html#ac135f27391332e8666ab14a3fc345f15">01317</a> <span class="keywordtype">bool</span> <a class="code" href="classcrop.html#ac135f27391332e8666ab14a3fc345f15">crop::IrrigationDemand</a>()
<a name="l01318"></a>01318 {
<a name="l01319"></a>01319         <span class="keywordtype">double</span> MaxWDeficit = 1.0;
<a name="l01320"></a>01320    <span class="keywordflow">if</span> (<a class="code" href="classcrop.html#a38f05d3f77cfc67ff755eb8c0d79e301">Phenology</a>-&gt;<a class="code" href="classphenology.html#a514ca53b35d3dfc3e8dc1b4841d221cf" title="return true if crop has emerged">Emerged</a>() &amp;&amp; <a class="code" href="classcrop.html#a38f05d3f77cfc67ff755eb8c0d79e301">Phenology</a>-&gt;<a class="code" href="classphenology.html#ac59e649ce2b4cede632496fbc6de53e1" title="Temperature sum for leaf expansion (used in linear growth)">TempSumForLeaf</a>&gt;=<a class="code" href="classcrop.html#a38f05d3f77cfc67ff755eb8c0d79e301">Phenology</a>-&gt;<a class="code" href="classphenology.html#a88c5292d2d713236a2403cb0a100655c" title="Growth phase for linear leaf growth (related to TempSumForLeaf!)">LinearLeafPhase</a>)
<a name="l01321"></a>01321    {
<a name="l01322"></a>01322            <span class="keywordflow">if</span> (!<a class="code" href="classcrop.html#a38f05d3f77cfc67ff755eb8c0d79e301">Phenology</a>-&gt;<a class="code" href="classphenology.html#a9f571608ca2e2eaf7d1a79715afa8e0c" title="return true if crop has reached anthesis">Anthesis</a>())
<a name="l01323"></a>01323            {
<a name="l01324"></a>01324         <span class="keywordflow">if</span> (<a class="code" href="bstime_8h.html#ac0dc3834220ee5ae84c115e146194d75">theTime</a>.<a class="code" href="classbs_time.html#a777a59c97951688c4b2a67c4b0bca16e">GetMonth</a>()&gt;=10 || <a class="code" href="bstime_8h.html#ac0dc3834220ee5ae84c115e146194d75">theTime</a>.<a class="code" href="classbs_time.html#a777a59c97951688c4b2a67c4b0bca16e">GetMonth</a>()&lt;=3)
<a name="l01325"></a>01325                 MaxWDeficit = 1.0;
<a name="l01326"></a>01326          <span class="keywordflow">else</span>
<a name="l01327"></a>01327                 MaxWDeficit = <a class="code" href="classcrop.html#a5eb2d5b9554ecd6e8f7f32b229509b67">WaterDeficitVegGrowth</a>;
<a name="l01328"></a>01328            }
<a name="l01329"></a>01329            <span class="keywordflow">else</span>
<a name="l01330"></a>01330            {
<a name="l01331"></a>01331                    <span class="keywordflow">if</span> (!<a class="code" href="classcrop.html#a38f05d3f77cfc67ff755eb8c0d79e301">Phenology</a>-&gt;<a class="code" href="classphenology.html#a8cae850ebecaff9242a27d529ab72e09" title="return true if the grain has started to develop">GrainFillStart</a>())
<a name="l01332"></a>01332                            MaxWDeficit = <a class="code" href="classcrop.html#a4a332805f2e6027e5e2e18e2bf7cae17">WaterDeficitLagPhase</a>;
<a name="l01333"></a>01333                    <span class="keywordflow">else</span>
<a name="l01334"></a>01334                            MaxWDeficit = <a class="code" href="classcrop.html#abcc0955968163247c126f91191a4c782">WaterDeficitGrainFill</a>;
<a name="l01335"></a>01335            }
<a name="l01336"></a>01336    }
<a name="l01337"></a>01337    <span class="keywordflow">if</span> (<a class="code" href="classcrop.html#aaf7bdd66e714b1ad4057bad5a46e6772">aSoil</a> &amp;&amp; (MaxWDeficit&lt;1.0) &amp;&amp; <a class="code" href="classcrop.html#aefe9049cee98b6ac81f4362c4a1190a9">RootDepth</a>&gt;0.0)
<a name="l01338"></a>01338       {
<a name="l01339"></a>01339         <span class="keywordtype">double</span> WaterStatus= (<a class="code" href="classcrop.html#aaf7bdd66e714b1ad4057bad5a46e6772">aSoil</a>-&gt;<a class="code" href="classsoil.html#a42157cb55748341f87032731541d5f4f">GetAvailWater</a>(0,<a class="code" href="classcrop.html#aefe9049cee98b6ac81f4362c4a1190a9">RootDepth</a>*1000.0)-<a class="code" href="classcrop.html#aaf7bdd66e714b1ad4057bad5a46e6772">aSoil</a>-&gt;<a class="code" href="classsoil.html#a06c73f2cfdba2d776e2ac58ba8894c0b">GetWiltCapacity</a>(0,<a class="code" href="classcrop.html#aefe9049cee98b6ac81f4362c4a1190a9">RootDepth</a>*1000.0))
<a name="l01340"></a>01340                             /(<a class="code" href="classcrop.html#aaf7bdd66e714b1ad4057bad5a46e6772">aSoil</a>-&gt;<a class="code" href="classsoil.html#a7393e26e3493fc1af1304fc59f3a73d0">GetFieldCapacity</a>(0,<a class="code" href="classcrop.html#aefe9049cee98b6ac81f4362c4a1190a9">RootDepth</a>*1000.0)-<a class="code" href="classcrop.html#aaf7bdd66e714b1ad4057bad5a46e6772">aSoil</a>-&gt;<a class="code" href="classsoil.html#a06c73f2cfdba2d776e2ac58ba8894c0b">GetWiltCapacity</a>(0,<a class="code" href="classcrop.html#aefe9049cee98b6ac81f4362c4a1190a9">RootDepth</a>*1000.0));
<a name="l01341"></a>01341     <span class="comment">//     return (max(WaterStatus,TranspirationRatio)&lt;MaxWDeficit);</span>
<a name="l01342"></a>01342          <span class="keywordflow">return</span> (WaterStatus&lt;MaxWDeficit);
<a name="l01343"></a>01343       }
<a name="l01344"></a>01344    <span class="keywordflow">else</span>
<a name="l01345"></a>01345       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01346"></a>01346 }
<a name="l01347"></a>01347 
<a name="l01348"></a>01348 <span class="comment">/****************************************************************************\</span>
<a name="l01349"></a>01349 <span class="comment">\****************************************************************************/</span>
<a name="l01350"></a><a class="code" href="classcrop.html#a17c3bc93f8a3a6c784f9e30e9d17fbef">01350</a> <span class="keywordtype">double</span> * <a class="code" href="classcrop.html#a17c3bc93f8a3a6c784f9e30e9d17fbef">crop::GiveRootLengthList</a>()
<a name="l01351"></a>01351 {
<a name="l01352"></a>01352         <span class="keywordflow">return</span> (<span class="keywordtype">double</span> *)&amp;<a class="code" href="classcrop.html#ad629acdfd462323490f91ad3ce9a7b59">RootLengthList</a>;
<a name="l01353"></a>01353 }
<a name="l01354"></a>01354 
<a name="l01355"></a>01355 <span class="comment">/****************************************************************************\</span>
<a name="l01356"></a>01356 <span class="comment">\****************************************************************************/</span>
<a name="l01357"></a><a class="code" href="classcrop.html#a7f8a309f89bee5db02055897d0a717be">01357</a> <span class="keywordtype">double</span> <a class="code" href="classcrop.html#a7f8a309f89bee5db02055897d0a717be">crop::NitrogenDemand</a>()
<a name="l01358"></a>01358 {
<a name="l01359"></a>01359         <span class="keywordtype">double</span> NitrogenDem=max(0.0,<a class="code" href="classcrop.html#a6416f0baf1364f2cf28f312584c39f73">Nmax</a>()-<a class="code" href="classcrop.html#adabbdde8753e5ae0ecd238e221429d88" title="How much Nitrogen that is in the plant.">Nitrogen</a>.<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a>);
<a name="l01360"></a>01360 <span class="comment">//      double NitrogenDem=0.5*(Nmax()-Nitrogen.n);    //TEST MEL 2009: Changed to 50 %  to avoid problems with uptake of access nitrogen</span>
<a name="l01361"></a>01361         <span class="keywordflow">if</span> ((<a class="code" href="classcrop.html#a6416f0baf1364f2cf28f312584c39f73">Nmax</a>()-<a class="code" href="classcrop.html#adabbdde8753e5ae0ecd238e221429d88" title="How much Nitrogen that is in the plant.">Nitrogen</a>.<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a>&lt;-1e-10)&amp;&amp;(<a class="code" href="classcrop.html#a38f05d3f77cfc67ff755eb8c0d79e301">Phenology</a> -&gt; DS &gt; 0.1))
<a name="l01362"></a>01362 {
<a name="l01363"></a>01363                 <a class="code" href="message_8h.html#a8ad29009121a629982c6ade0bd332470">theMessage</a>-&gt;<a class="code" href="classmessage.html#aacaa1466698a349689502491cf089f72">Warning</a>(<span class="stringliteral">&quot;crop::NitrogenDemand is below zero&quot;</span>);
<a name="l01364"></a>01364         }
<a name="l01365"></a>01365         <span class="keywordflow">if</span> (NitrogenDem&lt;0.0)
<a name="l01366"></a>01366                 NitrogenDem=0.0;
<a name="l01367"></a>01367         <span class="keywordflow">if</span> (<a class="code" href="classcrop.html#a2691a60a48a5166469df5da0e0e824fb">GreenCropAreaIndex</a>&lt;1E-6 )
<a name="l01368"></a>01368                 NitrogenDem=0.0;
<a name="l01369"></a>01369         <span class="keywordflow">if</span>(<a class="code" href="classcrop.html#a38f05d3f77cfc67ff755eb8c0d79e301">Phenology</a>-&gt;<a class="code" href="classphenology.html#a8cae850ebecaff9242a27d529ab72e09" title="return true if the grain has started to develop">GrainFillStart</a>())
<a name="l01370"></a>01370         {
<a name="l01371"></a>01371                 <span class="keywordtype">double</span> <a class="code" href="typer_8h.html#ae4c405e5c68c6ec2c44bb6d6adfc2f6cab10366ecc76133a0a4a4712a5ee26f65">fraction</a> = (<a class="code" href="classcrop.html#a38f05d3f77cfc67ff755eb8c0d79e301">Phenology</a>-&gt;<a class="code" href="classphenology.html#afdc8ea11c9fcb90491341ed8e70d2927" title="development stage">DS</a>-2.0)*1/(<a class="code" href="classcrop.html#a38f05d3f77cfc67ff755eb8c0d79e301">Phenology</a>-&gt;<a class="code" href="classphenology.html#aea2f0be3503256d007d5b1ee391e98e0" title="Developing System scale for start of grainfill (is it a scale??">DS_StartFill</a>-2.0);
<a name="l01372"></a>01372                 NitrogenDem=max(0.0,(fraction)*NitrogenDem);
<a name="l01373"></a>01373         }
<a name="l01374"></a>01374     <span class="keywordflow">return</span> NitrogenDem;
<a name="l01375"></a>01375 }
<a name="l01376"></a>01376 
<a name="l01380"></a><a class="code" href="classcrop.html#a84819af6b3132d798a56acd9c78dfbe1">01380</a> <span class="keywordtype">void</span> <a class="code" href="classcrop.html#a84819af6b3132d798a56acd9c78dfbe1">crop::CalcRootDistribution</a>()
<a name="l01381"></a>01381 {
<a name="l01382"></a>01382    <span class="keywordtype">double</span> startdepth=0.0;
<a name="l01383"></a>01383         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;<a class="code" href="classcrop.html#add8f384e82643550fa78abd7382abc4f" title="Describe how many layers a plan has. It is use to distribute sunlight.">NumOfLayers</a>;i++)
<a name="l01384"></a>01384    {
<a name="l01385"></a>01385       <span class="keywordflow">if</span> (<a class="code" href="classcrop.html#a26eb467869df5fc16784e0b42798cc4b">LayerThickness</a>[i]&lt;0)
<a name="l01386"></a>01386          <a class="code" href="classcrop.html#a26eb467869df5fc16784e0b42798cc4b">LayerThickness</a>[i]=<a class="code" href="classcrop.html#aaf7bdd66e714b1ad4057bad5a46e6772">aSoil</a>-&gt;<a class="code" href="classsoil.html#a2036fe29081a982325d1c6b8b644db12" title="returned to the thickness of a given layer ( millimetres)">GetLayerThickness</a>(i)/1000;
<a name="l01387"></a>01387       <span class="keywordflow">if</span> (<a class="code" href="classcrop.html#a26eb467869df5fc16784e0b42798cc4b">LayerThickness</a>[i]&gt;0)
<a name="l01388"></a>01388                 <a class="code" href="classcrop.html#ad629acdfd462323490f91ad3ce9a7b59">RootLengthList</a>[i]=<a class="code" href="classcrop.html#a72e68283aa65578e991092da749c6f44">RootLengthInInterval</a>(startdepth,<a class="code" href="classcrop.html#a26eb467869df5fc16784e0b42798cc4b">LayerThickness</a>[i]);
<a name="l01389"></a>01389       <span class="keywordflow">else</span>
<a name="l01390"></a>01390          <a class="code" href="classcrop.html#ad629acdfd462323490f91ad3ce9a7b59">RootLengthList</a>[i]=0.0;
<a name="l01391"></a>01391 
<a name="l01392"></a>01392       <span class="keywordflow">if</span> (i&gt;0)
<a name="l01393"></a>01393       {
<a name="l01394"></a>01394          <span class="keywordflow">if</span> (((<a class="code" href="classcrop.html#ad629acdfd462323490f91ad3ce9a7b59">RootLengthList</a>[i-1]/<a class="code" href="classcrop.html#a26eb467869df5fc16784e0b42798cc4b">LayerThickness</a>[i-1])-(<a class="code" href="classcrop.html#ad629acdfd462323490f91ad3ce9a7b59">RootLengthList</a>[i]/<a class="code" href="classcrop.html#a26eb467869df5fc16784e0b42798cc4b">LayerThickness</a>[i]))&lt;-1e-10)
<a name="l01395"></a>01395             <a class="code" href="message_8h.html#a8ad29009121a629982c6ade0bd332470">theMessage</a>-&gt;<a class="code" href="classmessage.html#af9891cb7111375e6a36363afffb09d63">FatalError</a>(<span class="stringliteral">&quot;crop::CalcRootDistribution - root density is increasing with depth&quot;</span>);
<a name="l01396"></a>01396       }
<a name="l01397"></a>01397       <span class="keywordflow">if</span> (<a class="code" href="classcrop.html#ad629acdfd462323490f91ad3ce9a7b59">RootLengthList</a>[i]&lt;0.0)
<a name="l01398"></a>01398       {
<a name="l01399"></a>01399          <span class="keywordflow">if</span> (<a class="code" href="classcrop.html#ad629acdfd462323490f91ad3ce9a7b59">RootLengthList</a>[i]&lt;(-1E-10))
<a name="l01400"></a>01400             <a class="code" href="message_8h.html#a8ad29009121a629982c6ade0bd332470">theMessage</a>-&gt;<a class="code" href="classmessage.html#afed66d0552f90b4385c5169cf5929907">WarningWithDisplay</a>(<span class="stringliteral">&quot;crop::CalcRootDistribution - root length can not be negative&quot;</span>);
<a name="l01401"></a>01401          <a class="code" href="classcrop.html#ad629acdfd462323490f91ad3ce9a7b59">RootLengthList</a>[i]=0.0;
<a name="l01402"></a>01402       }
<a name="l01403"></a>01403       startdepth+=<a class="code" href="classcrop.html#a26eb467869df5fc16784e0b42798cc4b">LayerThickness</a>[i];
<a name="l01404"></a>01404    }
<a name="l01405"></a>01405 }
<a name="l01406"></a>01406 
<a name="l01407"></a>01407 <span class="comment">/****************************************************************************\</span>
<a name="l01408"></a>01408 <span class="comment">\****************************************************************************/</span>
<a name="l01409"></a><a class="code" href="classcrop.html#a7f8e3691756173129745ea074a076442">01409</a> <span class="keywordtype">void</span> <a class="code" href="classcrop.html#a7f8e3691756173129745ea074a076442">crop::GetStatus</a>(<span class="keywordtype">double</span> * aRootRadius,
<a name="l01410"></a>01410                                                         <span class="keywordtype">double</span> * aRootpF,
<a name="l01411"></a>01411                                                         <span class="keywordtype">double</span> * aNitrogenDemand,
<a name="l01412"></a>01412                                                         <span class="keywordtype">double</span> * aNitrateUptakeRate,
<a name="l01413"></a>01413                                                         <span class="keywordtype">double</span> * aAmmoniumUptakeRate,
<a name="l01414"></a>01414                      <span class="keywordtype">double</span> * aMinimumSoilNitrate,
<a name="l01415"></a>01415                      <span class="keywordtype">double</span> * aMinimumSoilAmmonium)
<a name="l01416"></a>01416 {
<a name="l01417"></a>01417         <span class="keywordflow">if</span> (<a class="code" href="classcrop.html#a38f05d3f77cfc67ff755eb8c0d79e301">Phenology</a>-&gt;<a class="code" href="classphenology.html#aa4986dd79d0fc195c3f1c21833171906" title="return true if the crop is sown">Sown</a>() &amp;&amp; !<a class="code" href="classcrop.html#a38f05d3f77cfc67ff755eb8c0d79e301">Phenology</a>-&gt;<a class="code" href="classphenology.html#a906583e45eeda4d8a6e1cec487a272cc" title="return true if planed is ready to be ripped">Ripe</a>() &amp;&amp; <a class="code" href="classcrop.html#aaf7bdd66e714b1ad4057bad5a46e6772">aSoil</a>)
<a name="l01418"></a>01418         *aNitrogenDemand=<a class="code" href="classcrop.html#a7f8a309f89bee5db02055897d0a717be">NitrogenDemand</a>();
<a name="l01419"></a>01419    <span class="keywordflow">else</span>
<a name="l01420"></a>01420            *aNitrogenDemand=0.0;
<a name="l01421"></a>01421         *aRootRadius         = sqrt(1.0/(3.1415926535*0.075*<a class="code" href="classcrop.html#a56cef92be3d0cb8376b13f1666c469e2">SpecificRootLength</a>));          <span class="comment">// assumes that root system is cylindric and dm = 7.5%</span>
<a name="l01422"></a>01422         *aRootpF             = <a class="code" href="classcrop.html#a6ea7c6dccd7cf399d9276d0328c142cb">RootpF</a>;
<a name="l01423"></a>01423         *aNitrateUptakeRate  = <a class="code" href="classcrop.html#a0cbba1c8f072c0ae99c9465f5eadf2cb">NitrateUptakeRate</a>;
<a name="l01424"></a>01424         *aAmmoniumUptakeRate = <a class="code" href="classcrop.html#a1707be6e4080e9ca3c3f24d6ffe0d6fa">AmmoniumUptakeRate</a>;
<a name="l01425"></a>01425    *aMinimumSoilNitrate = <a class="code" href="classcrop.html#af1ec4e9a12abd41e5f5b39c87cfc2349">MinimumSoilNitrate</a>;
<a name="l01426"></a>01426    *aMinimumSoilAmmonium= <a class="code" href="classcrop.html#af11b53bf326f21dc1628289175ecb6d7">MinimumSoilAmmonium</a>;
<a name="l01427"></a>01427 }
<a name="l01428"></a>01428 
<a name="l01432"></a><a class="code" href="classcrop.html#a4ed6aaf98890015fb52d4d8957313166">01432</a> <span class="keywordtype">void</span> <a class="code" href="classcrop.html#a4ed6aaf98890015fb52d4d8957313166">crop::NitrogenAndTranspiration</a>(<a class="code" href="classnitrogen.html">nitrogen</a> aNitrogenUptake,<span class="keywordtype">double</span> aTranspirationRatio)
<a name="l01433"></a>01433 {
<a name="l01434"></a>01434    <a class="code" href="classcrop.html#a461228045f8a07f1f12a06acd12adf89">TranspirationRatio</a> = aTranspirationRatio;
<a name="l01435"></a>01435    <span class="keywordflow">if</span> ((<a class="code" href="classcrop.html#a461228045f8a07f1f12a06acd12adf89">TranspirationRatio</a>&lt;0.5) &amp;&amp; (<a class="code" href="classcrop.html#a7acb3fa412808c819f4d9b662cc2148c">YellowCropAreaIndex</a>+<a class="code" href="classcrop.html#a2691a60a48a5166469df5da0e0e824fb">GreenCropAreaIndex</a>&lt;0.01))         <span class="comment">// corrects problem with transpiration the day of germination</span>
<a name="l01436"></a>01436         <a class="code" href="classcrop.html#a461228045f8a07f1f12a06acd12adf89">TranspirationRatio</a> = 1.0;
<a name="l01437"></a>01437    <span class="keywordflow">if</span> (aNitrogenUptake.<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a>&gt;1e-15)
<a name="l01438"></a>01438    {
<a name="l01439"></a>01439       <a class="code" href="classcrop.html#adabbdde8753e5ae0ecd238e221429d88" title="How much Nitrogen that is in the plant.">Nitrogen</a> = <a class="code" href="classcrop.html#adabbdde8753e5ae0ecd238e221429d88" title="How much Nitrogen that is in the plant.">Nitrogen</a> + aNitrogenUptake;
<a name="l01440"></a>01440       <a class="code" href="classcrop.html#ac99038132c4676e35b98265edb34a213" title="Noone knows that this is.">AccumulatedNProduction</a> = <a class="code" href="classcrop.html#ac99038132c4676e35b98265edb34a213" title="Noone knows that this is.">AccumulatedNProduction</a> + aNitrogenUptake;
<a name="l01441"></a>01441       <a class="code" href="classcrop.html#af7ae14fac12af3efa728e789155983fb">Nbudget</a>.<a class="code" href="classbudget.html#ad619d773e77931df0435e8c08314f68e">AddInput</a>(aNitrogenUptake.n);              <span class="comment">// Budgets</span>
<a name="l01442"></a>01442       <a class="code" href="classcrop.html#a3e5fad944be35152e933b5e50f928f5a">N15budget</a>.<a class="code" href="classbudget.html#ad619d773e77931df0435e8c08314f68e">AddInput</a>(aNitrogenUptake.n15);
<a name="l01443"></a>01443    }
<a name="l01444"></a>01444    <span class="comment">//MEL 2009</span>
<a name="l01445"></a>01445    <span class="keywordtype">double</span> minimumN = <a class="code" href="classcrop.html#adc9f2a384dfd4be26746b822c4324f37">Nmin</a>();
<a name="l01446"></a>01446    <span class="keywordtype">double</span> maximumN = <a class="code" href="classcrop.html#a6416f0baf1364f2cf28f312584c39f73">Nmax</a>();
<a name="l01447"></a>01447 
<a name="l01448"></a>01448    <span class="keywordflow">if</span> ((<a class="code" href="classcrop.html#a4a2803c0618d2f662abfa8d230c811df">DryMatterStorage</a> + <a class="code" href="classcrop.html#a3c5f4942cf46d45168caf4da80b79537">DryMatterRoot</a> + <a class="code" href="classcrop.html#a755b12e801a538bb34a8c7b829047e76">DryMatterVegTop</a> &gt; 0.0) &amp;&amp; (<a class="code" href="classcrop.html#adabbdde8753e5ae0ecd238e221429d88" title="How much Nitrogen that is in the plant.">Nitrogen</a>.<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a> &gt; 0.5))
<a name="l01449"></a>01449    {
<a name="l01450"></a>01450         <span class="keywordflow">if</span> (minimumN &gt; <a class="code" href="classcrop.html#adabbdde8753e5ae0ecd238e221429d88" title="How much Nitrogen that is in the plant.">Nitrogen</a>.<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a> * 1.25)
<a name="l01451"></a>01451       {
<a name="l01452"></a>01452         cout &lt;&lt; <a class="code" href="classbase.html#aae39ec3da4311af6b93e424d29b2c66a">GetLongName</a>() &lt;&lt; endl;
<a name="l01453"></a>01453                 <a class="code" href="message_8h.html#a8ad29009121a629982c6ade0bd332470">theMessage</a>-&gt;<a class="code" href="classmessage.html#afed66d0552f90b4385c5169cf5929907">WarningWithDisplay</a>(<span class="stringliteral">&quot;crop::NitrogenAndTranspiration - not enough nitrogen in plant&quot;</span>);
<a name="l01454"></a>01454         }
<a name="l01455"></a>01455         <span class="keywordflow">if</span> (maximumN &lt; <a class="code" href="classcrop.html#adabbdde8753e5ae0ecd238e221429d88" title="How much Nitrogen that is in the plant.">Nitrogen</a>.<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a> * 0.75)
<a name="l01456"></a>01456         {
<a name="l01457"></a>01457         cout &lt;&lt; <a class="code" href="classbase.html#aae39ec3da4311af6b93e424d29b2c66a">GetLongName</a>() &lt;&lt; endl;
<a name="l01458"></a>01458                 <a class="code" href="message_8h.html#a8ad29009121a629982c6ade0bd332470">theMessage</a>-&gt;<a class="code" href="classmessage.html#afed66d0552f90b4385c5169cf5929907">WarningWithDisplay</a>(<span class="stringliteral">&quot;crop::NitrogenAndTranspiration - too much nitrogen in plant&quot;</span>);
<a name="l01459"></a>01459       }
<a name="l01460"></a>01460    }
<a name="l01461"></a>01461 
<a name="l01462"></a>01462 }
<a name="l01463"></a>01463 
<a name="l01467"></a><a class="code" href="classcrop.html#a9ed02462e332fffb65498075e7499bf4">01467</a> <span class="keywordtype">double</span> <a class="code" href="classcrop.html#a9ed02462e332fffb65498075e7499bf4">crop::Update</a>(<span class="keywordtype">double</span> ActivePar)
<a name="l01468"></a>01468 {
<a name="l01469"></a>01469 
<a name="l01470"></a>01470    <a class="code" href="classcrop.html#a089361fdbd7eedb3b84e501ebc4f7221">Rg</a>   = ActivePar;
<a name="l01471"></a>01471    <a class="code" href="classcrop.html#abfc8df1469f20d8084f744da461d1df5">temp</a>         = <a class="code" href="climate_8h.html#ad05fb99191dc4a9cb94e7f8c99280389">theClimate</a>-&gt;<a class="code" href="classclimate.html#a679acf82733860fad71dac0769ae16be">tmean</a>;
<a name="l01472"></a>01472    <span class="keywordtype">double</span> DailyDMGrowth = 0.0;
<a name="l01473"></a>01473    <a class="code" href="classcrop.html#a0491b172b4874adcd1b3930cb3be00fe">DeltaDMTop</a>=0.0;
<a name="l01474"></a>01474    <span class="keywordflow">if</span> (<a class="code" href="classcrop.html#a38f05d3f77cfc67ff755eb8c0d79e301">Phenology</a>-&gt;<a class="code" href="classphenology.html#aa4986dd79d0fc195c3f1c21833171906" title="return true if the crop is sown">Sown</a>() &amp;&amp; !<a class="code" href="classcrop.html#a38f05d3f77cfc67ff755eb8c0d79e301">Phenology</a>-&gt;<a class="code" href="classphenology.html#a906583e45eeda4d8a6e1cec487a272cc" title="return true if planed is ready to be ripped">Ripe</a>() &amp;&amp; !<a class="code" href="classcrop.html#af94e599e6f05fae15099673485d28e88" title="Describe if a plan is dead(true) or alive(false)">terminated</a>)
<a name="l01475"></a>01475    {
<a name="l01476"></a>01476       <span class="keywordflow">if</span> (<a class="code" href="classcrop.html#ac25231ecf44f1c5ffb8bf60c45334929">totalLAIStand</a>&gt;0.0)
<a name="l01477"></a>01477       {
<a name="l01478"></a>01478           <span class="keywordtype">double</span> maxSpaceFraction=(<a class="code" href="classcrop.html#a2691a60a48a5166469df5da0e0e824fb">GreenCropAreaIndex</a>+<a class="code" href="classcrop.html#a7acb3fa412808c819f4d9b662cc2148c">YellowCropAreaIndex</a>)/<a class="code" href="classcrop.html#ac25231ecf44f1c5ffb8bf60c45334929">totalLAIStand</a>;
<a name="l01479"></a>01479           <a class="code" href="classcrop.html#a394d3da7bbc4c297a68b5c6f575c5ecc">fractionOfSpace</a>=max(0.0,min(maxSpaceFraction,<a class="code" href="classcrop.html#a394d3da7bbc4c297a68b5c6f575c5ecc">fractionOfSpace</a>+max(0.0,<a class="code" href="classcrop.html#abfc8df1469f20d8084f744da461d1df5">temp</a>)*<a class="code" href="classcrop.html#a787dec1e35057a17b4837bc01fc34350">ColonialisationRate</a>));
<a name="l01480"></a>01480       }
<a name="l01481"></a>01481          <span class="keywordtype">double</span> soilTemp=<a class="code" href="classcrop.html#aaf7bdd66e714b1ad4057bad5a46e6772">aSoil</a>-&gt;<a class="code" href="classsoil.html#a30a2ef147290c60895e4c389ad3c72b8" title="returns the temperature at a given depth in the profile">GetTemperature</a>(200);
<a name="l01482"></a>01482       <span class="keywordtype">double</span> DayLength = <a class="code" href="climate_8h.html#ad05fb99191dc4a9cb94e7f8c99280389">theClimate</a>-&gt;<a class="code" href="classclimate.html#a2a5a0fd4f393d95c69ecf170d06513fb">PhotoPeriod</a>();
<a name="l01483"></a>01483       <a class="code" href="classcrop.html#a38f05d3f77cfc67ff755eb8c0d79e301">Phenology</a>-&gt;<a class="code" href="classphenology.html#a2e385ad05ba01687483faa3ec7de127c">Update</a>(<a class="code" href="classcrop.html#abfc8df1469f20d8084f744da461d1df5">temp</a>,soilTemp,DayLength);      <span class="comment">// updates phenology</span>
<a name="l01484"></a>01484 
<a name="l01485"></a>01485       <span class="keywordflow">if</span> (<a class="code" href="classcrop.html#a38f05d3f77cfc67ff755eb8c0d79e301">Phenology</a>-&gt;<a class="code" href="classphenology.html#aa4986dd79d0fc195c3f1c21833171906" title="return true if the crop is sown">Sown</a>())
<a name="l01486"></a>01486                         <a class="code" href="classcrop.html#a362d42d586668dca552ec4d8cd381b68">TempSumRoot</a> += max(0.0,<a class="code" href="classcrop.html#abfc8df1469f20d8084f744da461d1df5">temp</a>);
<a name="l01487"></a>01487 
<a name="l01488"></a>01488       <a class="code" href="classcrop.html#aeccf3077c6ad647769145b8064ba426b">UpdateHeight</a>();
<a name="l01489"></a>01489                 <span class="keywordtype">double</span> deltaDryMatt = <a class="code" href="classcrop.html#a2dbc56666f949042e5d0c80dbbd66325">DeltaDryMatter</a>();
<a name="l01490"></a>01490       DailyDMGrowth = deltaDryMatt;
<a name="l01491"></a>01491       <a class="code" href="classcrop.html#a46844fd0540eb7627555f21afa8545e8">DMbudget</a>.<a class="code" href="classbudget.html#ad619d773e77931df0435e8c08314f68e">AddInput</a>(deltaDryMatt);              <span class="comment">// Budgets</span>
<a name="l01492"></a>01492       <a class="code" href="classcrop.html#ac9e8384797116e758558faff120ae56d">AccumulatedDMProduction</a> += deltaDryMatt;
<a name="l01493"></a>01493 
<a name="l01494"></a>01494       <span class="keywordflow">if</span> (<a class="code" href="classcrop.html#a38f05d3f77cfc67ff755eb8c0d79e301">Phenology</a>-&gt;<a class="code" href="classphenology.html#ac59e649ce2b4cede632496fbc6de53e1" title="Temperature sum for leaf expansion (used in linear growth)">TempSumForLeaf</a>&lt;=<a class="code" href="classcrop.html#a38f05d3f77cfc67ff755eb8c0d79e301">Phenology</a>-&gt;<a class="code" href="classphenology.html#a88c5292d2d713236a2403cb0a100655c" title="Growth phase for linear leaf growth (related to TempSumForLeaf!)">LinearLeafPhase</a>)                         <span class="comment">// the same termal time as linear leaf growth</span>
<a name="l01495"></a>01495       {
<a name="l01496"></a>01496          <span class="keywordtype">double</span> DMTransfer=2.0*<a class="code" href="classcrop.html#a158a4f00952108fdc19727bdc90765f9">TopFraction</a>*<a class="code" href="classcrop.html#a86aa841b9bfef88701e24c3a1922bba5">InitialSeedDM</a>*(max(0.0,<a class="code" href="classcrop.html#abfc8df1469f20d8084f744da461d1df5">temp</a>)/<a class="code" href="classcrop.html#a38f05d3f77cfc67ff755eb8c0d79e301">Phenology</a>-&gt;<a class="code" href="classphenology.html#a88c5292d2d713236a2403cb0a100655c" title="Growth phase for linear leaf growth (related to TempSumForLeaf!)">LinearLeafPhase</a>);
<a name="l01497"></a>01497          DMTransfer = min(DMTransfer,<a class="code" href="classcrop.html#a2dfb21c27aff36f3049be9a39e7c6538">SeedDM</a>);
<a name="l01498"></a>01498          <a class="code" href="classcrop.html#a755b12e801a538bb34a8c7b829047e76">DryMatterVegTop</a> += 0.5*DMTransfer;
<a name="l01499"></a>01499          <a class="code" href="classcrop.html#a3c5f4942cf46d45168caf4da80b79537">DryMatterRoot</a>   += 0.5*DMTransfer;
<a name="l01500"></a>01500          <a class="code" href="classcrop.html#a2dfb21c27aff36f3049be9a39e7c6538">SeedDM</a> -= DMTransfer;
<a name="l01501"></a>01501       }
<a name="l01502"></a>01502 
<a name="l01503"></a>01503       <a class="code" href="classcrop.html#aeb0993f2a6d2f21d30a5c24bbd46833e">TransferDryMatterToRoot</a>(&amp;deltaDryMatt);
<a name="l01504"></a>01504       <a class="code" href="classcrop.html#a022c14d2c183c8d21c622c225bb763d8">CalcRootGrowth</a>();
<a name="l01505"></a>01505       <a class="code" href="classcrop.html#aa93103e69836afc4fb23c1a29b15584f">TransferDryMatterToStorage</a>(&amp;deltaDryMatt);
<a name="l01506"></a>01506       <a class="code" href="classcrop.html#a755b12e801a538bb34a8c7b829047e76">DryMatterVegTop</a> += deltaDryMatt;
<a name="l01507"></a>01507       <a class="code" href="classcrop.html#a0491b172b4874adcd1b3930cb3be00fe">DeltaDMTop</a> = deltaDryMatt;                              <span class="comment">// Used for output</span>
<a name="l01508"></a>01508       <a class="code" href="classcrop.html#a14395e2b72c28aaf9dc729fcd0d3b1c8">CalcLeafAreaIndices</a>();
<a name="l01509"></a>01509         }
<a name="l01510"></a>01510 
<a name="l01511"></a>01511    <span class="keywordflow">return</span> DailyDMGrowth;
<a name="l01512"></a>01512 }
<a name="l01513"></a>01513 
<a name="l01517"></a><a class="code" href="classcrop.html#a9c7ffd6332d9aa190c27618cbcaea767">01517</a> <span class="keywordtype">void</span> <a class="code" href="classcrop.html#a9c7ffd6332d9aa190c27618cbcaea767">crop::KillRootsBelow</a>(<span class="keywordtype">double</span> depth, <a class="code" href="classdecomposable.html">decomposable</a> *DeadRoot, <span class="keywordtype">double</span>* RootList)
<a name="l01518"></a>01518 {
<a name="l01519"></a>01519         DeadRoot-&gt;<a class="code" href="classproduct.html#a0219cde65dc26376f3371a0138199ba8">Setname</a>(<span class="stringliteral">&quot;ROOTMATTER&quot;</span>);
<a name="l01520"></a>01520    <a class="code" href="_new_main_8cpp.html#af1019990138497f1f18cc7294737d140">theProducts</a>-&gt;<a class="code" href="classproducts.html#a8bd239aabc0a167741c02882e305d65d">GiveProductInformation</a>(DeadRoot);
<a name="l01521"></a>01521 
<a name="l01522"></a>01522         <span class="keywordtype">double</span> RootBelow = 0;
<a name="l01523"></a>01523    <span class="keywordtype">double</span> CurrentDepth = 0;
<a name="l01524"></a>01524    <span class="keywordflow">if</span> (<a class="code" href="classcrop.html#a1f0aa4443cf11cdf5776454bd056fa28">TotalRootLength</a>&gt;0)
<a name="l01525"></a>01525    {
<a name="l01526"></a>01526       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;<a class="code" href="typer_8h.html#a61dadd085c1777f559549e05962b2c9ea489863aec95253fced254923e4cb8148">MaxSoilLayers</a>;i++)
<a name="l01527"></a>01527       {
<a name="l01528"></a>01528          RootList[i] = 0.0;
<a name="l01529"></a>01529          <span class="keywordflow">if</span> (depth&lt;CurrentDepth+<a class="code" href="classcrop.html#a26eb467869df5fc16784e0b42798cc4b">LayerThickness</a>[i])
<a name="l01530"></a>01530          {
<a name="l01531"></a>01531             RootList[i] = max(1.0,(depth-CurrentDepth)/<a class="code" href="classcrop.html#a26eb467869df5fc16784e0b42798cc4b">LayerThickness</a>[i])*<a class="code" href="classcrop.html#ad629acdfd462323490f91ad3ce9a7b59">RootLengthList</a>[i];
<a name="l01532"></a>01532             RootBelow += RootList[i];
<a name="l01533"></a>01533          }
<a name="l01534"></a>01534          CurrentDepth += <a class="code" href="classcrop.html#a26eb467869df5fc16784e0b42798cc4b">LayerThickness</a>[i];
<a name="l01535"></a>01535       }
<a name="l01536"></a>01536 
<a name="l01537"></a>01537       <span class="keywordtype">double</span> DMdecay = <a class="code" href="classcrop.html#a3c5f4942cf46d45168caf4da80b79537">DryMatterRoot</a>*RootBelow/<a class="code" href="classcrop.html#a1f0aa4443cf11cdf5776454bd056fa28">TotalRootLength</a>;
<a name="l01538"></a>01538       <span class="keywordflow">if</span> (DMdecay&gt;0 &amp;&amp; <a class="code" href="classcrop.html#a3c5f4942cf46d45168caf4da80b79537">DryMatterRoot</a>&gt;0)
<a name="l01539"></a>01539       {
<a name="l01540"></a>01540          <a class="code" href="classnitrogen.html">nitrogen</a> NConcentration =  <a class="code" href="classcrop.html#ad0404629e0ae80c88ae7b99ff50cfdca">NitrogenInRoot</a>()/<a class="code" href="classcrop.html#a3c5f4942cf46d45168caf4da80b79537">DryMatterRoot</a>;
<a name="l01541"></a>01541          <span class="keywordflow">if</span> (NConcentration.<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a>&lt;<a class="code" href="classcrop.html#acc16e034b1484f87bbc3ec3863418f83">CorrectedMinN_Root</a>())
<a name="l01542"></a>01542          {
<a name="l01543"></a>01543             <span class="keywordflow">if</span> (NConcentration.<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a>==0)
<a name="l01544"></a>01544             {
<a name="l01545"></a>01545                 <a class="code" href="message_8h.html#a8ad29009121a629982c6ade0bd332470">theMessage</a>-&gt;<a class="code" href="classmessage.html#afed66d0552f90b4385c5169cf5929907">WarningWithDisplay</a>(<span class="stringliteral">&quot;crop::KillRootsBelow - nitrogen concentration in roots zero&quot;</span>);
<a name="l01546"></a>01546                NConcentration = <a class="code" href="classcrop.html#acc16e034b1484f87bbc3ec3863418f83">CorrectedMinN_Root</a>();
<a name="l01547"></a>01547             }
<a name="l01548"></a>01548             <a class="code" href="message_8h.html#a8ad29009121a629982c6ade0bd332470">theMessage</a>-&gt;<a class="code" href="classmessage.html#afed66d0552f90b4385c5169cf5929907">WarningWithDisplay</a>(<span class="stringliteral">&quot;crop::KillRootsBelow - nitrogen concentration in roots below possible value&quot;</span>);
<a name="l01549"></a>01549             NConcentration = NConcentration*<a class="code" href="classcrop.html#acc16e034b1484f87bbc3ec3863418f83">CorrectedMinN_Root</a>()/NConcentration.<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a>;
<a name="l01550"></a>01550          }
<a name="l01551"></a>01551 
<a name="l01552"></a>01552          <a class="code" href="classnitrogen.html">nitrogen</a> Ndecay = NConcentration*DMdecay;
<a name="l01553"></a>01553          <a class="code" href="classcrop.html#a3c5f4942cf46d45168caf4da80b79537">DryMatterRoot</a>  -= DMdecay;
<a name="l01554"></a>01554          <a class="code" href="classcrop.html#adabbdde8753e5ae0ecd238e221429d88" title="How much Nitrogen that is in the plant.">Nitrogen</a>           = <a class="code" href="classcrop.html#adabbdde8753e5ae0ecd238e221429d88" title="How much Nitrogen that is in the plant.">Nitrogen</a> - Ndecay;
<a name="l01555"></a>01555 
<a name="l01556"></a>01556          DeadRoot-&gt;<a class="code" href="classproduct.html#a18ec2e96f1d9b7cef74c4b2800ebdca1">Setamount</a>(DMdecay/DeadRoot-&gt;<a class="code" href="classlive_matter.html#ad3d05f1e8ceedc99e214adca94638de0">GetdryMatter</a>());                         <span class="comment">// Conversion from g/m2 to t/ha</span>
<a name="l01557"></a>01557          DeadRoot-&gt;<a class="code" href="classlive_matter.html#adbb45be219dd863cfad2b5e97cde1508">SetorgN_content</a>(Ndecay/(DMdecay/DeadRoot-&gt;<a class="code" href="classlive_matter.html#ad3d05f1e8ceedc99e214adca94638de0">GetdryMatter</a>()));
<a name="l01558"></a>01558 
<a name="l01559"></a>01559          <span class="comment">// update budgets</span>
<a name="l01560"></a>01560          <a class="code" href="classcrop.html#af7ae14fac12af3efa728e789155983fb">Nbudget</a>.<a class="code" href="classbudget.html#a47bfa9740186f2be18a10dd3423a5eea">AddOutput</a>(Ndecay.n);
<a name="l01561"></a>01561          <a class="code" href="classcrop.html#a3e5fad944be35152e933b5e50f928f5a">N15budget</a>.<a class="code" href="classbudget.html#a47bfa9740186f2be18a10dd3423a5eea">AddOutput</a>(Ndecay.n15);
<a name="l01562"></a>01562          <a class="code" href="classcrop.html#a46844fd0540eb7627555f21afa8545e8">DMbudget</a>.<a class="code" href="classbudget.html#a47bfa9740186f2be18a10dd3423a5eea">AddOutput</a>(DMdecay);
<a name="l01563"></a>01563 
<a name="l01564"></a>01564          <a class="code" href="classcrop.html#aefe9049cee98b6ac81f4362c4a1190a9">RootDepth</a> = depth;
<a name="l01565"></a>01565       }
<a name="l01566"></a>01566         }
<a name="l01567"></a>01567 }
<a name="l01568"></a>01568 
<a name="l01572"></a><a class="code" href="classcrop.html#ae8be0fd1bc438d926ce68942cb0886a0">01572</a> <span class="keywordtype">void</span> <a class="code" href="classcrop.html#ae8be0fd1bc438d926ce68942cb0886a0">crop::RootDecay</a>(<span class="keywordtype">double</span> RootTranslocation)
<a name="l01573"></a>01573 {
<a name="l01574"></a>01574         <span class="keywordflow">if</span>(!<a class="code" href="classcrop.html#a38f05d3f77cfc67ff755eb8c0d79e301">Phenology</a>-&gt;<a class="code" href="classphenology.html#a906583e45eeda4d8a6e1cec487a272cc" title="return true if planed is ready to be ripped">Ripe</a>())
<a name="l01575"></a>01575    {
<a name="l01576"></a>01576                 <a class="code" href="classnitrogen.html">nitrogen</a> aNitrogenInRoot =  <a class="code" href="classcrop.html#ad0404629e0ae80c88ae7b99ff50cfdca">NitrogenInRoot</a>();
<a name="l01577"></a>01577                 <span class="keywordflow">if</span> (<a class="code" href="classcrop.html#a2ca05aa427979d52b8fbbba1cc5150cf">rootMatter</a>)
<a name="l01578"></a>01578                         <a class="code" href="classcrop.html#a2ca05aa427979d52b8fbbba1cc5150cf">rootMatter</a>-&gt;<a class="code" href="classproduct.html#a18ec2e96f1d9b7cef74c4b2800ebdca1">Setamount</a>(0.0);
<a name="l01579"></a>01579 
<a name="l01580"></a>01580                 <span class="keywordtype">double</span> SoilTemp=<a class="code" href="classcrop.html#aaf7bdd66e714b1ad4057bad5a46e6772">aSoil</a>-&gt;<a class="code" href="classsoil.html#a30a2ef147290c60895e4c389ad3c72b8" title="returns the temperature at a given depth in the profile">GetTemperature</a>(200);
<a name="l01581"></a>01581 
<a name="l01582"></a>01582                 <span class="keywordflow">if</span> (<a class="code" href="classcrop.html#a3c5f4942cf46d45168caf4da80b79537">DryMatterRoot</a>&gt;0 &amp;&amp; <a class="code" href="classcrop.html#abfc8df1469f20d8084f744da461d1df5">temp</a>&gt;0 &amp;&amp; <a class="code" href="classcrop.html#a38f05d3f77cfc67ff755eb8c0d79e301">Phenology</a>-&gt;<a class="code" href="classphenology.html#a514ca53b35d3dfc3e8dc1b4841d221cf" title="return true if crop has emerged">Emerged</a>())
<a name="l01583"></a>01583                 {
<a name="l01584"></a>01584                 <span class="comment">/*if (Phenology-&gt;Anthesis())  // MEL 2007 Removed due to dying rootsystem</span>
<a name="l01585"></a>01585 <span class="comment">                         DecayRoot = 0.05;*/</span>
<a name="l01586"></a>01586                         <span class="keywordtype">double</span> DMdecay = <a class="code" href="classcrop.html#a3c5f4942cf46d45168caf4da80b79537">DryMatterRoot</a>*<a class="code" href="classcrop.html#af01aa0fd15613a9e2fcb2a23ca089d5f">TemperatureEffect</a>(SoilTemp)*<a class="code" href="classcrop.html#afe8c6c11905d19aca8f9623180b8462f">DecayRoot</a>+
<a name="l01587"></a>01587                                           RootTranslocation*<a class="code" href="classcrop.html#a252ade240154c71d644732abc9304f79">RhizoDepositFraction</a>;
<a name="l01588"></a>01588                         DMdecay = min(<a class="code" href="classcrop.html#a3c5f4942cf46d45168caf4da80b79537">DryMatterRoot</a>,DMdecay);
<a name="l01589"></a>01589 
<a name="l01590"></a>01590                         <span class="keywordflow">if</span> (DMdecay&gt;0)
<a name="l01591"></a>01591                         {
<a name="l01592"></a>01592                                 <a class="code" href="classnitrogen.html">nitrogen</a> NConcentration =  aNitrogenInRoot/<a class="code" href="classcrop.html#a3c5f4942cf46d45168caf4da80b79537">DryMatterRoot</a>;
<a name="l01593"></a>01593                                 <span class="keywordflow">if</span> (<a class="code" href="compare_8cpp.html#aa01f0fa6e5951da14ee8774259233c39">doubleLess</a>(NConcentration.<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a>,<a class="code" href="classcrop.html#acc16e034b1484f87bbc3ec3863418f83">CorrectedMinN_Root</a>(),0.000001))
<a name="l01594"></a>01594                                 {
<a name="l01595"></a>01595                                 <span class="keywordflow">if</span> (NConcentration.<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a>==0)
<a name="l01596"></a>01596                                 {
<a name="l01597"></a>01597                                         <a class="code" href="message_8h.html#a8ad29009121a629982c6ade0bd332470">theMessage</a>-&gt;<a class="code" href="classmessage.html#afed66d0552f90b4385c5169cf5929907">WarningWithDisplay</a>(<span class="stringliteral">&quot;crop::RootDecay - nitrogen concentration in roots zero&quot;</span>);
<a name="l01598"></a>01598                                         NConcentration = <a class="code" href="classcrop.html#acc16e034b1484f87bbc3ec3863418f83">CorrectedMinN_Root</a>();
<a name="l01599"></a>01599                                 }
<a name="l01600"></a>01600                                         <a class="code" href="message_8h.html#a8ad29009121a629982c6ade0bd332470">theMessage</a>-&gt;<a class="code" href="classmessage.html#afed66d0552f90b4385c5169cf5929907">WarningWithDisplay</a>(<span class="stringliteral">&quot;crop::RootDecay - nitrogen concentration in roots below possible&quot;</span>);
<a name="l01601"></a>01601                                         NConcentration = NConcentration*<a class="code" href="classcrop.html#acc16e034b1484f87bbc3ec3863418f83">CorrectedMinN_Root</a>()/NConcentration.<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a>;
<a name="l01602"></a>01602                                 }
<a name="l01603"></a>01603 
<a name="l01604"></a>01604                                 <a class="code" href="classnitrogen.html">nitrogen</a> Ndecay = NConcentration*DMdecay;
<a name="l01605"></a>01605                                 <a class="code" href="classcrop.html#a3c5f4942cf46d45168caf4da80b79537">DryMatterRoot</a>  -= DMdecay;
<a name="l01606"></a>01606                                 <a class="code" href="classcrop.html#adabbdde8753e5ae0ecd238e221429d88" title="How much Nitrogen that is in the plant.">Nitrogen</a>            = <a class="code" href="classcrop.html#adabbdde8753e5ae0ecd238e221429d88" title="How much Nitrogen that is in the plant.">Nitrogen</a> - Ndecay;
<a name="l01607"></a>01607 
<a name="l01608"></a>01608                                 <a class="code" href="classcrop.html#a2ca05aa427979d52b8fbbba1cc5150cf">rootMatter</a>-&gt;<a class="code" href="classproduct.html#a18ec2e96f1d9b7cef74c4b2800ebdca1">Setamount</a>(DMdecay/<a class="code" href="classcrop.html#a2ca05aa427979d52b8fbbba1cc5150cf">rootMatter</a>-&gt;<a class="code" href="classlive_matter.html#ad3d05f1e8ceedc99e214adca94638de0">GetdryMatter</a>());
<a name="l01609"></a>01609                                 <a class="code" href="classcrop.html#a2ca05aa427979d52b8fbbba1cc5150cf">rootMatter</a>-&gt;<a class="code" href="classlive_matter.html#adbb45be219dd863cfad2b5e97cde1508">SetorgN_content</a>(Ndecay/(DMdecay/<a class="code" href="classcrop.html#a2ca05aa427979d52b8fbbba1cc5150cf">rootMatter</a>-&gt;<a class="code" href="classlive_matter.html#ad3d05f1e8ceedc99e214adca94638de0">GetdryMatter</a>()));
<a name="l01610"></a>01610 
<a name="l01611"></a>01611                                 <span class="comment">// update budgets</span>
<a name="l01612"></a>01612                                 <a class="code" href="classcrop.html#af7ae14fac12af3efa728e789155983fb">Nbudget</a>.<a class="code" href="classbudget.html#a47bfa9740186f2be18a10dd3423a5eea">AddOutput</a>(Ndecay.n);
<a name="l01613"></a>01613                                 <a class="code" href="classcrop.html#a3e5fad944be35152e933b5e50f928f5a">N15budget</a>.<a class="code" href="classbudget.html#a47bfa9740186f2be18a10dd3423a5eea">AddOutput</a>(Ndecay.n15);
<a name="l01614"></a>01614                                 <a class="code" href="classcrop.html#a46844fd0540eb7627555f21afa8545e8">DMbudget</a>.<a class="code" href="classbudget.html#a47bfa9740186f2be18a10dd3423a5eea">AddOutput</a>(DMdecay);
<a name="l01615"></a>01615                                 <a class="code" href="classcrop.html#a29dcfc8e28d3f6689a94184c968a1882">AccumulatedRootDeposit</a>  += DMdecay;
<a name="l01616"></a>01616                                 <a class="code" href="classcrop.html#aa050617ad81407650b6bd3150b8c5b93" title="How much Nitrogen that the plant has given to the soil via roots.">AccumulatedRootNDeposit</a> = <a class="code" href="classcrop.html#aa050617ad81407650b6bd3150b8c5b93" title="How much Nitrogen that the plant has given to the soil via roots.">AccumulatedRootNDeposit</a> + Ndecay;
<a name="l01617"></a>01617 
<a name="l01618"></a>01618                         }
<a name="l01619"></a>01619                 }
<a name="l01620"></a>01620    }
<a name="l01621"></a>01621 }
<a name="l01622"></a>01622 
<a name="l01626"></a><a class="code" href="classcrop.html#a442c2c4c3198041f6480f1e6f3a1f35e">01626</a> <span class="keywordtype">void</span> <a class="code" href="classcrop.html#a442c2c4c3198041f6480f1e6f3a1f35e">crop::StreamKeyData</a>(fstream&amp; os)
<a name="l01627"></a>01627 {
<a name="l01628"></a>01628 
<a name="l01629"></a>01629 
<a name="l01630"></a>01630         <span class="keywordtype">double</span> TSum = 0.0;
<a name="l01631"></a>01631    <span class="keywordtype">double</span> DS = 0.0;
<a name="l01632"></a>01632    <span class="keywordflow">if</span> (<a class="code" href="classcrop.html#a38f05d3f77cfc67ff755eb8c0d79e301">Phenology</a>)
<a name="l01633"></a>01633    {
<a name="l01634"></a>01634         DS = <a class="code" href="classcrop.html#a38f05d3f77cfc67ff755eb8c0d79e301">Phenology</a>-&gt;<a class="code" href="classphenology.html#afdc8ea11c9fcb90491341ed8e70d2927" title="development stage">DS</a>;
<a name="l01635"></a>01635       TSum = <a class="code" href="classcrop.html#a38f05d3f77cfc67ff755eb8c0d79e301">Phenology</a>-&gt;<a class="code" href="classphenology.html#ac59e649ce2b4cede632496fbc6de53e1" title="Temperature sum for leaf expansion (used in linear growth)">TempSumForLeaf</a>;
<a name="l01636"></a>01636 
<a name="l01637"></a>01637    }
<a name="l01638"></a>01638 
<a name="l01639"></a>01639    os &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <a class="code" href="classcrop.html#af852d2f62dd22411199ae8e164536a7d">CropName</a>
<a name="l01640"></a>01640       &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; DS
<a name="l01641"></a>01641       &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; TSum
<a name="l01642"></a>01642      &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <a class="code" href="climate_8h.html#ad05fb99191dc4a9cb94e7f8c99280389">theClimate</a>-&gt;<a class="code" href="classclimate.html#a14e9a0d27f51b514217508b04f53ca04">GetCO2Concentration</a>()
<a name="l01643"></a>01643       &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <a class="code" href="classcrop.html#a2691a60a48a5166469df5da0e0e824fb">GreenCropAreaIndex</a>
<a name="l01644"></a>01644       &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <a class="code" href="classcrop.html#a7acb3fa412808c819f4d9b662cc2148c">YellowCropAreaIndex</a>
<a name="l01645"></a>01645       &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <a class="code" href="classcrop.html#a3c5f4942cf46d45168caf4da80b79537">DryMatterRoot</a>;
<a name="l01646"></a>01646   os    &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <a class="code" href="classcrop.html#a45017219012e2e4865e53c406ca32756">GiveRootInInterval</a>(0.0,0.3, DryMatterRoot);
<a name="l01647"></a>01647    <span class="keywordflow">if</span> ((<a class="code" href="classcrop.html#af852d2f62dd22411199ae8e164536a7d">CropName</a> == <span class="stringliteral">&quot;Beet&quot;</span>) || (<a class="code" href="classcrop.html#af852d2f62dd22411199ae8e164536a7d">CropName</a> == <span class="stringliteral">&quot;Potato&quot;</span>) || (<a class="code" href="classcrop.html#af852d2f62dd22411199ae8e164536a7d">CropName</a> == <span class="stringliteral">&quot;OilRadish&quot;</span>))
<a name="l01648"></a>01648         os      &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <a class="code" href="classcrop.html#ab8db7f88fbd260a4e8b7dbb735490753">GiveDryMatterStorage</a>()+ <a class="code" href="classcrop.html#aceebd864d8c9058698b7f93ae413c45d">GiveDryMatterRoot</a>();
<a name="l01649"></a>01649    <span class="keywordflow">else</span>
<a name="l01650"></a>01650         os &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <a class="code" href="classcrop.html#aceebd864d8c9058698b7f93ae413c45d">GiveDryMatterRoot</a>();
<a name="l01651"></a>01651    os &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <a class="code" href="classcrop.html#a8442897ed98c68b6821a17ce3adc38e8">GiveDryMatterVegTop</a>()
<a name="l01652"></a>01652       &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <a class="code" href="classcrop.html#a4a2803c0618d2f662abfa8d230c811df">DryMatterStorage</a>;
<a name="l01653"></a>01653    <span class="keywordflow">if</span> ((<a class="code" href="classcrop.html#af852d2f62dd22411199ae8e164536a7d">CropName</a> == <span class="stringliteral">&quot;Beet&quot;</span>) || (<a class="code" href="classcrop.html#af852d2f62dd22411199ae8e164536a7d">CropName</a> == <span class="stringliteral">&quot;Potato&quot;</span>) || (<a class="code" href="classcrop.html#af852d2f62dd22411199ae8e164536a7d">CropName</a> == <span class="stringliteral">&quot;OilRadish&quot;</span>))  <span class="comment">// Dry matter of total top</span>
<a name="l01654"></a>01654         os      &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <a class="code" href="classcrop.html#a8442897ed98c68b6821a17ce3adc38e8">GiveDryMatterVegTop</a>();
<a name="l01655"></a>01655    <span class="keywordflow">else</span>
<a name="l01656"></a>01656         os &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; DryMatterStorage+<a class="code" href="classcrop.html#a8442897ed98c68b6821a17ce3adc38e8">GiveDryMatterVegTop</a>();
<a name="l01657"></a>01657 
<a name="l01658"></a>01658       os &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <a class="code" href="classcrop.html#a461228045f8a07f1f12a06acd12adf89">TranspirationRatio</a>
<a name="l01659"></a>01659      &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <a class="code" href="classcrop.html#ac135f27391332e8666ab14a3fc345f15">IrrigationDemand</a>()
<a name="l01660"></a>01660       &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <a class="code" href="classcrop.html#a3f40980535ac184d9cced18aff1a0f8c">PlantHeight</a>
<a name="l01661"></a>01661       &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <a class="code" href="classcrop.html#aefe9049cee98b6ac81f4362c4a1190a9">RootDepth</a>
<a name="l01662"></a>01662       &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <a class="code" href="classcrop.html#a1f0aa4443cf11cdf5776454bd056fa28">TotalRootLength</a>
<a name="l01663"></a>01663       &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <a class="code" href="classcrop.html#af42802c05fc1e8dcba94d04bcb41f163">InterceptedRadiation</a>
<a name="l01664"></a>01664       &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <a class="code" href="classcrop.html#adabbdde8753e5ae0ecd238e221429d88" title="How much Nitrogen that is in the plant.">Nitrogen</a>.<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a>
<a name="l01665"></a>01665       &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <a class="code" href="classcrop.html#a82bef6e98553aa173173b0ea454a3e0a">NitrogenInVegTop</a>().<a class="code" href="classnitrogen.html#a2d537cc848da50f09b7580539f261dfc">n15</a>
<a name="l01666"></a>01666       &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <a class="code" href="classcrop.html#adc9f2a384dfd4be26746b822c4324f37">Nmin</a>()
<a name="l01667"></a>01667       &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <a class="code" href="classcrop.html#a6416f0baf1364f2cf28f312584c39f73">Nmax</a>()
<a name="l01668"></a>01668       &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <a class="code" href="classcrop.html#a4f4f31c68a905ef3fef26b9d7456cb36">NitrogenInStorage</a>().<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a>;
<a name="l01669"></a>01669 <span class="keywordflow">if</span> ((<a class="code" href="classcrop.html#af852d2f62dd22411199ae8e164536a7d">CropName</a> == <span class="stringliteral">&quot;Beet&quot;</span>) || (<a class="code" href="classcrop.html#af852d2f62dd22411199ae8e164536a7d">CropName</a> == <span class="stringliteral">&quot;Potato&quot;</span>) || (<a class="code" href="classcrop.html#af852d2f62dd22411199ae8e164536a7d">CropName</a> == <span class="stringliteral">&quot;OilRadish&quot;</span>))     <span class="comment">//Nitrogen in total top</span>
<a name="l01670"></a>01670         os      &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <a class="code" href="classcrop.html#a82bef6e98553aa173173b0ea454a3e0a">NitrogenInVegTop</a>().<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a>;
<a name="l01671"></a>01671    <span class="keywordflow">else</span>
<a name="l01672"></a>01672         os &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; (<a class="code" href="classcrop.html#a82bef6e98553aa173173b0ea454a3e0a">NitrogenInVegTop</a>()+<a class="code" href="classcrop.html#a4f4f31c68a905ef3fef26b9d7456cb36">NitrogenInStorage</a>()).n;
<a name="l01673"></a>01673 
<a name="l01674"></a>01674       os &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <a class="code" href="classcrop.html#a82bef6e98553aa173173b0ea454a3e0a">NitrogenInVegTop</a>().<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a>
<a name="l01675"></a>01675       &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <a class="code" href="classcrop.html#ad0404629e0ae80c88ae7b99ff50cfdca">NitrogenInRoot</a>().<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a>
<a name="l01676"></a>01676       &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <a class="code" href="classcrop.html#a45017219012e2e4865e53c406ca32756">GiveRootInInterval</a>(0.0,0.3, <a class="code" href="classcrop.html#ad0404629e0ae80c88ae7b99ff50cfdca">NitrogenInRoot</a>().n);
<a name="l01677"></a>01677    <span class="keywordflow">if</span> ((<a class="code" href="classcrop.html#af852d2f62dd22411199ae8e164536a7d">CropName</a> == <span class="stringliteral">&quot;Beet&quot;</span>) || (<a class="code" href="classcrop.html#af852d2f62dd22411199ae8e164536a7d">CropName</a> == <span class="stringliteral">&quot;Potato&quot;</span>) || (<a class="code" href="classcrop.html#af852d2f62dd22411199ae8e164536a7d">CropName</a> == <span class="stringliteral">&quot;OilRadish&quot;</span>))      <span class="comment">// Nitrogen in roots and tubers</span>
<a name="l01678"></a>01678         os &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <a class="code" href="classcrop.html#a4f4f31c68a905ef3fef26b9d7456cb36">NitrogenInStorage</a>().<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a>+ <a class="code" href="classcrop.html#ad0404629e0ae80c88ae7b99ff50cfdca">NitrogenInRoot</a>().<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a>;
<a name="l01679"></a>01679    <span class="keywordflow">else</span>
<a name="l01680"></a>01680       os &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <a class="code" href="classcrop.html#ad0404629e0ae80c88ae7b99ff50cfdca">NitrogenInRoot</a>().<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a>;
<a name="l01681"></a>01681    <span class="keywordflow">if</span> (<a class="code" href="classcrop.html#adabbdde8753e5ae0ecd238e221429d88" title="How much Nitrogen that is in the plant.">Nitrogen</a>.<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a>&gt;0)
<a name="l01682"></a>01682          os &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <a class="code" href="classcrop.html#a602622ac2c0de6432e6b9438dbbb646b">fNitrogen</a>()
<a name="l01683"></a>01683             &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <a class="code" href="classcrop.html#a3bcfac5c51663141e42b2d6bd17a2cb6">fNitrogenCurve</a>();
<a name="l01684"></a>01684    <span class="keywordflow">else</span>
<a name="l01685"></a>01685         os &lt;&lt; <span class="stringliteral">&quot;\t1\t1&quot;</span>;
<a name="l01686"></a>01686    os &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <a class="code" href="classcrop.html#a29dcfc8e28d3f6689a94184c968a1882">AccumulatedRootDeposit</a>
<a name="l01687"></a>01687       &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <a class="code" href="classcrop.html#a15b020b5308e854371c7919b1ebe64ab">RootTranslocation</a>
<a name="l01688"></a>01688       &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <a class="code" href="classcrop.html#aa050617ad81407650b6bd3150b8c5b93" title="How much Nitrogen that the plant has given to the soil via roots.">AccumulatedRootNDeposit</a>.<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a>
<a name="l01689"></a>01689       &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <a class="code" href="classcrop.html#a9bf4f47a0a193df878aa15b364dbec14">AccumulatedTopDeposit</a>
<a name="l01690"></a>01690         &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <a class="code" href="classcrop.html#ad9583ee2f76a5141a1a54ebea83627fe" title="How much Nitrogen that the plant gives to the ground via dead leafs.">AccumulatedTopNDeposit</a>.<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a>
<a name="l01691"></a>01691       &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <a class="code" href="classcrop.html#ac9e8384797116e758558faff120ae56d">AccumulatedDMProduction</a>
<a name="l01692"></a>01692         &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <a class="code" href="classcrop.html#ac99038132c4676e35b98265edb34a213" title="Noone knows that this is.">AccumulatedNProduction</a>.<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a>
<a name="l01693"></a>01693       &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <a class="code" href="classcrop.html#aec045be7b4c6fd112b48ead6ee68dcd9">GetNFixationThisDay</a>()
<a name="l01694"></a>01694         &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <a class="code" href="classcrop.html#ad4c7a7759997919efa9c9befb53cab69">AccumulatedNFixation</a>
<a name="l01695"></a>01695       &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <a class="code" href="classcrop.html#a0491b172b4874adcd1b3930cb3be00fe">DeltaDMTop</a>
<a name="l01696"></a>01696       &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <a class="code" href="classcrop.html#ad0404629e0ae80c88ae7b99ff50cfdca">NitrogenInRoot</a>().<a class="code" href="classnitrogen.html#ac97f3ebad4801a13a7c444bab3b3a886">Get15NRatio</a>()
<a name="l01697"></a>01697       &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <a class="code" href="classcrop.html#a9342a07dc579e1e3169eba7060741339">AccumulatedRootRespiration</a>;
<a name="l01698"></a>01698 
<a name="l01699"></a>01699                 <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0;i&lt;<a class="code" href="output_data_8h.html#aadc9d3b76fa69bf28c5ab340dd810e20">theOutputData</a>-&gt;<a class="code" href="classoutput_data.html#a52a733aa57217c278df4d06e50c48ad8">RootData</a>.size();i++)
<a name="l01700"></a>01700                 {
<a name="l01701"></a>01701                         <span class="keywordtype">double</span> StartDepth = <a class="code" href="output_data_8h.html#aadc9d3b76fa69bf28c5ab340dd810e20">theOutputData</a>-&gt;<a class="code" href="classoutput_data.html#a52a733aa57217c278df4d06e50c48ad8">RootData</a>[i].getStartDepth()/1000;
<a name="l01702"></a>01702                         <span class="keywordtype">double</span> Thickness = <a class="code" href="output_data_8h.html#aadc9d3b76fa69bf28c5ab340dd810e20">theOutputData</a>-&gt;<a class="code" href="classoutput_data.html#a52a733aa57217c278df4d06e50c48ad8">RootData</a>[i].getEndDepth()/1000-StartDepth;
<a name="l01703"></a>01703          os &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <a class="code" href="classcrop.html#a72e68283aa65578e991092da749c6f44">RootLengthInInterval</a>(StartDepth, Thickness)
<a name="l01704"></a>01704                                 &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <a class="code" href="classcrop.html#a45017219012e2e4865e53c406ca32756">GiveRootInInterval</a>(StartDepth, Thickness, DryMatterRoot)
<a name="l01705"></a>01705                 &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <a class="code" href="classcrop.html#a45017219012e2e4865e53c406ca32756">GiveRootInInterval</a>(StartDepth, Thickness, <a class="code" href="classcrop.html#ad0404629e0ae80c88ae7b99ff50cfdca">NitrogenInRoot</a>().n);
<a name="l01706"></a>01706       }
<a name="l01707"></a>01707 
<a name="l01708"></a>01708 
<a name="l01709"></a>01709 
<a name="l01710"></a>01710 }
<a name="l01711"></a>01711 <span class="comment">/****************************************************************************\</span>
<a name="l01712"></a>01712 <span class="comment">\****************************************************************************/</span>
<a name="l01713"></a><a class="code" href="classcrop.html#a8c3a80a0de839c07691add129dbacafa">01713</a> <span class="keywordtype">void</span> <a class="code" href="classcrop.html#a8c3a80a0de839c07691add129dbacafa">crop::StartBudget</a>()
<a name="l01714"></a>01714 {
<a name="l01715"></a>01715         <a class="code" href="classcrop.html#af7ae14fac12af3efa728e789155983fb">Nbudget</a>.<a class="code" href="classbudget.html#a885260b83f245dee43a1e6ee70a4c68d">SetInput</a>(<a class="code" href="classcrop.html#adabbdde8753e5ae0ecd238e221429d88" title="How much Nitrogen that is in the plant.">Nitrogen</a>.<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a>);
<a name="l01716"></a>01716         <a class="code" href="classcrop.html#a3e5fad944be35152e933b5e50f928f5a">N15budget</a>.<a class="code" href="classbudget.html#a885260b83f245dee43a1e6ee70a4c68d">SetInput</a>(<a class="code" href="classcrop.html#adabbdde8753e5ae0ecd238e221429d88" title="How much Nitrogen that is in the plant.">Nitrogen</a>.<a class="code" href="classnitrogen.html#a2d537cc848da50f09b7580539f261dfc">n15</a>);
<a name="l01717"></a>01717         <a class="code" href="classcrop.html#a46844fd0540eb7627555f21afa8545e8">DMbudget</a>.<a class="code" href="classbudget.html#a885260b83f245dee43a1e6ee70a4c68d">SetInput</a>(<a class="code" href="classcrop.html#a755b12e801a538bb34a8c7b829047e76">DryMatterVegTop</a>+<a class="code" href="classcrop.html#a3c5f4942cf46d45168caf4da80b79537">DryMatterRoot</a>+<a class="code" href="classcrop.html#a4a2803c0618d2f662abfa8d230c811df">DryMatterStorage</a>);
<a name="l01718"></a>01718         <a class="code" href="classcrop.html#af7ae14fac12af3efa728e789155983fb">Nbudget</a>.<a class="code" href="classbudget.html#a28fc928b65aef6475ad0dee374bbb7f2">SetOutput</a>(0);
<a name="l01719"></a>01719         <a class="code" href="classcrop.html#a3e5fad944be35152e933b5e50f928f5a">N15budget</a>.<a class="code" href="classbudget.html#a28fc928b65aef6475ad0dee374bbb7f2">SetOutput</a>(0);
<a name="l01720"></a>01720         <a class="code" href="classcrop.html#a46844fd0540eb7627555f21afa8545e8">DMbudget</a>.<a class="code" href="classbudget.html#a28fc928b65aef6475ad0dee374bbb7f2">SetOutput</a>(0);
<a name="l01721"></a>01721 }
<a name="l01722"></a>01722 
<a name="l01727"></a><a class="code" href="classcrop.html#aaacb9f08e608ce328d60a25813a49ca5">01727</a> <span class="keywordtype">bool</span> <a class="code" href="classcrop.html#aaacb9f08e608ce328d60a25813a49ca5">crop::EndBudget</a>(<span class="keywordtype">double</span> * NRemain, <span class="keywordtype">double</span> * DMRemain)
<a name="l01728"></a>01728 {
<a name="l01729"></a>01729         <span class="keywordtype">bool</span> retVal=<span class="keyword">true</span>;
<a name="l01730"></a>01730         *NRemain=<a class="code" href="classcrop.html#adabbdde8753e5ae0ecd238e221429d88" title="How much Nitrogen that is in the plant.">Nitrogen</a>.<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a>;
<a name="l01731"></a>01731         *DMRemain=<a class="code" href="classcrop.html#a8442897ed98c68b6821a17ce3adc38e8">GiveDryMatterVegTop</a>()+<a class="code" href="classcrop.html#a3c5f4942cf46d45168caf4da80b79537">DryMatterRoot</a>+<a class="code" href="classcrop.html#a4a2803c0618d2f662abfa8d230c811df">DryMatterStorage</a>+<a class="code" href="classcrop.html#a2dfb21c27aff36f3049be9a39e7c6538">SeedDM</a>;
<a name="l01732"></a>01732    <span class="keywordflow">if</span> (!<a class="code" href="classcrop.html#af7ae14fac12af3efa728e789155983fb">Nbudget</a>.<a class="code" href="classbudget.html#a2814c71d2d504462defc2c85f2cd86b2">Balance</a>(*NRemain))
<a name="l01733"></a>01733         retVal=<span class="keyword">false</span>;
<a name="l01734"></a>01734    <span class="keywordflow">if</span> (!<a class="code" href="classcrop.html#a46844fd0540eb7627555f21afa8545e8">DMbudget</a>.<a class="code" href="classbudget.html#a2814c71d2d504462defc2c85f2cd86b2">Balance</a>(*DMRemain))
<a name="l01735"></a>01735    {
<a name="l01736"></a>01736         retVal=<span class="keyword">false</span>;
<a name="l01737"></a>01737       cout &lt;&lt; <span class="stringliteral">&quot;Dry matter &quot;</span> &lt;&lt; <a class="code" href="classcrop.html#a8442897ed98c68b6821a17ce3adc38e8">GiveDryMatterVegTop</a>() &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="classcrop.html#a3c5f4942cf46d45168caf4da80b79537">DryMatterRoot</a>
<a name="l01738"></a>01738            &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="classcrop.html#a4a2803c0618d2f662abfa8d230c811df">DryMatterStorage</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; SeedDM &lt;&lt; endl; <span class="comment">// !!!!!!</span>
<a name="l01739"></a>01739       cout &lt;&lt; <span class="stringliteral">&quot;&quot;</span>;
<a name="l01740"></a>01740    }
<a name="l01741"></a>01741    <span class="keywordtype">double</span> N15Remain = <a class="code" href="classcrop.html#adabbdde8753e5ae0ecd238e221429d88" title="How much Nitrogen that is in the plant.">Nitrogen</a>.<a class="code" href="classnitrogen.html#a2d537cc848da50f09b7580539f261dfc">n15</a>;
<a name="l01742"></a>01742    <span class="keywordflow">if</span> (!<a class="code" href="classcrop.html#a3e5fad944be35152e933b5e50f928f5a">N15budget</a>.<a class="code" href="classbudget.html#a2814c71d2d504462defc2c85f2cd86b2">Balance</a>(N15Remain))
<a name="l01743"></a>01743         retVal=<span class="keyword">false</span>;
<a name="l01744"></a>01744    <span class="keywordflow">return</span> retVal;
<a name="l01745"></a>01745 }
<a name="l01746"></a>01746 
<a name="l01750"></a><a class="code" href="classcrop.html#a5b2a6a3522c64790e295055ff164dc10">01750</a> <span class="keywordtype">void</span> <a class="code" href="classcrop.html#a5b2a6a3522c64790e295055ff164dc10" title="harvest vegetation above a certain height. Is used for forage crops. Not currently used...">crop::Cut</a>(<a class="code" href="classplant_item.html">plantItem</a> * cutPlantMaterial, <span class="keywordtype">double</span> CutHeight)
<a name="l01751"></a>01751 {
<a name="l01752"></a>01752    cout &lt;&lt; <a class="code" href="classbase.html#aae39ec3da4311af6b93e424d29b2c66a">GetLongName</a>();
<a name="l01753"></a>01753    <a class="code" href="message_8h.html#a8ad29009121a629982c6ade0bd332470">theMessage</a>-&gt;<a class="code" href="classmessage.html#af9891cb7111375e6a36363afffb09d63">FatalError</a>(<span class="stringliteral">&quot;crop::Cut - this function should never be called, use &#39;Harvest&#39; instead&quot;</span>);
<a name="l01754"></a>01754 }
<a name="l01755"></a>01755 
<a name="l01760"></a><a class="code" href="classcrop.html#a0e9bb36caf25761c567dd2c59e3afccd">01760</a> <span class="keywordtype">double</span> <a class="code" href="classcrop.html#a0e9bb36caf25761c567dd2c59e3afccd">crop::PotentialDryMatter</a>(<span class="keywordtype">double</span> radiation, <span class="keywordtype">double</span> temperature)
<a name="l01761"></a>01761 {
<a name="l01762"></a>01762    <span class="keywordtype">double</span> CO2conc = <a class="code" href="climate_8h.html#ad05fb99191dc4a9cb94e7f8c99280389">theClimate</a>-&gt;<a class="code" href="classclimate.html#a14e9a0d27f51b514217508b04f53ca04">GetCO2Concentration</a>();
<a name="l01763"></a>01763         <span class="keywordtype">double</span> retVal, CO2PhotEffect=1.0;
<a name="l01764"></a>01764 
<a name="l01765"></a>01765    <span class="keywordflow">if</span>(!<a class="code" href="classcrop.html#aef5d855a21b1f0227b429764dea1c8fe" title="Describe if the crop is a C4 crop (CO2 effect only on C3 crops)">C4Photosynthesis</a>)
<a name="l01766"></a>01766       CO2PhotEffect = <a class="code" href="classcrop.html#a40992582378c797a8b5a4b8d9aef6d2b">CO2Effect</a>*exp(0.4537-170.97/CO2conc);
<a name="l01767"></a>01767 
<a name="l01768"></a>01768    retVal=radiation*<a class="code" href="classcrop.html#a23c5f9e6bead96515b31e977405637d8">PhotoSyntActPart</a>*<a class="code" href="classcrop.html#ace1e4d77fd9e80f3cd5c301927e03630">MaxRadUseEff</a>
<a name="l01769"></a>01769           *CO2PhotEffect
<a name="l01770"></a>01770           *<a class="code" href="classcrop.html#a9ff0b086b54afd4c235cb80a9a080d05">fTW</a>(temperature);
<a name="l01771"></a>01771 
<a name="l01772"></a>01772    <span class="keywordflow">return</span> retVal;
<a name="l01773"></a>01773 }
</pre></div></div>
</div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address class="footer"><small>Generated on Mon Aug 22 2011 10:28:56 for Fasset by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
