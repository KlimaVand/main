<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Fasset: C:/main/trunk/src/manager/grazingManager.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.4 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Fasset</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">C:/main/trunk/src/manager/grazingManager.cpp</div>  </div>
</div>
<div class="contents">
<a href="grazing_manager_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/****************************************************************************\</span>
<a name="l00002"></a>00002 <span class="comment"> $URL$</span>
<a name="l00003"></a>00003 <span class="comment"> $LastChangedDate$</span>
<a name="l00004"></a>00004 <span class="comment"> $LastChangedRevision$</span>
<a name="l00005"></a>00005 <span class="comment"> $LastChangedBy$</span>
<a name="l00006"></a>00006 <span class="comment">\****************************************************************************/</span>
<a name="l00007"></a>00007 <span class="comment">//Warning! This class currently contains various nasty hardcodings</span>
<a name="l00008"></a>00008 <span class="comment">//Should be restructured now that all cattle are instanced as dairy</span>
<a name="l00009"></a>00009 
<a name="l00010"></a>00010 <span class="comment">// Class: grazing_manager_class</span>
<a name="l00011"></a>00011 <span class="preprocessor">#include &quot;../base/common.h&quot;</span>
<a name="l00012"></a>00012 <span class="preprocessor">#include &quot;<a class="code" href="grazing_manager_8h.html">grazingManager.h</a>&quot;</span>
<a name="l00013"></a>00013 <span class="preprocessor">#include &quot;../building/stable.h&quot;</span>
<a name="l00014"></a>00014 <span class="preprocessor">#include &quot;../fields/field.h&quot;</span>
<a name="l00015"></a>00015 <span class="preprocessor">#include &quot;../fields/patch.h&quot;</span>
<a name="l00016"></a>00016 <span class="preprocessor">#include &quot;../base/climate.h&quot;</span>
<a name="l00017"></a>00017 
<a name="l00018"></a>00018 <span class="preprocessor">#include &quot;../base/nixcbits.h&quot;</span>
<a name="l00019"></a>00019 <span class="preprocessor">#include &quot;../data/outputData.h&quot;</span>
<a name="l00020"></a>00020 <span class="preprocessor">#include &quot;../data/systemData.h&quot;</span>
<a name="l00021"></a>00021 
<a name="l00022"></a>00022 <span class="comment">/*******************************************************************</span>
<a name="l00023"></a>00023 <span class="comment">********************************************************************/</span>
<a name="l00024"></a><a class="code" href="classgrazing_manager.html#a278deab30e954617cdd90a482e309f3f">00024</a> <a class="code" href="classgrazing_manager.html#a278deab30e954617cdd90a482e309f3f">grazingManager::grazingManager</a> ():<a class="code" href="classbase.html">base</a>()
<a name="l00025"></a>00025 {
<a name="l00026"></a>00026   fields_to_graze= <span class="keyword">new</span> <a class="code" href="classlink_list.html">linkList &lt;field&gt;</a>;
<a name="l00027"></a>00027   fields_avail_to_graze= <span class="keyword">new</span> <a class="code" href="classlink_list.html">linkList &lt;field&gt;</a>;
<a name="l00028"></a>00028   theCattle = <span class="keyword">new</span> <a class="code" href="classlink_list.html">linkList &lt;dairyStock&gt;</a>;
<a name="l00029"></a>00029 
<a name="l00030"></a>00030 
<a name="l00031"></a>00031   ExpectedSilageHolding = 0.0;
<a name="l00032"></a>00032 
<a name="l00033"></a>00033   initialised = <span class="keyword">false</span>;
<a name="l00034"></a>00034   growthStart = NULL;
<a name="l00035"></a>00035   growthEnd = NULL;
<a name="l00036"></a>00036   targetCutMass[0]=2.5;
<a name="l00037"></a>00037   targetCutMass[1]=2.0;
<a name="l00038"></a>00038   periodEnd=NULL;
<a name="l00039"></a>00039   maxPeriods = 10;
<a name="l00040"></a>00040   SilageMade =0.0;
<a name="l00041"></a>00041   grazmanfile=NULL;
<a name="l00042"></a>00042   residualDM=0.0;
<a name="l00043"></a>00043   minHarvestable=0.0;
<a name="l00044"></a>00044 
<a name="l00045"></a>00045 
<a name="l00046"></a>00046   lowerGrazingLimit=0.0;
<a name="l00047"></a>00047   upperGrazingLimit=0.0;
<a name="l00048"></a>00048 }
<a name="l00049"></a>00049 
<a name="l00050"></a>00050 <span class="comment">/*******************************************************************</span>
<a name="l00051"></a>00051 <span class="comment">********************************************************************/</span>
<a name="l00052"></a><a class="code" href="classgrazing_manager.html#ae9e0a96a199a9e571fed2f9728444885">00052</a> <a class="code" href="classgrazing_manager.html#ae9e0a96a199a9e571fed2f9728444885">grazingManager::~grazingManager</a>()
<a name="l00053"></a>00053 {
<a name="l00054"></a>00054  fields_to_graze-&gt;<a class="code" href="classlink_list.html#a8005163404c8378ebb3b34d0e21da338" title="Delete all notes without deleting the elements.">ForgetAll</a>();
<a name="l00055"></a>00055  fields_avail_to_graze-&gt;<a class="code" href="classlink_list.html#a8005163404c8378ebb3b34d0e21da338" title="Delete all notes without deleting the elements.">ForgetAll</a>();
<a name="l00056"></a>00056  theCattle-&gt;<a class="code" href="classlink_list.html#a8005163404c8378ebb3b34d0e21da338" title="Delete all notes without deleting the elements.">ForgetAll</a>();
<a name="l00057"></a>00057  <span class="keyword">delete</span> fields_to_graze;
<a name="l00058"></a>00058  <span class="keyword">delete</span> fields_avail_to_graze;
<a name="l00059"></a>00059 
<a name="l00060"></a>00060  <span class="keyword">delete</span> theCattle;
<a name="l00061"></a>00061  <span class="keyword">delete</span> growthStart;
<a name="l00062"></a>00062  <span class="keyword">delete</span> growthEnd;
<a name="l00063"></a>00063  <span class="keywordflow">if</span> (grazmanfile)
<a name="l00064"></a>00064         grazmanfile-&gt;close();
<a name="l00065"></a>00065  <span class="keyword">delete</span> grazmanfile;
<a name="l00066"></a>00066 }
<a name="l00067"></a>00067 
<a name="l00068"></a>00068 <span class="comment">/*******************************************************************</span>
<a name="l00069"></a>00069 <span class="comment">created 1.5.00 by NJH</span>
<a name="l00070"></a>00070 <span class="comment">call after all livestock, fields and animal housing  etc are created</span>
<a name="l00071"></a>00071 <span class="comment">********************************************************************/</span>
<a name="l00072"></a><a class="code" href="classgrazing_manager.html#a8929fd866876ba054eeeb2dfd02e688b">00072</a> <span class="keywordtype">void</span> <a class="code" href="classgrazing_manager.html#a8929fd866876ba054eeeb2dfd02e688b">grazingManager::Initialize</a>(<a class="code" href="classlivestock.html">livestock</a> * theLivestockptr,
<a name="l00073"></a>00073                                                                            <a class="code" href="classcrop_rotation.html">cropRotation</a> * theCropRotationptr,
<a name="l00074"></a>00074                               <a class="code" href="classbuildings.html">buildings</a> * theBuildingsptr, <a class="code" href="classcattle_feeding_manager.html">cattleFeedingManager</a> * theCattleFeedingManagerptr)
<a name="l00075"></a>00075 {
<a name="l00076"></a>00076         theLivestock = theLivestockptr;
<a name="l00077"></a>00077         theCropRotation = theCropRotationptr;
<a name="l00078"></a>00078         theBuildings = theBuildingsptr;
<a name="l00079"></a>00079    theCattleFeedingManager = theCattleFeedingManagerptr;
<a name="l00080"></a>00080 
<a name="l00081"></a>00081    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;theLivestock -&gt;<a class="code" href="classlivestock.html#a99ae9948a427d2119fbc60ee9a64bf75">getanimalStock</a>()-&gt;<a class="code" href="classlink_list.html#aee3f890e4e8f48db1518e5114d5bcca8" title="Returned total number of nodes.">NumOfNodes</a>();i++)
<a name="l00082"></a>00082    {
<a name="l00083"></a>00083            <span class="keywordflow">if</span> (strcmp(theLivestock -&gt;getanimalStock()-&gt;ElementAtNumber(i)-&gt;<a class="code" href="classbase.html#a5b4079d3eb535e704fcaed3016c76ecb">GetName</a>(),<span class="stringliteral">&quot;DairyStock&quot;</span>)==0)
<a name="l00084"></a>00084       <span class="comment">//only if dairy animals are present</span>
<a name="l00085"></a>00085         {
<a name="l00086"></a>00086          <span class="comment">//store address of the DairyStock instance in theCattle</span>
<a name="l00087"></a>00087               theCattle-&gt;<a class="code" href="classlink_list.html#a5ef6013a096b9065c2c362fcd5113413" title="Inserts a new node at the end of the list.">InsertLast</a>((<a class="code" href="classdairy_stock.html">dairyStock</a> *) theLivestock -&gt;getanimalStock()-&gt;ElementAtNumber(i));
<a name="l00088"></a>00088                 }
<a name="l00089"></a>00089 
<a name="l00090"></a>00090       <span class="keywordflow">if</span> (strcmp(theLivestock -&gt;getanimalStock()-&gt;ElementAtNumber(i)-&gt;<a class="code" href="classbase.html#a5b4079d3eb535e704fcaed3016c76ecb">GetName</a>(),<span class="stringliteral">&quot;BeefStock&quot;</span>)==0)
<a name="l00091"></a>00091          <span class="comment">//only if beef animals are present</span>
<a name="l00092"></a>00092          {
<a name="l00093"></a>00093             <span class="comment">//store address of the DairyStock instance in theCattle</span>
<a name="l00094"></a>00094             theCattle-&gt;<a class="code" href="classlink_list.html#a5ef6013a096b9065c2c362fcd5113413" title="Inserts a new node at the end of the list.">InsertLast</a>((<a class="code" href="classdairy_stock.html">dairyStock</a> *) theLivestock -&gt;getanimalStock()-&gt;ElementAtNumber(i));
<a name="l00095"></a>00095          }
<a name="l00096"></a>00096         }
<a name="l00097"></a>00097 
<a name="l00098"></a>00098 <span class="comment">//   InitialiseGrowthEstimates();</span>
<a name="l00099"></a>00099    currentPeriod=0;
<a name="l00100"></a>00100    <span class="keywordflow">if</span> ((<a class="code" href="output_data_8h.html#aadc9d3b76fa69bf28c5ab340dd810e20">theOutputData</a>-&gt;<a class="code" href="classoutput_data.html#ae50b979972f6c57c3881edd6a7dd96b4">DetailsData</a>.<a class="code" href="classoutput_details.html#a6f2663357cecc863a74ffa3b36edbdfa">getPastureDetails</a>())&amp;&amp; (!grazmanfile))
<a name="l00101"></a>00101         <a class="code" href="classgrazing_manager.html#a2facc8dfbfbbcd8f9fec21fe5d58c942">InitialiseFileOutput</a>();
<a name="l00102"></a>00102 }
<a name="l00103"></a>00103 
<a name="l00104"></a>00104 <span class="comment">/*******************************************************************</span>
<a name="l00105"></a>00105 <span class="comment">********************************************************************/</span>
<a name="l00106"></a><a class="code" href="classgrazing_manager.html#a0790c1be6eea4fbc391a89814b7dac99">00106</a> <span class="keywordtype">void</span> <a class="code" href="classgrazing_manager.html#a0790c1be6eea4fbc391a89814b7dac99">grazingManager::HouseAnimals</a>()
<a name="l00107"></a>00107 {
<a name="l00108"></a>00108 <span class="comment">// Associates animals with animal housing</span>
<a name="l00109"></a>00109    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;theCattle-&gt;<a class="code" href="classlink_list.html#aee3f890e4e8f48db1518e5114d5bcca8" title="Returned total number of nodes.">NumOfNodes</a>();i++)
<a name="l00110"></a>00110    {
<a name="l00111"></a>00111       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0;j&lt;theCattle-&gt;<a class="code" href="classlink_list.html#a5735a6e54a2eed841bdf1fdb52aed03f" title="Return the address of the node with a given logical number in the list.">ElementAtNumber</a>(i)-&gt;<a class="code" href="classdairy_stock.html#aa0df5d9ea7cd74dd41369e4830548fb8">GetCattleGroup</a>()-&gt;<a class="code" href="classlink_list.html#aee3f890e4e8f48db1518e5114d5bcca8" title="Returned total number of nodes.">NumOfNodes</a>();j++)
<a name="l00112"></a>00112       {
<a name="l00113"></a>00113          <a class="code" href="classcattle_group.html">cattleGroup</a> * aGroup = theCattle-&gt;<a class="code" href="classlink_list.html#a5735a6e54a2eed841bdf1fdb52aed03f" title="Return the address of the node with a given logical number in the list.">ElementAtNumber</a>(i)-&gt;<a class="code" href="classdairy_stock.html#aa0df5d9ea7cd74dd41369e4830548fb8">GetCattleGroup</a>()-&gt;<a class="code" href="classlink_list.html#a5735a6e54a2eed841bdf1fdb52aed03f" title="Return the address of the node with a given logical number in the list.">ElementAtNumber</a>(j);
<a name="l00114"></a>00114          <span class="comment">//note that number of animals is currently an integer here</span>
<a name="l00115"></a>00115          <span class="keywordtype">double</span> aNumberOfAnimals = (double) aGroup-&gt;<a class="code" href="classcattle_group.html#aeb189fcd248d7444d6e23a3f5c36a8ef">GetnumberOfAnimals</a>();
<a name="l00116"></a>00116          <span class="keywordflow">if</span> (aNumberOfAnimals&gt;0)
<a name="l00117"></a>00117          {
<a name="l00118"></a>00118             <span class="keywordtype">double</span> urinePerYear,faecesPerYear;
<a name="l00119"></a>00119             aGroup-&gt;<a class="code" href="classcattle_group.html#aae729884313654275cbc05971e104637">SetanimalSection</a>(theBuildings-&gt;<a class="code" href="classbuildings.html#af2943b86173a6a6049c4d52b9793e36e">PlaceAnimal</a>(aGroup-&gt;<a class="code" href="classcattle_group.html#abc9e83055bbfc774f2cd1900cff76c5b">GetAlias</a>().c_str()));
<a name="l00120"></a>00120             <a class="code" href="classcattle.html">cattle</a> * anAnimal = aGroup-&gt;<a class="code" href="classcattle_group.html#a2242557ba924ba92be1cbf0d25b6f422">GetGroupMember</a>(0);
<a name="l00121"></a>00121             faecesPerYear = aNumberOfAnimals *anAnimal-&gt;<a class="code" href="classanimal.html#a7d4699bba0c75390bb33bdf70254ad64">GetamountSolid</a>()*365/1000.0;
<a name="l00122"></a>00122             urinePerYear = aNumberOfAnimals *anAnimal-&gt;<a class="code" href="classanimal.html#a47dafe1783cc6864cf11b345efc5e622">GetamountFluid</a>()*365/1000.0;
<a name="l00123"></a>00123             aGroup-&gt;<a class="code" href="classcattle_group.html#a1822e1d26e286df36a7f307e379cc684">GetanimalSection</a>()-&gt;<a class="code" href="classanimal_section.html#a8266d11321ed09220ff65d4b2f765714" title="Initialise animal parameters.">SetAnimalParameters</a>(aNumberOfAnimals,faecesPerYear,urinePerYear);
<a name="l00124"></a>00124             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0;k&lt;aGroup-&gt;<a class="code" href="classcattle_group.html#abd59eca5138e783ad615b0944915e072">GetnumberOfCohorts</a>();k++)
<a name="l00125"></a>00125             {
<a name="l00126"></a>00126                anAnimal = aGroup-&gt;<a class="code" href="classcattle_group.html#a2242557ba924ba92be1cbf0d25b6f422">GetGroupMember</a>(k);
<a name="l00127"></a>00127                anAnimal-&gt;<a class="code" href="classanimal.html#a258dbe20d150fc63fd99a08c28484a2c">SetStableSection</a>(aGroup-&gt;<a class="code" href="classcattle_group.html#a1822e1d26e286df36a7f307e379cc684">GetanimalSection</a>());
<a name="l00128"></a>00128             }
<a name="l00129"></a>00129          }
<a name="l00130"></a>00130       }
<a name="l00131"></a>00131    }
<a name="l00132"></a>00132 }
<a name="l00133"></a>00133 
<a name="l00134"></a>00134 <span class="comment">/*******************************************************************</span>
<a name="l00135"></a>00135 <span class="comment">Created by NJH 2001</span>
<a name="l00136"></a>00136 <span class="comment">Logs grass or grass/clover fields as grazable by animals (fields_avail_to_graze used by cattle)</span>
<a name="l00137"></a>00137 <span class="comment">********************************************************************/</span>
<a name="l00138"></a><a class="code" href="classgrazing_manager.html#a84c7728ec93315511d221ae456e997dd">00138</a> <span class="keywordtype">void</span> <a class="code" href="classgrazing_manager.html#a84c7728ec93315511d221ae456e997dd">grazingManager::SetGrazableFields</a>()
<a name="l00139"></a>00139 {
<a name="l00140"></a>00140    <span class="comment">//patch *aPatch;</span>
<a name="l00141"></a>00141    <a class="code" href="classfield.html">field</a> *aField;
<a name="l00142"></a>00142    fields_avail_to_graze-&gt;<a class="code" href="classlink_list.html#a8005163404c8378ebb3b34d0e21da338" title="Delete all notes without deleting the elements.">ForgetAll</a>();
<a name="l00143"></a>00143    <a class="code" href="classbs_time.html">bsTime</a> *housingDate = theCattleFeedingManager-&gt;<a class="code" href="classcattle_feeding_manager.html#aae27bce98c713f0c2ee71f49d824f967">GetHousingDate</a>();
<a name="l00144"></a>00144    <span class="comment">//bsTime *turnoutDate = theCattleFeedingManager-&gt;GetTurnoutDate();</span>
<a name="l00145"></a>00145 <span class="comment">/*   if (turnoutDate)</span>
<a name="l00146"></a>00146 <span class="comment">   {</span>
<a name="l00147"></a>00147 <span class="comment">      if ((theTime&gt;=*turnoutDate)&amp;&amp;(theTime&lt;=*housingDate))*/</span>
<a name="l00148"></a>00148    <span class="keywordflow">if</span> (housingDate)
<a name="l00149"></a>00149    {
<a name="l00150"></a>00150       <span class="keywordflow">if</span> ((initialised)&amp;&amp;(<a class="code" href="bstime_8h.html#ac0dc3834220ee5ae84c115e146194d75">theTime</a>&lt;=*housingDate))
<a name="l00151"></a>00151       {
<a name="l00152"></a>00152          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;theCropRotation -&gt;<a class="code" href="classcrop_rotation.html#ad85aaa3c1694c992e1a92fad544194b4">GetFields</a>()-&gt;<a class="code" href="classlink_list.html#aee3f890e4e8f48db1518e5114d5bcca8" title="Returned total number of nodes.">NumOfNodes</a>();i++)
<a name="l00153"></a>00153          {
<a name="l00154"></a>00154             aField = theCropRotation -&gt;<a class="code" href="classcrop_rotation.html#ad85aaa3c1694c992e1a92fad544194b4">GetFields</a>()-&gt;<a class="code" href="classlink_list.html#a5735a6e54a2eed841bdf1fdb52aed03f" title="Return the address of the node with a given logical number in the list.">ElementAtNumber</a>(i);
<a name="l00155"></a>00155             <span class="keywordtype">char</span> *cropId;
<a name="l00156"></a>00156             aField-&gt;<a class="code" href="classfield.html#ac88e569c5e0854563c505665eba50e24">PresentCrop_</a>(cropId);
<a name="l00157"></a>00157             <span class="keywordflow">if</span> (aField-&gt;<a class="code" href="classfield.html#a80a51fb0402683c89f7aa316210854e1">GetActive</a>() &amp;&amp; aField-&gt;<a class="code" href="classfield.html#aadde0ba8d453394c5e790f7e92c0cb35">GetGrazingPossible</a>())
<a name="l00158"></a>00158             {
<a name="l00159"></a>00159                <span class="keywordflow">if</span> ((strcmp(<span class="stringliteral">&quot;C1&quot;</span>,cropId)==0) || (strcmp(<span class="stringliteral">&quot;C2&quot;</span>,cropId)==0) || (strcmp(<span class="stringliteral">&quot;G1&quot;</span>,cropId)==0) ||
<a name="l00160"></a>00160                   (strcmp(<span class="stringliteral">&quot;G2&quot;</span>,cropId)==0) || (strcmp(<span class="stringliteral">&quot;K1&quot;</span>,cropId)==0) || (strcmp(<span class="stringliteral">&quot;G4&quot;</span>,cropId)==0) || (strcmp(<span class="stringliteral">&quot;G5&quot;</span>,cropId)==0))
<a name="l00161"></a>00161                {
<a name="l00162"></a>00162 <span class="comment">//                      if (!aField-&gt;GivecrrPlan()-&gt;FieldOPStopsGrazing())</span>
<a name="l00163"></a>00163                           fields_avail_to_graze-&gt;<a class="code" href="classlink_list.html#a5ef6013a096b9065c2c362fcd5113413" title="Inserts a new node at the end of the list.">InsertLast</a>(aField);
<a name="l00164"></a>00164                }
<a name="l00165"></a>00165             }
<a name="l00166"></a>00166          }
<a name="l00167"></a>00167       }
<a name="l00168"></a>00168    }
<a name="l00169"></a>00169 }
<a name="l00170"></a>00170 
<a name="l00171"></a>00171 <span class="comment">/*******************************************************************</span>
<a name="l00172"></a>00172 <span class="comment">********************************************************************/</span>
<a name="l00173"></a><a class="code" href="classgrazing_manager.html#a9f1919dad1cc77b8d229ed9b13a470d9">00173</a> <span class="keywordtype">void</span> <a class="code" href="classgrazing_manager.html#a9f1919dad1cc77b8d229ed9b13a470d9">grazingManager::ReceivePlan</a>(<span class="keywordtype">char</span> *fileName)
<a name="l00174"></a>00174 {
<a name="l00175"></a>00175    <span class="keywordflow">if</span>(!<a class="code" href="classbase.html#a551ea12cd21bfc786892b5bb8c333ee0">OpenInputFile</a>(fileName))
<a name="l00176"></a>00176                 <a class="code" href="message_8h.html#a8ad29009121a629982c6ade0bd332470">theMessage</a>-&gt;<a class="code" href="classmessage.html#af9891cb7111375e6a36363afffb09d63">FatalError</a>(<span class="stringliteral">&quot;grazing_manager::ReceivePlan - error in opening &quot;</span>,fileName);
<a name="l00177"></a>00177    <span class="keywordflow">else</span>
<a name="l00178"></a>00178    {
<a name="l00179"></a>00179           <a class="code" href="classbase.html#a3cb378050dc4ced8420f41dcd7292239">Setfile</a>(<a class="code" href="classbase.html#a3af52ee9891719d09b8b19b42450b6f6">file</a>);
<a name="l00180"></a>00180       <a class="code" href="classbase.html#a80052a7eeb8bce90247aedd358cc1cf6">SetCritical</a>();
<a name="l00181"></a>00181       <a class="code" href="classbase.html#a88e41ff60ffb7e707312a09f20457e73">FindSection</a>(<span class="stringliteral">&quot;Grazing&quot;</span>,0);
<a name="l00182"></a>00182       <a class="code" href="classbase.html#aff0b96b92d78c345fd60335cece99d08">GetParameter</a>(<span class="stringliteral">&quot;enableGrazing&quot;</span>,&amp;enableGrazing);
<a name="l00183"></a>00183       <span class="keywordflow">if</span> (enableGrazing)
<a name="l00184"></a>00184       {
<a name="l00185"></a>00185          <a class="code" href="classbase.html#aff0b96b92d78c345fd60335cece99d08">GetParameter</a>(<span class="stringliteral">&quot;residualDM&quot;</span>,&amp;residualDM);
<a name="l00186"></a>00186          <a class="code" href="classbase.html#aff0b96b92d78c345fd60335cece99d08">GetParameter</a>(<span class="stringliteral">&quot;minHarvestable&quot;</span>,&amp;minHarvestable);
<a name="l00187"></a>00187 
<a name="l00188"></a>00188          <a class="code" href="classbase.html#aff0b96b92d78c345fd60335cece99d08">GetParameter</a>(<span class="stringliteral">&quot;turnoutThreshold&quot;</span>,&amp;turnoutThreshold);
<a name="l00189"></a>00189          <a class="code" href="classbase.html#aff0b96b92d78c345fd60335cece99d08">GetParameter</a>(<span class="stringliteral">&quot;lowerGrazingLimit&quot;</span>,&amp;lowerGrazingLimit);
<a name="l00190"></a>00190          <a class="code" href="classbase.html#aff0b96b92d78c345fd60335cece99d08">GetParameter</a>(<span class="stringliteral">&quot;upperGrazingLimit&quot;</span>,&amp;upperGrazingLimit);
<a name="l00191"></a>00191          <a class="code" href="classbase.html#aff0b96b92d78c345fd60335cece99d08">GetParameter</a>(<span class="stringliteral">&quot;springCutoffDay&quot;</span>,&amp;springCutoffDay);
<a name="l00192"></a>00192          <a class="code" href="classbase.html#aff0b96b92d78c345fd60335cece99d08">GetParameter</a>(<span class="stringliteral">&quot;potentialGrowthFactor&quot;</span>,&amp;potentialGrowthFactor);
<a name="l00193"></a>00193          <a class="code" href="classbase.html#aff0b96b92d78c345fd60335cece99d08">GetParameter</a>(<span class="stringliteral">&quot;maxPeriods&quot;</span>,&amp;maxPeriods);
<a name="l00194"></a>00194       }
<a name="l00195"></a>00195    }
<a name="l00196"></a>00196    <a class="code" href="classbase.html#a56480e2d42e0f66e1416dbf064a913d1">CloseInputFile</a>();
<a name="l00197"></a>00197    <span class="keywordflow">if</span> (enableGrazing)
<a name="l00198"></a>00198            <a class="code" href="classgrazing_manager.html#a65c9a2762d9760f899bba4cb65b1e024">InitialiseGrowthEstimates</a>();
<a name="l00199"></a>00199 
<a name="l00200"></a>00200 <span class="comment">//Put animals into animal housing - all animals housed at start of year</span>
<a name="l00201"></a>00201         <a class="code" href="classgrazing_manager.html#a0790c1be6eea4fbc391a89814b7dac99">HouseAnimals</a>();
<a name="l00202"></a>00202    ExpectedSilageHolding = <a class="code" href="classgrazing_manager.html#a17ced3f230c570a362648df3d519b3fa">calcSilageRequirement</a>();
<a name="l00203"></a>00203 <span class="comment">//   AutoGrazingPossible();</span>
<a name="l00204"></a>00204    <span class="keywordflow">if</span> ((enableGrazing)&amp;&amp; (theCattleFeedingManager-&gt;<a class="code" href="classcattle_feeding_manager.html#a6fc27712d1be3fb9f192446d09f9e143">GetTurnoutDate</a>())&amp;&amp;(!initialised))
<a name="l00205"></a>00205            periodEnd = theCattleFeedingManager-&gt;<a class="code" href="classcattle_feeding_manager.html#a6fc27712d1be3fb9f192446d09f9e143">GetTurnoutDate</a>()-&gt;<a class="code" href="classbs_time.html#a36b213ecefd6c4e7a51eac4c27483270">clone</a>();
<a name="l00206"></a>00206 }
<a name="l00207"></a>00207 
<a name="l00208"></a>00208 <span class="comment">/*******************************************************************</span>
<a name="l00209"></a>00209 <span class="comment">********************************************************************/</span>
<a name="l00210"></a><a class="code" href="classgrazing_manager.html#add090eda9935ad4665d5388587aa5801">00210</a> <a class="code" href="classlink_list.html">linkList &lt;field&gt;</a> *  <a class="code" href="classgrazing_manager.html#add090eda9935ad4665d5388587aa5801">grazingManager::daily_update</a>(<span class="keywordtype">int</span> *numOthers)
<a name="l00211"></a>00211 {
<a name="l00212"></a>00212    <span class="keywordflow">if</span> (enableGrazing)
<a name="l00213"></a>00213    {
<a name="l00214"></a>00214       <span class="keywordtype">int</span> growthPeriod=0;
<a name="l00215"></a>00215       <span class="keyword">static</span> <span class="keywordtype">bool</span> setNewPeriod;
<a name="l00216"></a>00216       <span class="keywordflow">if</span> (periodEnd)
<a name="l00217"></a>00217       {
<a name="l00218"></a>00218          <span class="keywordflow">if</span> ((setNewPeriod)&amp;&amp;(initialised))
<a name="l00219"></a>00219          {
<a name="l00220"></a>00220             <span class="keywordflow">if</span> ((currentPeriod&lt;=maxPeriods)&amp;&amp;(SilageMade&lt;ExpectedSilageHolding))
<a name="l00221"></a>00221             {
<a name="l00222"></a>00222                <span class="keywordflow">if</span> (currentPeriod==0)
<a name="l00223"></a>00223                   growthPeriod=0;
<a name="l00224"></a>00224                <span class="keywordflow">else</span>
<a name="l00225"></a>00225                   growthPeriod=1;
<a name="l00226"></a>00226                <span class="keywordtype">int</span> <a class="code" href="classperiod.html">period</a> = <a class="code" href="classgrazing_manager.html#aaaedb1e74f765f6501d7bc7772ea8600">CalcGrazingPeriod</a>(periodEnd, growthPeriod);
<a name="l00227"></a>00227                <a class="code" href="classgrazing_manager.html#af4d75fc52160ba2df1afa74db9727e5c">SetGrazing</a>(periodEnd,period,numOthers);
<a name="l00228"></a>00228                currentPeriod++;
<a name="l00229"></a>00229                setNewPeriod=<span class="keyword">false</span>;
<a name="l00230"></a>00230             }
<a name="l00231"></a>00231             <span class="keywordflow">else</span>
<a name="l00232"></a>00232                <a class="code" href="classgrazing_manager.html#a6f11fda1e9b60ffac195adb3d93d6ca7">SetGrazingAll</a>();
<a name="l00233"></a>00233          }
<a name="l00234"></a>00234          <span class="keywordtype">bool</span> forceCut=<a class="code" href="classgrazing_manager.html#a7e94949ab9bfb77da28ac2c3dcd79aaa">CheckConservationFields</a>();
<a name="l00235"></a>00235          <a class="code" href="classgrazing_manager.html#ad4339322398af753da757bcebc3a085c">CheckOpStopsGrazing</a>();         <span class="comment">//see if any operations (eg ploughing) means that one or more field cannot be grazed</span>
<a name="l00236"></a>00236          <span class="keywordflow">if</span> ((<a class="code" href="bstime_8h.html#ac0dc3834220ee5ae84c115e146194d75">theTime</a>==*periodEnd)||(forceCut))
<a name="l00237"></a>00237          {
<a name="l00238"></a>00238             setNewPeriod=<span class="keyword">true</span>;
<a name="l00239"></a>00239             <span class="keywordflow">if</span> (currentPeriod==0)
<a name="l00240"></a>00240             {
<a name="l00241"></a>00241                <span class="keywordflow">if</span> (!initialised)
<a name="l00242"></a>00242                   <a class="code" href="classgrazing_manager.html#a52d950e97efbe047f9fec1493a0ce62e">StartGrazingManagement</a>();
<a name="l00243"></a>00243                <span class="keywordflow">if</span> (!<a class="code" href="classgrazing_manager.html#aa831a26148a1171fce3f1e2971135d34">CheckGrazingTheshold</a>())
<a name="l00244"></a>00244                {
<a name="l00245"></a>00245                   setNewPeriod=<span class="keyword">false</span>;
<a name="l00246"></a>00246                   periodEnd-&gt;<a class="code" href="classbs_time.html#a0386f6d4b49e3c0fd6f04f523dbfc7af">AddOneDay</a>();
<a name="l00247"></a>00247                }
<a name="l00248"></a>00248                <span class="keywordflow">else</span>
<a name="l00249"></a>00249                   SilageMade=0.0;
<a name="l00250"></a>00250             }
<a name="l00251"></a>00251             <span class="keywordflow">else</span>
<a name="l00252"></a>00252                setNewPeriod=<a class="code" href="classgrazing_manager.html#abc0c9f087272175f7d3f7f7d099c7fd8">CutConservationFields</a>(forceCut);
<a name="l00253"></a>00253          }
<a name="l00254"></a>00254          <span class="keywordflow">if</span> ((<a class="code" href="bstime_8h.html#ac0dc3834220ee5ae84c115e146194d75">theTime</a>==(*theCattleFeedingManager-&gt;<a class="code" href="classcattle_feeding_manager.html#aae27bce98c713f0c2ee71f49d824f967">GetHousingDate</a>())))
<a name="l00255"></a>00255          {
<a name="l00256"></a>00256             setNewPeriod=<span class="keyword">false</span>;
<a name="l00257"></a>00257             <a class="code" href="classgrazing_manager.html#a6d936f90c10dfc4f5bf7e7eddc3b85c0">EndOfSeason</a>(<span class="keyword">true</span>);
<a name="l00258"></a>00258          }
<a name="l00259"></a>00259       }
<a name="l00260"></a>00260    }
<a name="l00261"></a>00261    <span class="keywordflow">return</span> fields_to_graze;
<a name="l00262"></a>00262 }
<a name="l00263"></a>00263 
<a name="l00264"></a>00264 
<a name="l00265"></a>00265 <span class="comment">/*******************************************************************</span>
<a name="l00266"></a>00266 <span class="comment">********************************************************************/</span>
<a name="l00267"></a><a class="code" href="classgrazing_manager.html#a17ced3f230c570a362648df3d519b3fa">00267</a> <span class="keywordtype">double</span> <a class="code" href="classgrazing_manager.html#a17ced3f230c570a362648df3d519b3fa">grazingManager::calcSilageRequirement</a>()
<a name="l00268"></a>00268 {
<a name="l00269"></a>00269         <span class="keywordtype">double</span> silageDemand=theCattleFeedingManager-&gt;<a class="code" href="classcattle_feeding_manager.html#a7bd08ef0fe270e8301f5c84cb5564ba3">GetSilageRequired</a>();
<a name="l00270"></a>00270         <span class="keywordflow">return</span> silageDemand;
<a name="l00271"></a>00271 }
<a name="l00272"></a>00272 
<a name="l00273"></a>00273 
<a name="l00274"></a>00274 
<a name="l00275"></a>00275 <span class="comment">/*******************************************************************</span>
<a name="l00276"></a>00276 <span class="comment">********************************************************************/</span>
<a name="l00277"></a><a class="code" href="classgrazing_manager.html#a9d3a5982adf0406463307e6b25a62f0c">00277</a> <span class="keywordtype">double</span> <a class="code" href="classgrazing_manager.html#a9d3a5982adf0406463307e6b25a62f0c">grazingManager::GetHerbageAvailability</a>(<span class="keywordtype">bool</span> restricted)
<a name="l00278"></a>00278 {
<a name="l00279"></a>00279 
<a name="l00280"></a>00280    <span class="keywordtype">double</span> herbageAvailable=0.0;
<a name="l00281"></a>00281    <span class="keywordtype">int</span> max;
<a name="l00282"></a>00282         <span class="comment">//If restricted is true, only return herbage that is on fields that are to be grazed</span>
<a name="l00283"></a>00283    <span class="keywordflow">if</span> (restricted)
<a name="l00284"></a>00284         max = fields_to_graze-&gt;<a class="code" href="classlink_list.html#aee3f890e4e8f48db1518e5114d5bcca8" title="Returned total number of nodes.">NumOfNodes</a>();
<a name="l00285"></a>00285    <span class="keywordflow">else</span>
<a name="l00286"></a>00286         max = fields_avail_to_graze-&gt;<a class="code" href="classlink_list.html#aee3f890e4e8f48db1518e5114d5bcca8" title="Returned total number of nodes.">NumOfNodes</a>();
<a name="l00287"></a>00287 
<a name="l00288"></a>00288    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;max;i++)
<a name="l00289"></a>00289    {
<a name="l00290"></a>00290 
<a name="l00291"></a>00291       <span class="keywordtype">double</span> fieldMassAvail = <a class="code" href="classgrazing_manager.html#a9d3a5982adf0406463307e6b25a62f0c">GetHerbageAvailability</a>(restricted,i);
<a name="l00292"></a>00292                 herbageAvailable +=  fieldMassAvail;
<a name="l00293"></a>00293    }
<a name="l00294"></a>00294    <span class="keywordflow">return</span> herbageAvailable;
<a name="l00295"></a>00295 };
<a name="l00296"></a>00296 <span class="comment">/*******************************************************************</span>
<a name="l00297"></a>00297 <span class="comment">Returns herbage availability in kg DM for a field</span>
<a name="l00298"></a>00298 <span class="comment">********************************************************************/</span>
<a name="l00299"></a><a class="code" href="classgrazing_manager.html#a4f0ad2c2781ed63cc717059d3780d548">00299</a> <span class="keywordtype">double</span> <a class="code" href="classgrazing_manager.html#a9d3a5982adf0406463307e6b25a62f0c">grazingManager::GetHerbageAvailability</a>(<span class="keywordtype">bool</span> restricted, <span class="keywordtype">int</span> fieldNo)
<a name="l00300"></a>00300 {
<a name="l00301"></a>00301    <a class="code" href="classfield.html">field</a> *aField;
<a name="l00302"></a>00302    <span class="keywordflow">if</span> (restricted)
<a name="l00303"></a>00303       aField = (<a class="code" href="classfield.html">field</a>*) fields_to_graze-&gt;<a class="code" href="classlink_list.html#a5735a6e54a2eed841bdf1fdb52aed03f" title="Return the address of the node with a given logical number in the list.">ElementAtNumber</a>(fieldNo);
<a name="l00304"></a>00304    <span class="keywordflow">else</span>
<a name="l00305"></a>00305       aField = (<a class="code" href="classfield.html">field</a>*) fields_avail_to_graze-&gt;<a class="code" href="classlink_list.html#a5735a6e54a2eed841bdf1fdb52aed03f" title="Return the address of the node with a given logical number in the list.">ElementAtNumber</a>(fieldNo);
<a name="l00306"></a>00306    <span class="keywordtype">double</span> herbageAvailable = aField-&gt;<a class="code" href="classfield.html#a5faf5dbca7ad4c4a2f33f7104fd3908e">GetAvailableHerbageMasskg</a>(residualDM);
<a name="l00307"></a>00307    <span class="keywordflow">if</span> (herbageAvailable&lt;0.0)
<a name="l00308"></a>00308         herbageAvailable=0.0;
<a name="l00309"></a>00309    <span class="keywordflow">return</span> herbageAvailable;
<a name="l00310"></a>00310 };
<a name="l00311"></a>00311 
<a name="l00312"></a>00312 
<a name="l00313"></a>00313 
<a name="l00314"></a>00314 <span class="comment">/*******************************************************************</span>
<a name="l00315"></a>00315 <span class="comment">Calculates the length of a grazing period</span>
<a name="l00316"></a>00316 <span class="comment">********************************************************************/</span>
<a name="l00317"></a><a class="code" href="classgrazing_manager.html#aaaedb1e74f765f6501d7bc7772ea8600">00317</a> <span class="keywordtype">int</span> <a class="code" href="classgrazing_manager.html#aaaedb1e74f765f6501d7bc7772ea8600">grazingManager::CalcGrazingPeriod</a>(<a class="code" href="classbs_time.html">bsTime</a> *aDate, <span class="keywordtype">int</span> growthPeriod)
<a name="l00318"></a>00318 {
<a name="l00319"></a>00319         <span class="keywordtype">int</span> <a class="code" href="classperiod.html">period</a> = 0;
<a name="l00320"></a>00320    <a class="code" href="classbs_time.html">bsTime</a> *tempTime = aDate-&gt;<a class="code" href="classbs_time.html#a36b213ecefd6c4e7a51eac4c27483270">clone</a>();
<a name="l00321"></a>00321    <span class="keywordtype">double</span> cummass=0.0;
<a name="l00322"></a>00322    <span class="keywordtype">double</span> cumarea=0.0;
<a name="l00323"></a>00323  <span class="comment">//  double currentAveMass=0.0;</span>
<a name="l00324"></a>00324    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;fields_avail_to_graze-&gt;<a class="code" href="classlink_list.html#aee3f890e4e8f48db1518e5114d5bcca8" title="Returned total number of nodes.">NumOfNodes</a>();i++)
<a name="l00325"></a>00325    {
<a name="l00326"></a>00326       <a class="code" href="classfield.html">field</a> *aField = fields_avail_to_graze-&gt;<a class="code" href="classlink_list.html#a5735a6e54a2eed841bdf1fdb52aed03f" title="Return the address of the node with a given logical number in the list.">ElementAtNumber</a>(i);
<a name="l00327"></a>00327       cumarea+=aField-&gt;<a class="code" href="classfield.html#ac4c5edc4de9c9035c58c7204356a12b0">GetArea</a>();
<a name="l00328"></a>00328    }
<a name="l00329"></a>00329 
<a name="l00330"></a>00330    <span class="keywordtype">double</span> aveMass=0.0;
<a name="l00331"></a>00331 <span class="comment">//   if (cummass&gt;0.0)</span>
<a name="l00332"></a>00332   <span class="comment">//    aveMass=cummass/cumarea;</span>
<a name="l00333"></a>00333    <span class="keywordflow">while</span> ((aveMass&lt; targetCutMass[growthPeriod])&amp;&amp;(*tempTime&lt;=*theCattleFeedingManager-&gt;GetHousingDate()))
<a name="l00334"></a>00334    {
<a name="l00335"></a>00335       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;fields_avail_to_graze-&gt;<a class="code" href="classlink_list.html#aee3f890e4e8f48db1518e5114d5bcca8" title="Returned total number of nodes.">NumOfNodes</a>();i++)
<a name="l00336"></a>00336       {
<a name="l00337"></a>00337               <a class="code" href="classfield.html">field</a> *aField = fields_avail_to_graze-&gt;<a class="code" href="classlink_list.html#a5735a6e54a2eed841bdf1fdb52aed03f" title="Return the address of the node with a given logical number in the list.">ElementAtNumber</a>(i);
<a name="l00338"></a>00338          cummass+= aField-&gt;<a class="code" href="classfield.html#ac4c5edc4de9c9035c58c7204356a12b0">GetArea</a>() * <a class="code" href="classgrazing_manager.html#aa45455953b5da3c6c7898c9e99bb274b">GetExpectedGrowthRate</a>(tempTime, i)/1000.0;
<a name="l00339"></a>00339       }
<a name="l00340"></a>00340            <span class="keywordflow">if</span> (cummass&gt;0.0)
<a name="l00341"></a>00341            aveMass=cummass/cumarea;
<a name="l00342"></a>00342       tempTime-&gt;<a class="code" href="classbs_time.html#a0386f6d4b49e3c0fd6f04f523dbfc7af">AddOneDay</a>();
<a name="l00343"></a>00343         period++;
<a name="l00344"></a>00344    }
<a name="l00345"></a>00345    <span class="keyword">delete</span> tempTime;
<a name="l00346"></a>00346    <span class="keywordflow">return</span> period;
<a name="l00347"></a>00347 }
<a name="l00348"></a>00348 
<a name="l00349"></a>00349 
<a name="l00350"></a>00350 
<a name="l00351"></a>00351 <span class="comment">/*******************************************************************</span>
<a name="l00352"></a>00352 <span class="comment">NJH May 2004 Insert a cut into a field operation list</span>
<a name="l00353"></a>00353 <span class="comment">********************************************************************/</span>
<a name="l00354"></a><a class="code" href="classgrazing_manager.html#a6f01332621905d316bb39c5f51169dd9">00354</a> <span class="keywordtype">void</span> <a class="code" href="classgrazing_manager.html#a6f01332621905d316bb39c5f51169dd9">grazingManager::InsertCut</a>(<a class="code" href="classfield.html">field</a> * aField, <span class="keywordtype">bool</span> harvestCut)
<a name="l00355"></a>00355 {
<a name="l00356"></a>00356    <span class="keywordtype">char</span> * crop_id =<span class="keyword">new</span> <span class="keywordtype">char</span>[5];
<a name="l00357"></a>00357    strcpy(crop_id,<span class="stringliteral">&quot;G4&quot;</span>);
<a name="l00358"></a>00358    <a class="code" href="classharvest_fields.html">harvestFields</a> * FO=<span class="keyword">new</span> <a class="code" href="classharvest_fields.html">harvestFields</a>;
<a name="l00359"></a>00359    aField-&gt;<a class="code" href="classfield.html#ac88e569c5e0854563c505665eba50e24">PresentCrop_</a>(crop_id);
<a name="l00360"></a>00360    <a class="code" href="classplant_item.html">plantItem</a> *aPlantItem1=<span class="keyword">new</span> <a class="code" href="classplant_item.html">plantItem</a>;
<a name="l00361"></a>00361    aPlantItem1-&gt;<a class="code" href="classproduct.html#a0219cde65dc26376f3371a0138199ba8">Setname</a>(<span class="stringliteral">&quot;RYEGRASS&quot;</span>);
<a name="l00362"></a>00362    <a class="code" href="_new_main_8cpp.html#af1019990138497f1f18cc7294737d140">theProducts</a>-&gt;<a class="code" href="classproducts.html#a8bd239aabc0a167741c02882e305d65d">GiveProductInformation</a>(aPlantItem1);
<a name="l00363"></a>00363    FO-&gt;<a class="code" href="classharvest_fields.html#abf0a1c96f2c3fd07843970bc1c4ae157">SetMainProduct</a>(aPlantItem1);
<a name="l00364"></a>00364 
<a name="l00365"></a>00365 <span class="preprocessor">#ifndef MEASCOPE</span>
<a name="l00366"></a>00366 <span class="preprocessor"></span>
<a name="l00367"></a>00367    <span class="keywordflow">if</span> (harvestCut)
<a name="l00368"></a>00368       FO-&gt;<a class="code" href="classharvest_fields.html#aed7f89142c895481212938562ce61f3a">DefineHarvestFieldsOper</a>(<a class="code" href="operation_names_8h.html#a77d40de6faa131199a5de6df3d9c7e3da9663f1fb19aeaf49317bf090f588c894">ForageHarvesting</a>,crop_id,<span class="stringliteral">&quot;Pasture&quot;</span>,
<a name="l00369"></a>00369          <a class="code" href="bstime_8h.html#ac0dc3834220ee5ae84c115e146194d75">theTime</a>.<a class="code" href="classbs_time.html#afcb5953580c085bce20eb33a4b21e155">GetYear</a>(),<a class="code" href="bstime_8h.html#ac0dc3834220ee5ae84c115e146194d75">theTime</a>.<a class="code" href="classbs_time.html#a777a59c97951688c4b2a67c4b0bca16e">GetMonth</a>(),<a class="code" href="bstime_8h.html#ac0dc3834220ee5ae84c115e146194d75">theTime</a>.<a class="code" href="classbs_time.html#a3b4126cf9db93be0c2f69549699730d3">GetDay</a>(),
<a name="l00370"></a>00370          aField-&gt;<a class="code" href="classfield.html#ac4c5edc4de9c9035c58c7204356a12b0">GetArea</a>(),0,aField-&gt;<a class="code" href="classfield.html#aab17aa694538578ace4f6fc40cc561fc">DistanceToField_</a>(),1.0,<span class="keyword">true</span>,residualDM,0); <span class="comment">// @@@ Might be problems here regarding parameters !!!</span>
<a name="l00371"></a>00371    <span class="keywordflow">else</span>
<a name="l00372"></a>00372       FO-&gt;<a class="code" href="classharvest_fields.html#aed7f89142c895481212938562ce61f3a">DefineHarvestFieldsOper</a>(<a class="code" href="operation_names_8h.html#a77d40de6faa131199a5de6df3d9c7e3da99fed0ff90596f04a750e9764df22d20">CutSetAside</a>,crop_id,<span class="stringliteral">&quot;Pasture&quot;</span>,
<a name="l00373"></a>00373          <a class="code" href="bstime_8h.html#ac0dc3834220ee5ae84c115e146194d75">theTime</a>.<a class="code" href="classbs_time.html#afcb5953580c085bce20eb33a4b21e155">GetYear</a>(),<a class="code" href="bstime_8h.html#ac0dc3834220ee5ae84c115e146194d75">theTime</a>.<a class="code" href="classbs_time.html#a777a59c97951688c4b2a67c4b0bca16e">GetMonth</a>(),<a class="code" href="bstime_8h.html#ac0dc3834220ee5ae84c115e146194d75">theTime</a>.<a class="code" href="classbs_time.html#a3b4126cf9db93be0c2f69549699730d3">GetDay</a>(),
<a name="l00374"></a>00374          aField-&gt;<a class="code" href="classfield.html#ac4c5edc4de9c9035c58c7204356a12b0">GetArea</a>(),0,aField-&gt;<a class="code" href="classfield.html#aab17aa694538578ace4f6fc40cc561fc">DistanceToField_</a>(),1.0,<span class="keyword">true</span>,residualDM,0); <span class="comment">// @@@ Might be problems here regarding parameters !!!</span>
<a name="l00375"></a>00375    aField-&gt;<a class="code" href="classfield.html#a83310dd2f0b81ec3178627f285e7535a">GivecrrPlan</a>()-&gt;<a class="code" href="classplan.html#a66bc896a7b501149627955ae025d62b0">InsertAsNextOperation</a>(FO);
<a name="l00376"></a>00376 
<a name="l00377"></a>00377 <span class="preprocessor">#else</span>
<a name="l00378"></a>00378 <span class="preprocessor"></span><span class="comment">//      fieldOrderPeriod * aPeriod = new fieldOrderPeriod(&quot;Cutting&quot;,0,aField);</span>
<a name="l00379"></a>00379       aField-&gt;<a class="code" href="classfield.html#a83310dd2f0b81ec3178627f285e7535a">GivecrrPlan</a>()-&gt;SetFinished(<span class="keyword">false</span>);
<a name="l00380"></a>00380       <span class="keywordtype">double</span> CuttingHeight = 0.07;
<a name="l00381"></a>00381       <span class="keywordtype">int</span> processProduct;
<a name="l00382"></a>00382         <a class="code" href="classharvest_fields.html">harvestFields</a> * FO1 = NULL;
<a name="l00383"></a>00383       <span class="keywordflow">if</span> (harvestCut)
<a name="l00384"></a>00384       {
<a name="l00385"></a>00385         processProduct = 1;
<a name="l00386"></a>00386          FO-&gt;<a class="code" href="classharvest_fields.html#aed7f89142c895481212938562ce61f3a">DefineHarvestFieldsOper</a>(<a class="code" href="operation_names_8h.html#a77d40de6faa131199a5de6df3d9c7e3da9663f1fb19aeaf49317bf090f588c894">ForageHarvesting</a>, crop_id,<span class="stringliteral">&quot;Pasture&quot;</span>,<a class="code" href="bstime_8h.html#ac0dc3834220ee5ae84c115e146194d75">theTime</a>.<a class="code" href="classbs_time.html#afcb5953580c085bce20eb33a4b21e155">GetYear</a>(),<a class="code" href="bstime_8h.html#ac0dc3834220ee5ae84c115e146194d75">theTime</a>.<a class="code" href="classbs_time.html#a777a59c97951688c4b2a67c4b0bca16e">GetMonth</a>(),<a class="code" href="bstime_8h.html#ac0dc3834220ee5ae84c115e146194d75">theTime</a>.<a class="code" href="classbs_time.html#a3b4126cf9db93be0c2f69549699730d3">GetDay</a>(),
<a name="l00387"></a>00387                         <a class="code" href="bstime_8h.html#ac0dc3834220ee5ae84c115e146194d75">theTime</a>.<a class="code" href="classbs_time.html#afcb5953580c085bce20eb33a4b21e155">GetYear</a>(),<a class="code" href="bstime_8h.html#ac0dc3834220ee5ae84c115e146194d75">theTime</a>.<a class="code" href="classbs_time.html#a777a59c97951688c4b2a67c4b0bca16e">GetMonth</a>(),<a class="code" href="bstime_8h.html#ac0dc3834220ee5ae84c115e146194d75">theTime</a>.<a class="code" href="classbs_time.html#a3b4126cf9db93be0c2f69549699730d3">GetDay</a>()+1,0.0,
<a name="l00388"></a>00388                         0.0, 0,aField-&gt;<a class="code" href="classfield.html#ac4c5edc4de9c9035c58c7204356a12b0">GetArea</a>(),0,aField-&gt;<a class="code" href="classfield.html#aab17aa694538578ace4f6fc40cc561fc">DistanceToField_</a>(),1.0,<span class="keyword">true</span>,0.95,0.95);
<a name="l00389"></a>00389       }
<a name="l00390"></a>00390       <span class="keywordflow">else</span>
<a name="l00391"></a>00391       {
<a name="l00392"></a>00392               <span class="keywordtype">int</span> processProduct = 0;  <span class="comment">//set elsewhere  !!!!!!!!!!!!!!!!!!!!!!!!</span>
<a name="l00393"></a>00393          <span class="keywordflow">switch</span> (processProduct)  <span class="comment">// 0=cut set-aside, 1 = silage, 2 = hay</span>
<a name="l00394"></a>00394          {
<a name="l00395"></a>00395             <span class="keywordflow">case</span> 0:FO-&gt;<a class="code" href="classharvest_fields.html#aed7f89142c895481212938562ce61f3a">DefineHarvestFieldsOper</a>(<a class="code" href="operation_names_8h.html#a77d40de6faa131199a5de6df3d9c7e3da99fed0ff90596f04a750e9764df22d20">CutSetAside</a>, crop_id,<span class="stringliteral">&quot;Pasture&quot;</span>,<a class="code" href="bstime_8h.html#ac0dc3834220ee5ae84c115e146194d75">theTime</a>.<a class="code" href="classbs_time.html#afcb5953580c085bce20eb33a4b21e155">GetYear</a>(),<a class="code" href="bstime_8h.html#ac0dc3834220ee5ae84c115e146194d75">theTime</a>.<a class="code" href="classbs_time.html#a777a59c97951688c4b2a67c4b0bca16e">GetMonth</a>(),<a class="code" href="bstime_8h.html#ac0dc3834220ee5ae84c115e146194d75">theTime</a>.<a class="code" href="classbs_time.html#a3b4126cf9db93be0c2f69549699730d3">GetDay</a>(),
<a name="l00396"></a>00396                      <a class="code" href="bstime_8h.html#ac0dc3834220ee5ae84c115e146194d75">theTime</a>.<a class="code" href="classbs_time.html#afcb5953580c085bce20eb33a4b21e155">GetYear</a>(),<a class="code" href="bstime_8h.html#ac0dc3834220ee5ae84c115e146194d75">theTime</a>.<a class="code" href="classbs_time.html#a777a59c97951688c4b2a67c4b0bca16e">GetMonth</a>(),<a class="code" href="bstime_8h.html#ac0dc3834220ee5ae84c115e146194d75">theTime</a>.<a class="code" href="classbs_time.html#a3b4126cf9db93be0c2f69549699730d3">GetDay</a>()+1,0.0,
<a name="l00397"></a>00397                      0.0, 0,aField-&gt;<a class="code" href="classfield.html#ac4c5edc4de9c9035c58c7204356a12b0">GetArea</a>(),0,aField-&gt;<a class="code" href="classfield.html#aab17aa694538578ace4f6fc40cc561fc">DistanceToField_</a>(),1.0,<span class="keyword">true</span>,0.95,0.95);
<a name="l00398"></a>00398                   <span class="keywordflow">break</span>;
<a name="l00399"></a>00399             <span class="keywordflow">case</span> 1:FO-&gt;<a class="code" href="classharvest_fields.html#aed7f89142c895481212938562ce61f3a">DefineHarvestFieldsOper</a>(<a class="code" href="operation_names_8h.html#a77d40de6faa131199a5de6df3d9c7e3daa0011af3cf59bcbf278a1133f972c016">Mowing</a>,  crop_id,<span class="stringliteral">&quot;Pasture&quot;</span>,<a class="code" href="bstime_8h.html#ac0dc3834220ee5ae84c115e146194d75">theTime</a>.<a class="code" href="classbs_time.html#afcb5953580c085bce20eb33a4b21e155">GetYear</a>(),<a class="code" href="bstime_8h.html#ac0dc3834220ee5ae84c115e146194d75">theTime</a>.<a class="code" href="classbs_time.html#a777a59c97951688c4b2a67c4b0bca16e">GetMonth</a>(),<a class="code" href="bstime_8h.html#ac0dc3834220ee5ae84c115e146194d75">theTime</a>.<a class="code" href="classbs_time.html#a3b4126cf9db93be0c2f69549699730d3">GetDay</a>(),
<a name="l00400"></a>00400                      <a class="code" href="bstime_8h.html#ac0dc3834220ee5ae84c115e146194d75">theTime</a>.<a class="code" href="classbs_time.html#afcb5953580c085bce20eb33a4b21e155">GetYear</a>(),<a class="code" href="bstime_8h.html#ac0dc3834220ee5ae84c115e146194d75">theTime</a>.<a class="code" href="classbs_time.html#a777a59c97951688c4b2a67c4b0bca16e">GetMonth</a>(),<a class="code" href="bstime_8h.html#ac0dc3834220ee5ae84c115e146194d75">theTime</a>.<a class="code" href="classbs_time.html#a3b4126cf9db93be0c2f69549699730d3">GetDay</a>()+1,0.0,
<a name="l00401"></a>00401                      0.0, 0,aField-&gt;<a class="code" href="classfield.html#ac4c5edc4de9c9035c58c7204356a12b0">GetArea</a>(),0,aField-&gt;<a class="code" href="classfield.html#aab17aa694538578ace4f6fc40cc561fc">DistanceToField_</a>(),1.0,<span class="keyword">true</span>,0.95,0.95);
<a name="l00402"></a>00402                     <span class="comment">//collect silage</span>
<a name="l00403"></a>00403                     FO1=<span class="keyword">new</span> <a class="code" href="classharvest_fields.html">harvestFields</a>;
<a name="l00404"></a>00404                     FO1-&gt;<a class="code" href="classharvest_fields.html#aed7f89142c895481212938562ce61f3a">DefineHarvestFieldsOper</a>(<a class="code" href="operation_names_8h.html#a77d40de6faa131199a5de6df3d9c7e3dad41298e335d754c78ee0d9f0a217d3a0">GatheringSilage</a>,  crop_id,<span class="stringliteral">&quot;Pasture&quot;</span>,<a class="code" href="bstime_8h.html#ac0dc3834220ee5ae84c115e146194d75">theTime</a>.<a class="code" href="classbs_time.html#afcb5953580c085bce20eb33a4b21e155">GetYear</a>(),<a class="code" href="bstime_8h.html#ac0dc3834220ee5ae84c115e146194d75">theTime</a>.<a class="code" href="classbs_time.html#a777a59c97951688c4b2a67c4b0bca16e">GetMonth</a>(),<a class="code" href="bstime_8h.html#ac0dc3834220ee5ae84c115e146194d75">theTime</a>.<a class="code" href="classbs_time.html#a3b4126cf9db93be0c2f69549699730d3">GetDay</a>(),
<a name="l00405"></a>00405                      <a class="code" href="bstime_8h.html#ac0dc3834220ee5ae84c115e146194d75">theTime</a>.<a class="code" href="classbs_time.html#afcb5953580c085bce20eb33a4b21e155">GetYear</a>(),<a class="code" href="bstime_8h.html#ac0dc3834220ee5ae84c115e146194d75">theTime</a>.<a class="code" href="classbs_time.html#a777a59c97951688c4b2a67c4b0bca16e">GetMonth</a>(),<a class="code" href="bstime_8h.html#ac0dc3834220ee5ae84c115e146194d75">theTime</a>.<a class="code" href="classbs_time.html#a3b4126cf9db93be0c2f69549699730d3">GetDay</a>()+1,0.0,
<a name="l00406"></a>00406                      0.0, 0,aField-&gt;<a class="code" href="classfield.html#ac4c5edc4de9c9035c58c7204356a12b0">GetArea</a>(),0,aField-&gt;<a class="code" href="classfield.html#aab17aa694538578ace4f6fc40cc561fc">DistanceToField_</a>(),1.0,<span class="keyword">true</span>,0.95,0.95);
<a name="l00407"></a>00407                     FO1-&gt;<a class="code" href="classharvest_fields.html#abf0a1c96f2c3fd07843970bc1c4ae157">SetMainProduct</a>(aPlantItem1);
<a name="l00408"></a>00408                     <span class="keywordflow">break</span>;
<a name="l00409"></a>00409             <span class="keywordflow">case</span> 2:FO-&gt;<a class="code" href="classharvest_fields.html#aed7f89142c895481212938562ce61f3a">DefineHarvestFieldsOper</a>(<a class="code" href="operation_names_8h.html#a77d40de6faa131199a5de6df3d9c7e3daa0011af3cf59bcbf278a1133f972c016">Mowing</a>,  crop_id,<span class="stringliteral">&quot;Pasture&quot;</span>,<a class="code" href="bstime_8h.html#ac0dc3834220ee5ae84c115e146194d75">theTime</a>.<a class="code" href="classbs_time.html#afcb5953580c085bce20eb33a4b21e155">GetYear</a>(),<a class="code" href="bstime_8h.html#ac0dc3834220ee5ae84c115e146194d75">theTime</a>.<a class="code" href="classbs_time.html#a777a59c97951688c4b2a67c4b0bca16e">GetMonth</a>(),<a class="code" href="bstime_8h.html#ac0dc3834220ee5ae84c115e146194d75">theTime</a>.<a class="code" href="classbs_time.html#a3b4126cf9db93be0c2f69549699730d3">GetDay</a>(),
<a name="l00410"></a>00410                      <a class="code" href="bstime_8h.html#ac0dc3834220ee5ae84c115e146194d75">theTime</a>.<a class="code" href="classbs_time.html#afcb5953580c085bce20eb33a4b21e155">GetYear</a>(),<a class="code" href="bstime_8h.html#ac0dc3834220ee5ae84c115e146194d75">theTime</a>.<a class="code" href="classbs_time.html#a777a59c97951688c4b2a67c4b0bca16e">GetMonth</a>(),<a class="code" href="bstime_8h.html#ac0dc3834220ee5ae84c115e146194d75">theTime</a>.<a class="code" href="classbs_time.html#a3b4126cf9db93be0c2f69549699730d3">GetDay</a>()+1,0.0,
<a name="l00411"></a>00411                      0.0, 0,aField-&gt;<a class="code" href="classfield.html#ac4c5edc4de9c9035c58c7204356a12b0">GetArea</a>(),0,aField-&gt;<a class="code" href="classfield.html#aab17aa694538578ace4f6fc40cc561fc">DistanceToField_</a>(),1.0,<span class="keyword">true</span>,0.95,0.95);
<a name="l00412"></a>00412                     <span class="comment">//collect silage</span>
<a name="l00413"></a>00413                     FO1=<span class="keyword">new</span> <a class="code" href="classharvest_fields.html">harvestFields</a>;
<a name="l00414"></a>00414                     FO1-&gt;<a class="code" href="classharvest_fields.html#aed7f89142c895481212938562ce61f3a">DefineHarvestFieldsOper</a>(<a class="code" href="operation_names_8h.html#a77d40de6faa131199a5de6df3d9c7e3da24e377f438eb079c4f5ed457d5c91a7e">GatheringHay</a>,  crop_id,<span class="stringliteral">&quot;Pasture&quot;</span>,<a class="code" href="bstime_8h.html#ac0dc3834220ee5ae84c115e146194d75">theTime</a>.<a class="code" href="classbs_time.html#afcb5953580c085bce20eb33a4b21e155">GetYear</a>(),<a class="code" href="bstime_8h.html#ac0dc3834220ee5ae84c115e146194d75">theTime</a>.<a class="code" href="classbs_time.html#a777a59c97951688c4b2a67c4b0bca16e">GetMonth</a>(),<a class="code" href="bstime_8h.html#ac0dc3834220ee5ae84c115e146194d75">theTime</a>.<a class="code" href="classbs_time.html#a3b4126cf9db93be0c2f69549699730d3">GetDay</a>(),
<a name="l00415"></a>00415                      <a class="code" href="bstime_8h.html#ac0dc3834220ee5ae84c115e146194d75">theTime</a>.<a class="code" href="classbs_time.html#afcb5953580c085bce20eb33a4b21e155">GetYear</a>(),<a class="code" href="bstime_8h.html#ac0dc3834220ee5ae84c115e146194d75">theTime</a>.<a class="code" href="classbs_time.html#a777a59c97951688c4b2a67c4b0bca16e">GetMonth</a>(),<a class="code" href="bstime_8h.html#ac0dc3834220ee5ae84c115e146194d75">theTime</a>.<a class="code" href="classbs_time.html#a3b4126cf9db93be0c2f69549699730d3">GetDay</a>()+1,0.0,
<a name="l00416"></a>00416                      0.0, 0,aField-&gt;<a class="code" href="classfield.html#ac4c5edc4de9c9035c58c7204356a12b0">GetArea</a>(),0,aField-&gt;<a class="code" href="classfield.html#aab17aa694538578ace4f6fc40cc561fc">DistanceToField_</a>(),1.0,<span class="keyword">true</span>,0.95,0.95);
<a name="l00417"></a>00417                     FO1-&gt;<a class="code" href="classharvest_fields.html#abf0a1c96f2c3fd07843970bc1c4ae157">SetMainProduct</a>(aPlantItem1);
<a name="l00418"></a>00418                   <span class="keywordflow">break</span>;
<a name="l00419"></a>00419             <span class="keywordflow">default</span>:
<a name="l00420"></a>00420             <a class="code" href="message_8h.html#a8ad29009121a629982c6ade0bd332470">theMessage</a>-&gt;<a class="code" href="classmessage.html#af9891cb7111375e6a36363afffb09d63">FatalError</a>(<span class="stringliteral">&quot;static crop - invalid process product in field no&quot;</span>);<span class="comment">//, FO-&gt;GetFieldNumber());</span>
<a name="l00421"></a>00421          }
<a name="l00422"></a>00422       }
<a name="l00423"></a>00423       FO-&gt;<a class="code" href="classharvest_fields.html#a866acc00456f874d384414c557818194">SetCuttingHeight</a>(CuttingHeight);
<a name="l00424"></a>00424            aField-&gt;<a class="code" href="classfield.html#a83310dd2f0b81ec3178627f285e7535a">GivecrrPlan</a>()-&gt;<a class="code" href="classplan.html#a66bc896a7b501149627955ae025d62b0">InsertAsNextOperation</a>(FO);
<a name="l00425"></a>00425       <span class="keywordflow">if</span> (FO1)
<a name="l00426"></a>00426             <a class="code" href="message_8h.html#a8ad29009121a629982c6ade0bd332470">theMessage</a>-&gt;<a class="code" href="classmessage.html#af9891cb7111375e6a36363afffb09d63">FatalError</a>(<span class="stringliteral">&quot;grazing manager - operation not tested&quot;</span>); 
<a name="l00427"></a>00427 <span class="comment">//                 aField-&gt;GivecrrPlan()-&gt;InsertAsNextOperation(FO1);</span>
<a name="l00428"></a>00428 
<a name="l00429"></a>00429 
<a name="l00430"></a>00430 <span class="preprocessor">#endif</span>
<a name="l00431"></a>00431 <span class="preprocessor"></span>   <span class="keyword">delete</span> aPlantItem1;
<a name="l00432"></a>00432 
<a name="l00433"></a>00433 
<a name="l00434"></a>00434 
<a name="l00435"></a>00435 }
<a name="l00436"></a>00436 
<a name="l00437"></a>00437 
<a name="l00438"></a>00438 <span class="comment">/*******************************************************************</span>
<a name="l00439"></a>00439 <span class="comment">NJH Dec 2005 Estimate maximum accumulated growth for each field</span>
<a name="l00440"></a>00440 <span class="comment">Growth is in kg DM/ha</span>
<a name="l00441"></a>00441 <span class="comment">REPLACE WITH SOME STATIC CALCULATION, AS THIS METHOD DEPENDS ON A</span>
<a name="l00442"></a>00442 <span class="comment">PRECISE LOOK INTO THE FUTURE !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!@@@</span>
<a name="l00443"></a>00443 <span class="comment">********************************************************************/</span>
<a name="l00444"></a><a class="code" href="classgrazing_manager.html#a65c9a2762d9760f899bba4cb65b1e024">00444</a> <span class="keywordtype">void</span> <a class="code" href="classgrazing_manager.html#a65c9a2762d9760f899bba4cb65b1e024">grazingManager::InitialiseGrowthEstimates</a>()
<a name="l00445"></a>00445 {
<a name="l00446"></a>00446 <span class="comment">//   theMessage-&gt;FatalError(&quot;grazing_manager_class::InitialiseGrowthEstimates() - this code is not completed&quot;);</span>
<a name="l00447"></a>00447 
<a name="l00448"></a>00448    <a class="code" href="classbs_time.html">bsTime</a> *tempTime = <a class="code" href="bstime_8h.html#ac0dc3834220ee5ae84c115e146194d75">theTime</a>.<a class="code" href="classbs_time.html#a36b213ecefd6c4e7a51eac4c27483270">clone</a>();
<a name="l00449"></a>00449    <span class="keywordtype">double</span> maxGrowthRate=0.0;
<a name="l00450"></a>00450    <span class="keywordtype">int</span> daysWithGrowth=0;
<a name="l00451"></a>00451    <span class="keywordtype">int</span> daysWithoutGrowth=0;
<a name="l00452"></a>00452    <a class="code" href="climate_8h.html#ad05fb99191dc4a9cb94e7f8c99280389">theClimate</a>-&gt;<a class="code" href="classclimate.html#a959c6049cbb0c3d517966ef11f0cf0bc">CalcAverageClimate</a>();
<a name="l00453"></a>00453    <span class="keywordtype">int</span> totalDays = 365;
<a name="l00454"></a>00454    <span class="keywordflow">if</span> (<a class="code" href="bstime_8h.html#ac0dc3834220ee5ae84c115e146194d75">theTime</a>.<a class="code" href="classbs_time.html#a0f580ba0f0255ced05439c50049529d6">IsLeapYear</a>(<a class="code" href="bstime_8h.html#ac0dc3834220ee5ae84c115e146194d75">theTime</a>.<a class="code" href="classbs_time.html#afcb5953580c085bce20eb33a4b21e155">GetYear</a>()))
<a name="l00455"></a>00455         totalDays=366;
<a name="l00456"></a>00456    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0;j&lt;totalDays;j++)
<a name="l00457"></a>00457    {
<a name="l00458"></a>00458            <span class="keywordtype">bool</span> hasGrown = <span class="keyword">false</span>;
<a name="l00459"></a>00459       <a class="code" href="climate_8h.html#ad05fb99191dc4a9cb94e7f8c99280389">theClimate</a>-&gt;<a class="code" href="classclimate.html#ab8380f4e16a95955cb1707899166e65d">Update</a>(tempTime);
<a name="l00460"></a>00460       <span class="keywordtype">int</span> <a class="code" href="typer_8h.html#ae4c405e5c68c6ec2c44bb6d6adfc2f6ca0c8f8663af5d02dd407beb7decb7df37">day</a> = tempTime-&gt;<a class="code" href="classbs_time.html#a3b4126cf9db93be0c2f69549699730d3">GetDay</a>();
<a name="l00461"></a>00461       <span class="keywordtype">int</span> month = tempTime-&gt;<a class="code" href="classbs_time.html#a777a59c97951688c4b2a67c4b0bca16e">GetMonth</a>();
<a name="l00462"></a>00462       <span class="keywordtype">int</span> year = tempTime-&gt;<a class="code" href="classbs_time.html#afcb5953580c085bce20eb33a4b21e155">GetYear</a>();
<a name="l00463"></a>00463       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;theCropRotation -&gt;<a class="code" href="classcrop_rotation.html#ad85aaa3c1694c992e1a92fad544194b4">GetFields</a>()-&gt;<a class="code" href="classlink_list.html#aee3f890e4e8f48db1518e5114d5bcca8" title="Returned total number of nodes.">NumOfNodes</a>();i++)
<a name="l00464"></a>00464       {
<a name="l00465"></a>00465          <a class="code" href="classfield.html">field</a> *aField = theCropRotation -&gt;<a class="code" href="classcrop_rotation.html#ad85aaa3c1694c992e1a92fad544194b4">GetFields</a>()-&gt;<a class="code" href="classlink_list.html#a5735a6e54a2eed841bdf1fdb52aed03f" title="Return the address of the node with a given logical number in the list.">ElementAtNumber</a>(i);
<a name="l00466"></a>00466          maxGrowthRate=potentialGrowthFactor * aField-&gt;<a class="code" href="classfield.html#ac93fd3654dbd322021fcd0c92475e39b">InitExpectedGrowthRate</a>(<a class="code" href="climate_8h.html#ad05fb99191dc4a9cb94e7f8c99280389">theClimate</a>-&gt;<a class="code" href="classclimate.html#acabf247267712ae1a2d35358e3cc03f7">GetnormTemp</a>(month), <a class="code" href="climate_8h.html#ad05fb99191dc4a9cb94e7f8c99280389">theClimate</a>-&gt;<a class="code" href="classclimate.html#a2f109ffd62417e7151c7c816291bdbc8">GetnormRad</a>(month));
<a name="l00467"></a>00467          <span class="keywordtype">int</span> dayNumber = tempTime-&gt;<a class="code" href="classbs_time.html#af5a34894c96b25a0ba8cf2a15d94e714">GetJulianDay</a>()-1;
<a name="l00468"></a>00468          aField-&gt;<a class="code" href="classfield.html#a7a6c11488529bfc2cada2caec2f56dc1">SetexpectedGrowth</a>(dayNumber,maxGrowthRate);
<a name="l00469"></a>00469          <span class="keywordflow">if</span> (maxGrowthRate&gt;10.0)
<a name="l00470"></a>00470                 hasGrown = <span class="keyword">true</span>;
<a name="l00471"></a>00471          <span class="keywordflow">if</span> (tempTime-&gt;<a class="code" href="classbs_time.html#af5a34894c96b25a0ba8cf2a15d94e714">GetJulianDay</a>(day, month,year)&lt;springCutoffDay)
<a name="l00472"></a>00472                  aField-&gt;<a class="code" href="classfield.html#a3e63fc647748d3e072b82aeed08f2727">AddExpectedGrowth</a>(0,maxGrowthRate);
<a name="l00473"></a>00473                         <span class="keywordflow">else</span>
<a name="l00474"></a>00474                  aField-&gt;<a class="code" href="classfield.html#a3e63fc647748d3e072b82aeed08f2727">AddExpectedGrowth</a>(1,maxGrowthRate);
<a name="l00475"></a>00475       }
<a name="l00476"></a>00476       <span class="comment">//estimate the dates when growth starts and ends</span>
<a name="l00477"></a>00477       <span class="keywordflow">if</span> ((hasGrown)&amp;&amp;(tempTime-&gt;<a class="code" href="classbs_time.html#af5a34894c96b25a0ba8cf2a15d94e714">GetJulianDay</a>(day, month,year)&lt;springCutoffDay))
<a name="l00478"></a>00478                 daysWithGrowth++;
<a name="l00479"></a>00479       <span class="keywordflow">if</span> ((!hasGrown)&amp;&amp;(tempTime-&gt;<a class="code" href="classbs_time.html#af5a34894c96b25a0ba8cf2a15d94e714">GetJulianDay</a>(day, month,year)&gt;=springCutoffDay))
<a name="l00480"></a>00480                 daysWithoutGrowth++;
<a name="l00481"></a>00481                 <span class="keywordflow">if</span> ((!growthStart)&amp;&amp;(tempTime-&gt;<a class="code" href="classbs_time.html#af5a34894c96b25a0ba8cf2a15d94e714">GetJulianDay</a>(day, month,year)&lt;springCutoffDay)&amp;&amp;(daysWithGrowth&gt;10))
<a name="l00482"></a>00482         growthStart = tempTime-&gt;<a class="code" href="classbs_time.html#a36b213ecefd6c4e7a51eac4c27483270">clone</a>();
<a name="l00483"></a>00483                 <span class="keywordflow">if</span> ((!growthEnd)&amp;&amp;(tempTime-&gt;<a class="code" href="classbs_time.html#af5a34894c96b25a0ba8cf2a15d94e714">GetJulianDay</a>(day, month,year)&gt;=springCutoffDay)&amp;&amp;(daysWithoutGrowth&gt;10))
<a name="l00484"></a>00484         growthEnd = tempTime-&gt;<a class="code" href="classbs_time.html#a36b213ecefd6c4e7a51eac4c27483270">clone</a>();
<a name="l00485"></a>00485       tempTime-&gt;<a class="code" href="classbs_time.html#a0386f6d4b49e3c0fd6f04f523dbfc7af">AddOneDay</a>();
<a name="l00486"></a>00486    }
<a name="l00487"></a>00487    <span class="keyword">delete</span> tempTime;
<a name="l00488"></a>00488    <a class="code" href="climate_8h.html#ad05fb99191dc4a9cb94e7f8c99280389">theClimate</a>-&gt;<a class="code" href="classclimate.html#ab8380f4e16a95955cb1707899166e65d">Update</a>(&amp;<a class="code" href="bstime_8h.html#ac0dc3834220ee5ae84c115e146194d75">theTime</a>);
<a name="l00489"></a>00489 }
<a name="l00490"></a>00490 
<a name="l00491"></a>00491 
<a name="l00492"></a>00492 
<a name="l00493"></a><a class="code" href="classgrazing_manager.html#a52d950e97efbe047f9fec1493a0ce62e">00493</a> <span class="keywordtype">void</span> <a class="code" href="classgrazing_manager.html#a52d950e97efbe047f9fec1493a0ce62e">grazingManager::StartGrazingManagement</a>()
<a name="l00494"></a>00494 {
<a name="l00495"></a>00495 
<a name="l00496"></a>00496    fields_to_graze-&gt;<a class="code" href="classlink_list.html#a8005163404c8378ebb3b34d0e21da338" title="Delete all notes without deleting the elements.">ForgetAll</a>();
<a name="l00497"></a>00497    <a class="code" href="classgrazing_manager.html#a782edbd814727753f68ea5d041f79c9d">AutoGrazingPossible</a>();
<a name="l00498"></a>00498    fields_avail_to_graze-&gt;<a class="code" href="classlink_list.html#a8005163404c8378ebb3b34d0e21da338" title="Delete all notes without deleting the elements.">ForgetAll</a>();
<a name="l00499"></a>00499    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;theCropRotation -&gt;<a class="code" href="classcrop_rotation.html#ad85aaa3c1694c992e1a92fad544194b4">GetFields</a>()-&gt;<a class="code" href="classlink_list.html#aee3f890e4e8f48db1518e5114d5bcca8" title="Returned total number of nodes.">NumOfNodes</a>();i++)
<a name="l00500"></a>00500    {
<a name="l00501"></a>00501       <a class="code" href="classfield.html">field</a> * aField = theCropRotation -&gt;<a class="code" href="classcrop_rotation.html#ad85aaa3c1694c992e1a92fad544194b4">GetFields</a>()-&gt;<a class="code" href="classlink_list.html#a5735a6e54a2eed841bdf1fdb52aed03f" title="Return the address of the node with a given logical number in the list.">ElementAtNumber</a>(i);
<a name="l00502"></a>00502       <span class="keywordflow">if</span> (aField-&gt;<a class="code" href="classfield.html#a80a51fb0402683c89f7aa316210854e1">GetActive</a>() &amp;&amp; aField-&gt;<a class="code" href="classfield.html#aadde0ba8d453394c5e790f7e92c0cb35">GetGrazingPossible</a>())
<a name="l00503"></a>00503       {
<a name="l00504"></a>00504                         aField-&gt;<a class="code" href="classfield.html#a72edee119271bbed91109a3c648c61c6">SetGrazingShutDown</a>(<span class="keyword">false</span>);
<a name="l00505"></a>00505          aField-&gt;<a class="code" href="classfield.html#a83310dd2f0b81ec3178627f285e7535a">GivecrrPlan</a>()-&gt;<a class="code" href="classplan.html#a8a7b5b42e4b3ff4a705390733b2e38e2">RemoveHerbageHarvests</a>();
<a name="l00506"></a>00506                         fields_avail_to_graze-&gt;<a class="code" href="classlink_list.html#a5ef6013a096b9065c2c362fcd5113413" title="Inserts a new node at the end of the list.">InsertLast</a>(aField);
<a name="l00507"></a>00507       }
<a name="l00508"></a>00508    }
<a name="l00509"></a>00509    <a class="code" href="classgrazing_manager.html#ab0930ab0af01943e76429ecdbb9d9dfd">SortFields</a>();
<a name="l00510"></a>00510    SilageMade =0.0;
<a name="l00511"></a>00511         initialised=<span class="keyword">true</span>;
<a name="l00512"></a>00512    <a class="code" href="message_8h.html#a8ad29009121a629982c6ade0bd332470">theMessage</a>-&gt;<a class="code" href="classmessage.html#a9292720e75bec37fc568dfffbb02a68f">LogEventWithTime</a>(<span class="stringliteral">&quot;Grazing management started&quot;</span>);
<a name="l00513"></a>00513 }
<a name="l00514"></a>00514 
<a name="l00515"></a>00515 <span class="comment">/***************************************</span>
<a name="l00516"></a>00516 <span class="comment">Sort fields into order of distance from steading</span>
<a name="l00517"></a>00517 <span class="comment">***************************************/</span>
<a name="l00518"></a><a class="code" href="classgrazing_manager.html#ab0930ab0af01943e76429ecdbb9d9dfd">00518</a> <span class="keywordtype">void</span> <a class="code" href="classgrazing_manager.html#ab0930ab0af01943e76429ecdbb9d9dfd">grazingManager::SortFields</a>()
<a name="l00519"></a>00519 {
<a name="l00520"></a>00520    <span class="keywordtype">int</span> counter;
<a name="l00521"></a>00521         <a class="code" href="nixcbits_8h.html#a68ab5d5d2952c9fb1dda8c9c933238c8">temp_double_array</a> distances;
<a name="l00522"></a>00522         <a class="code" href="nixcbits_8h.html#a9591c51efe1722a99382057dd6042cce">temp_ptr_array</a> ptrlist;
<a name="l00523"></a>00523    <span class="keywordtype">int</span> numOfFields = fields_avail_to_graze-&gt;<a class="code" href="classlink_list.html#aee3f890e4e8f48db1518e5114d5bcca8" title="Returned total number of nodes.">NumOfNodes</a>();
<a name="l00524"></a>00524    <span class="keywordflow">for</span> (counter=numOfFields-1;counter&gt;=0;counter--)
<a name="l00525"></a>00525    {
<a name="l00526"></a>00526         <a class="code" href="classfield.html">field</a> *aField = fields_avail_to_graze-&gt;<a class="code" href="classlink_list.html#a5735a6e54a2eed841bdf1fdb52aed03f" title="Return the address of the node with a given logical number in the list.">ElementAtNumber</a>(counter);
<a name="l00527"></a>00527       distances[counter]=aField-&gt;<a class="code" href="classfield.html#aab17aa694538578ace4f6fc40cc561fc">DistanceToField_</a>();
<a name="l00528"></a>00528         ptrlist[counter]=(<span class="keywordtype">void</span>*) aField;
<a name="l00529"></a>00529         }
<a name="l00530"></a>00530    <a class="code" href="nixcbits_8cpp.html#ae4db44782fbd1eb57b8a6e355c721deb">Comsort</a>(distances, ptrlist, numOfFields);
<a name="l00531"></a>00531    fields_avail_to_graze-&gt;<a class="code" href="classlink_list.html#a8005163404c8378ebb3b34d0e21da338" title="Delete all notes without deleting the elements.">ForgetAll</a>();
<a name="l00532"></a>00532    <span class="keywordflow">for</span> (counter=0;counter&lt;numOfFields;counter++)
<a name="l00533"></a>00533    {
<a name="l00534"></a>00534                 fields_avail_to_graze-&gt;<a class="code" href="classlink_list.html#a5ef6013a096b9065c2c362fcd5113413" title="Inserts a new node at the end of the list.">InsertLast</a>((<a class="code" href="classfield.html">field</a>*) ptrlist[counter]);
<a name="l00535"></a>00535    }
<a name="l00536"></a>00536 }
<a name="l00537"></a>00537 
<a name="l00538"></a>00538 <span class="comment">/***************************************</span>
<a name="l00539"></a>00539 <span class="comment">***************************************/</span>
<a name="l00540"></a><a class="code" href="classgrazing_manager.html#af4d75fc52160ba2df1afa74db9727e5c">00540</a> <span class="keywordtype">void</span> <a class="code" href="classgrazing_manager.html#af4d75fc52160ba2df1afa74db9727e5c">grazingManager::SetGrazing</a>(<a class="code" href="classbs_time.html">bsTime</a> * aDate, <span class="keywordtype">int</span> duration, <span class="keywordtype">int</span> *numOthers)
<a name="l00541"></a>00541 {
<a name="l00542"></a>00542         <span class="keywordtype">double</span> grazedFeedReq;
<a name="l00543"></a>00543    fields_to_graze-&gt;<a class="code" href="classlink_list.html#a8005163404c8378ebb3b34d0e21da338" title="Delete all notes without deleting the elements.">ForgetAll</a>();
<a name="l00544"></a>00544    aDate-&gt;<a class="code" href="classbs_time.html#a251f783d4c967ab24b9509e7f46f4785">AddDays</a>(duration);
<a name="l00545"></a>00545    <span class="keywordtype">double</span> currentHerbageMass=0.0;
<a name="l00546"></a>00546 <span class="comment">//start with followers</span>
<a name="l00547"></a>00547    grazedFeedReq =(double) duration * theCattleFeedingManager-&gt;<a class="code" href="classcattle_feeding_manager.html#aa1f06485a79e16288f2c99bb85f078b0">GetFollowerHerbageRequired</a>(<span class="keyword">false</span>);     <span class="comment">//in tonnes DM</span>
<a name="l00548"></a>00548    <span class="keywordtype">double</span> feedAvailable=0.0; <span class="comment">//in tonnes DM</span>
<a name="l00549"></a>00549    <span class="keywordtype">double</span> newGrowth=0.0;
<a name="l00550"></a>00550    <span class="keywordtype">int</span> i=fields_avail_to_graze-&gt;<a class="code" href="classlink_list.html#aee3f890e4e8f48db1518e5114d5bcca8" title="Returned total number of nodes.">NumOfNodes</a>()-1;
<a name="l00551"></a>00551    <span class="comment">//allocate fields, starting with those that are furthest from the steading</span>
<a name="l00552"></a>00552    <span class="keywordflow">while</span> ((i&gt;=0)&amp;&amp;(feedAvailable &lt; grazedFeedReq))
<a name="l00553"></a>00553    {
<a name="l00554"></a>00554         <a class="code" href="classfield.html">field</a> *aField = fields_avail_to_graze-&gt;<a class="code" href="classlink_list.html#a5735a6e54a2eed841bdf1fdb52aed03f" title="Return the address of the node with a given logical number in the list.">ElementAtNumber</a>(i);
<a name="l00555"></a>00555       aField-&gt;<a class="code" href="classfield.html#a72edee119271bbed91109a3c648c61c6">SetGrazingShutDown</a>(<span class="keyword">false</span>);
<a name="l00556"></a>00556                 fields_to_graze-&gt;<a class="code" href="classlink_list.html#a5ef6013a096b9065c2c362fcd5113413" title="Inserts a new node at the end of the list.">InsertLast</a>(aField);
<a name="l00557"></a>00557       newGrowth+=duration * <a class="code" href="classgrazing_manager.html#a92d31c0f475ac2aaed6b01b1b72d5a57">GetAverageGrowthRate</a>(aDate, i, duration) * aField-&gt;<a class="code" href="classfield.html#ac4c5edc4de9c9035c58c7204356a12b0">GetArea</a>()/1000.0;
<a name="l00558"></a>00558       currentHerbageMass+= aField-&gt;<a class="code" href="classfield.html#a5faf5dbca7ad4c4a2f33f7104fd3908e">GetAvailableHerbageMasskg</a>(residualDM)/1000.0;
<a name="l00559"></a>00559       feedAvailable = currentHerbageMass + newGrowth;
<a name="l00560"></a>00560       i--;
<a name="l00561"></a>00561    }
<a name="l00562"></a>00562    <span class="keywordtype">int</span> minOthers = i+1;   <span class="comment">//lowest number of field in fields_avail_to_graze that has been allocated to animals other than dairy cattle</span>
<a name="l00563"></a>00563    *numOthers = fields_to_graze-&gt;<a class="code" href="classlink_list.html#aee3f890e4e8f48db1518e5114d5bcca8" title="Returned total number of nodes.">NumOfNodes</a>();  <span class="comment">//number of fields grazed by animals other than dairy cattle</span>
<a name="l00564"></a>00564 
<a name="l00565"></a>00565 <span class="comment">//Now allocate fields to dairy cattle, starting with those closest to the steading</span>
<a name="l00566"></a>00566    grazedFeedReq =((double) duration) * theCattleFeedingManager-&gt;<a class="code" href="classcattle_feeding_manager.html#a8d59a8ddd47dfd6a2870b6441d0d5b2c">GetDairyHerbageRequired</a>(<span class="keyword">false</span>);   <span class="comment">//tonnes DM</span>
<a name="l00567"></a>00567    newGrowth=0.0;
<a name="l00568"></a>00568    feedAvailable=0.0;
<a name="l00569"></a>00569    currentHerbageMass=0.0;
<a name="l00570"></a>00570    i=0;
<a name="l00571"></a>00571    <span class="keywordflow">while</span> ((i&lt;minOthers)&amp;&amp;(feedAvailable &lt; grazedFeedReq))
<a name="l00572"></a>00572    {
<a name="l00573"></a>00573         <a class="code" href="classfield.html">field</a> *aField = fields_avail_to_graze-&gt;<a class="code" href="classlink_list.html#a5735a6e54a2eed841bdf1fdb52aed03f" title="Return the address of the node with a given logical number in the list.">ElementAtNumber</a>(i);
<a name="l00574"></a>00574       aField-&gt;<a class="code" href="classfield.html#a72edee119271bbed91109a3c648c61c6">SetGrazingShutDown</a>(<span class="keyword">false</span>);
<a name="l00575"></a>00575                 fields_to_graze-&gt;<a class="code" href="classlink_list.html#a5ef6013a096b9065c2c362fcd5113413" title="Inserts a new node at the end of the list.">InsertLast</a>(aField);
<a name="l00576"></a>00576       newGrowth+=duration * <a class="code" href="classgrazing_manager.html#a92d31c0f475ac2aaed6b01b1b72d5a57">GetAverageGrowthRate</a>(aDate, i, duration) * aField-&gt;<a class="code" href="classfield.html#ac4c5edc4de9c9035c58c7204356a12b0">GetArea</a>()/1000.0;
<a name="l00577"></a>00577       currentHerbageMass+= aField-&gt;<a class="code" href="classfield.html#a5faf5dbca7ad4c4a2f33f7104fd3908e">GetAvailableHerbageMasskg</a>(residualDM)/1000.0;
<a name="l00578"></a>00578       feedAvailable = currentHerbageMass + newGrowth;
<a name="l00579"></a>00579       i++;
<a name="l00580"></a>00580    }
<a name="l00581"></a>00581 
<a name="l00582"></a>00582 <span class="comment">//shut down grazing on any remaining fields</span>
<a name="l00583"></a>00583    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> counter=i;counter&lt;minOthers;counter++)
<a name="l00584"></a>00584    {
<a name="l00585"></a>00585         <a class="code" href="classfield.html">field</a> *aField = fields_avail_to_graze-&gt;<a class="code" href="classlink_list.html#a5735a6e54a2eed841bdf1fdb52aed03f" title="Return the address of the node with a given logical number in the list.">ElementAtNumber</a>(counter);
<a name="l00586"></a>00586       aField-&gt;<a class="code" href="classfield.html#a72edee119271bbed91109a3c648c61c6">SetGrazingShutDown</a>(<span class="keyword">true</span>);
<a name="l00587"></a>00587    }
<a name="l00588"></a>00588    <span class="keywordflow">if</span> (fields_to_graze-&gt;<a class="code" href="classlink_list.html#aee3f890e4e8f48db1518e5114d5bcca8" title="Returned total number of nodes.">NumOfNodes</a>()&gt;0)
<a name="l00589"></a>00589            <a class="code" href="message_8h.html#a8ad29009121a629982c6ade0bd332470">theMessage</a>-&gt;<a class="code" href="classmessage.html#a9292720e75bec37fc568dfffbb02a68f">LogEventWithTime</a>(<span class="stringliteral">&quot;Fields grazed &quot;</span>, fields_to_graze-&gt;<a class="code" href="classlink_list.html#aee3f890e4e8f48db1518e5114d5bcca8" title="Returned total number of nodes.">NumOfNodes</a>());
<a name="l00590"></a>00590 }
<a name="l00591"></a>00591 
<a name="l00592"></a>00592 <span class="comment">/*****************************</span>
<a name="l00593"></a>00593 <span class="comment">Returns the expected growth rate from a particular field for a date, measured in kgDM/ha/d</span>
<a name="l00594"></a>00594 <span class="comment">REPLACE WITH SOME STATIC CALCULATION, AS THIS METHOD DEPENDS ON A</span>
<a name="l00595"></a>00595 <span class="comment">PRECISE LOOK INTO THE FUTURE !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!@@@</span>
<a name="l00596"></a>00596 <span class="comment">*****************************/</span>
<a name="l00597"></a><a class="code" href="classgrazing_manager.html#aa45455953b5da3c6c7898c9e99bb274b">00597</a> <span class="keywordtype">double</span> <a class="code" href="classgrazing_manager.html#aa45455953b5da3c6c7898c9e99bb274b">grazingManager::GetExpectedGrowthRate</a>(<a class="code" href="classbs_time.html">bsTime</a> *aDate, <span class="keywordtype">int</span> fieldNo)
<a name="l00598"></a>00598 {
<a name="l00599"></a>00599         <a class="code" href="classfield.html">field</a> *aField = fields_avail_to_graze-&gt;<a class="code" href="classlink_list.html#a5735a6e54a2eed841bdf1fdb52aed03f" title="Return the address of the node with a given logical number in the list.">ElementAtNumber</a>(fieldNo);
<a name="l00600"></a>00600    <span class="keywordtype">double</span> ret_val;
<a name="l00601"></a>00601 <span class="comment">//   double expectedGrowth =aField-&gt;GetExpectedGrowth(aDate); //cumulative growth in either spring or summer</span>
<a name="l00602"></a>00602    <span class="keywordtype">int</span> JulianaDate = aDate-&gt;<a class="code" href="classbs_time.html#af5a34894c96b25a0ba8cf2a15d94e714">GetJulianDay</a>();
<a name="l00603"></a>00603    ret_val =aField-&gt;<a class="code" href="classfield.html#a090eef7a1e95aaa0d997f14952d7068e">GetexpectedGrowth</a>(JulianaDate); <span class="comment">//cumulative growth in either spring or summer</span>
<a name="l00604"></a>00604 <span class="comment">/*   int JulianStart = growthStart-&gt;GetJulianDay();</span>
<a name="l00605"></a>00605 <span class="comment">   int JulianEnd = growthEnd-&gt;GetJulianDay();</span>
<a name="l00606"></a>00606 <span class="comment">   if (JulianaDate&lt;=springCutoffDay)              //calculate the appropriate expected daily growth rate in kg DM/ha</span>
<a name="l00607"></a>00607 <span class="comment">     ret_val = 2 * (JulianaDate - JulianStart) * expectedGrowth/((springCutoffDay - JulianStart)*(springCutoffDay - JulianStart));</span>
<a name="l00608"></a>00608 <span class="comment">   else</span>
<a name="l00609"></a>00609 <span class="comment">     ret_val = 2 *(JulianaDate - springCutoffDay) * expectedGrowth/((JulianEnd-springCutoffDay)*(JulianEnd-springCutoffDay));*/</span>
<a name="l00610"></a>00610 
<a name="l00611"></a>00611 
<a name="l00612"></a>00612    <span class="keywordflow">return</span> ret_val;
<a name="l00613"></a>00613 }
<a name="l00614"></a>00614 
<a name="l00615"></a>00615 <span class="comment">/*****************************</span>
<a name="l00616"></a>00616 <span class="comment">*****************************/</span>
<a name="l00617"></a><a class="code" href="classgrazing_manager.html#abc0c9f087272175f7d3f7f7d099c7fd8">00617</a> <span class="keywordtype">bool</span> <a class="code" href="classgrazing_manager.html#abc0c9f087272175f7d3f7f7d099c7fd8">grazingManager::CutConservationFields</a>(<span class="keywordtype">bool</span> forceCut)
<a name="l00618"></a>00618 {
<a name="l00619"></a>00619         <span class="keywordtype">bool</span> ret_val=<span class="keyword">false</span>;
<a name="l00620"></a>00620         <span class="keywordtype">int</span> growthPeriod=0;
<a name="l00621"></a>00621    <span class="keywordflow">if</span> (<a class="code" href="bstime_8h.html#ac0dc3834220ee5ae84c115e146194d75">theTime</a>.<a class="code" href="classbs_time.html#af5a34894c96b25a0ba8cf2a15d94e714">GetJulianDay</a>()&gt;springCutoffDay)
<a name="l00622"></a>00622         growthPeriod=1;
<a name="l00623"></a>00623         <span class="keywordtype">int</span> numFieldsToCut=0;
<a name="l00624"></a>00624    <span class="keywordtype">int</span> numOfFields = fields_avail_to_graze-&gt;<a class="code" href="classlink_list.html#aee3f890e4e8f48db1518e5114d5bcca8" title="Returned total number of nodes.">NumOfNodes</a>();
<a name="l00625"></a>00625    <span class="keywordtype">int</span> numCuttableFields= numOfFields-fields_to_graze-&gt;<a class="code" href="classlink_list.html#aee3f890e4e8f48db1518e5114d5bcca8" title="Returned total number of nodes.">NumOfNodes</a>();
<a name="l00626"></a>00626    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> counter=0;counter&lt;numOfFields;counter++)
<a name="l00627"></a>00627    {
<a name="l00628"></a>00628         <a class="code" href="classfield.html">field</a> *aField = fields_avail_to_graze-&gt;<a class="code" href="classlink_list.html#a5735a6e54a2eed841bdf1fdb52aed03f" title="Return the address of the node with a given logical number in the list.">ElementAtNumber</a>(counter);
<a name="l00629"></a>00629       <span class="keywordflow">if</span> (aField-&gt;<a class="code" href="classfield.html#aaa75ae81d0511e47197059ee64b38dc5">GetGrazingShutDown</a>())
<a name="l00630"></a>00630       {
<a name="l00631"></a>00631         <span class="keywordtype">double</span> massDensity =aField-&gt;<a class="code" href="classfield.html#a32c9aa62de35c4671da6b21621eb66ea">GetAvailableHerbageMasskgPerHa</a>(residualDM)/1000.0;
<a name="l00632"></a>00632         <span class="keywordflow">if</span> ( (massDensity&gt;=targetCutMass[growthPeriod])||(forceCut))
<a name="l00633"></a>00633                numFieldsToCut++;  <span class="comment">//Count fields to cut</span>
<a name="l00634"></a>00634       }
<a name="l00635"></a>00635    }
<a name="l00636"></a>00636    <span class="keywordflow">if</span> (numCuttableFields&gt;0)
<a name="l00637"></a>00637    {
<a name="l00638"></a>00638         <span class="keywordflow">if</span> (2*numFieldsToCut&gt;=numCuttableFields) <span class="comment">//only cut when half of the cuttable fields are ready</span>
<a name="l00639"></a>00639       {
<a name="l00640"></a>00640          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> counter=0;counter&lt;numOfFields;counter++)
<a name="l00641"></a>00641          {
<a name="l00642"></a>00642             <a class="code" href="classfield.html">field</a> *aField = fields_avail_to_graze-&gt;<a class="code" href="classlink_list.html#a5735a6e54a2eed841bdf1fdb52aed03f" title="Return the address of the node with a given logical number in the list.">ElementAtNumber</a>(counter);
<a name="l00643"></a>00643             <span class="keywordflow">if</span> (aField-&gt;<a class="code" href="classfield.html#aaa75ae81d0511e47197059ee64b38dc5">GetGrazingShutDown</a>())
<a name="l00644"></a>00644             {
<a name="l00645"></a>00645                 SilageMade+=aField-&gt;<a class="code" href="classfield.html#a5faf5dbca7ad4c4a2f33f7104fd3908e">GetAvailableHerbageMasskg</a>(residualDM)/1000.0;
<a name="l00646"></a>00646                <a class="code" href="classgrazing_manager.html#a6f01332621905d316bb39c5f51169dd9">InsertCut</a>(aField,<span class="keyword">true</span>);  <span class="comment">//Cut that grass!!</span>
<a name="l00647"></a>00647             }
<a name="l00648"></a>00648          }
<a name="l00649"></a>00649          ret_val=<span class="keyword">true</span>;
<a name="l00650"></a>00650       }
<a name="l00651"></a>00651       <span class="keywordflow">else</span>
<a name="l00652"></a>00652          periodEnd-&gt;<a class="code" href="classbs_time.html#a0386f6d4b49e3c0fd6f04f523dbfc7af">AddOneDay</a>();
<a name="l00653"></a>00653    }
<a name="l00654"></a>00654    <span class="keywordflow">else</span>
<a name="l00655"></a>00655                 ret_val=<span class="keyword">true</span>;
<a name="l00656"></a>00656 
<a name="l00657"></a>00657    <span class="keywordflow">return</span> ret_val;
<a name="l00658"></a>00658 }
<a name="l00659"></a>00659 
<a name="l00660"></a>00660 <span class="comment">/*******************************************************************</span>
<a name="l00661"></a>00661 <span class="comment">NJH May 2004 Estimate average growth rate in next period (kg DM/ha/day)</span>
<a name="l00662"></a>00662 <span class="comment">********************************************************************/</span>
<a name="l00663"></a><a class="code" href="classgrazing_manager.html#a92d31c0f475ac2aaed6b01b1b72d5a57">00663</a> <span class="keywordtype">double</span> <a class="code" href="classgrazing_manager.html#a92d31c0f475ac2aaed6b01b1b72d5a57">grazingManager::GetAverageGrowthRate</a>(<a class="code" href="classbs_time.html">bsTime</a> * aDate, <span class="keywordtype">int</span> fieldNo, <span class="keywordtype">int</span> duration)
<a name="l00664"></a>00664 {
<a name="l00665"></a>00665         <span class="keywordtype">double</span> growthRate=0.0;
<a name="l00666"></a>00666    <a class="code" href="classbs_time.html">bsTime</a> *tempTime = aDate-&gt;<a class="code" href="classbs_time.html#a36b213ecefd6c4e7a51eac4c27483270">clone</a>();
<a name="l00667"></a>00667    <span class="keywordtype">int</span> JulianStartPeriod = aDate-&gt;<a class="code" href="classbs_time.html#af5a34894c96b25a0ba8cf2a15d94e714">GetJulianDay</a>();
<a name="l00668"></a>00668    <span class="keywordtype">int</span> JulianEndPeriod = JulianStartPeriod + duration;
<a name="l00669"></a>00669    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=JulianStartPeriod; i&lt;JulianEndPeriod; i++)
<a name="l00670"></a>00670    {
<a name="l00671"></a>00671                 growthRate+=<a class="code" href="classgrazing_manager.html#aa45455953b5da3c6c7898c9e99bb274b">GetExpectedGrowthRate</a>(tempTime, fieldNo);
<a name="l00672"></a>00672       tempTime-&gt;<a class="code" href="classbs_time.html#a0386f6d4b49e3c0fd6f04f523dbfc7af">AddOneDay</a>();
<a name="l00673"></a>00673    }
<a name="l00674"></a>00674    growthRate/=duration;
<a name="l00675"></a>00675    <span class="keyword">delete</span> tempTime;
<a name="l00676"></a>00676    <span class="keywordflow">return</span> growthRate;
<a name="l00677"></a>00677 }
<a name="l00678"></a>00678 
<a name="l00679"></a><a class="code" href="classgrazing_manager.html#a6d936f90c10dfc4f5bf7e7eddc3b85c0">00679</a> <span class="keywordtype">void</span> <a class="code" href="classgrazing_manager.html#a6d936f90c10dfc4f5bf7e7eddc3b85c0">grazingManager::EndOfSeason</a>(<span class="keywordtype">bool</span> topping)
<a name="l00680"></a>00680 {
<a name="l00681"></a>00681    <span class="keywordtype">int</span> numOfFields = fields_avail_to_graze-&gt;<a class="code" href="classlink_list.html#aee3f890e4e8f48db1518e5114d5bcca8" title="Returned total number of nodes.">NumOfNodes</a>();
<a name="l00682"></a>00682    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> counter=0;counter&lt;numOfFields;counter++)
<a name="l00683"></a>00683    {
<a name="l00684"></a>00684       <a class="code" href="classfield.html">field</a> *aField = fields_avail_to_graze-&gt;<a class="code" href="classlink_list.html#a5735a6e54a2eed841bdf1fdb52aed03f" title="Return the address of the node with a given logical number in the list.">ElementAtNumber</a>(counter);
<a name="l00685"></a>00685         <span class="keywordtype">double</span> massDensity =aField-&gt;<a class="code" href="classfield.html#a32c9aa62de35c4671da6b21621eb66ea">GetAvailableHerbageMasskgPerHa</a>(residualDM)/1000.0;
<a name="l00686"></a>00686       <span class="keywordflow">if</span> ((massDensity&gt;=targetCutMass[1])&amp;&amp; (!topping))
<a name="l00687"></a>00687          <a class="code" href="classgrazing_manager.html#a6f01332621905d316bb39c5f51169dd9">InsertCut</a>(aField,<span class="keyword">true</span>);  <span class="comment">//Cut grass and harvest</span>
<a name="l00688"></a>00688       <span class="keywordflow">else</span>
<a name="l00689"></a>00689          <a class="code" href="classgrazing_manager.html#a6f01332621905d316bb39c5f51169dd9">InsertCut</a>(aField,<span class="keyword">false</span>);  <span class="comment">//Cut grass but leave it lying</span>
<a name="l00690"></a>00690    }
<a name="l00691"></a>00691         currentPeriod=0;
<a name="l00692"></a>00692    <span class="keyword">delete</span> periodEnd;
<a name="l00693"></a>00693    initialised=<span class="keyword">false</span>;
<a name="l00694"></a>00694         periodEnd=theCattleFeedingManager-&gt;<a class="code" href="classcattle_feeding_manager.html#a6fc27712d1be3fb9f192446d09f9e143">GetTurnoutDate</a>()-&gt;<a class="code" href="classbs_time.html#a36b213ecefd6c4e7a51eac4c27483270">clone</a>();
<a name="l00695"></a>00695 }
<a name="l00696"></a>00696 
<a name="l00697"></a>00697 <span class="comment">/***************************************</span>
<a name="l00698"></a>00698 <span class="comment">***************************************/</span>
<a name="l00699"></a><a class="code" href="classgrazing_manager.html#a6f11fda1e9b60ffac195adb3d93d6ca7">00699</a> <span class="keywordtype">void</span> <a class="code" href="classgrazing_manager.html#a6f11fda1e9b60ffac195adb3d93d6ca7">grazingManager::SetGrazingAll</a>()
<a name="l00700"></a>00700 {
<a name="l00701"></a>00701    fields_to_graze-&gt;<a class="code" href="classlink_list.html#a8005163404c8378ebb3b34d0e21da338" title="Delete all notes without deleting the elements.">ForgetAll</a>();
<a name="l00702"></a>00702    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;fields_avail_to_graze-&gt;<a class="code" href="classlink_list.html#aee3f890e4e8f48db1518e5114d5bcca8" title="Returned total number of nodes.">NumOfNodes</a>();i++)
<a name="l00703"></a>00703    {
<a name="l00704"></a>00704       <a class="code" href="classfield.html">field</a> *aField = fields_avail_to_graze-&gt;<a class="code" href="classlink_list.html#a5735a6e54a2eed841bdf1fdb52aed03f" title="Return the address of the node with a given logical number in the list.">ElementAtNumber</a>(i);
<a name="l00705"></a>00705       aField-&gt;<a class="code" href="classfield.html#a72edee119271bbed91109a3c648c61c6">SetGrazingShutDown</a>(<span class="keyword">false</span>);
<a name="l00706"></a>00706                 fields_to_graze-&gt;<a class="code" href="classlink_list.html#a5ef6013a096b9065c2c362fcd5113413" title="Inserts a new node at the end of the list.">InsertLast</a>(aField);
<a name="l00707"></a>00707    }
<a name="l00708"></a>00708 
<a name="l00709"></a>00709 <span class="comment">//   theMessage-&gt;LogEvent(&quot;Fields grazed &quot;, fields_to_graze-&gt;NumOfNodes());</span>
<a name="l00710"></a>00710 }
<a name="l00711"></a>00711 
<a name="l00712"></a><a class="code" href="classgrazing_manager.html#aa831a26148a1171fce3f1e2971135d34">00712</a> <span class="keywordtype">bool</span> <a class="code" href="classgrazing_manager.html#aa831a26148a1171fce3f1e2971135d34">grazingManager::CheckGrazingTheshold</a>()
<a name="l00713"></a>00713 {
<a name="l00714"></a>00714 <span class="comment">//      double areaAvailable = GetGrazingAreaAvailable();</span>
<a name="l00715"></a>00715    <span class="keywordtype">double</span> grazedFeedReq =theCattleFeedingManager-&gt;<a class="code" href="classcattle_feeding_manager.html#a2ba749a4e41bab1a7fac88fdc7783449">GetHerbageRequired</a>(0,theCattleFeedingManager-&gt;<a class="code" href="classcattle_feeding_manager.html#a625686a337bc7f33fcc6e71cc426da61">GetNumFeedingGroups</a>()-1, <span class="keyword">false</span>);
<a name="l00716"></a>00716         grazedFeedReq +=theCattleFeedingManager-&gt;<a class="code" href="classcattle_feeding_manager.html#a2ba749a4e41bab1a7fac88fdc7783449">GetHerbageRequired</a>(0,theCattleFeedingManager-&gt;<a class="code" href="classcattle_feeding_manager.html#a625686a337bc7f33fcc6e71cc426da61">GetNumFeedingGroups</a>()-1, <span class="keyword">true</span>);
<a name="l00717"></a>00717    <span class="keywordflow">if</span> (grazedFeedReq&gt;0.0)
<a name="l00718"></a>00718    {
<a name="l00719"></a>00719                 <span class="keywordtype">double</span> herbageAllowance = <a class="code" href="classgrazing_manager.html#a9d3a5982adf0406463307e6b25a62f0c">GetHerbageAvailability</a>(<span class="keyword">false</span>)/grazedFeedReq;
<a name="l00720"></a>00720            <span class="keywordflow">if</span> (herbageAllowance&gt;turnoutThreshold)
<a name="l00721"></a>00721         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00722"></a>00722       <span class="keywordflow">else</span>
<a name="l00723"></a>00723         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00724"></a>00724    }
<a name="l00725"></a>00725         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00726"></a>00726 
<a name="l00727"></a>00727 }
<a name="l00728"></a><a class="code" href="classgrazing_manager.html#ac5d9211b46dabde68fb3038bfad1752b">00728</a> <span class="keywordtype">void</span> <a class="code" href="classgrazing_manager.html#ac5d9211b46dabde68fb3038bfad1752b">grazingManager::GetStatus</a>()
<a name="l00729"></a>00729 {
<a name="l00730"></a>00730    <span class="comment">//int numGrazableFields = GetNumGrazableFields();</span>
<a name="l00731"></a>00731 <span class="comment">//   int numFieldsGrazed = fields_avail_to_graze-&gt;NumOfNodes();</span>
<a name="l00732"></a>00732    <span class="keywordflow">if</span> (<a class="code" href="output_data_8h.html#aadc9d3b76fa69bf28c5ab340dd810e20">theOutputData</a>-&gt;<a class="code" href="classoutput_data.html#ae50b979972f6c57c3881edd6a7dd96b4">DetailsData</a>.<a class="code" href="classoutput_details.html#a6f2663357cecc863a74ffa3b36edbdfa">getPastureDetails</a>())
<a name="l00733"></a>00733    {
<a name="l00734"></a>00734         *grazmanfile &lt;&lt; <a class="code" href="bstime_8h.html#ac0dc3834220ee5ae84c115e146194d75">theTime</a>.<a class="code" href="classbs_time.html#afcb5953580c085bce20eb33a4b21e155">GetYear</a>() &lt;&lt; <span class="stringliteral">&quot;-&quot;</span> &lt;&lt; <a class="code" href="bstime_8h.html#ac0dc3834220ee5ae84c115e146194d75">theTime</a>.<a class="code" href="classbs_time.html#a777a59c97951688c4b2a67c4b0bca16e">GetMonth</a>() &lt;&lt; <span class="stringliteral">&quot;-&quot;</span> &lt;&lt; <a class="code" href="bstime_8h.html#ac0dc3834220ee5ae84c115e146194d75">theTime</a>.<a class="code" href="classbs_time.html#a3b4126cf9db93be0c2f69549699730d3">GetDay</a>() &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span>;
<a name="l00735"></a>00735            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;theCropRotation -&gt;<a class="code" href="classcrop_rotation.html#ad85aaa3c1694c992e1a92fad544194b4">GetFields</a>()-&gt;<a class="code" href="classlink_list.html#aee3f890e4e8f48db1518e5114d5bcca8" title="Returned total number of nodes.">NumOfNodes</a>();i++)
<a name="l00736"></a>00736         {
<a name="l00737"></a>00737          <span class="keywordtype">double</span> proteinConc = 0.0;
<a name="l00738"></a>00738          <span class="keywordtype">double</span> FEperKgDM = 0.0;
<a name="l00739"></a>00739               <a class="code" href="classfield.html">field</a> *aField = theCropRotation -&gt;<a class="code" href="classcrop_rotation.html#ad85aaa3c1694c992e1a92fad544194b4">GetFields</a>()-&gt;<a class="code" href="classlink_list.html#a5735a6e54a2eed841bdf1fdb52aed03f" title="Return the address of the node with a given logical number in the list.">ElementAtNumber</a>(i);
<a name="l00740"></a>00740          <span class="keywordtype">double</span> mass = aField-&gt;<a class="code" href="classfield.html#ad5e1460e730daa874bb7b0fced8ebb5a">GetHerbageMasskg</a>();
<a name="l00741"></a>00741          <span class="keywordtype">double</span> area = aField-&gt;<a class="code" href="classfield.html#ac4c5edc4de9c9035c58c7204356a12b0">GetArea</a>();
<a name="l00742"></a>00742 <span class="comment">//              if (aField-&gt;GetActive() &amp;&amp; aField-&gt;GetGrazingPossible())</span>
<a name="l00743"></a>00743         <span class="keywordflow">if</span> (aField-&gt;<a class="code" href="classfield.html#a80a51fb0402683c89f7aa316210854e1">GetActive</a>())
<a name="l00744"></a>00744         {
<a name="l00745"></a>00745             <span class="keywordflow">if</span> (aField-&gt;<a class="code" href="classfield.html#aedfd65c34ae6b67acbd5cdfb2e5d1a9e">GetHerbageMasskgPerHa</a>()&gt;100.0)    <span class="comment">//avoid daft values that occur just after sowing</span>
<a name="l00746"></a>00746             {
<a name="l00747"></a>00747                proteinConc=aField-&gt;<a class="code" href="classfield.html#a106ff033bc0271d52377d1c25b5e297b">GetAbovegroundCropN</a>()*<a class="code" href="nixcbits_8cpp.html#a2ea878dfbe195112a4eb66ca7e322184">N_to_protein</a>()*1000.0/mass;
<a name="l00748"></a>00748                FEperKgDM = <a class="code" href="nixcbits_8cpp.html#a7f982a8e545dc43b732c54de10fdfba1">N_to_FE</a>(proteinConc/(<a class="code" href="nixcbits_8cpp.html#a2ea878dfbe195112a4eb66ca7e322184">N_to_protein</a>() * 1000.0));
<a name="l00749"></a>00749             }
<a name="l00750"></a>00750             mass/=1000.0;
<a name="l00751"></a>00751          }
<a name="l00752"></a>00752          *grazmanfile &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; (mass/area) &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; proteinConc &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; FEperKgDM
<a name="l00753"></a>00753                         &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; aField-&gt;<a class="code" href="classfield.html#a3b566f2cfcd110bb6acdc6912d3ab3c9">GetDailyDMProduction</a>()/area &lt;&lt;<span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; aField-&gt;<a class="code" href="classfield.html#a2bb1e4784fca6aed504a2ab7d4f200a0">GetDMGrazed</a>()/area&lt;&lt; <span class="stringliteral">&quot;\t&quot;</span>;
<a name="l00754"></a>00754       }
<a name="l00755"></a>00755       *grazmanfile &lt;&lt; endl;
<a name="l00756"></a>00756         }
<a name="l00757"></a>00757         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;theCropRotation -&gt;<a class="code" href="classcrop_rotation.html#ad85aaa3c1694c992e1a92fad544194b4">GetFields</a>()-&gt;<a class="code" href="classlink_list.html#aee3f890e4e8f48db1518e5114d5bcca8" title="Returned total number of nodes.">NumOfNodes</a>();i++)
<a name="l00758"></a>00758    {
<a name="l00759"></a>00759         <a class="code" href="classfield.html">field</a> *aField = theCropRotation -&gt;<a class="code" href="classcrop_rotation.html#ad85aaa3c1694c992e1a92fad544194b4">GetFields</a>()-&gt;<a class="code" href="classlink_list.html#a5735a6e54a2eed841bdf1fdb52aed03f" title="Return the address of the node with a given logical number in the list.">ElementAtNumber</a>(i);
<a name="l00760"></a>00760         aField-&gt;<a class="code" href="classfield.html#ae1b97f96f274b114d6d92c1ce80f3dfd">ClearTemporaryVariables</a>();
<a name="l00761"></a>00761    }
<a name="l00762"></a>00762 }
<a name="l00763"></a>00763 
<a name="l00764"></a><a class="code" href="classgrazing_manager.html#a2facc8dfbfbbcd8f9fec21fe5d58c942">00764</a> <span class="keywordtype">void</span> <a class="code" href="classgrazing_manager.html#a2facc8dfbfbbcd8f9fec21fe5d58c942">grazingManager::InitialiseFileOutput</a>()
<a name="l00765"></a>00765 {
<a name="l00766"></a>00766    <span class="keywordtype">char</span> filename[20];
<a name="l00767"></a>00767    <span class="keywordtype">char</span> leader[200];
<a name="l00768"></a>00768 
<a name="l00769"></a>00769    grazmanfile = <span class="keyword">new</span> fstream();
<a name="l00770"></a>00770    sprintf(leader,<a class="code" href="system_data_8h.html#a76e0b93133ea900729e1fa09c9ad6d5c">theSystemData</a>-&gt;<a class="code" href="classsystem_data.html#a836f74ba0df2cec8f0768226595953c0">getOutputDirectory</a>().c_str());
<a name="l00771"></a>00771 <span class="preprocessor">#ifdef __BCplusplus</span>
<a name="l00772"></a>00772 <span class="preprocessor"></span>   sprintf(filename,<span class="stringliteral">&quot;pasture.xls&quot;</span>,<a class="code" href="classbase.html#afa59aaa1a0201700640234eb13a03aae">Index</a>);
<a name="l00773"></a>00773 <span class="preprocessor">#else</span>
<a name="l00774"></a>00774 <span class="preprocessor"></span>   sprintf(filename,<span class="stringliteral">&quot;pasture.xls&quot;</span>);
<a name="l00775"></a>00775 <span class="preprocessor">#endif</span>
<a name="l00776"></a>00776 <span class="preprocessor"></span>   strcat(leader,filename);
<a name="l00777"></a>00777    grazmanfile-&gt;open(leader,ios::out);
<a name="l00778"></a>00778    grazmanfile-&gt;precision(8);
<a name="l00779"></a>00779 
<a name="l00780"></a>00780    *grazmanfile &lt;&lt; <span class="stringliteral">&quot;Date&quot;</span> &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span>;
<a name="l00781"></a>00781 <span class="comment">//   int numGrazableFields = GetNumGrazableFields();</span>
<a name="l00782"></a>00782    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;theCropRotation -&gt;<a class="code" href="classcrop_rotation.html#ad85aaa3c1694c992e1a92fad544194b4">GetFields</a>()-&gt;<a class="code" href="classlink_list.html#aee3f890e4e8f48db1518e5114d5bcca8" title="Returned total number of nodes.">NumOfNodes</a>();i++)
<a name="l00783"></a>00783    {
<a name="l00784"></a>00784       *grazmanfile &lt;&lt; <span class="stringliteral">&quot;FieldNO&quot;</span> &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <span class="stringliteral">&quot;HerbageMass&quot;</span> &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <span class="stringliteral">&quot;ProteinConc&quot;</span> &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span>&lt;&lt; <span class="stringliteral">&quot;FEperKgDM&quot;</span> &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span>
<a name="l00785"></a>00785                 &lt;&lt; <span class="stringliteral">&quot;DMProd&quot;</span> &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span>&lt;&lt; <span class="stringliteral">&quot;DMGrazed&quot;</span> &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <span class="stringliteral">&quot;GLAI&quot;</span> &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span>;
<a name="l00786"></a>00786    }
<a name="l00787"></a>00787    *grazmanfile &lt;&lt; endl;
<a name="l00788"></a>00788    *grazmanfile &lt;&lt; <span class="stringliteral">&quot; &quot;</span>&lt;&lt; <span class="stringliteral">&quot;\t&quot;</span>;
<a name="l00789"></a>00789    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;theCropRotation -&gt;<a class="code" href="classcrop_rotation.html#ad85aaa3c1694c992e1a92fad544194b4">GetFields</a>()-&gt;<a class="code" href="classlink_list.html#aee3f890e4e8f48db1518e5114d5bcca8" title="Returned total number of nodes.">NumOfNodes</a>();i++)
<a name="l00790"></a>00790    {
<a name="l00791"></a>00791       *grazmanfile &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <span class="stringliteral">&quot;tDM/ha&quot;</span> &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <span class="stringliteral">&quot;g/kg&quot;</span> &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span>&lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span>&lt;&lt; <span class="stringliteral">&quot;kgDM/ha/d&quot;</span>&lt;&lt; <span class="stringliteral">&quot;\t&quot;</span>&lt;&lt; <span class="stringliteral">&quot;kgDM/ha/d&quot;</span> &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span>;
<a name="l00792"></a>00792    }
<a name="l00793"></a>00793    *grazmanfile &lt;&lt; endl;
<a name="l00794"></a>00794 }
<a name="l00795"></a>00795 
<a name="l00796"></a>00796 
<a name="l00797"></a>00797 <span class="comment">/*****************************</span>
<a name="l00798"></a>00798 <span class="comment">*****************************/</span>
<a name="l00799"></a><a class="code" href="classgrazing_manager.html#a7e94949ab9bfb77da28ac2c3dcd79aaa">00799</a> <span class="keywordtype">bool</span> <a class="code" href="classgrazing_manager.html#a7e94949ab9bfb77da28ac2c3dcd79aaa">grazingManager::CheckConservationFields</a>()
<a name="l00800"></a>00800 {
<a name="l00801"></a>00801         <span class="keywordtype">bool</span> ret_val=<span class="keyword">false</span>;
<a name="l00802"></a>00802 <span class="comment">//      int numFieldsToCut=0;</span>
<a name="l00803"></a>00803    <span class="keywordtype">int</span> numOfFields = fields_avail_to_graze-&gt;<a class="code" href="classlink_list.html#aee3f890e4e8f48db1518e5114d5bcca8" title="Returned total number of nodes.">NumOfNodes</a>();
<a name="l00804"></a>00804 <span class="comment">//   cout &lt;&lt; theTime.GetDay() &lt;&lt; &quot; &quot; &lt;&lt; theTime.GetMonth() &lt;&lt; &quot; &quot; &lt;&lt; numOfFields &lt;&lt; endl;</span>
<a name="l00805"></a>00805    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> counter=0;counter&lt;numOfFields;counter++)
<a name="l00806"></a>00806    {
<a name="l00807"></a>00807         <a class="code" href="classfield.html">field</a> *aField = fields_avail_to_graze-&gt;<a class="code" href="classlink_list.html#a5735a6e54a2eed841bdf1fdb52aed03f" title="Return the address of the node with a given logical number in the list.">ElementAtNumber</a>(counter);
<a name="l00808"></a>00808       <span class="keywordflow">if</span> (aField-&gt;<a class="code" href="classfield.html#aaa75ae81d0511e47197059ee64b38dc5">GetGrazingShutDown</a>())
<a name="l00809"></a>00809       {
<a name="l00810"></a>00810          <span class="keywordtype">double</span> mass = aField-&gt;<a class="code" href="classfield.html#ad5e1460e730daa874bb7b0fced8ebb5a">GetHerbageMasskg</a>();
<a name="l00811"></a>00811          <span class="keywordtype">double</span> proteinConc = 0.0;
<a name="l00812"></a>00812 
<a name="l00813"></a>00813         <span class="keywordtype">double</span> massDensity =aField-&gt;<a class="code" href="classfield.html#a32c9aa62de35c4671da6b21621eb66ea">GetAvailableHerbageMasskgPerHa</a>(residualDM)/1000.0;
<a name="l00814"></a>00814  <span class="comment">//        double area = aField-&gt;GetArea();</span>
<a name="l00815"></a>00815          <span class="keywordflow">if</span> (massDensity&gt;minHarvestable)    <span class="comment">//avoid daft values that occur just after sowing</span>
<a name="l00816"></a>00816          {
<a name="l00817"></a>00817             proteinConc=aField-&gt;<a class="code" href="classfield.html#a106ff033bc0271d52377d1c25b5e297b">GetAbovegroundCropN</a>()*<a class="code" href="nixcbits_8cpp.html#a2ea878dfbe195112a4eb66ca7e322184">N_to_protein</a>()/mass;
<a name="l00818"></a>00818 
<a name="l00819"></a>00819             proteinConc*=1000.0;  <span class="comment">//convert to g/kg DM</span>
<a name="l00820"></a>00820 <span class="comment">//            if ((FEperKgDM&lt;GetminEnergyConc())||(proteinConc&lt;GetminProteinConc()))</span>
<a name="l00821"></a>00821 <span class="comment">//            if (proteinConc&lt;GetminProteinConc())</span>
<a name="l00822"></a>00822 <span class="comment">//              ret_val=true;</span>
<a name="l00823"></a>00823                 ret_val=<span class="keyword">false</span>;
<a name="l00824"></a>00824          }
<a name="l00825"></a>00825       }
<a name="l00826"></a>00826    }
<a name="l00827"></a>00827    <span class="keywordflow">return</span> ret_val;
<a name="l00828"></a>00828 }
<a name="l00829"></a>00829 
<a name="l00830"></a><a class="code" href="classgrazing_manager.html#a2e8c040172f02e13bf9642b493ea1ab0">00830</a> <span class="keywordtype">int</span> <a class="code" href="classgrazing_manager.html#a2e8c040172f02e13bf9642b493ea1ab0">grazingManager::GetGrazingSupplyStatus</a>(<span class="keywordtype">double</span> numberOfDaysSupply)
<a name="l00831"></a>00831 {
<a name="l00832"></a>00832         <span class="keywordtype">int</span> status=1;
<a name="l00833"></a>00833    {
<a name="l00834"></a>00834       <span class="keywordflow">if</span> (numberOfDaysSupply&lt;=lowerGrazingLimit)
<a name="l00835"></a>00835          status=0;                                 <span class="comment">//deficiency of grazed pasture</span>
<a name="l00836"></a>00836       <span class="keywordflow">if</span> (numberOfDaysSupply&gt;=upperGrazingLimit)
<a name="l00837"></a>00837          status=2;                                 <span class="comment">//surplus of grazed pasture</span>
<a name="l00838"></a>00838    }
<a name="l00839"></a>00839    <span class="keywordflow">return</span> status;
<a name="l00840"></a>00840 }
<a name="l00841"></a>00841 
<a name="l00842"></a>00842 
<a name="l00843"></a>00843 
<a name="l00844"></a><a class="code" href="classgrazing_manager.html#a782edbd814727753f68ea5d041f79c9d">00844</a> <span class="keywordtype">void</span> <a class="code" href="classgrazing_manager.html#a782edbd814727753f68ea5d041f79c9d">grazingManager::AutoGrazingPossible</a>()
<a name="l00845"></a>00845 {
<a name="l00846"></a>00846    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;theCropRotation -&gt;<a class="code" href="classcrop_rotation.html#ad85aaa3c1694c992e1a92fad544194b4">GetFields</a>()-&gt;<a class="code" href="classlink_list.html#aee3f890e4e8f48db1518e5114d5bcca8" title="Returned total number of nodes.">NumOfNodes</a>();i++)
<a name="l00847"></a>00847    {
<a name="l00848"></a>00848       <a class="code" href="classfield.html">field</a> *aField = theCropRotation -&gt;<a class="code" href="classcrop_rotation.html#ad85aaa3c1694c992e1a92fad544194b4">GetFields</a>()-&gt;<a class="code" href="classlink_list.html#a5735a6e54a2eed841bdf1fdb52aed03f" title="Return the address of the node with a given logical number in the list.">ElementAtNumber</a>(i);
<a name="l00849"></a>00849       aField-&gt;<a class="code" href="classfield.html#a62798f048b9b2b4c7c4ba3e5ff6f0694">AutoGrazingPossible</a>();
<a name="l00850"></a>00850    }
<a name="l00851"></a>00851 }
<a name="l00852"></a>00852 
<a name="l00853"></a>00853 
<a name="l00854"></a>00854 <span class="comment">/****************************************************</span>
<a name="l00855"></a>00855 <span class="comment">See if one or more fields will have an operation that will stop grazing (eg ploughed)  NJH Sep 2007</span>
<a name="l00856"></a>00856 <span class="comment">*****************************************************/</span>
<a name="l00857"></a><a class="code" href="classgrazing_manager.html#ad4339322398af753da757bcebc3a085c">00857</a> <span class="keywordtype">void</span> <a class="code" href="classgrazing_manager.html#ad4339322398af753da757bcebc3a085c">grazingManager::CheckOpStopsGrazing</a>()
<a name="l00858"></a>00858 {
<a name="l00859"></a>00859         <a class="code" href="classlink_list.html" title="Utility link list class.">linkList&lt;field&gt;::PS</a> P;
<a name="l00860"></a>00860    fields_to_graze-&gt;<a class="code" href="classlink_list.html#a7a7cc9e8690c7e9c73d5b406cae066d3" title="Returned a pointer to the first node.">PeekHead</a>(P);
<a name="l00861"></a>00861    <span class="keywordflow">while</span> (P!=NULL)
<a name="l00862"></a>00862    {
<a name="l00863"></a>00863       <span class="keywordflow">if</span> (P-&gt;element-&gt;GetGrazingShutDown())
<a name="l00864"></a>00864          fields_to_graze-&gt;<a class="code" href="classlink_list.html#a24a989f008cb02dd4e452f4e5479d5cb" title="Remove this node but do not delete the instance of the class held.">Release</a>(P);
<a name="l00865"></a>00865       fields_to_graze-&gt;<a class="code" href="classlink_list.html#a2b549aa4a51e457cb8e0ef19e35978f3" title="Move one step in list.">OneStep</a>(P);
<a name="l00866"></a>00866    }
<a name="l00867"></a>00867 }
</pre></div></div>
</div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address class="footer"><small>Generated on Mon Aug 22 2011 10:29:03 for Fasset by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
