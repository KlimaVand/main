<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Fasset: C:/main/trunk/src/soil/soil.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.4 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Fasset</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">C:/main/trunk/src/soil/soil.cpp</div>  </div>
</div>
<div class="contents">
<a href="soil_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/****************************************************************************\</span>
<a name="l00002"></a>00002 <span class="comment"> $URL$</span>
<a name="l00003"></a>00003 <span class="comment"> $LastChangedDate$</span>
<a name="l00004"></a>00004 <span class="comment"> $LastChangedRevision$</span>
<a name="l00005"></a>00005 <span class="comment"> $LastChangedBy$</span>
<a name="l00006"></a>00006 <span class="comment">\****************************************************************************/</span>
<a name="l00007"></a>00007 <span class="comment">/****************************************************************************\</span>
<a name="l00008"></a>00008 <span class="comment">Water and nitrogen in soil</span>
<a name="l00009"></a>00009 <span class="comment">\****************************************************************************/</span>
<a name="l00010"></a>00010 <span class="preprocessor">#include &quot;../data/systemData.h&quot;</span>
<a name="l00011"></a>00011 <span class="preprocessor">#include &quot;../base/common.h&quot;</span>
<a name="l00012"></a>00012 <span class="preprocessor">#include &quot;<a class="code" href="soil_8h.html">soil.h</a>&quot;</span>
<a name="l00013"></a>00013 <span class="preprocessor">#include &quot;../data/outputData.h&quot;</span>
<a name="l00014"></a>00014 
<a name="l00015"></a>00015 <span class="preprocessor">#include &quot;../base/bstime.h&quot;</span>
<a name="l00016"></a>00016 
<a name="l00017"></a>00017 
<a name="l00018"></a>00018 <span class="comment">/****************************************************************************\</span>
<a name="l00019"></a>00019 <span class="comment">\****************************************************************************/</span>
<a name="l00020"></a><a class="code" href="classsoil.html#a289d10d074eff9162a03968bd9240ece">00020</a> soil::soil(<span class="keyword">const</span> <span class="keywordtype">char</span> * Pname,<span class="keyword">const</span> <span class="keywordtype">int</span> Index,<span class="keyword">const</span> <a class="code" href="classbase.html">base</a> * owner)
<a name="l00021"></a>00021    : <a class="code" href="classbase.html">base</a>(Pname,Index,owner)
<a name="l00022"></a>00022 {
<a name="l00023"></a>00023    <a class="code" href="classsoil.html#a8f203b5b85e7a616745ae8ec50e7f40d">AccumulatedWaterDrainage</a>   = 0.0;
<a name="l00024"></a>00024    <a class="code" href="classsoil.html#a92ba9cb92d2aebff24c21437ced70017">AccumulatedNitrateDrainage</a> = 0.0;
<a name="l00025"></a>00025    <a class="code" href="classsoil.html#a1b5519eb95daaba51a3326b0bbc4e653">evapotranspiration</a>         = 0.0;
<a name="l00026"></a>00026    <a class="code" href="classsoil.html#a727b7e354f1982a033764880c47d7a81">soilEvaporation</a>            = 0.0;
<a name="l00027"></a>00027    <a class="code" href="classsoil.html#aca4597213bffd5e97041c7da8b41f009">CO2Evolution</a>               = 0.0;
<a name="l00028"></a>00028    <a class="code" href="classsoil.html#a6d11057be5710fe4f12a148abccc30eb">nitrateLeached</a>.<a class="code" href="classnitrogen.html#a706b101d934ddb44c4bff07761c8dfef">Clear</a>();
<a name="l00029"></a>00029    <a class="code" href="classsoil.html#ad38099a7fb0f61aa85c082b4aa0ed931">ammoniumLeached</a>.<a class="code" href="classnitrogen.html#a706b101d934ddb44c4bff07761c8dfef">Clear</a>();
<a name="l00030"></a>00030    <a class="code" href="classsoil.html#ab94851a74389f879a38bdcaad1826ef2">denitrification</a>.<a class="code" href="classnitrogen.html#a706b101d934ddb44c4bff07761c8dfef">Clear</a>();
<a name="l00031"></a>00031    <a class="code" href="classsoil.html#a9b86d97fc4356ee0b07bbb78f67484c8">nitrification</a>.<a class="code" href="classnitrogen.html#a706b101d934ddb44c4bff07761c8dfef">Clear</a>();
<a name="l00032"></a>00032 
<a name="l00033"></a>00033    <a class="code" href="classsoil.html#abae868b529287ef261d995d817163406">evaporationDepth</a> = 200.0;
<a name="l00034"></a>00034    <a class="code" href="classsoil.html#a7b54d79b2b2742e3a173c49e76a797c9">totalTranspiration</a>        = 0.;
<a name="l00035"></a>00035    <a class="code" href="classsoil.html#a7bd29a49ff933e84c22b9fe2753cc2fe">NitrogenNetMineralisation</a>.<a class="code" href="classnitrogen.html#a706b101d934ddb44c4bff07761c8dfef">Clear</a>();
<a name="l00036"></a>00036    <a class="code" href="classsoil.html#a738126f478188eb4e5ec2b04271c6d6d">nitrogenUptake</a>=NULL;
<a name="l00037"></a>00037 
<a name="l00038"></a>00038    <a class="code" href="classsoil.html#addf9abd98e1b4678c37c714b49045f79" title="soil nitrogen budget">Nbudget</a>.<a class="code" href="classbudget.html#ada0ca75f0dd9d8a6d0dfd5fcbd666653">SetNames</a>(<span class="stringliteral">&quot;soil&quot;</span>,<span class="stringliteral">&quot;N&quot;</span>);
<a name="l00039"></a>00039    <a class="code" href="classsoil.html#a5fc83b89b81299ab7cde864a78092279" title="soil water budget">WaterBudget</a>.<a class="code" href="classbudget.html#ada0ca75f0dd9d8a6d0dfd5fcbd666653">SetNames</a>(<span class="stringliteral">&quot;soil&quot;</span>,<span class="stringliteral">&quot;water&quot;</span>);
<a name="l00040"></a>00040 
<a name="l00041"></a>00041    <a class="code" href="classsoil.html#ab5516aa25f35082aba80ca2795c68e4e" title="object describing compounds on the soil surface (e.g. undissolved fertiliser)">Surface</a>              = <span class="keyword">new</span> <a class="code" href="classsoil_surface.html">soilSurface</a>;
<a name="l00042"></a>00042    <a class="code" href="classsoil.html#ab36e32808c2cadf3b50cd18fdc06ca01" title="object describing the soil profile">Profile</a>              = <span class="keyword">new</span> <a class="code" href="classsoil_profile.html">soilProfile</a>(<span class="stringliteral">&quot;SoilProfile&quot;</span>,0,<span class="keyword">this</span>);
<a name="l00043"></a>00043 
<a name="l00044"></a>00044 
<a name="l00045"></a>00045 
<a name="l00046"></a>00046 
<a name="l00047"></a>00047 }
<a name="l00048"></a>00048 
<a name="l00049"></a>00049 <span class="comment">/****************************************************************************\</span>
<a name="l00050"></a>00050 <span class="comment">\****************************************************************************/</span>
<a name="l00051"></a><a class="code" href="classsoil.html#a905aaf29599f8afceb8aa8f51a631def">00051</a> soil::soil(<span class="keyword">const</span> <a class="code" href="classsoil.html">soil</a>&amp; Soil)
<a name="l00052"></a>00052  : <a class="code" href="classbase.html">base</a>(Soil)
<a name="l00053"></a>00053 {
<a name="l00054"></a>00054    <span class="keywordflow">if</span> (&amp;Soil)
<a name="l00055"></a>00055    {
<a name="l00056"></a>00056       <a class="code" href="classsoil.html#abae868b529287ef261d995d817163406">evaporationDepth</a>          = Soil.<a class="code" href="classsoil.html#abae868b529287ef261d995d817163406">evaporationDepth</a>;
<a name="l00057"></a>00057       <a class="code" href="classsoil.html#a1b5519eb95daaba51a3326b0bbc4e653">evapotranspiration</a>        = Soil.<a class="code" href="classsoil.html#a1b5519eb95daaba51a3326b0bbc4e653">evapotranspiration</a>;
<a name="l00058"></a>00058       <a class="code" href="classsoil.html#a727b7e354f1982a033764880c47d7a81">soilEvaporation</a>           = Soil.<a class="code" href="classsoil.html#a727b7e354f1982a033764880c47d7a81">soilEvaporation</a>;
<a name="l00059"></a>00059       <a class="code" href="classsoil.html#aca4597213bffd5e97041c7da8b41f009">CO2Evolution</a>              = Soil.<a class="code" href="classsoil.html#aca4597213bffd5e97041c7da8b41f009">CO2Evolution</a>;
<a name="l00060"></a>00060       <a class="code" href="classsoil.html#a6d11057be5710fe4f12a148abccc30eb">nitrateLeached</a>            = Soil.<a class="code" href="classsoil.html#a6d11057be5710fe4f12a148abccc30eb">nitrateLeached</a>;
<a name="l00061"></a>00061       <a class="code" href="classsoil.html#ad38099a7fb0f61aa85c082b4aa0ed931">ammoniumLeached</a>           = Soil.<a class="code" href="classsoil.html#ad38099a7fb0f61aa85c082b4aa0ed931">ammoniumLeached</a>;
<a name="l00062"></a>00062       <a class="code" href="classsoil.html#ab94851a74389f879a38bdcaad1826ef2">denitrification</a>           = Soil.<a class="code" href="classsoil.html#ab94851a74389f879a38bdcaad1826ef2">denitrification</a>;
<a name="l00063"></a>00063       <a class="code" href="classsoil.html#a9b86d97fc4356ee0b07bbb78f67484c8">nitrification</a>             = Soil.<a class="code" href="classsoil.html#a9b86d97fc4356ee0b07bbb78f67484c8">nitrification</a>;
<a name="l00064"></a>00064       <a class="code" href="classsoil.html#a7b54d79b2b2742e3a173c49e76a797c9">totalTranspiration</a>        = Soil.<a class="code" href="classsoil.html#a7b54d79b2b2742e3a173c49e76a797c9">totalTranspiration</a>;
<a name="l00065"></a>00065       <a class="code" href="classsoil.html#a7bd29a49ff933e84c22b9fe2753cc2fe">NitrogenNetMineralisation</a> = Soil.<a class="code" href="classsoil.html#a7bd29a49ff933e84c22b9fe2753cc2fe">NitrogenNetMineralisation</a>;
<a name="l00066"></a>00066 
<a name="l00067"></a>00067 
<a name="l00068"></a>00068 
<a name="l00069"></a>00069       <a class="code" href="classsoil.html#a8f203b5b85e7a616745ae8ec50e7f40d">AccumulatedWaterDrainage</a>  = Soil.<a class="code" href="classsoil.html#a8f203b5b85e7a616745ae8ec50e7f40d">AccumulatedWaterDrainage</a>;
<a name="l00070"></a>00070       <a class="code" href="classsoil.html#a92ba9cb92d2aebff24c21437ced70017">AccumulatedNitrateDrainage</a>= Soil.<a class="code" href="classsoil.html#a92ba9cb92d2aebff24c21437ced70017">AccumulatedNitrateDrainage</a>;
<a name="l00071"></a>00071       <a class="code" href="classsoil.html#a738126f478188eb4e5ec2b04271c6d6d">nitrogenUptake</a>            = Soil.<a class="code" href="classsoil.html#a738126f478188eb4e5ec2b04271c6d6d">nitrogenUptake</a>;
<a name="l00072"></a>00072 
<a name="l00073"></a>00073 
<a name="l00074"></a>00074 
<a name="l00075"></a>00075       <a class="code" href="classsoil.html#addf9abd98e1b4678c37c714b49045f79" title="soil nitrogen budget">Nbudget</a>                         = <a class="code" href="classbudget.html">budget</a>(Soil.<a class="code" href="classsoil.html#addf9abd98e1b4678c37c714b49045f79" title="soil nitrogen budget">Nbudget</a>);
<a name="l00076"></a>00076       <a class="code" href="classsoil.html#a5fc83b89b81299ab7cde864a78092279" title="soil water budget">WaterBudget</a>                     = <a class="code" href="classbudget.html">budget</a>(Soil.<a class="code" href="classsoil.html#a5fc83b89b81299ab7cde864a78092279" title="soil water budget">WaterBudget</a>);
<a name="l00077"></a>00077       <a class="code" href="classsoil.html#a5fc83b89b81299ab7cde864a78092279" title="soil water budget">WaterBudget</a>.<a class="code" href="classbudget.html#a47533e4ef9b8907303904da10f934f74">Reset</a>(); <span class="comment">// History ignored!</span>
<a name="l00078"></a>00078       <a class="code" href="classsoil.html#ab5516aa25f35082aba80ca2795c68e4e" title="object describing compounds on the soil surface (e.g. undissolved fertiliser)">Surface</a>                   = <span class="keyword">new</span> <a class="code" href="classsoil_surface.html">soilSurface</a>(*Soil.<a class="code" href="classsoil.html#ab5516aa25f35082aba80ca2795c68e4e" title="object describing compounds on the soil surface (e.g. undissolved fertiliser)">Surface</a>);
<a name="l00079"></a>00079       <a class="code" href="classsoil.html#ab36e32808c2cadf3b50cd18fdc06ca01" title="object describing the soil profile">Profile</a>                   = <span class="keyword">new</span> <a class="code" href="classsoil_profile.html">soilProfile</a>(*Soil.<a class="code" href="classsoil.html#ab36e32808c2cadf3b50cd18fdc06ca01" title="object describing the soil profile">Profile</a>);
<a name="l00080"></a>00080       <a class="code" href="classsoil.html#ab36e32808c2cadf3b50cd18fdc06ca01" title="object describing the soil profile">Profile</a>-&gt;<a class="code" href="classbase.html#a42c446f0adea294e97a2486946b7cbc4">SetOwner</a>(<span class="keyword">this</span>);
<a name="l00081"></a>00081       <a class="code" href="classsoil.html#addf9abd98e1b4678c37c714b49045f79" title="soil nitrogen budget">Nbudget</a>.<a class="code" href="classbudget.html#a47533e4ef9b8907303904da10f934f74">Reset</a>(); <span class="comment">// History ignored!</span>
<a name="l00082"></a>00082    }
<a name="l00083"></a>00083 }
<a name="l00084"></a>00084 
<a name="l00085"></a>00085 <span class="comment">/****************************************************************************\</span>
<a name="l00086"></a>00086 <span class="comment">\****************************************************************************/</span>
<a name="l00087"></a><a class="code" href="classsoil.html#a863db6f7a26049bcac60099234181765">00087</a> <a class="code" href="classsoil.html#a863db6f7a26049bcac60099234181765" title="destructor">soil::~soil</a>()
<a name="l00088"></a>00088 {
<a name="l00089"></a>00089    <a class="code" href="classbase.html#a3af52ee9891719d09b8b19b42450b6f6">file</a>=NULL; <span class="comment">// !!! HACK !!!</span>
<a name="l00090"></a>00090 
<a name="l00091"></a>00091    <span class="keyword">delete</span> <a class="code" href="classsoil.html#ab5516aa25f35082aba80ca2795c68e4e" title="object describing compounds on the soil surface (e.g. undissolved fertiliser)">Surface</a>;
<a name="l00092"></a>00092    <span class="keyword">delete</span> <a class="code" href="classsoil.html#ab36e32808c2cadf3b50cd18fdc06ca01" title="object describing the soil profile">Profile</a>;
<a name="l00093"></a>00093    <span class="keywordflow">if</span> ( <a class="code" href="output_data_8h.html#aadc9d3b76fa69bf28c5ab340dd810e20">theOutputData</a>-&gt;<a class="code" href="classoutput_data.html#ae50b979972f6c57c3881edd6a7dd96b4">DetailsData</a>.<a class="code" href="classoutput_details.html#a084ee6303ae763562e96ac5e063e862c">getSoilDetails</a>()==<span class="keyword">true</span>)
<a name="l00094"></a>00094    { 
<a name="l00095"></a>00095         <a class="code" href="classsoil.html#a37ce966bebdb8775a666a3c0a6cd8bf3" title="file streams for details of soil variables.">f</a>.close();
<a name="l00096"></a>00096    }
<a name="l00097"></a>00097 }
<a name="l00098"></a>00098 
<a name="l00099"></a>00099 <span class="comment">/****************************************************************************\</span>
<a name="l00100"></a>00100 <span class="comment">\****************************************************************************/</span>
<a name="l00101"></a><a class="code" href="classsoil.html#ae5f6d74641b63e3c8bd9519bd7ca757c">00101</a> <span class="keywordtype">void</span> <a class="code" href="classsoil.html#ae5f6d74641b63e3c8bd9519bd7ca757c" title="initialise soil module">soil::Initialize</a>(<span class="keywordtype">char</span> * soilFileName)
<a name="l00102"></a>00102 {
<a name="l00103"></a>00103 
<a name="l00104"></a>00104    <a class="code" href="classbase.html#a80052a7eeb8bce90247aedd358cc1cf6">SetCritical</a>();
<a name="l00105"></a>00105    cout &lt;&lt; <span class="stringliteral">&quot;Initialising soil no &quot;</span> &lt;&lt; <a class="code" href="classbase.html#adc95005de44dba3af83c3d129d2ccba7">GetLongNameInNumbers</a>() &lt;&lt; <span class="stringliteral">&quot; with the file &quot;</span> &lt;&lt; soilFileName &lt;&lt; endl;  <span class="comment">//a problem with patches can occure at this point</span>
<a name="l00106"></a>00106    <a class="code" href="classbase.html#a551ea12cd21bfc786892b5bb8c333ee0">OpenInputFile</a>(soilFileName);
<a name="l00107"></a>00107    <a class="code" href="classsoil.html#ab36e32808c2cadf3b50cd18fdc06ca01" title="object describing the soil profile">Profile</a>-&gt;<a class="code" href="classsoil_profile.html#af06cdd8163adae8f60c89365e242f189">Initialize</a>(<a class="code" href="classbase.html#a3af52ee9891719d09b8b19b42450b6f6">file</a>);
<a name="l00108"></a>00108    <span class="keywordflow">if</span> (<a class="code" href="output_data_8h.html#aadc9d3b76fa69bf28c5ab340dd810e20">theOutputData</a>-&gt;<a class="code" href="classoutput_data.html#ae50b979972f6c57c3881edd6a7dd96b4">DetailsData</a>.<a class="code" href="classoutput_details.html#a084ee6303ae763562e96ac5e063e862c">getSoilDetails</a>()==<span class="keyword">true</span>)
<a name="l00109"></a>00109    {
<a name="l00110"></a>00110 
<a name="l00111"></a>00111       <span class="keywordtype">string</span> fileName=<a class="code" href="system_data_8h.html#a76e0b93133ea900729e1fa09c9ad6d5c">theSystemData</a>-&gt;<a class="code" href="classsystem_data.html#a836f74ba0df2cec8f0768226595953c0">getOutputDirectory</a>()+<span class="stringliteral">&quot;soil&quot;</span>+<a class="code" href="classbase.html#adc95005de44dba3af83c3d129d2ccba7">GetLongNameInNumbers</a>()+<span class="stringliteral">&quot;.xls&quot;</span>;
<a name="l00112"></a>00112 
<a name="l00113"></a>00113         <a class="code" href="classsoil.html#a37ce966bebdb8775a666a3c0a6cd8bf3" title="file streams for details of soil variables.">f</a>.open(fileName.c_str(),ios::out);
<a name="l00114"></a>00114       <a class="code" href="classsoil.html#a37ce966bebdb8775a666a3c0a6cd8bf3" title="file streams for details of soil variables.">f</a>.precision(4);
<a name="l00115"></a>00115       <a class="code" href="classsoil.html#a37ce966bebdb8775a666a3c0a6cd8bf3" title="file streams for details of soil variables.">f</a> &lt;&lt; <span class="stringliteral">&quot;date&quot;</span>;
<a name="l00116"></a>00116 
<a name="l00117"></a>00117       <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0;i&lt;<a class="code" href="output_data_8h.html#aadc9d3b76fa69bf28c5ab340dd810e20">theOutputData</a>-&gt;<a class="code" href="classoutput_data.html#a354085135b0a0a2b6bb245dff6779073">WaterData</a>.size();i++)
<a name="l00118"></a>00118       {
<a name="l00119"></a>00119          <a class="code" href="classsoil.html#a37ce966bebdb8775a666a3c0a6cd8bf3" title="file streams for details of soil variables.">f</a> &lt;&lt; <span class="stringliteral">&quot;\twater&quot;</span>&lt;&lt; <a class="code" href="output_data_8h.html#aadc9d3b76fa69bf28c5ab340dd810e20">theOutputData</a>-&gt;<a class="code" href="classoutput_data.html#a354085135b0a0a2b6bb245dff6779073">WaterData</a>[i].getStartDepth() &lt;&lt; <span class="stringliteral">&quot;-&quot;</span>&lt;&lt;<a class="code" href="output_data_8h.html#aadc9d3b76fa69bf28c5ab340dd810e20">theOutputData</a>-&gt;<a class="code" href="classoutput_data.html#a354085135b0a0a2b6bb245dff6779073">WaterData</a>[i].getEndDepth() ;
<a name="l00120"></a>00120       }
<a name="l00121"></a>00121 
<a name="l00122"></a>00122       <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0;i&lt;<a class="code" href="output_data_8h.html#aadc9d3b76fa69bf28c5ab340dd810e20">theOutputData</a>-&gt;<a class="code" href="classoutput_data.html#a213ddbf3e83fe1f17f12994794ae649d">NminData</a>.size();i++)
<a name="l00123"></a>00123       {
<a name="l00124"></a>00124          <a class="code" href="classsoil.html#a37ce966bebdb8775a666a3c0a6cd8bf3" title="file streams for details of soil variables.">f</a> &lt;&lt; <span class="stringliteral">&quot;\tNmin&quot;</span>&lt;&lt; <a class="code" href="output_data_8h.html#aadc9d3b76fa69bf28c5ab340dd810e20">theOutputData</a>-&gt;<a class="code" href="classoutput_data.html#a213ddbf3e83fe1f17f12994794ae649d">NminData</a>[i].getStartDepth() &lt;&lt; <span class="stringliteral">&quot;-&quot;</span>&lt;&lt; <a class="code" href="output_data_8h.html#aadc9d3b76fa69bf28c5ab340dd810e20">theOutputData</a>-&gt;<a class="code" href="classoutput_data.html#a213ddbf3e83fe1f17f12994794ae649d">NminData</a>[i].getEndDepth();
<a name="l00125"></a>00125          <a class="code" href="classsoil.html#a37ce966bebdb8775a666a3c0a6cd8bf3" title="file streams for details of soil variables.">f</a> &lt;&lt; <span class="stringliteral">&quot;\tNO3-&quot;</span>&lt;&lt; <a class="code" href="output_data_8h.html#aadc9d3b76fa69bf28c5ab340dd810e20">theOutputData</a>-&gt;<a class="code" href="classoutput_data.html#a213ddbf3e83fe1f17f12994794ae649d">NminData</a>[i].getStartDepth() &lt;&lt; <span class="stringliteral">&quot;-&quot;</span>&lt;&lt; <a class="code" href="output_data_8h.html#aadc9d3b76fa69bf28c5ab340dd810e20">theOutputData</a>-&gt;<a class="code" href="classoutput_data.html#a213ddbf3e83fe1f17f12994794ae649d">NminData</a>[i].getEndDepth();
<a name="l00126"></a>00126          <a class="code" href="classsoil.html#a37ce966bebdb8775a666a3c0a6cd8bf3" title="file streams for details of soil variables.">f</a> &lt;&lt; <span class="stringliteral">&quot;\tNH4-&quot;</span>&lt;&lt; <a class="code" href="output_data_8h.html#aadc9d3b76fa69bf28c5ab340dd810e20">theOutputData</a>-&gt;<a class="code" href="classoutput_data.html#a213ddbf3e83fe1f17f12994794ae649d">NminData</a>[i].getStartDepth()  &lt;&lt; <span class="stringliteral">&quot;-&quot;</span>&lt;&lt; <a class="code" href="output_data_8h.html#aadc9d3b76fa69bf28c5ab340dd810e20">theOutputData</a>-&gt;<a class="code" href="classoutput_data.html#a213ddbf3e83fe1f17f12994794ae649d">NminData</a>[i].getEndDepth();
<a name="l00127"></a>00127          <a class="code" href="classsoil.html#a37ce966bebdb8775a666a3c0a6cd8bf3" title="file streams for details of soil variables.">f</a> &lt;&lt; <span class="stringliteral">&quot;\tTotal15N-&quot;</span>&lt;&lt; <a class="code" href="output_data_8h.html#aadc9d3b76fa69bf28c5ab340dd810e20">theOutputData</a>-&gt;<a class="code" href="classoutput_data.html#a213ddbf3e83fe1f17f12994794ae649d">NminData</a>[i].getStartDepth() &lt;&lt; <span class="stringliteral">&quot;-&quot;</span>&lt;&lt; <a class="code" href="output_data_8h.html#aadc9d3b76fa69bf28c5ab340dd810e20">theOutputData</a>-&gt;<a class="code" href="classoutput_data.html#a213ddbf3e83fe1f17f12994794ae649d">NminData</a>[i].getEndDepth();
<a name="l00128"></a>00128       }
<a name="l00129"></a>00129 
<a name="l00130"></a>00130       <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0;i&lt;<a class="code" href="output_data_8h.html#aadc9d3b76fa69bf28c5ab340dd810e20">theOutputData</a>-&gt;<a class="code" href="classoutput_data.html#a18c6fe52f21a94dcb854e8b5d70c79f0">SoilOrgCData</a>.size();i++)
<a name="l00131"></a>00131       {
<a name="l00132"></a>00132 
<a name="l00133"></a>00133          <a class="code" href="classsoil.html#a37ce966bebdb8775a666a3c0a6cd8bf3" title="file streams for details of soil variables.">f</a> &lt;&lt; <span class="stringliteral">&quot;\tSMB-C-&quot;</span>&lt;&lt; <a class="code" href="output_data_8h.html#aadc9d3b76fa69bf28c5ab340dd810e20">theOutputData</a>-&gt;<a class="code" href="classoutput_data.html#a18c6fe52f21a94dcb854e8b5d70c79f0">SoilOrgCData</a>[i].getStartDepth() &lt;&lt; <span class="stringliteral">&quot;-&quot;</span>&lt;&lt;  <a class="code" href="output_data_8h.html#aadc9d3b76fa69bf28c5ab340dd810e20">theOutputData</a>-&gt;<a class="code" href="classoutput_data.html#a18c6fe52f21a94dcb854e8b5d70c79f0">SoilOrgCData</a>[i].getEndDepth();
<a name="l00134"></a>00134          <a class="code" href="classsoil.html#a37ce966bebdb8775a666a3c0a6cd8bf3" title="file streams for details of soil variables.">f</a> &lt;&lt; <span class="stringliteral">&quot;\tNH4\tNO3\tNH4-N15\tNO3-N15\tAOM1\tAOM2\tSMB1\tSMB2\tSMR\tNOM\tIOM\tAOM1-N15\tAOM2-N15\tSMB1-N15\tSMB2-N15\tSMR-N15\tNOM-N15&quot;</span>;
<a name="l00135"></a>00135       }
<a name="l00136"></a>00136       <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0;i&lt;<a class="code" href="output_data_8h.html#aadc9d3b76fa69bf28c5ab340dd810e20">theOutputData</a>-&gt;<a class="code" href="classoutput_data.html#aedb40aad179f87df3aa953a885cfa16c">SoilOrgNData</a>.size();i++)
<a name="l00137"></a>00137       {
<a name="l00138"></a>00138 
<a name="l00139"></a>00139           <a class="code" href="classsoil.html#a37ce966bebdb8775a666a3c0a6cd8bf3" title="file streams for details of soil variables.">f</a> &lt;&lt; <span class="stringliteral">&quot;\tSMB-N-&quot;</span>&lt;&lt; <a class="code" href="output_data_8h.html#aadc9d3b76fa69bf28c5ab340dd810e20">theOutputData</a>-&gt;<a class="code" href="classoutput_data.html#aedb40aad179f87df3aa953a885cfa16c">SoilOrgNData</a>[i].getStartDepth() &lt;&lt; <span class="stringliteral">&quot;-&quot;</span>&lt;&lt;  <a class="code" href="output_data_8h.html#aadc9d3b76fa69bf28c5ab340dd810e20">theOutputData</a>-&gt;<a class="code" href="classoutput_data.html#aedb40aad179f87df3aa953a885cfa16c">SoilOrgNData</a>[i].getEndDepth()&lt;&lt;<span class="stringliteral">&quot;[m/g]&quot;</span>;
<a name="l00140"></a>00140           <a class="code" href="classsoil.html#a37ce966bebdb8775a666a3c0a6cd8bf3" title="file streams for details of soil variables.">f</a> &lt;&lt; <span class="stringliteral">&quot;\tNOM-C\tIOM-C\tAOM1-C\tAOM2-C\tSMB1-C\tSMB2-C\tSMR-C\tTOC200\tTOC400\tTOC600\tTON200\tTOC1000\tTot15N-500\tTot15N-1500&quot;</span>;
<a name="l00141"></a>00141       }
<a name="l00142"></a>00142       <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0;i&lt;<a class="code" href="output_data_8h.html#aadc9d3b76fa69bf28c5ab340dd810e20">theOutputData</a>-&gt;<a class="code" href="classoutput_data.html#a9049c356d01885832d2118f58ed94bba">PoreWaterData</a>.size();i++)
<a name="l00143"></a>00143       {
<a name="l00144"></a>00144 
<a name="l00145"></a>00145          <a class="code" href="classsoil.html#a37ce966bebdb8775a666a3c0a6cd8bf3" title="file streams for details of soil variables.">f</a> &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <a class="code" href="output_data_8h.html#aadc9d3b76fa69bf28c5ab340dd810e20">theOutputData</a>-&gt;<a class="code" href="classoutput_data.html#a9049c356d01885832d2118f58ed94bba">PoreWaterData</a>[i].getDepth()/10 &lt;&lt;<span class="stringliteral">&quot;cmNit-N&quot;</span>
<a name="l00146"></a>00146          &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <a class="code" href="output_data_8h.html#aadc9d3b76fa69bf28c5ab340dd810e20">theOutputData</a>-&gt;<a class="code" href="classoutput_data.html#a9049c356d01885832d2118f58ed94bba">PoreWaterData</a>[i].getDepth()/10 &lt;&lt;<span class="stringliteral">&quot;cmAm-N&quot;</span>
<a name="l00147"></a>00147          &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <a class="code" href="output_data_8h.html#aadc9d3b76fa69bf28c5ab340dd810e20">theOutputData</a>-&gt;<a class="code" href="classoutput_data.html#a9049c356d01885832d2118f58ed94bba">PoreWaterData</a>[i].getDepth()/10 &lt;&lt;<span class="stringliteral">&quot;cmN&quot;</span>
<a name="l00148"></a>00148         &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <a class="code" href="output_data_8h.html#aadc9d3b76fa69bf28c5ab340dd810e20">theOutputData</a>-&gt;<a class="code" href="classoutput_data.html#a9049c356d01885832d2118f58ed94bba">PoreWaterData</a>[i].getDepth()/10 &lt;&lt;<span class="stringliteral">&quot;cmCL&quot;</span>
<a name="l00149"></a>00149          &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <a class="code" href="output_data_8h.html#aadc9d3b76fa69bf28c5ab340dd810e20">theOutputData</a>-&gt;<a class="code" href="classoutput_data.html#a9049c356d01885832d2118f58ed94bba">PoreWaterData</a>[i].getDepth()/10 &lt;&lt;<span class="stringliteral">&quot;cmN15&quot;</span>;
<a name="l00150"></a>00150 
<a name="l00151"></a>00151       }
<a name="l00152"></a>00152 
<a name="l00153"></a>00153       <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0;i&lt;<a class="code" href="output_data_8h.html#aadc9d3b76fa69bf28c5ab340dd810e20">theOutputData</a>-&gt;<a class="code" href="classoutput_data.html#a3e8cb56e571046aa8b37a4260a062594">TemperatureData</a>.size();i++)
<a name="l00154"></a>00154       {
<a name="l00155"></a>00155           <a class="code" href="classsoil.html#a37ce966bebdb8775a666a3c0a6cd8bf3" title="file streams for details of soil variables.">f</a> &lt;&lt; <span class="stringliteral">&quot;\tt&quot;</span> &lt;&lt;<a class="code" href="output_data_8h.html#aadc9d3b76fa69bf28c5ab340dd810e20">theOutputData</a>-&gt;<a class="code" href="classoutput_data.html#a3e8cb56e571046aa8b37a4260a062594">TemperatureData</a>[i].getDepth();
<a name="l00156"></a>00156       }
<a name="l00157"></a>00157 
<a name="l00158"></a>00158 
<a name="l00159"></a>00159       <a class="code" href="classsoil.html#a37ce966bebdb8775a666a3c0a6cd8bf3" title="file streams for details of soil variables.">f</a> &lt;&lt; <span class="stringliteral">&quot;\tnetMineralisation\tN2O-N\tN2O-D\tN2O\tN2Oratio\tDrainage\tDrainage-N\tSoilEvap\tPlantET&quot;</span>;
<a name="l00160"></a>00160       <a class="code" href="classsoil.html#a37ce966bebdb8775a666a3c0a6cd8bf3" title="file streams for details of soil variables.">f</a> &lt;&lt; <span class="stringliteral">&quot;\tDenitrification\tNitri\tCO2&quot;</span>;
<a name="l00161"></a>00161 <span class="comment">/*      f &lt;&lt; &quot;\tPotC\trN2OD&quot;;</span>
<a name="l00162"></a>00162 <span class="comment">      for (int i=0;i&lt;7;i++)</span>
<a name="l00163"></a>00163 <span class="comment">      {</span>
<a name="l00164"></a>00164 <span class="comment">        f &lt;&lt; &quot;\t&quot; &lt;&lt; &quot;N2OFromDen-&quot; &lt;&lt;i;</span>
<a name="l00165"></a>00165 <span class="comment">              f &lt;&lt; &quot;\t&quot; &lt;&lt; &quot;PotCTurn-&quot; &lt;&lt;i;</span>
<a name="l00166"></a>00166 <span class="comment">         f &lt;&lt; &quot;\t&quot; &lt;&lt; &quot;WaterEffect-&quot; &lt;&lt;i;</span>
<a name="l00167"></a>00167 <span class="comment">         f &lt;&lt; &quot;\t&quot; &lt;&lt; &quot;TempEffect-&quot; &lt;&lt;i;</span>
<a name="l00168"></a>00168 <span class="comment">         f &lt;&lt; &quot;\t&quot; &lt;&lt; &quot;NO3Effect-&quot; &lt;&lt;i;</span>
<a name="l00169"></a>00169 <span class="comment">      }</span>
<a name="l00170"></a>00170 <span class="comment">*/</span>
<a name="l00171"></a>00171       <a class="code" href="classsoil.html#a37ce966bebdb8775a666a3c0a6cd8bf3" title="file streams for details of soil variables.">f</a> &lt;&lt; <span class="stringliteral">&quot;\tSoilsurface-C\tSoilSurface-OrgN\tSoilSurface-&gt;TotN&quot;</span>;
<a name="l00172"></a>00172       <a class="code" href="classsoil.html#a37ce966bebdb8775a666a3c0a6cd8bf3" title="file streams for details of soil variables.">f</a> &lt;&lt; endl;
<a name="l00173"></a>00173    }
<a name="l00174"></a>00174    <a class="code" href="classbase.html#a56480e2d42e0f66e1416dbf064a913d1">CloseInputFile</a>();
<a name="l00175"></a>00175 }
<a name="l00176"></a>00176 
<a name="l00177"></a>00177 <span class="comment">/****************************************************************************\</span>
<a name="l00178"></a>00178 <span class="comment">&quot;nitrogenUptake&quot; not included</span>
<a name="l00179"></a>00179 <span class="comment">\****************************************************************************/</span>
<a name="l00180"></a><a class="code" href="classsoil.html#a3902dd1ec4cec0229854d26d0f3dbc14">00180</a> <span class="keywordtype">void</span> <a class="code" href="classsoil.html#a3902dd1ec4cec0229854d26d0f3dbc14" title="add one soil object to another">soil::Add</a>(<a class="code" href="classsoil.html">soil</a>* addSoil, <span class="keywordtype">double</span> <a class="code" href="typer_8h.html#ae4c405e5c68c6ec2c44bb6d6adfc2f6cab10366ecc76133a0a4a4712a5ee26f65">fraction</a>)
<a name="l00181"></a>00181 {
<a name="l00182"></a>00182    <a class="code" href="classsoil.html#abae868b529287ef261d995d817163406">evaporationDepth</a>          = (1.0-<a class="code" href="typer_8h.html#ae4c405e5c68c6ec2c44bb6d6adfc2f6cab10366ecc76133a0a4a4712a5ee26f65">fraction</a>)*<a class="code" href="classsoil.html#abae868b529287ef261d995d817163406">evaporationDepth</a>+fraction*addSoil-&gt;<a class="code" href="classsoil.html#abae868b529287ef261d995d817163406">evaporationDepth</a>;
<a name="l00183"></a>00183    <a class="code" href="classsoil.html#a1b5519eb95daaba51a3326b0bbc4e653">evapotranspiration</a>        = (1.0-fraction)*<a class="code" href="classsoil.html#a1b5519eb95daaba51a3326b0bbc4e653">evapotranspiration</a>+fraction*addSoil-&gt;<a class="code" href="classsoil.html#a1b5519eb95daaba51a3326b0bbc4e653">evapotranspiration</a>;
<a name="l00184"></a>00184    <a class="code" href="classsoil.html#aca4597213bffd5e97041c7da8b41f009">CO2Evolution</a>              = (1.0-<a class="code" href="typer_8h.html#ae4c405e5c68c6ec2c44bb6d6adfc2f6cab10366ecc76133a0a4a4712a5ee26f65">fraction</a>)*<a class="code" href="classsoil.html#aca4597213bffd5e97041c7da8b41f009">CO2Evolution</a>+fraction*addSoil-&gt;<a class="code" href="classsoil.html#aca4597213bffd5e97041c7da8b41f009">CO2Evolution</a>;
<a name="l00185"></a>00185 
<a name="l00186"></a>00186    <a class="code" href="classsoil.html#a6d11057be5710fe4f12a148abccc30eb">nitrateLeached</a>            = <a class="code" href="classsoil.html#a6d11057be5710fe4f12a148abccc30eb">nitrateLeached</a>*(1.0-fraction)+addSoil-&gt;<a class="code" href="classsoil.html#a6d11057be5710fe4f12a148abccc30eb">nitrateLeached</a>*<a class="code" href="typer_8h.html#ae4c405e5c68c6ec2c44bb6d6adfc2f6cab10366ecc76133a0a4a4712a5ee26f65">fraction</a>;
<a name="l00187"></a>00187    <a class="code" href="classsoil.html#ad38099a7fb0f61aa85c082b4aa0ed931">ammoniumLeached</a>           = <a class="code" href="classsoil.html#ad38099a7fb0f61aa85c082b4aa0ed931">ammoniumLeached</a>*(1.0-<a class="code" href="typer_8h.html#ae4c405e5c68c6ec2c44bb6d6adfc2f6cab10366ecc76133a0a4a4712a5ee26f65">fraction</a>)+addSoil-&gt;<a class="code" href="classsoil.html#ad38099a7fb0f61aa85c082b4aa0ed931">ammoniumLeached</a>*fraction;
<a name="l00188"></a>00188    <a class="code" href="classsoil.html#ab94851a74389f879a38bdcaad1826ef2">denitrification</a>           = <a class="code" href="classsoil.html#ab94851a74389f879a38bdcaad1826ef2">denitrification</a>*(1.0-fraction)+addSoil-&gt;<a class="code" href="classsoil.html#ab94851a74389f879a38bdcaad1826ef2">denitrification</a>*<a class="code" href="typer_8h.html#ae4c405e5c68c6ec2c44bb6d6adfc2f6cab10366ecc76133a0a4a4712a5ee26f65">fraction</a>;
<a name="l00189"></a>00189    <a class="code" href="classsoil.html#a9b86d97fc4356ee0b07bbb78f67484c8">nitrification</a>             = <a class="code" href="classsoil.html#a9b86d97fc4356ee0b07bbb78f67484c8">nitrification</a>*(1.0-<a class="code" href="typer_8h.html#ae4c405e5c68c6ec2c44bb6d6adfc2f6cab10366ecc76133a0a4a4712a5ee26f65">fraction</a>)+addSoil-&gt;<a class="code" href="classsoil.html#a9b86d97fc4356ee0b07bbb78f67484c8">nitrification</a>*fraction;
<a name="l00190"></a>00190 
<a name="l00191"></a>00191    <a class="code" href="classsoil.html#a7bd29a49ff933e84c22b9fe2753cc2fe">NitrogenNetMineralisation</a> = <a class="code" href="classsoil.html#a7bd29a49ff933e84c22b9fe2753cc2fe">NitrogenNetMineralisation</a>*(1.0-fraction)+addSoil-&gt;<a class="code" href="classsoil.html#a7bd29a49ff933e84c22b9fe2753cc2fe">NitrogenNetMineralisation</a>*<a class="code" href="typer_8h.html#ae4c405e5c68c6ec2c44bb6d6adfc2f6cab10366ecc76133a0a4a4712a5ee26f65">fraction</a>;
<a name="l00192"></a>00192 
<a name="l00193"></a>00193    <a class="code" href="classsoil.html#a7b54d79b2b2742e3a173c49e76a797c9">totalTranspiration</a>        = (1.0-<a class="code" href="typer_8h.html#ae4c405e5c68c6ec2c44bb6d6adfc2f6cab10366ecc76133a0a4a4712a5ee26f65">fraction</a>)*<a class="code" href="classsoil.html#a7b54d79b2b2742e3a173c49e76a797c9">totalTranspiration</a>+fraction*addSoil-&gt;<a class="code" href="classsoil.html#a7b54d79b2b2742e3a173c49e76a797c9">totalTranspiration</a>;
<a name="l00194"></a>00194    <a class="code" href="classsoil.html#a727b7e354f1982a033764880c47d7a81">soilEvaporation</a>           = (1.0-fraction)*<a class="code" href="classsoil.html#a727b7e354f1982a033764880c47d7a81">soilEvaporation</a>+fraction*addSoil-&gt;<a class="code" href="classsoil.html#a727b7e354f1982a033764880c47d7a81">soilEvaporation</a>;
<a name="l00195"></a>00195    <a class="code" href="classsoil.html#a8f203b5b85e7a616745ae8ec50e7f40d">AccumulatedWaterDrainage</a>  = (1.0-<a class="code" href="typer_8h.html#ae4c405e5c68c6ec2c44bb6d6adfc2f6cab10366ecc76133a0a4a4712a5ee26f65">fraction</a>)*<a class="code" href="classsoil.html#a8f203b5b85e7a616745ae8ec50e7f40d">AccumulatedWaterDrainage</a>+fraction*addSoil-&gt;<a class="code" href="classsoil.html#a8f203b5b85e7a616745ae8ec50e7f40d">AccumulatedWaterDrainage</a>;
<a name="l00196"></a>00196    <a class="code" href="classsoil.html#a92ba9cb92d2aebff24c21437ced70017">AccumulatedNitrateDrainage</a>= (1.0-fraction)*<a class="code" href="classsoil.html#a92ba9cb92d2aebff24c21437ced70017">AccumulatedNitrateDrainage</a>+fraction*addSoil-&gt;<a class="code" href="classsoil.html#a92ba9cb92d2aebff24c21437ced70017">AccumulatedNitrateDrainage</a>;
<a name="l00197"></a>00197 
<a name="l00198"></a>00198    <a class="code" href="classsoil.html#ab5516aa25f35082aba80ca2795c68e4e" title="object describing compounds on the soil surface (e.g. undissolved fertiliser)">Surface</a>-&gt;<a class="code" href="classsoil_surface.html#a076f92fc689a98876883f657855fae06">Add</a>(addSoil-&gt;<a class="code" href="classsoil.html#af438d2978a46a31b4ea15e13d23fd98d">GetSoilSurface</a>(),<a class="code" href="typer_8h.html#ae4c405e5c68c6ec2c44bb6d6adfc2f6cab10366ecc76133a0a4a4712a5ee26f65">fraction</a>);
<a name="l00199"></a>00199    <a class="code" href="classsoil.html#ab36e32808c2cadf3b50cd18fdc06ca01" title="object describing the soil profile">Profile</a>-&gt;<a class="code" href="classsoil_profile.html#a7fd5e793b56ea8fbc1aeb79e1927565e">Add</a>(addSoil-&gt;<a class="code" href="classsoil.html#a07a04782ac233c63f2f2246f89fb15c6">GetSoilProfile</a>(),<a class="code" href="typer_8h.html#ae4c405e5c68c6ec2c44bb6d6adfc2f6cab10366ecc76133a0a4a4712a5ee26f65">fraction</a>);
<a name="l00200"></a>00200    <a class="code" href="classsoil.html#addf9abd98e1b4678c37c714b49045f79" title="soil nitrogen budget">Nbudget</a>.<a class="code" href="classbudget.html#a2f378ac0b5f670cc9ec42b4e9ceb3c51">Add</a>(addSoil-&gt;<a class="code" href="classsoil.html#addf9abd98e1b4678c37c714b49045f79" title="soil nitrogen budget">Nbudget</a>,fraction);
<a name="l00201"></a>00201    <a class="code" href="classsoil.html#a5fc83b89b81299ab7cde864a78092279" title="soil water budget">WaterBudget</a>.<a class="code" href="classbudget.html#a2f378ac0b5f670cc9ec42b4e9ceb3c51">Add</a>(addSoil-&gt;<a class="code" href="classsoil.html#a5fc83b89b81299ab7cde864a78092279" title="soil water budget">WaterBudget</a>,fraction);
<a name="l00202"></a>00202 }
<a name="l00203"></a>00203 
<a name="l00204"></a>00204 <span class="comment">/****************************************************************************\</span>
<a name="l00205"></a>00205 <span class="comment">Adds nitrogen to soil</span>
<a name="l00206"></a>00206 <span class="comment">   surfNitrate   - Nitrate to be added to soil surface [g N/m�]</span>
<a name="l00207"></a>00207 <span class="comment">   surfAmmonium  - Ammonium to be added to soil surface [g N/m�]</span>
<a name="l00208"></a>00208 <span class="comment">   soilNitrate   - Nitrate to be added to top of soil profile [g N/m�]</span>
<a name="l00209"></a>00209 <span class="comment">   soilAmmonium  - Ammonium to be added to top of soil profile [g N/m�]</span>
<a name="l00210"></a>00210 <span class="comment">\****************************************************************************/</span>
<a name="l00211"></a><a class="code" href="classsoil.html#a827be6e854fe4893b5856774abb0bc8f">00211</a> <span class="keywordtype">void</span> <a class="code" href="classsoil.html#a827be6e854fe4893b5856774abb0bc8f" title="adds nitrogen to the soil">soil::AddNutrient</a>(<a class="code" href="classnitrogen.html">nitrogen</a> surfNitrate,
<a name="l00212"></a>00212                                                           <a class="code" href="classnitrogen.html">nitrogen</a> surfAmmonium,
<a name="l00213"></a>00213                                                           <a class="code" href="classnitrogen.html">nitrogen</a> soilNitrate,
<a name="l00214"></a>00214                                                           <a class="code" href="classnitrogen.html">nitrogen</a> soilAmmonium)
<a name="l00215"></a>00215 {
<a name="l00216"></a>00216    <a class="code" href="classsoil.html#ab5516aa25f35082aba80ca2795c68e4e" title="object describing compounds on the soil surface (e.g. undissolved fertiliser)">Surface</a>-&gt;<a class="code" href="classsoil_surface.html#afef3d7ce9b27c8f12412031604133e9a">AddSolidNitrogen</a>(surfNitrate,surfAmmonium);
<a name="l00217"></a>00217    <a class="code" href="classsoil.html#ab36e32808c2cadf3b50cd18fdc06ca01" title="object describing the soil profile">Profile</a>-&gt;<a class="code" href="classsoil_profile.html#aabd57b1bc75b4960731ed99fb01adba5">AddNutrient</a>(soilNitrate,soilAmmonium);
<a name="l00218"></a>00218    <a class="code" href="classsoil.html#addf9abd98e1b4678c37c714b49045f79" title="soil nitrogen budget">Nbudget</a>.<a class="code" href="classbudget.html#ad619d773e77931df0435e8c08314f68e">AddInput</a>(surfNitrate.<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a>+surfAmmonium.<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a>+soilNitrate.<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a>+soilAmmonium.<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a>);
<a name="l00219"></a>00219 }
<a name="l00220"></a>00220 
<a name="l00221"></a>00221 <span class="comment">/****************************************************************************\</span>
<a name="l00222"></a>00222 <span class="comment">\****************************************************************************/</span>
<a name="l00223"></a><a class="code" href="classsoil.html#a4d458777f5a0258b5459ece35f00121d">00223</a> <a class="code" href="classnitrogen.html">nitrogen</a> <a class="code" href="classsoil.html#a4d458777f5a0258b5459ece35f00121d">soil::GetNitrogenNetMineralisation</a>()
<a name="l00224"></a>00224 {
<a name="l00225"></a>00225    <a class="code" href="classnitrogen.html">nitrogen</a> Mineralisation = <a class="code" href="classsoil.html#a7bd29a49ff933e84c22b9fe2753cc2fe">NitrogenNetMineralisation</a>;
<a name="l00226"></a>00226    <a class="code" href="classsoil.html#a7bd29a49ff933e84c22b9fe2753cc2fe">NitrogenNetMineralisation</a>.<a class="code" href="classnitrogen.html#a706b101d934ddb44c4bff07761c8dfef">Clear</a>();
<a name="l00227"></a>00227    <span class="keywordflow">return</span> Mineralisation;
<a name="l00228"></a>00228 }
<a name="l00229"></a>00229 
<a name="l00230"></a>00230 <span class="comment">/****************************************************************************\</span>
<a name="l00231"></a>00231 <span class="comment">\****************************************************************************/</span>
<a name="l00232"></a><a class="code" href="classsoil.html#a103bd1bc57f62e9294194274c46ff7ef">00232</a> <a class="code" href="classnitrogen.html">nitrogen</a> <a class="code" href="classsoil.html#a103bd1bc57f62e9294194274c46ff7ef">soil::GetAmmonium</a>()
<a name="l00233"></a>00233 {
<a name="l00234"></a>00234    <a class="code" href="classnitrogen.html">nitrogen</a> Ammonium = <a class="code" href="classsoil.html#ab5516aa25f35082aba80ca2795c68e4e" title="object describing compounds on the soil surface (e.g. undissolved fertiliser)">Surface</a>-&gt;<a class="code" href="classsoil_surface.html#a4dac3a226167782d92048eab2e579abd">GetAmmoniumSolid</a>()+<a class="code" href="classsoil.html#ab5516aa25f35082aba80ca2795c68e4e" title="object describing compounds on the soil surface (e.g. undissolved fertiliser)">Surface</a>-&gt;<a class="code" href="classsoil_surface.html#a984469387e63e35357350cdfb35f294a">GetAmmoniumDisolved</a>()
<a name="l00235"></a>00235                        +<a class="code" href="classsoil.html#ab36e32808c2cadf3b50cd18fdc06ca01" title="object describing the soil profile">Profile</a>-&gt;<a class="code" href="classsoil_profile.html#ae08f75a5b3b0af43054c75f7c6b0867e">GetAmmonium</a>();
<a name="l00236"></a>00236         <span class="keywordflow">return</span> Ammonium;
<a name="l00237"></a>00237 }
<a name="l00238"></a>00238 
<a name="l00239"></a>00239 <span class="comment">/****************************************************************************\</span>
<a name="l00240"></a>00240 <span class="comment">\****************************************************************************/</span>
<a name="l00241"></a><a class="code" href="classsoil.html#a111760bc77c25164c82b3dbccf5e443a">00241</a> <a class="code" href="classnitrogen.html">nitrogen</a> <a class="code" href="classsoil.html#a111760bc77c25164c82b3dbccf5e443a">soil::GetNitrate</a>()
<a name="l00242"></a>00242 {
<a name="l00243"></a>00243         <span class="keywordflow">return</span> <a class="code" href="classsoil.html#ab5516aa25f35082aba80ca2795c68e4e" title="object describing compounds on the soil surface (e.g. undissolved fertiliser)">Surface</a>-&gt;<a class="code" href="classsoil_surface.html#a11d7a697d6f5e5b101641bcd5801282d">GetNitrateSolid</a>()+<a class="code" href="classsoil.html#ab5516aa25f35082aba80ca2795c68e4e" title="object describing compounds on the soil surface (e.g. undissolved fertiliser)">Surface</a>-&gt;<a class="code" href="classsoil_surface.html#a51dcb7eb6a1f8876beee1be1c85baa35">GetNitrateDisolved</a>()+<a class="code" href="classsoil.html#ab36e32808c2cadf3b50cd18fdc06ca01" title="object describing the soil profile">Profile</a>-&gt;<a class="code" href="classsoil_profile.html#a753455cef3dae233090a481b833e25c6">GetNitrate</a>();
<a name="l00244"></a>00244 }
<a name="l00245"></a>00245 
<a name="l00246"></a>00246 <span class="comment">/****************************************************************************\</span>
<a name="l00247"></a>00247 <span class="comment">\****************************************************************************/</span>
<a name="l00248"></a><a class="code" href="classsoil.html#a200ce7594b17ce2c3561789aeb3cf81c">00248</a> <a class="code" href="classnitrogen.html">nitrogen</a> <a class="code" href="classsoil.html#a200ce7594b17ce2c3561789aeb3cf81c">soil::GetMinNitrogen</a>()
<a name="l00249"></a>00249 {
<a name="l00250"></a>00250         <span class="keywordflow">return</span> <a class="code" href="classsoil.html#a103bd1bc57f62e9294194274c46ff7ef">GetAmmonium</a>()+<a class="code" href="classsoil.html#a111760bc77c25164c82b3dbccf5e443a">GetNitrate</a>();
<a name="l00251"></a>00251 }
<a name="l00252"></a>00252 
<a name="l00253"></a>00253 <span class="comment">/****************************************************************************\</span>
<a name="l00254"></a>00254 <span class="comment">\****************************************************************************/</span>
<a name="l00255"></a><a class="code" href="classsoil.html#a7b1b7b7110fd745719df083ba6292ac6">00255</a> <a class="code" href="classnitrogen.html">nitrogen</a> <a class="code" href="classsoil.html#a200ce7594b17ce2c3561789aeb3cf81c">soil::GetMinNitrogen</a>(<span class="keywordtype">double</span> startDep, <span class="keywordtype">double</span> thick)
<a name="l00256"></a>00256 {
<a name="l00257"></a>00257         <span class="keywordflow">return</span> <a class="code" href="classsoil.html#a103bd1bc57f62e9294194274c46ff7ef">GetAmmonium</a>(startDep,thick)+<a class="code" href="classsoil.html#a111760bc77c25164c82b3dbccf5e443a">GetNitrate</a>(startDep,thick);
<a name="l00258"></a>00258 }
<a name="l00259"></a>00259 
<a name="l00260"></a>00260 <span class="comment">/****************************************************************************\</span>
<a name="l00261"></a>00261 <span class="comment">\****************************************************************************/</span>
<a name="l00262"></a><a class="code" href="classsoil.html#a9bea1a88a9531db940078010517f596a">00262</a> <a class="code" href="classnitrogen.html">nitrogen</a> <a class="code" href="classsoil.html#a9bea1a88a9531db940078010517f596a">soil::GetTotalNitrogen</a>()
<a name="l00263"></a>00263 {
<a name="l00264"></a>00264         <span class="keywordflow">return</span> <a class="code" href="classsoil.html#ab5516aa25f35082aba80ca2795c68e4e" title="object describing compounds on the soil surface (e.g. undissolved fertiliser)">Surface</a>-&gt;<a class="code" href="classsoil_surface.html#a5d93b4b66e26d8e638f67c297db44821">GetTotalNitrogen</a>()+<a class="code" href="classsoil.html#ab36e32808c2cadf3b50cd18fdc06ca01" title="object describing the soil profile">Profile</a>-&gt;<a class="code" href="classsoil_profile.html#aaed7e24507f4b6af78401c985ab1cc12">GetTotalNitrogen</a>();
<a name="l00265"></a>00265 }
<a name="l00266"></a>00266 
<a name="l00267"></a>00267 <span class="comment">/****************************************************************************\</span>
<a name="l00268"></a>00268 <span class="comment">\****************************************************************************/</span>
<a name="l00269"></a><a class="code" href="classsoil.html#ae8d39d1c2f75f1aee237f657f7ac736d">00269</a> <a class="code" href="classnitrogen.html">nitrogen</a> <a class="code" href="classsoil.html#a9bea1a88a9531db940078010517f596a">soil::GetTotalNitrogen</a>(<span class="keywordtype">double</span> startDep, <span class="keywordtype">double</span> thick)
<a name="l00270"></a>00270 {
<a name="l00271"></a>00271         <span class="keywordflow">return</span> <a class="code" href="classsoil.html#a200ce7594b17ce2c3561789aeb3cf81c">GetMinNitrogen</a>(startDep,thick) + <a class="code" href="classsoil.html#ab36e32808c2cadf3b50cd18fdc06ca01" title="object describing the soil profile">Profile</a>-&gt;<a class="code" href="classsoil_profile.html#aee00c88c701f2ef848b9c96a3013e294">GetOrganicNitrogen</a>(startDep,thick);
<a name="l00272"></a>00272 }
<a name="l00273"></a>00273 
<a name="l00274"></a>00274 <span class="comment">/****************************************************************************\</span>
<a name="l00275"></a>00275 <span class="comment">\****************************************************************************/</span>
<a name="l00276"></a><a class="code" href="classsoil.html#a1ffeaf9576f8a6b9f09da84e921647d1">00276</a> <a class="code" href="classnitrogen.html">nitrogen</a> <a class="code" href="classsoil.html#a9bea1a88a9531db940078010517f596a">soil::GetTotalNitrogen</a>(<span class="keywordtype">double</span> depth)
<a name="l00277"></a>00277 {
<a name="l00278"></a>00278         <span class="keywordflow">return</span> <a class="code" href="classsoil.html#ab5516aa25f35082aba80ca2795c68e4e" title="object describing compounds on the soil surface (e.g. undissolved fertiliser)">Surface</a>-&gt;<a class="code" href="classsoil_surface.html#a5d93b4b66e26d8e638f67c297db44821">GetTotalNitrogen</a>()+ <a class="code" href="classsoil.html#a9bea1a88a9531db940078010517f596a">GetTotalNitrogen</a>(0, depth);
<a name="l00279"></a>00279 }
<a name="l00280"></a>00280 
<a name="l00281"></a>00281 <span class="comment">/****************************************************************************\</span>
<a name="l00282"></a>00282 <span class="comment">Updates the soil corresponding to the passing of one day.</span>
<a name="l00283"></a>00283 <span class="comment">   EPotToSoil      - potential evapotranspiration allocated to soil</span>
<a name="l00284"></a>00284 <span class="comment">   surplus         - water added to soil [mm/d]</span>
<a name="l00285"></a>00285 <span class="comment">   airTemperature  - air temperature [�C]</span>
<a name="l00286"></a>00286 <span class="comment">   snowContent     - snow content</span>
<a name="l00287"></a>00287 <span class="comment">   roots           - root descriptor list</span>
<a name="l00288"></a>00288 <span class="comment"></span>
<a name="l00289"></a>00289 <span class="comment">\****************************************************************************/</span>
<a name="l00290"></a><a class="code" href="classsoil.html#a79a9daafbc7c61b4a5392ac22f36ed5e">00290</a> <span class="keywordtype">void</span> <a class="code" href="classsoil.html#a79a9daafbc7c61b4a5392ac22f36ed5e" title="daily update for the soil">soil::Update</a>(<span class="keywordtype">double</span> surplus,
<a name="l00291"></a>00291                                         <span class="keywordtype">double</span> airTemperature,
<a name="l00292"></a>00292                   <span class="keywordtype">double</span> EPotToSoil,
<a name="l00293"></a>00293                   <span class="keywordtype">double</span> snowContent,
<a name="l00294"></a>00294                   <a class="code" href="classlink_list.html" title="Utility link list class.">linkList&lt;rootStructure&gt;</a>* rootInfo)
<a name="l00295"></a>00295 {
<a name="l00296"></a>00296 
<a name="l00297"></a>00297    <a class="code" href="classsoil.html#a5fc83b89b81299ab7cde864a78092279" title="soil water budget">WaterBudget</a>.<a class="code" href="classbudget.html#ad619d773e77931df0435e8c08314f68e">AddInput</a>(surplus);
<a name="l00298"></a>00298    <a class="code" href="classsoil.html#a1b5519eb95daaba51a3326b0bbc4e653">evapotranspiration</a>=0;
<a name="l00299"></a>00299 
<a name="l00300"></a>00300    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;(rootInfo-&gt;<a class="code" href="classlink_list.html#aee3f890e4e8f48db1518e5114d5bcca8" title="Returned total number of nodes.">NumOfNodes</a>()); i++) <span class="comment">// Convert root radius from mm to m</span>
<a name="l00301"></a>00301       rootInfo-&gt;<a class="code" href="classlink_list.html#a5735a6e54a2eed841bdf1fdb52aed03f" title="Return the address of the node with a given logical number in the list.">ElementAtNumber</a>(i)-&gt;<a class="code" href="structroot_structure.html#ae822dd60a6dd1507a84c10ab228fe97e">rootRadius</a>=rootInfo-&gt;<a class="code" href="classlink_list.html#a5735a6e54a2eed841bdf1fdb52aed03f" title="Return the address of the node with a given logical number in the list.">ElementAtNumber</a>(i)-&gt;<a class="code" href="structroot_structure.html#ae822dd60a6dd1507a84c10ab228fe97e">rootRadius</a>/1000.0;
<a name="l00302"></a>00302 
<a name="l00303"></a>00303    <span class="comment">// Update soil temperature</span>
<a name="l00304"></a>00304 
<a name="l00305"></a>00305       <a class="code" href="classsoil.html#ab36e32808c2cadf3b50cd18fdc06ca01" title="object describing the soil profile">Profile</a>-&gt;<a class="code" href="classsoil_profile.html#a11708c4ea232e4ba78ba3b7cf425853c">UpdateFinDiffTemperature</a>(airTemperature,snowContent);
<a name="l00306"></a>00306       <span class="comment">// Profile-&gt;UpdateTemperature(airTemperature,snowContent); // Old version</span>
<a name="l00307"></a>00307 
<a name="l00308"></a>00308    <span class="comment">// Update soil organic matter</span>
<a name="l00309"></a>00309 
<a name="l00310"></a>00310    <a class="code" href="classnitrogen.html">nitrogen</a> startMinN = <a class="code" href="classsoil.html#a200ce7594b17ce2c3561789aeb3cf81c">GetMinNitrogen</a>();
<a name="l00311"></a>00311    <a class="code" href="classsoil.html#aca4597213bffd5e97041c7da8b41f009">CO2Evolution</a> = <a class="code" href="classsoil.html#ab36e32808c2cadf3b50cd18fdc06ca01" title="object describing the soil profile">Profile</a>-&gt;<a class="code" href="classsoil_profile.html#a9928340939c7a139c0e708be2e7d4ca0">UpdateOrganicMatter</a>();
<a name="l00312"></a>00312    <a class="code" href="classsoil.html#a7bd29a49ff933e84c22b9fe2753cc2fe">NitrogenNetMineralisation</a> = <a class="code" href="classsoil.html#a7bd29a49ff933e84c22b9fe2753cc2fe">NitrogenNetMineralisation</a> + <a class="code" href="classsoil.html#a200ce7594b17ce2c3561789aeb3cf81c">GetMinNitrogen</a>()-startMinN;
<a name="l00313"></a>00313 
<a name="l00314"></a>00314 
<a name="l00315"></a>00315    <span class="comment">// Update nitrate by denitrification and nitrification</span>
<a name="l00316"></a>00316    <a class="code" href="classsoil.html#a9b86d97fc4356ee0b07bbb78f67484c8">nitrification</a> = <a class="code" href="classsoil.html#ab36e32808c2cadf3b50cd18fdc06ca01" title="object describing the soil profile">Profile</a>-&gt;<a class="code" href="classsoil_profile.html#a4a0d204ede21c28dc81b117813781ee1">UpdateNitrification</a>();
<a name="l00317"></a>00317    <a class="code" href="classsoil.html#ab94851a74389f879a38bdcaad1826ef2">denitrification</a> = <a class="code" href="classsoil.html#ab36e32808c2cadf3b50cd18fdc06ca01" title="object describing the soil profile">Profile</a>-&gt;<a class="code" href="classsoil_profile.html#abd4b5dd658a93bc311fcd9a1233eaa1f">UpdateDenitrification</a>(<a class="code" href="classsoil.html#aca4597213bffd5e97041c7da8b41f009">CO2Evolution</a>);
<a name="l00318"></a>00318 
<a name="l00319"></a>00319    <a class="code" href="classsoil.html#addf9abd98e1b4678c37c714b49045f79" title="soil nitrogen budget">Nbudget</a>.<a class="code" href="classbudget.html#a47bfa9740186f2be18a10dd3423a5eea">AddOutput</a>(<a class="code" href="classsoil.html#ab94851a74389f879a38bdcaad1826ef2">denitrification</a>.<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a>+<a class="code" href="classsoil.html#ab36e32808c2cadf3b50cd18fdc06ca01" title="object describing the soil profile">Profile</a>-&gt;<a class="code" href="classsoil_profile.html#a9be3f4ec8fe381095d2f9a15f1b7d77d">GetN2OFromDenitrification</a>().<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a>);
<a name="l00320"></a>00320    <a class="code" href="classsoil.html#addf9abd98e1b4678c37c714b49045f79" title="soil nitrogen budget">Nbudget</a>.<a class="code" href="classbudget.html#a47bfa9740186f2be18a10dd3423a5eea">AddOutput</a>(<a class="code" href="classsoil.html#ab36e32808c2cadf3b50cd18fdc06ca01" title="object describing the soil profile">Profile</a>-&gt;<a class="code" href="classsoil_profile.html#a1a70449a5466f3a625a9b393ee18112f">GetN2OFromNitrification</a>().<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a>);
<a name="l00321"></a>00321 
<a name="l00322"></a>00322    <span class="comment">// Update soil evaporation and nitrogen movement to soil</span>
<a name="l00323"></a>00323    <span class="keywordtype">double</span> relativeSurfaceWater = min(1.0,<a class="code" href="classsoil.html#ab36e32808c2cadf3b50cd18fdc06ca01" title="object describing the soil profile">Profile</a>-&gt;<a class="code" href="classsoil_profile.html#a51f57a7397df5853e8899f34ada2d374">GetAvailWater</a>(0.,<a class="code" href="classsoil.html#abae868b529287ef261d995d817163406">evaporationDepth</a>)/
<a name="l00324"></a>00324                                      <a class="code" href="classsoil.html#ab36e32808c2cadf3b50cd18fdc06ca01" title="object describing the soil profile">Profile</a>-&gt;<a class="code" href="classsoil_profile.html#adc7003b312a9bcc2fffdd45acfc65f28">GetAvailCapacity</a>(0.,<a class="code" href="classsoil.html#abae868b529287ef261d995d817163406">evaporationDepth</a>));
<a name="l00325"></a>00325    <span class="keywordtype">double</span> maxEvaporation = <a class="code" href="classsoil.html#ab36e32808c2cadf3b50cd18fdc06ca01" title="object describing the soil profile">Profile</a>-&gt;<a class="code" href="classsoil_profile.html#acfcd258f5c2c0914b13a39d6772e0f5c">GetMaximumEvaporation</a>();
<a name="l00326"></a>00326    <a class="code" href="classsoil.html#ab5516aa25f35082aba80ca2795c68e4e" title="object describing compounds on the soil surface (e.g. undissolved fertiliser)">Surface</a>-&gt;<a class="code" href="classsoil_surface.html#a76aba92c277390cc78e28d056f0dbbaa">Update</a>(&amp;surplus,
<a name="l00327"></a>00327                    EPotToSoil,
<a name="l00328"></a>00328                    relativeSurfaceWater,
<a name="l00329"></a>00329                    maxEvaporation,
<a name="l00330"></a>00330                    <a class="code" href="classsoil.html#ab36e32808c2cadf3b50cd18fdc06ca01" title="object describing the soil profile">Profile</a>-&gt;<a class="code" href="classsoil_profile.html#a839de879376f19c2408171cfb82c71e1">GetEvaporationContent</a>(),
<a name="l00331"></a>00331                                             airTemperature);
<a name="l00332"></a>00332    <a class="code" href="classsoil.html#a727b7e354f1982a033764880c47d7a81">soilEvaporation</a> = <a class="code" href="classsoil.html#ab5516aa25f35082aba80ca2795c68e4e" title="object describing compounds on the soil surface (e.g. undissolved fertiliser)">Surface</a>-&gt;<a class="code" href="classsoil_surface.html#a455a1094f28a710abb7fc1d88cae8c5d">GetEvaporation</a>();
<a name="l00333"></a>00333    <a class="code" href="classsoil.html#a1b5519eb95daaba51a3326b0bbc4e653">evapotranspiration</a> += <a class="code" href="classsoil.html#a727b7e354f1982a033764880c47d7a81">soilEvaporation</a>;
<a name="l00334"></a>00334    <a class="code" href="classsoil.html#ab36e32808c2cadf3b50cd18fdc06ca01" title="object describing the soil profile">Profile</a>-&gt;<a class="code" href="classsoil_profile.html#a4edb42ee540e88473200024afd61b232">SubtractEvaporation</a>(<a class="code" href="classsoil.html#a727b7e354f1982a033764880c47d7a81">soilEvaporation</a>);
<a name="l00335"></a>00335    <a class="code" href="classsoil.html#a5fc83b89b81299ab7cde864a78092279" title="soil water budget">WaterBudget</a>.<a class="code" href="classbudget.html#a47bfa9740186f2be18a10dd3423a5eea">AddOutput</a>(<a class="code" href="classsoil.html#a727b7e354f1982a033764880c47d7a81">soilEvaporation</a>);
<a name="l00336"></a>00336 
<a name="l00337"></a>00337 
<a name="l00338"></a>00338    <a class="code" href="classsoil.html#ab36e32808c2cadf3b50cd18fdc06ca01" title="object describing the soil profile">Profile</a>-&gt;<a class="code" href="classsoil_profile.html#a276eab1d6e61326093e214a89a9af7db">SubtractTranspiration</a>(rootInfo);
<a name="l00339"></a>00339 
<a name="l00340"></a>00340 
<a name="l00341"></a>00341    <a class="code" href="classsoil.html#a7b54d79b2b2742e3a173c49e76a797c9">totalTranspiration</a> = 0;
<a name="l00342"></a>00342    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;rootInfo-&gt;<a class="code" href="classlink_list.html#aee3f890e4e8f48db1518e5114d5bcca8" title="Returned total number of nodes.">NumOfNodes</a>(); i++)
<a name="l00343"></a>00343       <a class="code" href="classsoil.html#a7b54d79b2b2742e3a173c49e76a797c9">totalTranspiration</a>  += rootInfo-&gt;<a class="code" href="classlink_list.html#a5735a6e54a2eed841bdf1fdb52aed03f" title="Return the address of the node with a given logical number in the list.">ElementAtNumber</a>(i)-&gt;<a class="code" href="structroot_structure.html#ac5932526da0cac056674b385da3b52a1">actualTranspiration</a>;
<a name="l00344"></a>00344    <a class="code" href="classsoil.html#a1b5519eb95daaba51a3326b0bbc4e653">evapotranspiration</a> += <a class="code" href="classsoil.html#a7b54d79b2b2742e3a173c49e76a797c9">totalTranspiration</a>;
<a name="l00345"></a>00345    <a class="code" href="classsoil.html#a5fc83b89b81299ab7cde864a78092279" title="soil water budget">WaterBudget</a>.<a class="code" href="classbudget.html#a47bfa9740186f2be18a10dd3423a5eea">AddOutput</a>(<a class="code" href="classsoil.html#a7b54d79b2b2742e3a173c49e76a797c9">totalTranspiration</a>);
<a name="l00346"></a>00346 
<a name="l00347"></a>00347 
<a name="l00348"></a>00348    <a class="code" href="classnitrogen.html">nitrogen</a> surfaceNitrate  = <a class="code" href="classsoil.html#ab5516aa25f35082aba80ca2795c68e4e" title="object describing compounds on the soil surface (e.g. undissolved fertiliser)">Surface</a>-&gt;<a class="code" href="classsoil_surface.html#aa7fb1af3a01553e72ed3437291195eaf">ExtractNitrateDisolved</a>();
<a name="l00349"></a>00349    <a class="code" href="classnitrogen.html">nitrogen</a> surfaceAmmonium = <a class="code" href="classsoil.html#ab5516aa25f35082aba80ca2795c68e4e" title="object describing compounds on the soil surface (e.g. undissolved fertiliser)">Surface</a>-&gt;<a class="code" href="classsoil_surface.html#a8142c8ab4d304c03b412bc1c28c8a40b">ExtractAmmoniumDisolved</a>();
<a name="l00350"></a>00350    surplus += <a class="code" href="classsoil.html#ab5516aa25f35082aba80ca2795c68e4e" title="object describing compounds on the soil surface (e.g. undissolved fertiliser)">Surface</a>-&gt;<a class="code" href="classsoil_surface.html#a68d7c37ad7e711584848df35d7583910">ExtractWater</a>(); <span class="comment">// Code review 2011 Tjek om det er korrekt regnet ud, eller om alt vand og N forsvinder p een gang!!!!!</span>
<a name="l00351"></a>00351 
<a name="l00352"></a>00352    <span class="keywordtype">double</span> Chloride = <a class="code" href="classsoil.html#ab5516aa25f35082aba80ca2795c68e4e" title="object describing compounds on the soil surface (e.g. undissolved fertiliser)">Surface</a>-&gt;<a class="code" href="classsoil_surface.html#a58ffb9a0d3adac6295a53b08bde3d243">ExtractChloride</a>();
<a name="l00353"></a>00353    <span class="comment">// Water infiltration and nitrogen leaching</span>
<a name="l00354"></a>00354 
<a name="l00355"></a>00355    <a class="code" href="classsoil.html#ab36e32808c2cadf3b50cd18fdc06ca01" title="object describing the soil profile">Profile</a>-&gt;<a class="code" href="classsoil_profile.html#a942247912493da600aafecfa845d2d9c">UpdateInfiltrationSWAT</a>(&amp;surplus,&amp;surfaceNitrate,&amp;surfaceAmmonium,&amp;<a class="code" href="classsoil.html#a6d11057be5710fe4f12a148abccc30eb">nitrateLeached</a>,&amp;<a class="code" href="classsoil.html#ad38099a7fb0f61aa85c082b4aa0ed931">ammoniumLeached</a>,Chloride);
<a name="l00356"></a>00356 
<a name="l00357"></a>00357    <span class="comment">// Deposit possibly &quot;unused&quot; water and N on soil surface</span>
<a name="l00358"></a>00358    <span class="comment">// Code review Kan det nogensinde ske????!!!</span>
<a name="l00359"></a>00359    <a class="code" href="classsoil.html#ab5516aa25f35082aba80ca2795c68e4e" title="object describing compounds on the soil surface (e.g. undissolved fertiliser)">Surface</a>-&gt;<a class="code" href="classsoil_surface.html#a5d6f8c4c397d6cf8269ddd588e3e37f8">AddWater</a>(surplus);
<a name="l00360"></a>00360    <a class="code" href="classsoil.html#ab5516aa25f35082aba80ca2795c68e4e" title="object describing compounds on the soil surface (e.g. undissolved fertiliser)">Surface</a>-&gt;<a class="code" href="classsoil_surface.html#a61a48f2de12c8e87039fdba220856439">AddNitrateDissolved</a>(surfaceNitrate);
<a name="l00361"></a>00361    <a class="code" href="classsoil.html#ab5516aa25f35082aba80ca2795c68e4e" title="object describing compounds on the soil surface (e.g. undissolved fertiliser)">Surface</a>-&gt;<a class="code" href="classsoil_surface.html#aabff58a0f58d1f4ca7c0fccdc976fa77">AddAmmoniumDissolved</a>(surfaceAmmonium);
<a name="l00362"></a>00362    <span class="comment">// Perform surface run-off</span>
<a name="l00363"></a>00363    <a class="code" href="classsoil.html#ab5516aa25f35082aba80ca2795c68e4e" title="object describing compounds on the soil surface (e.g. undissolved fertiliser)">Surface</a>-&gt;<a class="code" href="classsoil_surface.html#aeb5d1da5eb1d80034c7293bf4442cbbd">SurfaceRunOff</a>();
<a name="l00364"></a>00364 
<a name="l00365"></a>00365    <span class="comment">// Nitrogen uptake by the plants</span>
<a name="l00366"></a>00366    <a class="code" href="classsoil.html#a738126f478188eb4e5ec2b04271c6d6d">nitrogenUptake</a> = <a class="code" href="classsoil.html#ab36e32808c2cadf3b50cd18fdc06ca01" title="object describing the soil profile">Profile</a>-&gt;<a class="code" href="classsoil_profile.html#af357c8e8608de267646daf715ca1a125">SubtractNitrogenUptake</a>(rootInfo);
<a name="l00367"></a>00367 
<a name="l00368"></a>00368    <span class="comment">// Perform budgeting</span>
<a name="l00369"></a>00369    <a class="code" href="classsoil.html#a5fc83b89b81299ab7cde864a78092279" title="soil water budget">WaterBudget</a>.<a class="code" href="classbudget.html#a47bfa9740186f2be18a10dd3423a5eea">AddOutput</a>(<a class="code" href="classsoil.html#ab36e32808c2cadf3b50cd18fdc06ca01" title="object describing the soil profile">Profile</a>-&gt;<a class="code" href="classsoil_profile.html#a46d21083a35260e54710785e8b9b8249">GetDrainage</a>(<a class="code" href="classsoil.html#a36b98f1dc475f9116205d93b64c84b67">GetMaximumDepth</a>())+<a class="code" href="classsoil.html#ab5516aa25f35082aba80ca2795c68e4e" title="object describing compounds on the soil surface (e.g. undissolved fertiliser)">Surface</a>-&gt;<a class="code" href="classsoil_surface.html#aa5fbf9e9f54d0dc0cd138033038213a5">GetRunOff</a>());
<a name="l00370"></a>00370    <span class="keywordflow">if</span> (<a class="code" href="bstime_8h.html#ac0dc3834220ee5ae84c115e146194d75">theTime</a>.<a class="code" href="classbs_time.html#a777a59c97951688c4b2a67c4b0bca16e">GetMonth</a>()==4 &amp;&amp; <a class="code" href="bstime_8h.html#ac0dc3834220ee5ae84c115e146194d75">theTime</a>.<a class="code" href="classbs_time.html#a3b4126cf9db93be0c2f69549699730d3">GetDay</a>()==1)
<a name="l00371"></a>00371            <a class="code" href="classsoil.html#a8f203b5b85e7a616745ae8ec50e7f40d">AccumulatedWaterDrainage</a> = <a class="code" href="classsoil.html#a92ba9cb92d2aebff24c21437ced70017">AccumulatedNitrateDrainage</a> = 0.0;
<a name="l00372"></a>00372    <a class="code" href="classsoil.html#a8f203b5b85e7a616745ae8ec50e7f40d">AccumulatedWaterDrainage</a>   += <a class="code" href="classsoil.html#ab36e32808c2cadf3b50cd18fdc06ca01" title="object describing the soil profile">Profile</a>-&gt;<a class="code" href="classsoil_profile.html#a46d21083a35260e54710785e8b9b8249">GetDrainage</a>(1000.0);
<a name="l00373"></a>00373    <a class="code" href="classsoil.html#a92ba9cb92d2aebff24c21437ced70017">AccumulatedNitrateDrainage</a> += <a class="code" href="classsoil.html#ab36e32808c2cadf3b50cd18fdc06ca01" title="object describing the soil profile">Profile</a>-&gt;<a class="code" href="classsoil_profile.html#aefe1b8475041b54e5f0a1fd6cdebff2a">GetNitrateLeaching</a>(1000.0).<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a>;
<a name="l00374"></a>00374 
<a name="l00375"></a>00375    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;rootInfo-&gt;<a class="code" href="classlink_list.html#aee3f890e4e8f48db1518e5114d5bcca8" title="Returned total number of nodes.">NumOfNodes</a>(); i++)
<a name="l00376"></a>00376            <a class="code" href="classsoil.html#addf9abd98e1b4678c37c714b49045f79" title="soil nitrogen budget">Nbudget</a>.<a class="code" href="classbudget.html#a47bfa9740186f2be18a10dd3423a5eea">AddOutput</a>(<a class="code" href="classsoil.html#a738126f478188eb4e5ec2b04271c6d6d">nitrogenUptake</a>[i].<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a>);
<a name="l00377"></a>00377    <a class="code" href="classsoil.html#addf9abd98e1b4678c37c714b49045f79" title="soil nitrogen budget">Nbudget</a>.<a class="code" href="classbudget.html#a47bfa9740186f2be18a10dd3423a5eea">AddOutput</a>(<a class="code" href="classsoil.html#ab5516aa25f35082aba80ca2795c68e4e" title="object describing compounds on the soil surface (e.g. undissolved fertiliser)">Surface</a>-&gt;<a class="code" href="classsoil_surface.html#ad8cea52b7a9dc89b8a3999a6d79785ed">GetRunOff_N</a>().<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a>);
<a name="l00378"></a>00378    <a class="code" href="classsoil.html#addf9abd98e1b4678c37c714b49045f79" title="soil nitrogen budget">Nbudget</a>.<a class="code" href="classbudget.html#a47bfa9740186f2be18a10dd3423a5eea">AddOutput</a>(<a class="code" href="classsoil.html#a349f7aeac285f43f4afb6d35eadcc194">GetNitrateLeaching</a>(<a class="code" href="classsoil.html#a36b98f1dc475f9116205d93b64c84b67">GetMaximumDepth</a>()).n+<a class="code" href="classsoil.html#a4ed6d8238db0cde0c7ceb073ec61fe83">GetAmmoniumLeaching</a>(<a class="code" href="classsoil.html#a36b98f1dc475f9116205d93b64c84b67">GetMaximumDepth</a>()).n);
<a name="l00379"></a>00379 
<a name="l00380"></a>00380    <span class="comment">// EndBudget(&amp;NRemain,&amp;WaterRemain); !!!???</span>
<a name="l00381"></a>00381 
<a name="l00382"></a>00382 
<a name="l00383"></a>00383    <a class="code" href="classsoil.html#a2dfefa36aa46caa719e36780e87bee59">WriteOutput</a>();
<a name="l00384"></a>00384 }
<a name="l00385"></a>00385 
<a name="l00386"></a>00386 <span class="comment">/****************************************************************************\</span>
<a name="l00387"></a>00387 <span class="comment">Incorporates organic matter from the surface and roots into the soil</span>
<a name="l00388"></a>00388 <span class="comment">(depth: mm, fraction: 0-1)</span>
<a name="l00389"></a>00389 <span class="comment">\****************************************************************************/</span>
<a name="l00390"></a><a class="code" href="classsoil.html#a0fcdb4597cdf9804bcb5608a6d99ea5d">00390</a> <span class="keywordtype">void</span> <a class="code" href="classsoil.html#a0fcdb4597cdf9804bcb5608a6d99ea5d" title="incorporate compounds that are on the soil surface into the soil">soil::Incorporate</a>(<span class="keywordtype">double</span> depth, <span class="keywordtype">double</span> frac, <span class="keywordtype">bool</span> tillage, <span class="keyword">const</span> <span class="keywordtype">char</span> * tillagetype)
<a name="l00391"></a>00391 {
<a name="l00392"></a>00392 
<a name="l00393"></a>00393    <span class="keywordflow">if</span> ((depth&gt;0 &amp;&amp; frac&gt;0))
<a name="l00394"></a>00394    {
<a name="l00395"></a>00395            <span class="keywordflow">if</span>(<a class="code" href="classbase.html#a82e26b779409159be745275990ef9c99">OpenInputFileString</a>(<span class="stringliteral">&quot;Tillage.dat&quot;</span>)) <span class="comment">// Only comes in effect when tillage.dat is present</span>
<a name="l00396"></a>00396                 {
<a name="l00397"></a>00397       <span class="keywordflow">if</span> (tillage)
<a name="l00398"></a>00398       {
<a name="l00399"></a>00399          <span class="keywordtype">double</span> p1=0.1;
<a name="l00400"></a>00400          <span class="keywordtype">double</span> p2=0.5;
<a name="l00401"></a>00401          <span class="keywordtype">double</span> TurnoverFactor=2;
<a name="l00402"></a>00402                 <a class="code" href="classbase.html#a88e41ff60ffb7e707312a09f20457e73">FindSection</a>(tillagetype);
<a name="l00403"></a>00403         <a class="code" href="classbase.html#aff0b96b92d78c345fd60335cece99d08">GetParameter</a>(<span class="stringliteral">&quot;KillSMBFraction&quot;</span>,&amp;p1);
<a name="l00404"></a>00404         <a class="code" href="classbase.html#aff0b96b92d78c345fd60335cece99d08">GetParameter</a>(<span class="stringliteral">&quot;MoveToFasterFraction&quot;</span>,&amp;p2);
<a name="l00405"></a>00405         <a class="code" href="classbase.html#aff0b96b92d78c345fd60335cece99d08">GetParameter</a>(<span class="stringliteral">&quot;TurnoverFactor&quot;</span>,&amp;TurnoverFactor);
<a name="l00406"></a>00406 
<a name="l00407"></a>00407                         <span class="keywordflow">if</span> (p1 &gt; 1.0 || p1 &lt; 0.0 || p2 &gt; 1.0 || p2 &lt; 0.0)
<a name="l00408"></a>00408                 <a class="code" href="message_8h.html#a8ad29009121a629982c6ade0bd332470">theMessage</a>-&gt;<a class="code" href="classmessage.html#af9891cb7111375e6a36363afffb09d63">FatalError</a>(<span class="stringliteral">&quot;Illegal parameter values for soil tillage effect&quot;</span>);
<a name="l00409"></a>00409                         <span class="keywordflow">if</span> (p1 &gt; 0.0)
<a name="l00410"></a>00410                 <a class="code" href="classsoil.html#a35efd012c78310446c1691c74d1a11d9">KillSMB</a>(p1,depth);
<a name="l00411"></a>00411                 <span class="keywordflow">if</span> (p2 &gt; 0.0)
<a name="l00412"></a>00412                 <a class="code" href="classsoil.html#a5c180783f496514ec193625e0cd6d501">ModifyAOM</a>(p2,TurnoverFactor,depth);
<a name="l00413"></a>00413         }
<a name="l00414"></a>00414 
<a name="l00415"></a>00415 
<a name="l00416"></a>00416       <a class="code" href="classbase.html#a56480e2d42e0f66e1416dbf064a913d1">CloseInputFile</a>();
<a name="l00417"></a>00417         }
<a name="l00418"></a>00418       <span class="keywordtype">int</span> n = <a class="code" href="classsoil.html#ab36e32808c2cadf3b50cd18fdc06ca01" title="object describing the soil profile">Profile</a>-&gt;<a class="code" href="classsoil_profile.html#a71a258ab02b886dcfe4e495c16490f80">GetNumberOfLayers</a>();
<a name="l00419"></a>00419       <span class="keywordtype">double</span> LengthList[300];
<a name="l00420"></a>00420       <span class="comment">//double * p = &amp;LengthList[0];</span>
<a name="l00421"></a>00421       <span class="keywordtype">double</span> CurrentDepth = 0;
<a name="l00422"></a>00422       <a class="code" href="classorganic_product.html">organicProduct</a> * prod;
<a name="l00423"></a>00423       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;n; i++)
<a name="l00424"></a>00424       {
<a name="l00425"></a>00425          <span class="keywordtype">double</span> LayerThickness = <a class="code" href="classsoil.html#ab36e32808c2cadf3b50cd18fdc06ca01" title="object describing the soil profile">Profile</a>-&gt;<a class="code" href="classsoil_profile.html#a062bc6b13eb0debe7a8a8c1e31c53b4e">GetLayerThickness</a>(i+1);
<a name="l00426"></a>00426          CurrentDepth += LayerThickness;
<a name="l00427"></a>00427          LengthList[i] = 0.;
<a name="l00428"></a>00428         <span class="keywordflow">if</span> (CurrentDepth&lt;=depth)
<a name="l00429"></a>00429             LengthList[i] = LayerThickness;
<a name="l00430"></a>00430          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (CurrentDepth-LayerThickness&lt;depth)
<a name="l00431"></a>00431                LengthList[i] = depth-(CurrentDepth-LayerThickness);
<a name="l00432"></a>00432       }
<a name="l00433"></a>00433       n = <a class="code" href="classsoil.html#ab5516aa25f35082aba80ca2795c68e4e" title="object describing compounds on the soil surface (e.g. undissolved fertiliser)">Surface</a>-&gt;<a class="code" href="classsoil_surface.html#a6f55ef8ba714bf70c97ac208d839ecce">GetNumberOfProducts</a>();
<a name="l00434"></a>00434       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;n; j++)
<a name="l00435"></a>00435       {
<a name="l00436"></a>00436          prod = <a class="code" href="classsoil.html#ab5516aa25f35082aba80ca2795c68e4e" title="object describing compounds on the soil surface (e.g. undissolved fertiliser)">Surface</a>-&gt;<a class="code" href="classsoil_surface.html#ab9ad1072ebafe753fdb342846877c8d7">RemoveProduct</a>(j,frac);
<a name="l00437"></a>00437          <span class="keywordflow">if</span> (prod-&gt;<a class="code" href="classorganic_product.html#acf7568317f8ce00b6073eda432ba7483">GetAmount</a>().<a class="code" href="classcn_matter.html#ad1d68c3a937d7111070aa0821c6c10f9">c</a>&gt;0)
<a name="l00438"></a>00438                  <a class="code" href="classsoil.html#afdc5aef4b05a7077fc613127df6341e7" title="adds an organic product to the soil surface or to the soil profile">AddOrganicProduct</a>(prod,&amp;LengthList[0]);
<a name="l00439"></a>00439          <span class="keyword">delete</span> prod;
<a name="l00440"></a>00440       }
<a name="l00441"></a>00441    }
<a name="l00442"></a>00442    
<a name="l00443"></a>00443 }
<a name="l00444"></a>00444 
<a name="l00445"></a>00445 
<a name="l00446"></a>00446 
<a name="l00447"></a>00447 
<a name="l00448"></a>00448 <span class="comment">/****************************************************************************\</span>
<a name="l00449"></a>00449 <span class="comment">Fraction (0-1) : fraction of SMB killed</span>
<a name="l00450"></a>00450 <span class="comment">Depth: mm</span>
<a name="l00451"></a>00451 <span class="comment">\****************************************************************************/</span>
<a name="l00452"></a><a class="code" href="classsoil.html#a35efd012c78310446c1691c74d1a11d9">00452</a> <span class="keywordtype">void</span> <a class="code" href="classsoil.html#a35efd012c78310446c1691c74d1a11d9">soil::KillSMB</a>(<span class="keywordtype">double</span> Fraction,<span class="keywordtype">double</span> Depth)
<a name="l00453"></a>00453 {
<a name="l00454"></a>00454   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="classsoil.html#ab36e32808c2cadf3b50cd18fdc06ca01" title="object describing the soil profile">Profile</a>-&gt;<a class="code" href="classsoil_profile.html#a71a258ab02b886dcfe4e495c16490f80">GetNumberOfLayers</a>(); i++)
<a name="l00455"></a>00455                 <span class="keywordflow">if</span> (<a class="code" href="classsoil.html#ab36e32808c2cadf3b50cd18fdc06ca01" title="object describing the soil profile">Profile</a>-&gt;<a class="code" href="classsoil_profile.html#aa91d669a4d9cc0755e7a277ae09dd7cd">GetLayer</a>(i)-&gt;<a class="code" href="classsoil_layer.html#a067dc1539ac09a475b678ef6d67b2812">GetStartDepth</a>()&lt;Depth) <span class="comment">// Actually a simplification !!!</span>
<a name="l00456"></a>00456         <a class="code" href="classsoil.html#ab36e32808c2cadf3b50cd18fdc06ca01" title="object describing the soil profile">Profile</a>-&gt;<a class="code" href="classsoil_profile.html#aa91d669a4d9cc0755e7a277ae09dd7cd">GetLayer</a>(i)-&gt;<a class="code" href="classsoil_layer.html#ae48e99b10956f43841d25f5402be1c30">KillSMB</a>(Fraction);
<a name="l00457"></a>00457 }
<a name="l00458"></a>00458 
<a name="l00459"></a>00459 <span class="comment">/****************************************************************************\</span>
<a name="l00460"></a>00460 <span class="comment">Fraction (0-1) : fraction of AOM transferred to pools with a modified</span>
<a name="l00461"></a>00461 <span class="comment">                 turnover rate</span>
<a name="l00462"></a>00462 <span class="comment">TurnoverFactor : Factor for modification of turnover rate</span>
<a name="l00463"></a>00463 <span class="comment">Depth: mm</span>
<a name="l00464"></a>00464 <span class="comment">\****************************************************************************/</span>
<a name="l00465"></a><a class="code" href="classsoil.html#a5c180783f496514ec193625e0cd6d501">00465</a> <span class="keywordtype">void</span> <a class="code" href="classsoil.html#a5c180783f496514ec193625e0cd6d501">soil::ModifyAOM</a>(<span class="keywordtype">double</span> Fraction,<span class="keywordtype">double</span> TurnoverFactor, <span class="keywordtype">double</span> Depth)
<a name="l00466"></a>00466 {
<a name="l00467"></a>00467   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="classsoil.html#ab36e32808c2cadf3b50cd18fdc06ca01" title="object describing the soil profile">Profile</a>-&gt;<a class="code" href="classsoil_profile.html#a71a258ab02b886dcfe4e495c16490f80">GetNumberOfLayers</a>(); i++)
<a name="l00468"></a>00468                 <span class="keywordflow">if</span> (<a class="code" href="classsoil.html#ab36e32808c2cadf3b50cd18fdc06ca01" title="object describing the soil profile">Profile</a>-&gt;<a class="code" href="classsoil_profile.html#aa91d669a4d9cc0755e7a277ae09dd7cd">GetLayer</a>(i)-&gt;<a class="code" href="classsoil_layer.html#a067dc1539ac09a475b678ef6d67b2812">GetStartDepth</a>()&lt;Depth) <span class="comment">// Actually a simplification !!!</span>
<a name="l00469"></a>00469       {
<a name="l00470"></a>00470          <span class="comment">//cout &lt;&lt; &quot;soil::ModifyAOM - layer no &quot; &lt;&lt; i &lt;&lt; endl;</span>
<a name="l00471"></a>00471         <a class="code" href="classsoil.html#ab36e32808c2cadf3b50cd18fdc06ca01" title="object describing the soil profile">Profile</a>-&gt;<a class="code" href="classsoil_profile.html#aa91d669a4d9cc0755e7a277ae09dd7cd">GetLayer</a>(i)-&gt;<a class="code" href="classsoil_layer.html#a7d58b327ed2900ba76920934d1802da2">ModifyAOM</a>(Fraction,TurnoverFactor);
<a name="l00472"></a>00472       }
<a name="l00473"></a>00473 }
<a name="l00474"></a>00474 
<a name="l00475"></a>00475 <span class="comment">/****************************************************************************\</span>
<a name="l00476"></a>00476 <span class="comment">\****************************************************************************/</span>
<a name="l00477"></a><a class="code" href="classsoil.html#afdc5aef4b05a7077fc613127df6341e7">00477</a> <span class="keywordtype">void</span> <a class="code" href="classsoil.html#afdc5aef4b05a7077fc613127df6341e7" title="adds an organic product to the soil surface or to the soil profile">soil::AddOrganicProduct</a>(<span class="keyword">const</span> <a class="code" href="classorganic_product.html">organicProduct</a>* <a class="code" href="classproduct.html">product</a>,
<a name="l00478"></a>00478                                                                           <span class="keywordtype">double</span> * rootLengthList)
<a name="l00479"></a>00479 {
<a name="l00480"></a>00480  <a class="code" href="classorganic_product.html">organicProduct</a> * p = <span class="keyword">new</span> <a class="code" href="classorganic_product.html">organicProduct</a>(*product);
<a name="l00481"></a>00481 
<a name="l00482"></a>00482  <span class="keywordflow">if</span> (rootLengthList==NULL)
<a name="l00483"></a>00483     <a class="code" href="classsoil.html#ab5516aa25f35082aba80ca2795c68e4e" title="object describing compounds on the soil surface (e.g. undissolved fertiliser)">Surface</a>-&gt;<a class="code" href="classsoil_surface.html#af3935f9b1363a0eee0f46a5c26b7f115">AddProduct</a>(p);
<a name="l00484"></a>00484  <span class="keywordflow">else</span>
<a name="l00485"></a>00485     <a class="code" href="classsoil.html#ab36e32808c2cadf3b50cd18fdc06ca01" title="object describing the soil profile">Profile</a>-&gt;<a class="code" href="classsoil_profile.html#a626f77b25f2ebf34e48b46fbc4c27088">AddProduct</a>(*p, rootLengthList);
<a name="l00486"></a>00486  <span class="keyword">delete</span> p;
<a name="l00487"></a>00487 }
<a name="l00488"></a>00488 
<a name="l00489"></a>00489 
<a name="l00490"></a>00490 
<a name="l00491"></a>00491 <span class="comment">/****************************************************************************\</span>
<a name="l00492"></a>00492 <span class="comment">\****************************************************************************/</span>
<a name="l00493"></a><a class="code" href="classsoil.html#a12a12882c22a4462895f9df500a9e77d">00493</a> <span class="keywordtype">void</span> <a class="code" href="classsoil.html#a12a12882c22a4462895f9df500a9e77d">soil::StartBudget</a>()
<a name="l00494"></a>00494 {
<a name="l00495"></a>00495    <a class="code" href="classnitrogen.html">nitrogen</a> N = <a class="code" href="classsoil.html#a9bea1a88a9531db940078010517f596a">GetTotalNitrogen</a>();
<a name="l00496"></a>00496    <a class="code" href="classsoil.html#addf9abd98e1b4678c37c714b49045f79" title="soil nitrogen budget">Nbudget</a>.<a class="code" href="classbudget.html#a885260b83f245dee43a1e6ee70a4c68d">SetInput</a>(N.<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a>);
<a name="l00497"></a>00497    <a class="code" href="classsoil.html#a5fc83b89b81299ab7cde864a78092279" title="soil water budget">WaterBudget</a>.<a class="code" href="classbudget.html#a885260b83f245dee43a1e6ee70a4c68d">SetInput</a>(<a class="code" href="classsoil.html#ae41f4677e15e604b208276eceb2e2369">GetWater</a>(0,<a class="code" href="classsoil.html#a36b98f1dc475f9116205d93b64c84b67">GetMaximumDepth</a>())+<a class="code" href="classsoil.html#a5b84e06a756061c8bb3c71ddb800929a">GetSurfaceWater</a>());
<a name="l00498"></a>00498    <a class="code" href="classsoil.html#ab36e32808c2cadf3b50cd18fdc06ca01" title="object describing the soil profile">Profile</a>-&gt;<a class="code" href="classsoil_profile.html#ac0825115659eefb3cdf0d25bc385b594">StartBudget</a>();
<a name="l00499"></a>00499 }
<a name="l00500"></a>00500 
<a name="l00501"></a>00501 <span class="comment">/****************************************************************************\</span>
<a name="l00502"></a>00502 <span class="comment">\****************************************************************************/</span>
<a name="l00503"></a><a class="code" href="classsoil.html#a8689520502e8522ac581ed1f4ed2a8a5">00503</a> <span class="keywordtype">bool</span> <a class="code" href="classsoil.html#a8689520502e8522ac581ed1f4ed2a8a5">soil::EndBudget</a>(<span class="keywordtype">double</span> * NRemain, <span class="keywordtype">double</span> *WaterRemain)
<a name="l00504"></a>00504 {
<a name="l00505"></a>00505    <span class="keywordtype">bool</span> retVal=<span class="keyword">true</span>;
<a name="l00506"></a>00506    *NRemain = <a class="code" href="classsoil.html#a9bea1a88a9531db940078010517f596a">GetTotalNitrogen</a>().<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a>;
<a name="l00507"></a>00507    <span class="keywordflow">if</span> (!<a class="code" href="classsoil.html#addf9abd98e1b4678c37c714b49045f79" title="soil nitrogen budget">Nbudget</a>.<a class="code" href="classbudget.html#a2814c71d2d504462defc2c85f2cd86b2">Balance</a>(*NRemain))
<a name="l00508"></a>00508            retVal=<span class="keyword">false</span>;
<a name="l00509"></a>00509    *WaterRemain = <a class="code" href="classsoil.html#ae41f4677e15e604b208276eceb2e2369">GetWater</a>(0,<a class="code" href="classsoil.html#a36b98f1dc475f9116205d93b64c84b67">GetMaximumDepth</a>())+<a class="code" href="classsoil.html#a5b84e06a756061c8bb3c71ddb800929a">GetSurfaceWater</a>();
<a name="l00510"></a>00510    <span class="keywordflow">if</span> (!<a class="code" href="classsoil.html#a5fc83b89b81299ab7cde864a78092279" title="soil water budget">WaterBudget</a>.<a class="code" href="classbudget.html#a2814c71d2d504462defc2c85f2cd86b2">Balance</a>(*WaterRemain))
<a name="l00511"></a>00511       retVal=<span class="keyword">false</span>;
<a name="l00512"></a>00512    <a class="code" href="classsoil.html#ab36e32808c2cadf3b50cd18fdc06ca01" title="object describing the soil profile">Profile</a>-&gt;<a class="code" href="classsoil_profile.html#af7441e5aa2d37028f2d8539bffba3580">EndBudget</a>();
<a name="l00513"></a>00513    <span class="keywordflow">return</span> retVal;
<a name="l00514"></a>00514 }
<a name="l00515"></a>00515 <span class="comment">/****************************************************************************\</span>
<a name="l00516"></a>00516 <span class="comment">\****************************************************************************/</span>
<a name="l00517"></a><a class="code" href="classsoil.html#a2dfefa36aa46caa719e36780e87bee59">00517</a> <span class="keywordtype">void</span> <a class="code" href="classsoil.html#a2dfefa36aa46caa719e36780e87bee59">soil::WriteOutput</a>()
<a name="l00518"></a>00518 {
<a name="l00519"></a>00519 
<a name="l00520"></a>00520         <span class="keywordflow">if</span>(<a class="code" href="output_data_8h.html#aadc9d3b76fa69bf28c5ab340dd810e20">theOutputData</a>-&gt;<a class="code" href="classoutput_data.html#ae50b979972f6c57c3881edd6a7dd96b4">DetailsData</a>.<a class="code" href="classoutput_details.html#a084ee6303ae763562e96ac5e063e862c">getSoilDetails</a>()==<span class="keyword">true</span>)
<a name="l00521"></a>00521         {
<a name="l00522"></a>00522                 <a class="code" href="classsoil.html#a37ce966bebdb8775a666a3c0a6cd8bf3" title="file streams for details of soil variables.">f</a> &lt;&lt; <a class="code" href="bstime_8h.html#ac0dc3834220ee5ae84c115e146194d75">theTime</a>.<a class="code" href="classbs_time.html#afcb5953580c085bce20eb33a4b21e155">GetYear</a>() &lt;&lt; <span class="stringliteral">&quot;-&quot;</span> &lt;&lt; <a class="code" href="bstime_8h.html#ac0dc3834220ee5ae84c115e146194d75">theTime</a>.<a class="code" href="classbs_time.html#a777a59c97951688c4b2a67c4b0bca16e">GetMonth</a>() &lt;&lt; <span class="stringliteral">&quot;-&quot;</span> &lt;&lt; <a class="code" href="bstime_8h.html#ac0dc3834220ee5ae84c115e146194d75">theTime</a>.<a class="code" href="classbs_time.html#a3b4126cf9db93be0c2f69549699730d3">GetDay</a>();
<a name="l00523"></a>00523                 <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0;i&lt;<a class="code" href="output_data_8h.html#aadc9d3b76fa69bf28c5ab340dd810e20">theOutputData</a>-&gt;<a class="code" href="classoutput_data.html#a354085135b0a0a2b6bb245dff6779073">WaterData</a>.size();i++)
<a name="l00524"></a>00524                 {
<a name="l00525"></a>00525                         <a class="code" href="classsoil.html#a37ce966bebdb8775a666a3c0a6cd8bf3" title="file streams for details of soil variables.">f</a> &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <a class="code" href="classsoil.html#ae41f4677e15e604b208276eceb2e2369">GetWater</a>(<a class="code" href="output_data_8h.html#aadc9d3b76fa69bf28c5ab340dd810e20">theOutputData</a>-&gt;<a class="code" href="classoutput_data.html#a354085135b0a0a2b6bb245dff6779073">WaterData</a>[i].getStartDepth(), <a class="code" href="output_data_8h.html#aadc9d3b76fa69bf28c5ab340dd810e20">theOutputData</a>-&gt;<a class="code" href="classoutput_data.html#a354085135b0a0a2b6bb245dff6779073">WaterData</a>[i].getEndDepth()-<a class="code" href="output_data_8h.html#aadc9d3b76fa69bf28c5ab340dd810e20">theOutputData</a>-&gt;<a class="code" href="classoutput_data.html#a354085135b0a0a2b6bb245dff6779073">WaterData</a>[i].getStartDepth());
<a name="l00526"></a>00526                 }
<a name="l00527"></a>00527                 <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0;i&lt;<a class="code" href="output_data_8h.html#aadc9d3b76fa69bf28c5ab340dd810e20">theOutputData</a>-&gt;<a class="code" href="classoutput_data.html#a213ddbf3e83fe1f17f12994794ae649d">NminData</a>.size();i++)
<a name="l00528"></a>00528                 {
<a name="l00529"></a>00529                         <span class="keywordtype">double</span> StartDepth =<a class="code" href="output_data_8h.html#aadc9d3b76fa69bf28c5ab340dd810e20">theOutputData</a>-&gt;<a class="code" href="classoutput_data.html#a213ddbf3e83fe1f17f12994794ae649d">NminData</a>[i].getStartDepth();
<a name="l00530"></a>00530                         <span class="keywordtype">double</span> Thickness = <a class="code" href="output_data_8h.html#aadc9d3b76fa69bf28c5ab340dd810e20">theOutputData</a>-&gt;<a class="code" href="classoutput_data.html#a213ddbf3e83fe1f17f12994794ae649d">NminData</a>[i].getEndDepth()-StartDepth;
<a name="l00531"></a>00531                         <a class="code" href="classsoil.html#a37ce966bebdb8775a666a3c0a6cd8bf3" title="file streams for details of soil variables.">f</a> &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <a class="code" href="classsoil.html#a200ce7594b17ce2c3561789aeb3cf81c">GetMinNitrogen</a>(StartDepth, Thickness).<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a>;
<a name="l00532"></a>00532                         <a class="code" href="classsoil.html#a37ce966bebdb8775a666a3c0a6cd8bf3" title="file streams for details of soil variables.">f</a> &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <a class="code" href="classsoil.html#a111760bc77c25164c82b3dbccf5e443a">GetNitrate</a>(StartDepth, Thickness).<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a>;
<a name="l00533"></a>00533                         <a class="code" href="classsoil.html#a37ce966bebdb8775a666a3c0a6cd8bf3" title="file streams for details of soil variables.">f</a> &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <a class="code" href="classsoil.html#a103bd1bc57f62e9294194274c46ff7ef">GetAmmonium</a>(StartDepth, Thickness).<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a>;
<a name="l00534"></a>00534                         <a class="code" href="classsoil.html#a37ce966bebdb8775a666a3c0a6cd8bf3" title="file streams for details of soil variables.">f</a> &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <a class="code" href="classsoil.html#a9bea1a88a9531db940078010517f596a">GetTotalNitrogen</a>(StartDepth, Thickness).<a class="code" href="classnitrogen.html#a2d537cc848da50f09b7580539f261dfc">n15</a>;
<a name="l00535"></a>00535                 }
<a name="l00536"></a>00536 
<a name="l00537"></a>00537                 <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0;i&lt;<a class="code" href="output_data_8h.html#aadc9d3b76fa69bf28c5ab340dd810e20">theOutputData</a>-&gt;<a class="code" href="classoutput_data.html#a18c6fe52f21a94dcb854e8b5d70c79f0">SoilOrgCData</a>.size();i++)
<a name="l00538"></a>00538                 {
<a name="l00539"></a>00539                         <span class="keywordtype">double</span> StartDepth =<a class="code" href="output_data_8h.html#aadc9d3b76fa69bf28c5ab340dd810e20">theOutputData</a>-&gt;<a class="code" href="classoutput_data.html#a18c6fe52f21a94dcb854e8b5d70c79f0">SoilOrgCData</a>[i].getStartDepth();
<a name="l00540"></a>00540                         <span class="keywordtype">double</span> Thickness = <a class="code" href="output_data_8h.html#aadc9d3b76fa69bf28c5ab340dd810e20">theOutputData</a>-&gt;<a class="code" href="classoutput_data.html#a18c6fe52f21a94dcb854e8b5d70c79f0">SoilOrgCData</a>[i].getEndDepth()-StartDepth;
<a name="l00541"></a>00541                         <span class="keywordtype">double</span> SoilMass = <a class="code" href="classsoil.html#ae21ef6025f587046d6de1304cb9d1dad">GetSoilMass</a>(StartDepth,Thickness)/10000000.0; <span class="comment">// BMP 29.10.2008 !!!!!!</span>
<a name="l00542"></a>00542                         <a class="code" href="classsoil.html#a37ce966bebdb8775a666a3c0a6cd8bf3" title="file streams for details of soil variables.">f</a> &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; (<a class="code" href="classsoil.html#a9e5128bdf857aedf7ab6dd2e12783873">GetPoolCarbon</a>(<span class="stringliteral">&quot;SMB1&quot;</span>,StartDepth,Thickness) + <a class="code" href="classsoil.html#a9e5128bdf857aedf7ab6dd2e12783873">GetPoolCarbon</a>(<span class="stringliteral">&quot;SMB2&quot;</span>,StartDepth,Thickness))/SoilMass;
<a name="l00543"></a>00543                         <a class="code" href="classsoil.html#a37ce966bebdb8775a666a3c0a6cd8bf3" title="file streams for details of soil variables.">f</a>.precision(5);
<a name="l00544"></a>00544                         <a class="code" href="classsoil.html#a37ce966bebdb8775a666a3c0a6cd8bf3" title="file streams for details of soil variables.">f</a>  &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <a class="code" href="classsoil.html#a9e5128bdf857aedf7ab6dd2e12783873">GetPoolCarbon</a>(<span class="stringliteral">&quot;NOM&quot;</span>,StartDepth,Thickness);
<a name="l00545"></a>00545                         <a class="code" href="classsoil.html#a37ce966bebdb8775a666a3c0a6cd8bf3" title="file streams for details of soil variables.">f</a>.precision(4);
<a name="l00546"></a>00546                         <a class="code" href="classsoil.html#a37ce966bebdb8775a666a3c0a6cd8bf3" title="file streams for details of soil variables.">f</a>  &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <a class="code" href="classsoil.html#a9e5128bdf857aedf7ab6dd2e12783873">GetPoolCarbon</a>(<span class="stringliteral">&quot;IOM&quot;</span>,StartDepth,Thickness)
<a name="l00547"></a>00547                            &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <a class="code" href="classsoil.html#a9e5128bdf857aedf7ab6dd2e12783873">GetPoolCarbon</a>(<span class="stringliteral">&quot;AOM1&quot;</span>,StartDepth,Thickness)
<a name="l00548"></a>00548                            &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <a class="code" href="classsoil.html#a9e5128bdf857aedf7ab6dd2e12783873">GetPoolCarbon</a>(<span class="stringliteral">&quot;AOM2&quot;</span>,StartDepth,Thickness)
<a name="l00549"></a>00549                            &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <a class="code" href="classsoil.html#a9e5128bdf857aedf7ab6dd2e12783873">GetPoolCarbon</a>(<span class="stringliteral">&quot;SMB1&quot;</span>,StartDepth,Thickness)
<a name="l00550"></a>00550                            &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <a class="code" href="classsoil.html#a9e5128bdf857aedf7ab6dd2e12783873">GetPoolCarbon</a>(<span class="stringliteral">&quot;SMB2&quot;</span>,StartDepth,Thickness)
<a name="l00551"></a>00551                            &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <a class="code" href="classsoil.html#a9e5128bdf857aedf7ab6dd2e12783873">GetPoolCarbon</a>(<span class="stringliteral">&quot;SMR&quot;</span>,StartDepth,Thickness);
<a name="l00552"></a>00552                 }
<a name="l00553"></a>00553                 <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0;i&lt;<a class="code" href="output_data_8h.html#aadc9d3b76fa69bf28c5ab340dd810e20">theOutputData</a>-&gt;<a class="code" href="classoutput_data.html#aedb40aad179f87df3aa953a885cfa16c">SoilOrgNData</a>.size();i++)
<a name="l00554"></a>00554                 {
<a name="l00555"></a>00555                         <span class="keywordtype">double</span> StartDepth =<a class="code" href="output_data_8h.html#aadc9d3b76fa69bf28c5ab340dd810e20">theOutputData</a>-&gt;<a class="code" href="classoutput_data.html#aedb40aad179f87df3aa953a885cfa16c">SoilOrgNData</a>[i].getStartDepth();
<a name="l00556"></a>00556                         <span class="keywordtype">double</span> Thickness = <a class="code" href="output_data_8h.html#aadc9d3b76fa69bf28c5ab340dd810e20">theOutputData</a>-&gt;<a class="code" href="classoutput_data.html#aedb40aad179f87df3aa953a885cfa16c">SoilOrgNData</a>[i].getEndDepth()-StartDepth;
<a name="l00557"></a>00557                         <span class="keywordtype">double</span> SoilMass = <a class="code" href="classsoil.html#ae21ef6025f587046d6de1304cb9d1dad">GetSoilMass</a>(StartDepth,Thickness)/10000000.0; <span class="comment">// BMP 29.10.2008 !!!!!!</span>
<a name="l00558"></a>00558                         <a class="code" href="classsoil.html#a37ce966bebdb8775a666a3c0a6cd8bf3" title="file streams for details of soil variables.">f</a> &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; (<a class="code" href="classsoil.html#a3fecfad808499426b79dc29f2bfad3cb">GetPoolNitrogen</a>(<span class="stringliteral">&quot;SMB1&quot;</span>,StartDepth,Thickness).<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a> + <a class="code" href="classsoil.html#a3fecfad808499426b79dc29f2bfad3cb">GetPoolNitrogen</a>(<span class="stringliteral">&quot;SMB2&quot;</span>,StartDepth,Thickness).<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a>)/SoilMass;
<a name="l00559"></a>00559                         <a class="code" href="classsoil.html#a37ce966bebdb8775a666a3c0a6cd8bf3" title="file streams for details of soil variables.">f</a> &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; (<a class="code" href="classsoil.html#a3fecfad808499426b79dc29f2bfad3cb">GetPoolNitrogen</a>(<span class="stringliteral">&quot;SMB1&quot;</span>,StartDepth,Thickness).<a class="code" href="classnitrogen.html#a2d537cc848da50f09b7580539f261dfc">n15</a> + <a class="code" href="classsoil.html#a3fecfad808499426b79dc29f2bfad3cb">GetPoolNitrogen</a>(<span class="stringliteral">&quot;SMB2&quot;</span>,StartDepth,Thickness).<a class="code" href="classnitrogen.html#a2d537cc848da50f09b7580539f261dfc">n15</a>)/SoilMass;
<a name="l00560"></a>00560                    <a class="code" href="classsoil.html#a37ce966bebdb8775a666a3c0a6cd8bf3" title="file streams for details of soil variables.">f</a>  &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <a class="code" href="classsoil.html#a3fecfad808499426b79dc29f2bfad3cb">GetPoolNitrogen</a>(<span class="stringliteral">&quot;AOM1&quot;</span>,StartDepth,Thickness).<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a>
<a name="l00561"></a>00561                       &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <a class="code" href="classsoil.html#a3fecfad808499426b79dc29f2bfad3cb">GetPoolNitrogen</a>(<span class="stringliteral">&quot;AOM2&quot;</span>,StartDepth,Thickness).<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a>
<a name="l00562"></a>00562                       &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <a class="code" href="classsoil.html#a3fecfad808499426b79dc29f2bfad3cb">GetPoolNitrogen</a>(<span class="stringliteral">&quot;SMB1&quot;</span>,StartDepth,Thickness).<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a>
<a name="l00563"></a>00563                       &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <a class="code" href="classsoil.html#a3fecfad808499426b79dc29f2bfad3cb">GetPoolNitrogen</a>(<span class="stringliteral">&quot;SMB2&quot;</span>,StartDepth,Thickness).<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a>
<a name="l00564"></a>00564                       &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <a class="code" href="classsoil.html#a3fecfad808499426b79dc29f2bfad3cb">GetPoolNitrogen</a>(<span class="stringliteral">&quot;SMR&quot;</span>,StartDepth,Thickness).<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a>;
<a name="l00565"></a>00565               <a class="code" href="classsoil.html#a37ce966bebdb8775a666a3c0a6cd8bf3" title="file streams for details of soil variables.">f</a>.precision(5);
<a name="l00566"></a>00566                    <a class="code" href="classsoil.html#a37ce966bebdb8775a666a3c0a6cd8bf3" title="file streams for details of soil variables.">f</a>  &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <a class="code" href="classsoil.html#a3fecfad808499426b79dc29f2bfad3cb">GetPoolNitrogen</a>(<span class="stringliteral">&quot;NOM&quot;</span>,StartDepth,Thickness).<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a>;
<a name="l00567"></a>00567                    <a class="code" href="classsoil.html#a37ce966bebdb8775a666a3c0a6cd8bf3" title="file streams for details of soil variables.">f</a>.precision(4);
<a name="l00568"></a>00568                    <a class="code" href="classsoil.html#a37ce966bebdb8775a666a3c0a6cd8bf3" title="file streams for details of soil variables.">f</a>  &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <a class="code" href="classsoil.html#a3fecfad808499426b79dc29f2bfad3cb">GetPoolNitrogen</a>(<span class="stringliteral">&quot;IOM&quot;</span>,StartDepth,Thickness).<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a>
<a name="l00569"></a>00569                       &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <a class="code" href="classsoil.html#a3fecfad808499426b79dc29f2bfad3cb">GetPoolNitrogen</a>(<span class="stringliteral">&quot;AOM1&quot;</span>,StartDepth,Thickness).<a class="code" href="classnitrogen.html#a2d537cc848da50f09b7580539f261dfc">n15</a>
<a name="l00570"></a>00570                       &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <a class="code" href="classsoil.html#a3fecfad808499426b79dc29f2bfad3cb">GetPoolNitrogen</a>(<span class="stringliteral">&quot;AOM2&quot;</span>,StartDepth,Thickness).<a class="code" href="classnitrogen.html#a2d537cc848da50f09b7580539f261dfc">n15</a>
<a name="l00571"></a>00571                       &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <a class="code" href="classsoil.html#a3fecfad808499426b79dc29f2bfad3cb">GetPoolNitrogen</a>(<span class="stringliteral">&quot;SMB1&quot;</span>,StartDepth,Thickness).<a class="code" href="classnitrogen.html#a2d537cc848da50f09b7580539f261dfc">n15</a>
<a name="l00572"></a>00572                       &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <a class="code" href="classsoil.html#a3fecfad808499426b79dc29f2bfad3cb">GetPoolNitrogen</a>(<span class="stringliteral">&quot;SMB2&quot;</span>,StartDepth,Thickness).<a class="code" href="classnitrogen.html#a2d537cc848da50f09b7580539f261dfc">n15</a>
<a name="l00573"></a>00573                       &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <a class="code" href="classsoil.html#a3fecfad808499426b79dc29f2bfad3cb">GetPoolNitrogen</a>(<span class="stringliteral">&quot;SMR&quot;</span>,StartDepth,Thickness).<a class="code" href="classnitrogen.html#a2d537cc848da50f09b7580539f261dfc">n15</a>
<a name="l00574"></a>00574                       &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <a class="code" href="classsoil.html#a3fecfad808499426b79dc29f2bfad3cb">GetPoolNitrogen</a>(<span class="stringliteral">&quot;NOM&quot;</span>,StartDepth,Thickness).<a class="code" href="classnitrogen.html#a2d537cc848da50f09b7580539f261dfc">n15</a>;
<a name="l00575"></a>00575                 }
<a name="l00576"></a>00576 
<a name="l00577"></a>00577                 <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0;i&lt;<a class="code" href="output_data_8h.html#aadc9d3b76fa69bf28c5ab340dd810e20">theOutputData</a>-&gt;<a class="code" href="classoutput_data.html#a9049c356d01885832d2118f58ed94bba">PoreWaterData</a>.size();i++)
<a name="l00578"></a>00578                 {
<a name="l00579"></a>00579                         <span class="keywordtype">double</span> depth = <a class="code" href="output_data_8h.html#aadc9d3b76fa69bf28c5ab340dd810e20">theOutputData</a>-&gt;<a class="code" href="classoutput_data.html#a9049c356d01885832d2118f58ed94bba">PoreWaterData</a>[i].getDepth();
<a name="l00580"></a>00580                         <a class="code" href="classsoil.html#a37ce966bebdb8775a666a3c0a6cd8bf3" title="file streams for details of soil variables.">f</a> &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; 1000.0*<a class="code" href="classsoil.html#a111760bc77c25164c82b3dbccf5e443a">GetNitrate</a>(depth-5,10).<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a>/<a class="code" href="classsoil.html#ae41f4677e15e604b208276eceb2e2369">GetWater</a>(depth-5,10)
<a name="l00581"></a>00581                 &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; 1000.0*<a class="code" href="classsoil.html#a103bd1bc57f62e9294194274c46ff7ef">GetAmmonium</a>(depth-5,10).<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a>/<a class="code" href="classsoil.html#ae41f4677e15e604b208276eceb2e2369">GetWater</a>(depth-5,10)
<a name="l00582"></a>00582             &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; 1000.0*(<a class="code" href="classsoil.html#a111760bc77c25164c82b3dbccf5e443a">GetNitrate</a>(depth-5,10).<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a>+<a class="code" href="classsoil.html#a103bd1bc57f62e9294194274c46ff7ef">GetAmmonium</a>(depth-5,10).<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a>)/<a class="code" href="classsoil.html#ae41f4677e15e604b208276eceb2e2369">GetWater</a>(depth-5,10)         <span class="comment">// Convert to mg/l</span>
<a name="l00583"></a>00583                 &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; 1000.0*<a class="code" href="classsoil.html#ab36e32808c2cadf3b50cd18fdc06ca01" title="object describing the soil profile">Profile</a>-&gt;<a class="code" href="classsoil_profile.html#a51f252742a43f831953d0ea34e273530">GetChloride</a>(depth-5,10)/<a class="code" href="classsoil.html#ae41f4677e15e604b208276eceb2e2369">GetWater</a>(depth-5,10)    <span class="comment">// Convert to mg/l</span>
<a name="l00584"></a>00584             &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; 1e5*<a class="code" href="classsoil.html#a111760bc77c25164c82b3dbccf5e443a">GetNitrate</a>(depth-5,10).<a class="code" href="classnitrogen.html#a2d537cc848da50f09b7580539f261dfc">n15</a>/<a class="code" href="classsoil.html#ae41f4677e15e604b208276eceb2e2369">GetWater</a>(depth-5,10);
<a name="l00585"></a>00585 
<a name="l00586"></a>00586                 }
<a name="l00587"></a>00587 
<a name="l00588"></a>00588       <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0;i&lt;<a class="code" href="output_data_8h.html#aadc9d3b76fa69bf28c5ab340dd810e20">theOutputData</a>-&gt;<a class="code" href="classoutput_data.html#a3e8cb56e571046aa8b37a4260a062594">TemperatureData</a>.size();i++)
<a name="l00589"></a>00589                 {
<a name="l00590"></a>00590 
<a name="l00591"></a>00591                         <span class="keywordtype">double</span> depth = <a class="code" href="output_data_8h.html#aadc9d3b76fa69bf28c5ab340dd810e20">theOutputData</a>-&gt;<a class="code" href="classoutput_data.html#a3e8cb56e571046aa8b37a4260a062594">TemperatureData</a>[i].getDepth();
<a name="l00592"></a>00592                         <a class="code" href="classsoil.html#a37ce966bebdb8775a666a3c0a6cd8bf3" title="file streams for details of soil variables.">f</a> &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <a class="code" href="classsoil.html#ab36e32808c2cadf3b50cd18fdc06ca01" title="object describing the soil profile">Profile</a>-&gt;<a class="code" href="classsoil_profile.html#a0ce7a0cacb136fae92fac737f23fe46f">GetTemperature</a>(depth);
<a name="l00593"></a>00593 
<a name="l00594"></a>00594                 }
<a name="l00595"></a>00595 
<a name="l00596"></a>00596       <a class="code" href="classsoil.html#a37ce966bebdb8775a666a3c0a6cd8bf3" title="file streams for details of soil variables.">f</a>  &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <a class="code" href="classsoil.html#a103bd1bc57f62e9294194274c46ff7ef">GetAmmonium</a>(0,250).<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a>
<a name="l00597"></a>00597          &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <a class="code" href="classsoil.html#a111760bc77c25164c82b3dbccf5e443a">GetNitrate</a>(0,250).<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a>
<a name="l00598"></a>00598               &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <a class="code" href="classsoil.html#a103bd1bc57f62e9294194274c46ff7ef">GetAmmonium</a>(0,250).<a class="code" href="classnitrogen.html#a2d537cc848da50f09b7580539f261dfc">n15</a>
<a name="l00599"></a>00599          &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <a class="code" href="classsoil.html#a111760bc77c25164c82b3dbccf5e443a">GetNitrate</a>(0,250).<a class="code" href="classnitrogen.html#a2d537cc848da50f09b7580539f261dfc">n15</a>;
<a name="l00600"></a>00600 
<a name="l00601"></a>00601 
<a name="l00602"></a>00602       <span class="keywordtype">double</span> N2ORatio = 1;
<a name="l00603"></a>00603       <span class="keywordflow">if</span> (<a class="code" href="classsoil.html#ab36e32808c2cadf3b50cd18fdc06ca01" title="object describing the soil profile">Profile</a>-&gt;<a class="code" href="classsoil_profile.html#a1a70449a5466f3a625a9b393ee18112f">GetN2OFromNitrification</a>().<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a>+<a class="code" href="classsoil.html#ab36e32808c2cadf3b50cd18fdc06ca01" title="object describing the soil profile">Profile</a>-&gt;<a class="code" href="classsoil_profile.html#a9be3f4ec8fe381095d2f9a15f1b7d77d">GetN2OFromDenitrification</a>().<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a>&gt;1e-10)
<a name="l00604"></a>00604         N2ORatio = <a class="code" href="classsoil.html#ab94851a74389f879a38bdcaad1826ef2">denitrification</a>.<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a>/(<a class="code" href="classsoil.html#ab36e32808c2cadf3b50cd18fdc06ca01" title="object describing the soil profile">Profile</a>-&gt;<a class="code" href="classsoil_profile.html#a1a70449a5466f3a625a9b393ee18112f">GetN2OFromNitrification</a>().<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a>+<a class="code" href="classsoil.html#ab36e32808c2cadf3b50cd18fdc06ca01" title="object describing the soil profile">Profile</a>-&gt;<a class="code" href="classsoil_profile.html#a9be3f4ec8fe381095d2f9a15f1b7d77d">GetN2OFromDenitrification</a>().<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a>);
<a name="l00605"></a>00605 
<a name="l00606"></a>00606 
<a name="l00607"></a>00607              <a class="code" href="classsoil.html#a37ce966bebdb8775a666a3c0a6cd8bf3" title="file streams for details of soil variables.">f</a> &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <a class="code" href="classsoil.html#a7bd29a49ff933e84c22b9fe2753cc2fe">NitrogenNetMineralisation</a>.<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a>
<a name="l00608"></a>00608          &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <a class="code" href="classsoil.html#ab36e32808c2cadf3b50cd18fdc06ca01" title="object describing the soil profile">Profile</a>-&gt;<a class="code" href="classsoil_profile.html#a1a70449a5466f3a625a9b393ee18112f">GetN2OFromNitrification</a>().<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a>
<a name="l00609"></a>00609               &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <a class="code" href="classsoil.html#ab36e32808c2cadf3b50cd18fdc06ca01" title="object describing the soil profile">Profile</a>-&gt;<a class="code" href="classsoil_profile.html#a9be3f4ec8fe381095d2f9a15f1b7d77d">GetN2OFromDenitrification</a>().<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a>
<a name="l00610"></a>00610                 &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <a class="code" href="classsoil.html#ab36e32808c2cadf3b50cd18fdc06ca01" title="object describing the soil profile">Profile</a>-&gt;<a class="code" href="classsoil_profile.html#a1a70449a5466f3a625a9b393ee18112f">GetN2OFromNitrification</a>().<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a>+<a class="code" href="classsoil.html#ab36e32808c2cadf3b50cd18fdc06ca01" title="object describing the soil profile">Profile</a>-&gt;<a class="code" href="classsoil_profile.html#a9be3f4ec8fe381095d2f9a15f1b7d77d">GetN2OFromDenitrification</a>().<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a>
<a name="l00611"></a>00611          &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; N2ORatio
<a name="l00612"></a>00612          &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <a class="code" href="classsoil.html#a8f203b5b85e7a616745ae8ec50e7f40d">AccumulatedWaterDrainage</a>
<a name="l00613"></a>00613          &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <a class="code" href="classsoil.html#a92ba9cb92d2aebff24c21437ced70017">AccumulatedNitrateDrainage</a>
<a name="l00614"></a>00614          &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <a class="code" href="classsoil.html#a727b7e354f1982a033764880c47d7a81">soilEvaporation</a>
<a name="l00615"></a>00615          &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <a class="code" href="classsoil.html#a7b54d79b2b2742e3a173c49e76a797c9">totalTranspiration</a>
<a name="l00616"></a>00616          &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <a class="code" href="classsoil.html#ab94851a74389f879a38bdcaad1826ef2">denitrification</a>.<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a>
<a name="l00617"></a>00617          &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <a class="code" href="classsoil.html#a9b86d97fc4356ee0b07bbb78f67484c8">nitrification</a>.<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a>
<a name="l00618"></a>00618          &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <a class="code" href="classsoil.html#aca4597213bffd5e97041c7da8b41f009">CO2Evolution</a>;
<a name="l00619"></a>00619 <span class="comment">//bad code - fix before reintroduction</span>
<a name="l00620"></a>00620 <span class="comment">/*</span>
<a name="l00621"></a>00621 <span class="comment">      double tempAdjust = 1.0/exp(-3.432+0.168*10*(1.0-0.5*10/36.9));</span>
<a name="l00622"></a>00622 <span class="comment">        double TemperatureEffect = tempAdjust*exp(-3.432+0.168*20.0*(1.0-0.5*20.0/36.9));                   // Note check if temperature effect on organimc matter</span>
<a name="l00623"></a>00623 <span class="comment">      double PotC = 0.0;</span>
<a name="l00624"></a>00624 <span class="comment">        for (int i=0;i&lt;20;i++)</span>
<a name="l00625"></a>00625 <span class="comment">        PotC += Profile-&gt;GetLayer(i)-&gt;PotentialCarbonTurnover();</span>
<a name="l00626"></a>00626 <span class="comment">      f &lt;&lt; &quot;\t&quot; &lt;&lt; TemperatureEffect*PotC;</span>
<a name="l00627"></a>00627 <span class="comment">      if (Profile-&gt;GetN2OFromDenitrification().n&gt;1e-10)</span>
<a name="l00628"></a>00628 <span class="comment">              f &lt;&lt; &quot;\t&quot; &lt;&lt; denitrification.n/Profile-&gt;GetN2OFromDenitrification().n;</span>
<a name="l00629"></a>00629 <span class="comment">      else</span>
<a name="l00630"></a>00630 <span class="comment">                        f &lt;&lt; &quot;\t0&quot;;</span>
<a name="l00631"></a>00631 <span class="comment">      for (int i=0;i&lt;7;i++)</span>
<a name="l00632"></a>00632 <span class="comment">      {</span>
<a name="l00633"></a>00633 <span class="comment">        f &lt;&lt; &quot;\t&quot; &lt;&lt; Profile-&gt;GetLayer(i)-&gt;GetN2OFromDenitrification().n;</span>
<a name="l00634"></a>00634 <span class="comment">        f &lt;&lt; &quot;\t&quot; &lt;&lt; Profile-&gt;GetLayer(i)-&gt;PotentialCarbonTurnover();</span>
<a name="l00635"></a>00635 <span class="comment"></span>
<a name="l00636"></a>00636 <span class="comment">         double WaterEffect = max(0.0,min(1.0,0.0116+1.36/(1+exp(-(Profile-&gt;GetLayer(i)-&gt;GetWaterFilledPorosity()-0.815)/0.0896))));</span>
<a name="l00637"></a>00637 <span class="comment">        f &lt;&lt; &quot;\t&quot; &lt;&lt; WaterEffect;</span>
<a name="l00638"></a>00638 <span class="comment"></span>
<a name="l00639"></a>00639 <span class="comment">         double tempAdjust = 1.0/exp(-3.432+0.168*10*(1.0-0.5*10/36.9));</span>
<a name="l00640"></a>00640 <span class="comment">                   double TemperatureEffect = tempAdjust*exp(-3.432+0.168*Profile-&gt;GetLayer(i)-&gt;GetTemperature()*(1.0-0.5*Profile-&gt;GetLayer(i)-&gt;GetTemperature()/36.9));</span>
<a name="l00641"></a>00641 <span class="comment">         f &lt;&lt; &quot;\t&quot; &lt;&lt; TemperatureEffect;</span>
<a name="l00642"></a>00642 <span class="comment"></span>
<a name="l00643"></a>00643 <span class="comment">         double NitrateConc = Profile-&gt;GetLayer(i)-&gt;GetNitrate().n/Profile-&gt;GetLayer(i)-&gt;GetThickness()*1000/Profile-&gt;GetLayer(i)-&gt;GetDryBulkDensity()*1e6; //unit mg kg-1</span>
<a name="l00644"></a>00644 <span class="comment">                   double NitrateEffect = max(0.0,min(1.0,1.17*NitrateConc/(32.7+NitrateConc)));</span>
<a name="l00645"></a>00645 <span class="comment"></span>
<a name="l00646"></a>00646 <span class="comment">        f &lt;&lt; &quot;\t&quot; &lt;&lt; NitrateEffect;</span>
<a name="l00647"></a>00647 <span class="comment">                }</span>
<a name="l00648"></a>00648 <span class="comment">*/</span>
<a name="l00649"></a>00649       <a class="code" href="classsoil.html#a37ce966bebdb8775a666a3c0a6cd8bf3" title="file streams for details of soil variables.">f</a> &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <a class="code" href="classsoil.html#ab5516aa25f35082aba80ca2795c68e4e" title="object describing compounds on the soil surface (e.g. undissolved fertiliser)">Surface</a>-&gt;<a class="code" href="classsoil_surface.html#a681cb140bad888b90a1c4e7fb9e390c7">GetCarbon</a>() &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <a class="code" href="classsoil.html#ab5516aa25f35082aba80ca2795c68e4e" title="object describing compounds on the soil surface (e.g. undissolved fertiliser)">Surface</a>-&gt;<a class="code" href="classsoil_surface.html#a3ca5e5b204e106714b33fa6993f02af8">GetOrganicNitrogen</a>().<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a> &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt;  <a class="code" href="classsoil.html#ab5516aa25f35082aba80ca2795c68e4e" title="object describing compounds on the soil surface (e.g. undissolved fertiliser)">Surface</a>-&gt;<a class="code" href="classsoil_surface.html#a5d93b4b66e26d8e638f67c297db44821">GetTotalNitrogen</a>().<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a>;
<a name="l00650"></a>00650       <a class="code" href="classsoil.html#a37ce966bebdb8775a666a3c0a6cd8bf3" title="file streams for details of soil variables.">f</a> &lt;&lt; endl;
<a name="l00651"></a>00651    }
<a name="l00652"></a>00652 }
<a name="l00653"></a>00653 
<a name="l00654"></a>00654 <span class="comment">/****************************************************************************\</span>
<a name="l00655"></a>00655 <span class="comment">\****************************************************************************/</span>
<a name="l00656"></a><a class="code" href="classsoil.html#a6ddfca2c474855d16889d6a85c4b508e">00656</a> <span class="keywordtype">void</span> <a class="code" href="classsoil.html#a6ddfca2c474855d16889d6a85c4b508e" title="adds decomposable organic matter to the soil">soil::AddDecomposable</a>(<a class="code" href="classdecomposable.html">decomposable</a>* produc,<span class="keywordtype">double</span> * rootLengthList)
<a name="l00657"></a>00657 {
<a name="l00658"></a>00658    produc-&gt;<a class="code" href="classlive_matter.html#ad058ede27a28aa89754500d5ccbbdd8a">RemoveWater</a>();                                          <span class="comment">// To cope with dry matters less than 1</span>
<a name="l00659"></a>00659         <span class="keywordflow">if</span> (produc-&gt;<a class="code" href="classproduct.html#a021ebef2da57e1d977cfe57e62c6e38b">GetAmount</a>()&lt;-1E-10)
<a name="l00660"></a>00660                 <a class="code" href="message_8h.html#a8ad29009121a629982c6ade0bd332470">theMessage</a>-&gt;<a class="code" href="classmessage.html#af9891cb7111375e6a36363afffb09d63">FatalError</a>(<span class="stringliteral">&quot;soil::AddDecomposable - negative amount added&quot;</span>);
<a name="l00661"></a>00661         <span class="keywordflow">if</span> (produc-&gt;<a class="code" href="classproduct.html#a021ebef2da57e1d977cfe57e62c6e38b">GetAmount</a>()&gt;0)
<a name="l00662"></a>00662         {
<a name="l00663"></a>00663       <span class="keywordflow">if</span> (produc-&gt;<a class="code" href="classlive_matter.html#ac4b95fdff5ad224d9aa1541589c64663">GetorgN_content</a>().<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a>&lt;0.0)
<a name="l00664"></a>00664                 <a class="code" href="message_8h.html#a8ad29009121a629982c6ade0bd332470">theMessage</a>-&gt;<a class="code" href="classmessage.html#af9891cb7111375e6a36363afffb09d63">FatalError</a>(<span class="stringliteral">&quot;soil::AddDecomposable - negative amount of organic N added&quot;</span>);
<a name="l00665"></a>00665                 <span class="comment">//if ((rootLengthList) &amp;&amp; (*rootLengthList&lt;=0))</span>
<a name="l00666"></a>00666         <span class="comment">//      theMessage-&gt;FatalError(&quot;soil::AddDecomposable - rootLengthList can not contain zero in first element&quot;);</span>
<a name="l00667"></a>00667                 <a class="code" href="classorganic_product.html">organicProduct</a> * p = <span class="keyword">new</span> <a class="code" href="classorganic_product.html">organicProduct</a>;
<a name="l00668"></a>00668 
<a name="l00669"></a>00669                 p-&gt;<a class="code" href="classorganic_product.html#add731f4e9ff946d3c662545ce7b86785">SetName</a>(produc-&gt;<a class="code" href="classbase.html#a5b4079d3eb535e704fcaed3016c76ecb">GetName</a>());
<a name="l00670"></a>00670                 p-&gt;<a class="code" href="classorganic_product.html#aed3ff10d5be6bddf62a64e3107d56d2c">SetCarbon</a>(produc-&gt;<a class="code" href="classlive_matter.html#a899102ff3dccbfdc70b79e701c135514">GetC_content</a>()*produc-&gt;<a class="code" href="classproduct.html#a021ebef2da57e1d977cfe57e62c6e38b">GetAmount</a>()*100);
<a name="l00671"></a>00671                 p-&gt;<a class="code" href="classorganic_product.html#a1da1b32c1a68a787fade1b1f6af1a85e">SetNitrogen</a>(produc-&gt;<a class="code" href="classlive_matter.html#ac4b95fdff5ad224d9aa1541589c64663">GetorgN_content</a>()*produc-&gt;<a class="code" href="classproduct.html#a021ebef2da57e1d977cfe57e62c6e38b">GetAmount</a>()*100);
<a name="l00672"></a>00672                 p-&gt;<a class="code" href="classorganic_product.html#ae2618cd8eb23583035214d37cb4fbe0f">SetNO3_content</a>(produc-&gt;<a class="code" href="classlive_matter.html#ab2a2d0d05066ad642643b8835016010e">GetNO3_content</a>()*produc-&gt;<a class="code" href="classproduct.html#a021ebef2da57e1d977cfe57e62c6e38b">GetAmount</a>()*100);
<a name="l00673"></a>00673                 p-&gt;<a class="code" href="classorganic_product.html#a62634111037a6e2961c7c042d6773038">SetNH4_content</a>(produc-&gt;<a class="code" href="classlive_matter.html#a461f95ec9e31447ffee31066ea357ab1">GetNH4_content</a>()*produc-&gt;<a class="code" href="classproduct.html#a021ebef2da57e1d977cfe57e62c6e38b">GetAmount</a>()*100);
<a name="l00674"></a>00674                 p-&gt;<a class="code" href="classorganic_product.html#ad126b4d58c7007da80a68cc60296c337">SetkAOM1</a>(produc-&gt;<a class="code" href="classdecomposable.html#aef778c85d2d909504863cb25f91c8ffe">GetkAOM1</a>());
<a name="l00675"></a>00675                 p-&gt;<a class="code" href="classorganic_product.html#a04807d30cde0dc4fee6868c17599b1f1">SetkAOM2</a>(produc-&gt;<a class="code" href="classdecomposable.html#abfebaed2dbded430bc75b4d22a54afab">GetkAOM2</a>());
<a name="l00676"></a>00676       p-&gt;<a class="code" href="classorganic_product.html#abe76058995d85817daf3bcf02e7f24bb">SetReduceTurnover</a>(produc-&gt;<a class="code" href="classdecomposable.html#a5df0740211a3624cd45f507fddb7fa3e">GetReduceTurnover</a>());
<a name="l00677"></a>00677                 <span class="keywordflow">if</span> (produc-&gt;<a class="code" href="classdecomposable.html#a837a38c6d72b2cb26077b1c28e1c8669">GetAOM1_fraction</a>()&gt;0.0)
<a name="l00678"></a>00678                 p-&gt;<a class="code" href="classorganic_product.html#accc8b9ad540adb9a9e22a1c2fcf53c78">SetAOM1_fraction</a>(produc-&gt;<a class="code" href="classdecomposable.html#a837a38c6d72b2cb26077b1c28e1c8669">GetAOM1_fraction</a>());
<a name="l00679"></a>00679                 <span class="keywordflow">if</span> (produc-&gt;<a class="code" href="classdecomposable.html#aeebdb3853eb29223fd30bc1bf6f51189">GetAOM2_fraction</a>()&gt;0.0)
<a name="l00680"></a>00680                 p-&gt;<a class="code" href="classorganic_product.html#a7ecff65aede65e22d43835131881f495">SetAOM2_fraction</a>(produc-&gt;<a class="code" href="classdecomposable.html#aeebdb3853eb29223fd30bc1bf6f51189">GetAOM2_fraction</a>());
<a name="l00681"></a>00681 
<a name="l00682"></a>00682       <span class="comment">// N allocations</span>
<a name="l00683"></a>00683        <span class="keywordtype">double</span> sum=0.0;
<a name="l00684"></a>00684            <span class="keywordflow">if</span> ((produc-&gt;<a class="code" href="classdecomposable.html#a9de8338cfa6616c44d4385fbf129ab39">GetAOM1_Nfraction</a>()&gt;0.0) || (produc-&gt;<a class="code" href="classdecomposable.html#a6bfb17228b49bdce4d57a911b1fab099">GetAOM2_Nfraction</a>()&gt;0.0))
<a name="l00685"></a>00685        {
<a name="l00686"></a>00686                 p-&gt;<a class="code" href="classorganic_product.html#a3442bd238770ac98b17b88b6a7939a51">SetNFraction</a>(0,produc-&gt;<a class="code" href="classdecomposable.html#a9de8338cfa6616c44d4385fbf129ab39">GetAOM1_Nfraction</a>());                 <span class="comment">// AOM1</span>
<a name="l00687"></a>00687          sum+=produc-&gt;<a class="code" href="classdecomposable.html#a9de8338cfa6616c44d4385fbf129ab39">GetAOM1_Nfraction</a>();
<a name="l00688"></a>00688                 p-&gt;<a class="code" href="classorganic_product.html#a3442bd238770ac98b17b88b6a7939a51">SetNFraction</a>(1,produc-&gt;<a class="code" href="classdecomposable.html#a6bfb17228b49bdce4d57a911b1fab099">GetAOM2_Nfraction</a>());                 <span class="comment">// AOM2</span>
<a name="l00689"></a>00689         sum+=produc-&gt;<a class="code" href="classdecomposable.html#a6bfb17228b49bdce4d57a911b1fab099">GetAOM2_Nfraction</a>();
<a name="l00690"></a>00690         p-&gt;<a class="code" href="classorganic_product.html#a3442bd238770ac98b17b88b6a7939a51">SetNFraction</a>(2,1.0-sum);     <span class="comment">// NOM</span>
<a name="l00691"></a>00691         <span class="keywordflow">if</span> (sum&lt;0 || sum&gt;1)
<a name="l00692"></a>00692                 <a class="code" href="message_8h.html#a8ad29009121a629982c6ade0bd332470">theMessage</a>-&gt;<a class="code" href="classmessage.html#af9891cb7111375e6a36363afffb09d63">FatalError</a>(<span class="stringliteral">&quot;soil::AddDecomposable - inconsistency in values for fAOM1 and/or fAOM2&quot;</span>);
<a name="l00693"></a>00693        }
<a name="l00694"></a>00694                 <a class="code" href="classsoil.html#afdc5aef4b05a7077fc613127df6341e7" title="adds an organic product to the soil surface or to the soil profile">AddOrganicProduct</a>(p,rootLengthList);
<a name="l00695"></a>00695                 <a class="code" href="classsoil.html#addf9abd98e1b4678c37c714b49045f79" title="soil nitrogen budget">Nbudget</a>.<a class="code" href="classbudget.html#ad619d773e77931df0435e8c08314f68e">AddInput</a>(p-&gt;<a class="code" href="classorganic_product.html#aba7720784ab3cc2e672d2659085b3950">GetTotalNitrogen</a>().<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a>);
<a name="l00696"></a>00696         <span class="keyword">delete</span> p;
<a name="l00697"></a>00697         }
<a name="l00698"></a>00698 }
<a name="l00699"></a>00699 
</pre></div></div>
</div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address class="footer"><small>Generated on Mon Aug 22 2011 10:29:05 for Fasset by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
