<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Fasset: C:/main/trunk/src/fields/crops/cropRyegrass.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.4 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Fasset</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">C:/main/trunk/src/fields/crops/cropRyegrass.cpp</div>  </div>
</div>
<div class="contents">
<a href="crop_ryegrass_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/****************************************************************************\</span>
<a name="l00002"></a>00002 <span class="comment"> $URL$</span>
<a name="l00003"></a>00003 <span class="comment"> $LastChangedDate$</span>
<a name="l00004"></a>00004 <span class="comment"> $LastChangedRevision$</span>
<a name="l00005"></a>00005 <span class="comment"> $LastChangedBy$</span>
<a name="l00006"></a>00006 <span class="comment">\****************************************************************************/</span>
<a name="l00007"></a>00007 <span class="preprocessor">#include &quot;../../base/common.h&quot;</span>
<a name="l00008"></a>00008 <span class="preprocessor">#include &quot;<a class="code" href="crop_ryegrass_8h.html">cropRyegrass.h</a>&quot;</span>
<a name="l00009"></a>00009 <span class="preprocessor">#include &quot;../../products/products.h&quot;</span>
<a name="l00010"></a>00010 <span class="preprocessor">#include &quot;../../base/IndicatorOutput.h&quot;</span>
<a name="l00011"></a>00011 <span class="preprocessor">#include &quot;../../base/climate.h&quot;</span>
<a name="l00012"></a>00012 <span class="preprocessor">#include &quot;../../base/nixcbits.h&quot;</span>
<a name="l00013"></a>00013 <span class="preprocessor">#include &quot;../../products/feedItem.h&quot;</span>
<a name="l00014"></a>00014 <span class="preprocessor">#include &quot;../../data/commonData.h&quot;</span>
<a name="l00015"></a>00015 
<a name="l00016"></a>00016 <span class="comment">/****************************************************************************\</span>
<a name="l00017"></a>00017 <span class="comment">\****************************************************************************/</span>
<a name="l00018"></a><a class="code" href="classcrop_ryegrass.html#a50501af696bb68d2c124f75fc03a904c">00018</a> <a class="code" href="classcrop_ryegrass.html#a50501af696bb68d2c124f75fc03a904c">cropRyegrass::cropRyegrass</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> * aName, <span class="keyword">const</span> <span class="keywordtype">int</span> aIndex, <span class="keyword">const</span> <a class="code" href="classbase.html">base</a> * aOwner, <span class="keywordtype">string</span> cropName )
<a name="l00019"></a>00019              :<a class="code" href="classcrop.html">crop</a>(aName,aIndex,aOwner, cropName)
<a name="l00020"></a>00020 {
<a name="l00021"></a>00021         <span class="comment">// For complete nomenclature see base class &#39;crop&#39;</span>
<a name="l00022"></a>00022 
<a name="l00023"></a>00023    <a class="code" href="classcrop.html#af982befddb79f8aedfa207bce540c47a">PlantItemName</a>  = <span class="stringliteral">&quot;RYEGRASS&quot;</span>;         <span class="comment">// No primarly harvest item</span>
<a name="l00024"></a>00024    <a class="code" href="classcrop.html#aa2aceced21d0fee166e40a836c2ee9cc">StrawItemName</a>  = <span class="stringliteral">&quot;RYEGRASS&quot;</span>;         <span class="comment">// These names maps to products.dat !</span>
<a name="l00025"></a>00025         <a class="code" href="classcrop.html#a7b2a38633965734c3298a4da248c6d53" title="Describe if a plan can grow trough winter.">WinterSeed</a>     = <span class="keyword">true</span>;               <span class="comment">// Is the present crop a wintercrop.</span>
<a name="l00026"></a>00026    <a class="code" href="classcrop.html#af82f3b3de55473a22e08c2b07d6e0645">GrowthContinue</a> = <span class="keyword">true</span>;
<a name="l00027"></a>00027         <a class="code" href="classcrop_ryegrass.html#affc800f21a3c26e2277a8e5679c27204">HasBeenCut</a> = <span class="keyword">false</span>;
<a name="l00028"></a>00028         <a class="code" href="classcrop_ryegrass.html#aebfc7e7f1e48269a0b41f08c27072b61">grazableDM</a>=0.0;
<a name="l00029"></a>00029    <a class="code" href="classcrop_ryegrass.html#a6fd909e402b37a89599cef6d026671c0">grazableN</a> = 0.0;
<a name="l00030"></a>00030 
<a name="l00031"></a>00031    <span class="comment">//---- Parameters -----------------------------------------------------------</span>
<a name="l00032"></a>00032 
<a name="l00033"></a>00033 
<a name="l00034"></a>00034         <span class="comment">//Dry matter accumulation</span>
<a name="l00035"></a>00035 
<a name="l00036"></a>00036    <a class="code" href="classcrop_ryegrass.html#ad0c31787525448d29e932a5d05476978">MinDayLength</a>                                                         = <a class="code" href="crop_parameters_data_8h.html#af71819066527a8ec2b9968375a84c8c3">theCropData</a>-&gt;<a class="code" href="classcrop_parameters_data.html#af9c44d2c87279f5b22b1cfa2753daab7">getMinDayLength</a>();
<a name="l00037"></a>00037 
<a name="l00038"></a>00038 
<a name="l00039"></a>00039         <span class="comment">// DM allocation</span>
<a name="l00040"></a>00040    <span class="comment">// Parameters below adjusted so that the total carbon flow matches data from Paustian et al. 1990. J. Appl. Ecol., 27, 60-84</span>
<a name="l00041"></a>00041         <a class="code" href="classcrop_ryegrass.html#aebf442425c9fe0662ad5f60a61792500">RespirationRoot</a>                                                 = <a class="code" href="crop_parameters_data_8h.html#af71819066527a8ec2b9968375a84c8c3">theCropData</a>-&gt;<a class="code" href="classcrop_parameters_data.html#a6c0d6722fbab900b0f129e2285382a2e">getRespirationRoot</a>();         <span class="comment">// Root respiration given as a daily fraction of DM at 10 deg. Celsius, Calibrated to Burreh?jvej data</span>
<a name="l00042"></a>00042         <a class="code" href="classcrop_ryegrass.html#a28d4c2eb58e04a840f3be6277a13e51b">RespirationTop</a>                                                  = <a class="code" href="crop_parameters_data_8h.html#af71819066527a8ec2b9968375a84c8c3">theCropData</a>-&gt;<a class="code" href="classcrop_parameters_data.html#aad6cb6e65f0a61bf52a79a17f1042b2f">getRespirationTop</a>();          <span class="comment">// Top respiration given as a daily fraction of DM at 10 deg. Celsius</span>
<a name="l00043"></a>00043    <a class="code" href="classcrop_ryegrass.html#ae11486448ac560cb05033e804aea5316">TransferRate</a>                                                 = <a class="code" href="crop_parameters_data_8h.html#af71819066527a8ec2b9968375a84c8c3">theCropData</a>-&gt;<a class="code" href="classcrop_parameters_data.html#a4c1839101bf8b1a70ce820d712aef8ed">getTransferRate</a>();                 <span class="comment">// Fraction (temperature-dependend) of the four age pools that is transferred to subsequent fraction</span>
<a name="l00044"></a>00044         <a class="code" href="classcrop_ryegrass.html#a851332fb794a51440e3930cb53f03802">BulkDensity</a>                                                     = <a class="code" href="crop_parameters_data_8h.html#af71819066527a8ec2b9968375a84c8c3">theCropData</a>-&gt;<a class="code" href="classcrop_parameters_data.html#a55b53ee449a5246b1f93e228331a54a8">getBulkDensity</a>();       <span class="comment">// g DM/m3 standing crop - guesstimated</span>
<a name="l00045"></a>00045    <a class="code" href="classcrop_ryegrass.html#a425c715cfd92033db6af5b091903af98">RecycleFraction</a>                                      =<a class="code" href="crop_parameters_data_8h.html#af71819066527a8ec2b9968375a84c8c3">theCropData</a>-&gt;<a class="code" href="classcrop_parameters_data.html#a39033f0f801162575c6f9736edc4b12c">getRecycleFraction</a>();
<a name="l00046"></a>00046 
<a name="l00047"></a>00047 
<a name="l00048"></a>00048 
<a name="l00049"></a>00049    <span class="comment">// LAI and canopy structure</span>
<a name="l00050"></a>00050 
<a name="l00051"></a>00051         <a class="code" href="classcrop_ryegrass.html#ababb5c5bbefcf437f81ac636fbbf3805">InitialLAIIncrease</a>                                      =<a class="code" href="crop_parameters_data_8h.html#af71819066527a8ec2b9968375a84c8c3">theCropData</a>-&gt;<a class="code" href="classcrop_parameters_data.html#a09baf6a55b8c5d258bff50d65fa46c89">getInitialLAIIncrease</a>();
<a name="l00052"></a>00052         <a class="code" href="classcrop_ryegrass.html#a0b667252165fc134819df04548618d56">liveOMD</a>                                                                         = <a class="code" href="crop_parameters_data_8h.html#af71819066527a8ec2b9968375a84c8c3">theCropData</a>-&gt;<a class="code" href="classcrop_parameters_data.html#a87c9fd40a20313b2c0215c19298b4636">getliveOMD</a>();            <span class="comment">// Digestibility of first 3 age classes</span>
<a name="l00053"></a>00053         <a class="code" href="classcrop_ryegrass.html#aad215af4abecd60bf33e223aafec8e6c">deadOMD</a>                                                                         = <a class="code" href="crop_parameters_data_8h.html#af71819066527a8ec2b9968375a84c8c3">theCropData</a>-&gt;<a class="code" href="classcrop_parameters_data.html#aa1a0cf375fa40032a728f9ac0083b506">getdeadOMD</a>();            <span class="comment">// Digestibility of last age class</span>
<a name="l00054"></a>00054 
<a name="l00055"></a>00055         <a class="code" href="classcrop_ryegrass.html#ad38b65aa16d9136baee37d9f6faff1a0">RateOfRipeReSeed</a>                                                =<a class="code" href="crop_parameters_data_8h.html#af71819066527a8ec2b9968375a84c8c3">theCropData</a>-&gt;<a class="code" href="classcrop_parameters_data.html#ab7b64d080ea289df1b25efea245008bc">getRateOfRipeReSeed</a>();                    <span class="comment">//Rate of storage reseeding</span>
<a name="l00056"></a>00056 
<a name="l00057"></a>00057    <span class="comment">// Relative availability of ages classes, according to the values for</span>
<a name="l00058"></a>00058    <span class="comment">// Thornleys age classes of leaves.</span>
<a name="l00059"></a>00059    <span class="comment">// Note that Thornleys age class avalabilities for sheth + stem all are unity!!!</span>
<a name="l00060"></a>00060    <a class="code" href="classcrop_ryegrass.html#a445c84d8258d5047e62dcd3d222cf8bd">uptakeWeight</a>[0] = 1.00;
<a name="l00061"></a>00061    <a class="code" href="classcrop_ryegrass.html#a445c84d8258d5047e62dcd3d222cf8bd">uptakeWeight</a>[1] = 0.75;
<a name="l00062"></a>00062    <a class="code" href="classcrop_ryegrass.html#a445c84d8258d5047e62dcd3d222cf8bd">uptakeWeight</a>[2] = 0.50;
<a name="l00063"></a>00063    <a class="code" href="classcrop_ryegrass.html#a445c84d8258d5047e62dcd3d222cf8bd">uptakeWeight</a>[3] = 0.25;
<a name="l00064"></a>00064    <a class="code" href="classcrop.html#af7ae14fac12af3efa728e789155983fb">Nbudget</a>.<a class="code" href="classbudget.html#ada0ca75f0dd9d8a6d0dfd5fcbd666653">SetNames</a>(<a class="code" href="classcrop.html#af852d2f62dd22411199ae8e164536a7d">CropName</a>,<span class="stringliteral">&quot;N&quot;</span>);
<a name="l00065"></a>00065    <a class="code" href="classcrop.html#a46844fd0540eb7627555f21afa8545e8">DMbudget</a>.<a class="code" href="classbudget.html#ada0ca75f0dd9d8a6d0dfd5fcbd666653">SetNames</a>(<a class="code" href="classcrop.html#af852d2f62dd22411199ae8e164536a7d">CropName</a>,<span class="stringliteral">&quot;DM&quot;</span>);
<a name="l00066"></a>00066 
<a name="l00067"></a>00067    <span class="comment">// State variables ----------------------------------------------------------</span>
<a name="l00068"></a>00068    <a class="code" href="classcrop_ryegrass.html#a3f0d73c30fb6fe15198a3beca5a68a6e">TemperatureSumAfterCut</a> = 0.0;                                             <span class="comment">// temperature sum after last cut</span>
<a name="l00069"></a>00069    <a class="code" href="classcrop_ryegrass.html#a75af628b7d7bb576d4c9285391d292b2">CutDelay</a> = 0.0;                                                           <span class="comment">// The temperature sum nessecary for obtaining 0.5 LAI after a cut</span>
<a name="l00070"></a>00070    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;4;i++)
<a name="l00071"></a>00071    {
<a name="l00072"></a>00072         <a class="code" href="classcrop_ryegrass.html#a60b9ccc77a862693545200a71d113608">grazedDM</a>[i]=0.0;
<a name="l00073"></a>00073       <a class="code" href="classcrop_ryegrass.html#ae9641d6c7c5459eb6053cb421df4e8d0">AgeClassTop</a>[i]=0.0;
<a name="l00074"></a>00074    }
<a name="l00075"></a>00075    <a class="code" href="classcrop_ryegrass.html#a20afe6ee954c51fafe8d0c184c395c65">ReSeedDM</a> = 0.0;
<a name="l00076"></a>00076 }
<a name="l00077"></a>00077 
<a name="l00078"></a>00078 <span class="comment">/****************************************************************************\</span>
<a name="l00079"></a>00079 <span class="comment">\****************************************************************************/</span>
<a name="l00080"></a><a class="code" href="classcrop_ryegrass.html#aeea36991d9749de3448b4c60d1338bd5">00080</a> <a class="code" href="classcrop_ryegrass.html#a50501af696bb68d2c124f75fc03a904c">cropRyegrass::cropRyegrass</a>(<span class="keyword">const</span> <a class="code" href="classcrop_ryegrass.html">cropRyegrass</a>&amp; acrop)
<a name="l00081"></a>00081    : <a class="code" href="classcrop.html">crop</a>(acrop)
<a name="l00082"></a>00082 {
<a name="l00083"></a>00083    <a class="code" href="classcrop_ryegrass.html#a851332fb794a51440e3930cb53f03802">BulkDensity</a>            = acrop.<a class="code" href="classcrop_ryegrass.html#a851332fb794a51440e3930cb53f03802">BulkDensity</a>;
<a name="l00084"></a>00084    <a class="code" href="classcrop_ryegrass.html#a28d4c2eb58e04a840f3be6277a13e51b">RespirationTop</a>         = acrop.<a class="code" href="classcrop_ryegrass.html#a28d4c2eb58e04a840f3be6277a13e51b">RespirationTop</a>;
<a name="l00085"></a>00085    <a class="code" href="classcrop_ryegrass.html#aebf442425c9fe0662ad5f60a61792500">RespirationRoot</a>        = acrop.<a class="code" href="classcrop_ryegrass.html#aebf442425c9fe0662ad5f60a61792500">RespirationRoot</a>;
<a name="l00086"></a>00086    <a class="code" href="classcrop_ryegrass.html#ae11486448ac560cb05033e804aea5316">TransferRate</a>           = acrop.<a class="code" href="classcrop_ryegrass.html#ae11486448ac560cb05033e804aea5316">TransferRate</a>;
<a name="l00087"></a>00087    <a class="code" href="classcrop_ryegrass.html#a425c715cfd92033db6af5b091903af98">RecycleFraction</a>        = acrop.<a class="code" href="classcrop_ryegrass.html#a425c715cfd92033db6af5b091903af98">RecycleFraction</a>;
<a name="l00088"></a>00088    <a class="code" href="classcrop_ryegrass.html#a3f0d73c30fb6fe15198a3beca5a68a6e">TemperatureSumAfterCut</a> = acrop.<a class="code" href="classcrop_ryegrass.html#a3f0d73c30fb6fe15198a3beca5a68a6e">TemperatureSumAfterCut</a>;
<a name="l00089"></a>00089    <a class="code" href="classcrop_ryegrass.html#a75af628b7d7bb576d4c9285391d292b2">CutDelay</a>               = acrop.<a class="code" href="classcrop_ryegrass.html#a75af628b7d7bb576d4c9285391d292b2">CutDelay</a>;
<a name="l00090"></a>00090    <a class="code" href="classcrop_ryegrass.html#a0b667252165fc134819df04548618d56">liveOMD</a>                = acrop.<a class="code" href="classcrop_ryegrass.html#a0b667252165fc134819df04548618d56">liveOMD</a>;
<a name="l00091"></a>00091    <a class="code" href="classcrop_ryegrass.html#aad215af4abecd60bf33e223aafec8e6c">deadOMD</a>                = acrop.<a class="code" href="classcrop_ryegrass.html#aad215af4abecd60bf33e223aafec8e6c">deadOMD</a>;
<a name="l00092"></a>00092    <a class="code" href="classcrop_ryegrass.html#aebfc7e7f1e48269a0b41f08c27072b61">grazableDM</a>             = acrop.<a class="code" href="classcrop_ryegrass.html#aebfc7e7f1e48269a0b41f08c27072b61">grazableDM</a>;
<a name="l00093"></a>00093    <a class="code" href="classcrop_ryegrass.html#a6fd909e402b37a89599cef6d026671c0">grazableN</a>              = acrop.<a class="code" href="classcrop_ryegrass.html#a6fd909e402b37a89599cef6d026671c0">grazableN</a>;
<a name="l00094"></a>00094    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;4;i++)
<a name="l00095"></a>00095    {
<a name="l00096"></a>00096       <a class="code" href="classcrop_ryegrass.html#ae9641d6c7c5459eb6053cb421df4e8d0">AgeClassTop</a>[i]      = acrop.<a class="code" href="classcrop_ryegrass.html#ae9641d6c7c5459eb6053cb421df4e8d0">AgeClassTop</a>[i];
<a name="l00097"></a>00097            <a class="code" href="classcrop_ryegrass.html#a60b9ccc77a862693545200a71d113608">grazedDM</a>[i]         = acrop.<a class="code" href="classcrop_ryegrass.html#a60b9ccc77a862693545200a71d113608">grazedDM</a>[i];
<a name="l00098"></a>00098       <a class="code" href="classcrop_ryegrass.html#a445c84d8258d5047e62dcd3d222cf8bd">uptakeWeight</a>[i]     = acrop.<a class="code" href="classcrop_ryegrass.html#a445c84d8258d5047e62dcd3d222cf8bd">uptakeWeight</a>[i];
<a name="l00099"></a>00099    }
<a name="l00100"></a>00100  }
<a name="l00101"></a>00101 
<a name="l00102"></a>00102 
<a name="l00103"></a>00103 <span class="comment">/****************************************************************************\</span>
<a name="l00104"></a>00104 <span class="comment">\****************************************************************************/</span>
<a name="l00105"></a><a class="code" href="classcrop_ryegrass.html#a3ee92e29d981a5bcae487e10f5aa18d4">00105</a> <span class="keywordtype">void</span> <a class="code" href="classcrop_ryegrass.html#a3ee92e29d981a5bcae487e10f5aa18d4">cropRyegrass::Add</a>(<a class="code" href="classcrop.html">crop</a>* aCrop, <span class="keywordtype">double</span> <a class="code" href="typer_8h.html#ae4c405e5c68c6ec2c44bb6d6adfc2f6cab10366ecc76133a0a4a4712a5ee26f65">fraction</a>)
<a name="l00106"></a>00106 {
<a name="l00107"></a>00107    <a class="code" href="classcrop_ryegrass.html#a3ee92e29d981a5bcae487e10f5aa18d4">crop::Add</a>(aCrop,fraction);
<a name="l00108"></a>00108    <a class="code" href="classcrop_ryegrass.html">cropRyegrass</a> * c = (<a class="code" href="classcrop_ryegrass.html">cropRyegrass</a>*)aCrop;
<a name="l00109"></a>00109 
<a name="l00110"></a>00110    <a class="code" href="classcrop_ryegrass.html#a851332fb794a51440e3930cb53f03802">BulkDensity</a>            =(1-<a class="code" href="typer_8h.html#ae4c405e5c68c6ec2c44bb6d6adfc2f6cab10366ecc76133a0a4a4712a5ee26f65">fraction</a>)*<a class="code" href="classcrop_ryegrass.html#a851332fb794a51440e3930cb53f03802">BulkDensity</a> + fraction*c-&gt;<a class="code" href="classcrop_ryegrass.html#a851332fb794a51440e3930cb53f03802">BulkDensity</a>;
<a name="l00111"></a>00111    <a class="code" href="classcrop_ryegrass.html#a28d4c2eb58e04a840f3be6277a13e51b">RespirationTop</a>         =(1-fraction)*<a class="code" href="classcrop_ryegrass.html#a28d4c2eb58e04a840f3be6277a13e51b">RespirationTop</a> + fraction*c-&gt;<a class="code" href="classcrop_ryegrass.html#a28d4c2eb58e04a840f3be6277a13e51b">RespirationTop</a>;
<a name="l00112"></a>00112    <a class="code" href="classcrop_ryegrass.html#aebf442425c9fe0662ad5f60a61792500">RespirationRoot</a>        =(1-<a class="code" href="typer_8h.html#ae4c405e5c68c6ec2c44bb6d6adfc2f6cab10366ecc76133a0a4a4712a5ee26f65">fraction</a>)*<a class="code" href="classcrop_ryegrass.html#aebf442425c9fe0662ad5f60a61792500">RespirationRoot</a> + fraction*c-&gt;<a class="code" href="classcrop_ryegrass.html#aebf442425c9fe0662ad5f60a61792500">RespirationRoot</a>;
<a name="l00113"></a>00113    <a class="code" href="classcrop_ryegrass.html#ae11486448ac560cb05033e804aea5316">TransferRate</a>           =(1-fraction)*<a class="code" href="classcrop_ryegrass.html#ae11486448ac560cb05033e804aea5316">TransferRate</a> + fraction*c-&gt;<a class="code" href="classcrop_ryegrass.html#ae11486448ac560cb05033e804aea5316">TransferRate</a>;
<a name="l00114"></a>00114    <a class="code" href="classcrop_ryegrass.html#a425c715cfd92033db6af5b091903af98">RecycleFraction</a>        =(1-<a class="code" href="typer_8h.html#ae4c405e5c68c6ec2c44bb6d6adfc2f6cab10366ecc76133a0a4a4712a5ee26f65">fraction</a>)*<a class="code" href="classcrop_ryegrass.html#a425c715cfd92033db6af5b091903af98">RecycleFraction</a> + fraction*c-&gt;<a class="code" href="classcrop_ryegrass.html#a425c715cfd92033db6af5b091903af98">RecycleFraction</a>;
<a name="l00115"></a>00115    <a class="code" href="classcrop_ryegrass.html#a3f0d73c30fb6fe15198a3beca5a68a6e">TemperatureSumAfterCut</a> =(1-fraction)*<a class="code" href="classcrop_ryegrass.html#a3f0d73c30fb6fe15198a3beca5a68a6e">TemperatureSumAfterCut</a> + fraction*c-&gt;<a class="code" href="classcrop_ryegrass.html#a3f0d73c30fb6fe15198a3beca5a68a6e">TemperatureSumAfterCut</a>;
<a name="l00116"></a>00116    <a class="code" href="classcrop_ryegrass.html#a75af628b7d7bb576d4c9285391d292b2">CutDelay</a>               =(1-<a class="code" href="typer_8h.html#ae4c405e5c68c6ec2c44bb6d6adfc2f6cab10366ecc76133a0a4a4712a5ee26f65">fraction</a>)*<a class="code" href="classcrop_ryegrass.html#a75af628b7d7bb576d4c9285391d292b2">CutDelay</a> + fraction*c-&gt;<a class="code" href="classcrop_ryegrass.html#a75af628b7d7bb576d4c9285391d292b2">CutDelay</a>;
<a name="l00117"></a>00117    for (<span class="keywordtype">int</span> i=0;i&lt;4;i++)
<a name="l00118"></a>00118    {
<a name="l00119"></a>00119       <a class="code" href="classcrop_ryegrass.html#ae9641d6c7c5459eb6053cb421df4e8d0">AgeClassTop</a>[i]=(1-<a class="code" href="typer_8h.html#ae4c405e5c68c6ec2c44bb6d6adfc2f6cab10366ecc76133a0a4a4712a5ee26f65">fraction</a>)*<a class="code" href="classcrop_ryegrass.html#ae9641d6c7c5459eb6053cb421df4e8d0">AgeClassTop</a>[i]+fraction*c-&gt;<a class="code" href="classcrop_ryegrass.html#ae9641d6c7c5459eb6053cb421df4e8d0">AgeClassTop</a>[i];
<a name="l00120"></a>00120            <a class="code" href="classcrop_ryegrass.html#a60b9ccc77a862693545200a71d113608">grazedDM</a>[i]=(1-fraction)*<a class="code" href="classcrop_ryegrass.html#a60b9ccc77a862693545200a71d113608">grazedDM</a>[i]+fraction*c-&gt;<a class="code" href="classcrop_ryegrass.html#a60b9ccc77a862693545200a71d113608">grazedDM</a>[i];
<a name="l00121"></a>00121       <a class="code" href="classcrop_ryegrass.html#a445c84d8258d5047e62dcd3d222cf8bd">uptakeWeight</a>[i]     = (1-<a class="code" href="typer_8h.html#ae4c405e5c68c6ec2c44bb6d6adfc2f6cab10366ecc76133a0a4a4712a5ee26f65">fraction</a>)*<a class="code" href="classcrop_ryegrass.html#a445c84d8258d5047e62dcd3d222cf8bd">uptakeWeight</a>[i]+fraction*c-&gt;<a class="code" href="classcrop_ryegrass.html#a445c84d8258d5047e62dcd3d222cf8bd">uptakeWeight</a>[i];
<a name="l00122"></a>00122    }
<a name="l00123"></a>00123 }
<a name="l00124"></a>00124 
<a name="l00125"></a>00125 <span class="comment">/****************************************************************************\</span>
<a name="l00126"></a>00126 <span class="comment">\****************************************************************************/</span>
<a name="l00127"></a><a class="code" href="classcrop_ryegrass.html#af7eb9cc81f755e89fc1486cc242b8b84">00127</a> <a class="code" href="classcrop_ryegrass.html">cropRyegrass</a> * <a class="code" href="classcrop_ryegrass.html#af7eb9cc81f755e89fc1486cc242b8b84">cropRyegrass::clone</a>()
<a name="l00128"></a>00128 {
<a name="l00129"></a>00129    <a class="code" href="classcrop_ryegrass.html">cropRyegrass</a>* aClone = <span class="keyword">new</span> <a class="code" href="classcrop_ryegrass.html#a50501af696bb68d2c124f75fc03a904c">cropRyegrass</a>(*<span class="keyword">this</span>);
<a name="l00130"></a>00130    <span class="keywordflow">return</span> aClone;
<a name="l00131"></a>00131 }
<a name="l00132"></a>00132 
<a name="l00133"></a>00133 
<a name="l00134"></a>00134 <span class="comment">/****************************************************************************\</span>
<a name="l00135"></a>00135 <span class="comment">An externally given cutting height should replace fractionLeft !!!</span>
<a name="l00136"></a>00136 <span class="comment">JBE implemented this @@@</span>
<a name="l00137"></a>00137 <span class="comment">\****************************************************************************/</span>
<a name="l00138"></a><a class="code" href="classcrop_ryegrass.html#ad72a3a888551fd165455cf75bd59cbf1">00138</a> <span class="keywordtype">void</span> <a class="code" href="classcrop_ryegrass.html#ad72a3a888551fd165455cf75bd59cbf1">cropRyegrass::GrazeOrCut</a>(<a class="code" href="classdecomposable.html">decomposable</a>* Hay,<span class="keywordtype">double</span> fractionLeft, <span class="keywordtype">bool</span> graze)
<a name="l00139"></a>00139 {
<a name="l00140"></a>00140    <a class="code" href="message_8h.html#a8ad29009121a629982c6ade0bd332470">theMessage</a>-&gt;<a class="code" href="classmessage.html#afed66d0552f90b4385c5169cf5929907">WarningWithDisplay</a>(<span class="stringliteral">&quot;cropRyegrass::GrazeOrCut should never be called - use cropRyegrass::Cut instead. Bj�rn, things to do !!!&quot;</span>);
<a name="l00141"></a>00141    <a class="code" href="classcrop.html#a8e7d3a42d931c8c1d95f92bb2669f2ef" title="Describe if a plan has been cut or harvested.">CutOrHarvested</a> = <span class="keyword">true</span>;
<a name="l00142"></a>00142    <a class="code" href="classcrop.html#a3f40980535ac184d9cced18aff1a0f8c">PlantHeight</a> = <a class="code" href="classcrop.html#a3f40980535ac184d9cced18aff1a0f8c">PlantHeight</a>*fractionLeft;
<a name="l00143"></a>00143    <span class="keywordflow">if</span> (<a class="code" href="classcrop_ryegrass.html#aedd4ae77832a94a71902085022f1eb88">GiveDryMatterVegTop</a>()&lt;=0.0)
<a name="l00144"></a>00144       <a class="code" href="message_8h.html#a8ad29009121a629982c6ade0bd332470">theMessage</a>-&gt;<a class="code" href="classmessage.html#afed66d0552f90b4385c5169cf5929907">WarningWithDisplay</a>(<span class="stringliteral">&quot;cropRyegrass::Cut/Graze - vegetative top must be bigger than zero here&quot;</span>);
<a name="l00145"></a>00145 
<a name="l00146"></a>00146    Hay-&gt;<a class="code" href="classproduct.html#a0219cde65dc26376f3371a0138199ba8">Setname</a>(<a class="code" href="classcrop.html#aa2aceced21d0fee166e40a836c2ee9cc">StrawItemName</a>);
<a name="l00147"></a>00147    <a class="code" href="_new_main_8cpp.html#af1019990138497f1f18cc7294737d140">theProducts</a>-&gt;<a class="code" href="classproducts.html#a8bd239aabc0a167741c02882e305d65d">GiveProductInformation</a>(Hay);
<a name="l00148"></a>00148    Hay-&gt;<a class="code" href="classlive_matter.html#ad058ede27a28aa89754500d5ccbbdd8a">RemoveWater</a>();
<a name="l00149"></a>00149 
<a name="l00150"></a>00150    <span class="keywordtype">double</span> aDryMatterInVegTop = <a class="code" href="classcrop_ryegrass.html#aedd4ae77832a94a71902085022f1eb88">GiveDryMatterVegTop</a>();
<a name="l00151"></a>00151    <a class="code" href="classnitrogen.html">nitrogen</a> aNitrogenInVegTop = <a class="code" href="classcrop.html#a82bef6e98553aa173173b0ea454a3e0a">NitrogenInVegTop</a>();
<a name="l00152"></a>00152    <span class="keywordflow">if</span> (aDryMatterInVegTop &gt; 0)
<a name="l00153"></a>00153    {
<a name="l00154"></a>00154                 Hay-&gt;<a class="code" href="classproduct.html#a18ec2e96f1d9b7cef74c4b2800ebdca1">Setamount</a>(aDryMatterInVegTop*(1-fractionLeft));
<a name="l00155"></a>00155       Hay-&gt;<a class="code" href="classlive_matter.html#adbb45be219dd863cfad2b5e97cde1508">SetorgN_content</a>(aNitrogenInVegTop/(aDryMatterInVegTop*(1-fractionLeft)));    <span class="comment">//MEL 2009</span>
<a name="l00156"></a>00156    }
<a name="l00157"></a>00157    <span class="keywordflow">else</span>
<a name="l00158"></a>00158         <a class="code" href="message_8h.html#a8ad29009121a629982c6ade0bd332470">theMessage</a>-&gt;<a class="code" href="classmessage.html#aacaa1466698a349689502491cf089f72">Warning</a>(<span class="stringliteral">&quot;RyeGrass:: Nothing to cut/graze&quot;</span>);
<a name="l00159"></a>00159 
<a name="l00160"></a>00160 
<a name="l00161"></a>00161    <span class="keywordtype">double</span> WeightedAverage = 0.0;                         <span class="comment">// JB implemented the selectively grazing 6/9/2002</span>
<a name="l00162"></a>00162    <span class="keywordtype">double</span> IntakeSelectivity [] = {0.4,0.3,0.2,0.1};
<a name="l00163"></a>00163 <span class="preprocessor">#ifdef BIOMODTEST</span>
<a name="l00164"></a>00164 <span class="preprocessor"></span>        <span class="keywordflow">if</span> (!graze)
<a name="l00165"></a>00165    {
<a name="l00166"></a>00166       <a class="code" href="classcrop_ryegrass.html#a3f0d73c30fb6fe15198a3beca5a68a6e">TemperatureSumAfterCut</a> = 0.0;                      <span class="comment">// Reset temperature sum</span>
<a name="l00167"></a>00167       <a class="code" href="classcrop_ryegrass.html#a75af628b7d7bb576d4c9285391d292b2">CutDelay</a> = 300.0*<a class="code" href="classcrop.html#ae5c58459f879a52a543bc517918513fd">DryMatterTotalStandVegTop</a>*(1.0-fractionLeft)/350.0;       <span class="comment">// from K. S�egaard p 21.</span>
<a name="l00168"></a>00168       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;4;i++) IntakeSelectivity[i] = 0.25;
<a name="l00169"></a>00169    }
<a name="l00170"></a>00170 <span class="preprocessor">#endif</span>
<a name="l00171"></a>00171 <span class="preprocessor"></span>   <a class="code" href="classnitrogen.html">nitrogen</a> HayN =  Hay-&gt;<a class="code" href="classlive_matter.html#ac4b95fdff5ad224d9aa1541589c64663">GetorgN_content</a>()*Hay-&gt;<a class="code" href="classproduct.html#a021ebef2da57e1d977cfe57e62c6e38b">GetAmount</a>();
<a name="l00172"></a>00172    <a class="code" href="classcrop.html#adabbdde8753e5ae0ecd238e221429d88" title="How much Nitrogen that is in the plant.">Nitrogen</a> = <a class="code" href="classcrop.html#adabbdde8753e5ae0ecd238e221429d88" title="How much Nitrogen that is in the plant.">Nitrogen</a> - HayN;
<a name="l00173"></a>00173 
<a name="l00174"></a>00174    <span class="keywordtype">double</span> RemoveDM = (1.0-fractionLeft)*<a class="code" href="classcrop_ryegrass.html#aedd4ae77832a94a71902085022f1eb88">GiveDryMatterVegTop</a>();       <span class="comment">// DM to remove</span>
<a name="l00175"></a>00175         <span class="keywordtype">double</span> Removed = RemoveDM;
<a name="l00176"></a>00176         <span class="keywordflow">while</span> (Removed&gt;1e-10)
<a name="l00177"></a>00177    {
<a name="l00178"></a>00178       WeightedAverage = 0.0;
<a name="l00179"></a>00179         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;4;i++)
<a name="l00180"></a>00180                 WeightedAverage += IntakeSelectivity[i]*<a class="code" href="classcrop_ryegrass.html#ae9641d6c7c5459eb6053cb421df4e8d0">AgeClassTop</a>[i];
<a name="l00181"></a>00181 
<a name="l00182"></a>00182         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;4;i++)
<a name="l00183"></a>00183         {
<a name="l00184"></a>00184          <span class="keywordtype">double</span> DMRemove = min(<a class="code" href="classcrop_ryegrass.html#ae9641d6c7c5459eb6053cb421df4e8d0">AgeClassTop</a>[i],RemoveDM*IntakeSelectivity[i]*<a class="code" href="classcrop_ryegrass.html#ae9641d6c7c5459eb6053cb421df4e8d0">AgeClassTop</a>[i]/WeightedAverage);
<a name="l00185"></a>00185                 <a class="code" href="classcrop_ryegrass.html#ae9641d6c7c5459eb6053cb421df4e8d0">AgeClassTop</a>[i] -= DMRemove;
<a name="l00186"></a>00186          Removed -= DMRemove;
<a name="l00187"></a>00187         }
<a name="l00188"></a>00188       RemoveDM = Removed;
<a name="l00189"></a>00189    }
<a name="l00190"></a>00190 
<a name="l00191"></a>00191    <a class="code" href="classcrop.html#a755b12e801a538bb34a8c7b829047e76">DryMatterVegTop</a>=<a class="code" href="classcrop_ryegrass.html#aedd4ae77832a94a71902085022f1eb88">GiveDryMatterVegTop</a>();       <span class="comment">// updates drymattervegtop</span>
<a name="l00192"></a>00192    <a class="code" href="classcrop_ryegrass.html#a573d23b1d622e156001cae5c45203bc0">CalcLeafAreaIndices</a>();
<a name="l00193"></a>00193 
<a name="l00194"></a>00194    <a class="code" href="classcrop.html#af7ae14fac12af3efa728e789155983fb">Nbudget</a>.<a class="code" href="classbudget.html#a47bfa9740186f2be18a10dd3423a5eea">AddOutput</a>(HayN.n);                    <span class="comment">// Budgets</span>
<a name="l00195"></a>00195    <a class="code" href="classcrop.html#a3e5fad944be35152e933b5e50f928f5a">N15budget</a>.<a class="code" href="classbudget.html#a47bfa9740186f2be18a10dd3423a5eea">AddOutput</a>(HayN.n15);
<a name="l00196"></a>00196    <a class="code" href="classcrop.html#a46844fd0540eb7627555f21afa8545e8">DMbudget</a>.<a class="code" href="classbudget.html#a47bfa9740186f2be18a10dd3423a5eea">AddOutput</a>(Hay-&gt;<a class="code" href="classproduct.html#a021ebef2da57e1d977cfe57e62c6e38b">GetAmount</a>());
<a name="l00197"></a>00197 
<a name="l00198"></a>00198    <span class="keywordtype">double</span> NRemain, DMRemain;
<a name="l00199"></a>00199    <a class="code" href="classcrop_ryegrass.html#a5bb3f7b2ad5805e527bea21bbb71531c">EndBudget</a>(&amp;NRemain,&amp;DMRemain);
<a name="l00200"></a>00200    <a class="code" href="classcrop_ryegrass.html#affc800f21a3c26e2277a8e5679c27204">HasBeenCut</a>=<span class="keyword">true</span>;
<a name="l00201"></a>00201    <a class="code" href="classcrop.html#a38f05d3f77cfc67ff755eb8c0d79e301">Phenology</a>-&gt;<a class="code" href="classphenology.html#aca23c5511f877cde110a2ee69f98463d">SetDSAfterCut</a>();
<a name="l00202"></a>00202 }
<a name="l00203"></a>00203 
<a name="l00204"></a>00204 <span class="comment">/****************************************************************************\</span>
<a name="l00205"></a>00205 <span class="comment">\****************************************************************************/</span>
<a name="l00206"></a><a class="code" href="classcrop_ryegrass.html#a33a0c70645ce03afc49541e8d3f4919b">00206</a> <span class="keywordtype">void</span> <a class="code" href="classcrop_ryegrass.html#a33a0c70645ce03afc49541e8d3f4919b" title="harvests all aboveground dry matter. Is used for harvesting non-forage crops">cropRyegrass::Harvest</a>(<a class="code" href="classdecomposable.html">decomposable</a>* Storage, <a class="code" href="classdecomposable.html">decomposable</a>* Straw)
<a name="l00207"></a>00207 {
<a name="l00208"></a>00208    <a class="code" href="classcrop.html#a8e7d3a42d931c8c1d95f92bb2669f2ef" title="Describe if a plan has been cut or harvested.">CutOrHarvested</a> = <span class="keyword">true</span>;
<a name="l00209"></a>00209    <span class="keywordtype">double</span> CuttingHeight = 0.1;
<a name="l00210"></a>00210    <span class="keywordtype">double</span> RatioStrawCut = (<a class="code" href="classcrop.html#a3f40980535ac184d9cced18aff1a0f8c">PlantHeight</a>-CuttingHeight)/<a class="code" href="classcrop.html#a3f40980535ac184d9cced18aff1a0f8c">PlantHeight</a>;
<a name="l00211"></a>00211    <span class="comment">//   Storage-&gt;Setname(PlantItemName);</span>
<a name="l00212"></a>00212    <span class="comment">//   if (PlantItemName!=&quot;&quot;)</span>
<a name="l00213"></a>00213       Storage-&gt;<a class="code" href="classproduct.html#a0219cde65dc26376f3371a0138199ba8">Setname</a>(<span class="stringliteral">&quot;GRASSSEED&quot;</span>);
<a name="l00214"></a>00214    <span class="comment">//   if (PlantItemName!=&quot;&quot;)</span>
<a name="l00215"></a>00215       {
<a name="l00216"></a>00216            <a class="code" href="_new_main_8cpp.html#af1019990138497f1f18cc7294737d140">theProducts</a>-&gt;<a class="code" href="classproducts.html#a8bd239aabc0a167741c02882e305d65d">GiveProductInformation</a>(Storage);
<a name="l00217"></a>00217            Storage-&gt;<a class="code" href="classproduct.html#a18ec2e96f1d9b7cef74c4b2800ebdca1">Setamount</a>(<a class="code" href="classcrop.html#a4a2803c0618d2f662abfa8d230c811df">DryMatterStorage</a>/Storage-&gt;<a class="code" href="classlive_matter.html#ad3d05f1e8ceedc99e214adca94638de0">GetdryMatter</a>());
<a name="l00218"></a>00218       }
<a name="l00219"></a>00219 
<a name="l00220"></a>00220    <span class="comment">//   Straw-&gt;Setname(StrawItemName);</span>
<a name="l00221"></a>00221       Straw-&gt;<a class="code" href="classproduct.html#a0219cde65dc26376f3371a0138199ba8">Setname</a>(<span class="stringliteral">&quot;GRASSSEEDSTRAW&quot;</span>);
<a name="l00222"></a>00222    <a class="code" href="_new_main_8cpp.html#af1019990138497f1f18cc7294737d140">theProducts</a>-&gt;<a class="code" href="classproducts.html#a8bd239aabc0a167741c02882e305d65d">GiveProductInformation</a>(Straw);
<a name="l00223"></a>00223    Straw-&gt;<a class="code" href="classproduct.html#a18ec2e96f1d9b7cef74c4b2800ebdca1">Setamount</a>(<a class="code" href="classcrop_ryegrass.html#aedd4ae77832a94a71902085022f1eb88">GiveDryMatterVegTop</a>()*RatioStrawCut/Straw-&gt;<a class="code" href="classlive_matter.html#ad3d05f1e8ceedc99e214adca94638de0">GetdryMatter</a>());
<a name="l00224"></a>00224 
<a name="l00225"></a>00225    <span class="comment">// Nitrogen</span>
<a name="l00226"></a>00226         <a class="code" href="classnitrogen.html">nitrogen</a> RootN, StorageN, StrawN;
<a name="l00227"></a>00227 
<a name="l00228"></a>00228    <span class="comment">//check amount of nitrogen at harvest</span>
<a name="l00229"></a>00229    <span class="keywordtype">double</span> minimumN = <a class="code" href="classcrop.html#adc9f2a384dfd4be26746b822c4324f37">Nmin</a>();
<a name="l00230"></a>00230    <span class="keywordtype">double</span> maximumN = <a class="code" href="classcrop_ryegrass.html#aac89498ebd762c28e8bed76ec7c78db0">Nmax</a>();
<a name="l00231"></a>00231 
<a name="l00232"></a>00232    <span class="keywordflow">if</span> (minimumN &gt; <a class="code" href="classcrop.html#adabbdde8753e5ae0ecd238e221429d88" title="How much Nitrogen that is in the plant.">Nitrogen</a>.<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a> * 1.25)  <span class="comment">//Corrected MEL 2009</span>
<a name="l00233"></a>00233    {
<a name="l00234"></a>00234       cout &lt;&lt; <a class="code" href="classbase.html#aae39ec3da4311af6b93e424d29b2c66a">GetLongName</a>() &lt;&lt; endl;
<a name="l00235"></a>00235         <a class="code" href="message_8h.html#a8ad29009121a629982c6ade0bd332470">theMessage</a>-&gt;<a class="code" href="classmessage.html#afed66d0552f90b4385c5169cf5929907">WarningWithDisplay</a>(<span class="stringliteral">&quot;crop::Harvest - not enough nitrogen in plant at harvest&quot;</span>);
<a name="l00236"></a>00236    }
<a name="l00237"></a>00237    <span class="keywordflow">if</span> (maximumN &lt; <a class="code" href="classcrop.html#adabbdde8753e5ae0ecd238e221429d88" title="How much Nitrogen that is in the plant.">Nitrogen</a>.<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a> * 0.75)  <span class="comment">//Corrected MEL 2009</span>
<a name="l00238"></a>00238    {
<a name="l00239"></a>00239       cout &lt;&lt; <a class="code" href="classbase.html#aae39ec3da4311af6b93e424d29b2c66a">GetLongName</a>() &lt;&lt; endl;
<a name="l00240"></a>00240            <a class="code" href="message_8h.html#a8ad29009121a629982c6ade0bd332470">theMessage</a>-&gt;<a class="code" href="classmessage.html#afed66d0552f90b4385c5169cf5929907">WarningWithDisplay</a>(<span class="stringliteral">&quot;crop::Harvest - too much nitrogen in plant at harvest&quot;</span>);
<a name="l00241"></a>00241    }
<a name="l00242"></a>00242    <span class="comment">//partition between compartments</span>
<a name="l00243"></a>00243    <span class="keywordtype">double</span> fN = <a class="code" href="classcrop.html#a602622ac2c0de6432e6b9438dbbb646b">fNitrogen</a>();
<a name="l00244"></a>00244         <span class="keywordtype">double</span> TotalRootN  = (<a class="code" href="classcrop.html#a4ec1369c2adcd701d7c4676fce24310c">MinN_Root</a>+fN*(<a class="code" href="classcrop.html#a62361ade607f9cc57e226c1134ad0eb2">MaxN_Root</a>-<a class="code" href="classcrop.html#a4ec1369c2adcd701d7c4676fce24310c">MinN_Root</a>))*<a class="code" href="classcrop.html#a3c5f4942cf46d45168caf4da80b79537">DryMatterRoot</a>;
<a name="l00245"></a>00245    <span class="keywordtype">double</span> TotStorageN = (<a class="code" href="classcrop.html#a3a411cb751e18aaf088d266ee47c9420">MinN_Store</a>+fN*(<a class="code" href="classcrop.html#a9f5ab366fce6f1259588cf5087cdb4c2">MaxN_Store</a>-<a class="code" href="classcrop.html#a3a411cb751e18aaf088d266ee47c9420">MinN_Store</a>))*<a class="code" href="classcrop.html#a4a2803c0618d2f662abfa8d230c811df">DryMatterStorage</a>;
<a name="l00246"></a>00246    <span class="keywordtype">double</span> N15Ratio    = <a class="code" href="classcrop.html#adabbdde8753e5ae0ecd238e221429d88" title="How much Nitrogen that is in the plant.">Nitrogen</a>.<a class="code" href="classnitrogen.html#ac97f3ebad4801a13a7c444bab3b3a886">Get15NRatio</a>();
<a name="l00247"></a>00247    <span class="keywordtype">double</span> TotalStrawN =  (<a class="code" href="classcrop.html#a10c59f3f5b94ba41a4678e68d6e559b2">NpctMinVegTop</a>()/100+fN*(<a class="code" href="classcrop.html#a32e4925865c2310ccc9efc0df1cec1bb">NpctMaxVegTop</a>()-<a class="code" href="classcrop.html#a10c59f3f5b94ba41a4678e68d6e559b2">NpctMinVegTop</a>())/100)*<a class="code" href="classcrop_ryegrass.html#aedd4ae77832a94a71902085022f1eb88">GiveDryMatterVegTop</a>();
<a name="l00248"></a>00248    <span class="keywordtype">double</span> Nrest = <a class="code" href="classcrop.html#adabbdde8753e5ae0ecd238e221429d88" title="How much Nitrogen that is in the plant.">Nitrogen</a>.<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a> - TotalRootN - TotStorageN - TotalStrawN;
<a name="l00249"></a>00249 
<a name="l00250"></a>00250    <span class="keywordflow">if</span> ((Nrest&lt;-0.01)||(Nrest&gt;0.01))
<a name="l00251"></a>00251    {
<a name="l00252"></a>00252       <a class="code" href="message_8h.html#a8ad29009121a629982c6ade0bd332470">theMessage</a>-&gt;<a class="code" href="classmessage.html#afed66d0552f90b4385c5169cf5929907">WarningWithDisplay</a>(<span class="stringliteral">&quot;crop::Harvest - Nitrogen content adjusted&quot;</span>);
<a name="l00253"></a>00253         <span class="keywordtype">double</span> RedFac = (<a class="code" href="classcrop.html#adabbdde8753e5ae0ecd238e221429d88" title="How much Nitrogen that is in the plant.">Nitrogen</a>.<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a>+Nrest)/<a class="code" href="classcrop.html#adabbdde8753e5ae0ecd238e221429d88" title="How much Nitrogen that is in the plant.">Nitrogen</a>.<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a>;
<a name="l00254"></a>00254                 TotalRootN = RedFac*TotalRootN;
<a name="l00255"></a>00255         TotStorageN = RedFac*TotStorageN;
<a name="l00256"></a>00256    }
<a name="l00257"></a>00257 
<a name="l00258"></a>00258 
<a name="l00259"></a>00259    RootN.<a class="code" href="classnitrogen.html#a49bebcba4c40f3c0a6abb24f590b2c8c">SetBoth</a>(TotalRootN,N15Ratio*TotalRootN);
<a name="l00260"></a>00260    StorageN.<a class="code" href="classnitrogen.html#a49bebcba4c40f3c0a6abb24f590b2c8c">SetBoth</a>(TotStorageN,N15Ratio*TotStorageN);
<a name="l00261"></a>00261    StrawN = <a class="code" href="classcrop.html#adabbdde8753e5ae0ecd238e221429d88" title="How much Nitrogen that is in the plant.">Nitrogen</a> - RootN - StorageN;
<a name="l00262"></a>00262    <span class="keywordflow">if</span> (Storage-&gt;<a class="code" href="classproduct.html#a021ebef2da57e1d977cfe57e62c6e38b">GetAmount</a>()&gt;0)
<a name="l00263"></a>00263         Storage-&gt;<a class="code" href="classlive_matter.html#adbb45be219dd863cfad2b5e97cde1508">SetorgN_content</a>(StorageN/Storage-&gt;<a class="code" href="classproduct.html#a021ebef2da57e1d977cfe57e62c6e38b">GetAmount</a>());
<a name="l00264"></a>00264    <span class="keywordflow">if</span> (Straw-&gt;<a class="code" href="classproduct.html#a021ebef2da57e1d977cfe57e62c6e38b">GetAmount</a>()&gt;0)
<a name="l00265"></a>00265                 Straw-&gt;<a class="code" href="classlive_matter.html#adbb45be219dd863cfad2b5e97cde1508">SetorgN_content</a>(StrawN/Straw-&gt;<a class="code" href="classproduct.html#a021ebef2da57e1d977cfe57e62c6e38b">GetAmount</a>());
<a name="l00266"></a>00266 
<a name="l00267"></a>00267         <a class="code" href="classcrop.html#adabbdde8753e5ae0ecd238e221429d88" title="How much Nitrogen that is in the plant.">Nitrogen</a> = <a class="code" href="classcrop.html#adabbdde8753e5ae0ecd238e221429d88" title="How much Nitrogen that is in the plant.">Nitrogen</a>-StorageN -StrawN;
<a name="l00268"></a>00268         <span class="keywordflow">if</span> (!<a class="code" href="classcrop.html#a38f05d3f77cfc67ff755eb8c0d79e301">Phenology</a>-&gt;<a class="code" href="classphenology.html#a906583e45eeda4d8a6e1cec487a272cc" title="return true if planed is ready to be ripped">Ripe</a>())
<a name="l00269"></a>00269       <a class="code" href="message_8h.html#a8ad29009121a629982c6ade0bd332470">theMessage</a>-&gt;<a class="code" href="classmessage.html#aacaa1466698a349689502491cf089f72">Warning</a>(<span class="stringliteral">&quot;crop::Harvest - crop not ready for harvest&quot;</span>);
<a name="l00270"></a>00270    <span class="keywordflow">if</span> (<a class="code" href="classcrop_ryegrass.html#aedd4ae77832a94a71902085022f1eb88">GiveDryMatterVegTop</a>()&lt;0 || <a class="code" href="classcrop.html#a4a2803c0618d2f662abfa8d230c811df">DryMatterStorage</a>&lt;0 || StorageN.n&lt;0 || StrawN.n&lt;0 || <a class="code" href="classcrop.html#adabbdde8753e5ae0ecd238e221429d88" title="How much Nitrogen that is in the plant.">Nitrogen</a>.<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a>&lt;0)
<a name="l00271"></a>00271    {
<a name="l00272"></a>00272            <a class="code" href="message_8h.html#a8ad29009121a629982c6ade0bd332470">theMessage</a>-&gt;<a class="code" href="classmessage.html#afed66d0552f90b4385c5169cf5929907">WarningWithDisplay</a>(<span class="stringliteral">&quot;crop:: Harvest values should not be negative&quot;</span>);
<a name="l00273"></a>00273       StorageN.n = max(0.0,StorageN.n);
<a name="l00274"></a>00274       StrawN.n = max(0.0,StrawN.n);
<a name="l00275"></a>00275         }
<a name="l00276"></a>00276 
<a name="l00277"></a>00277    <a class="code" href="classcrop.html#af7ae14fac12af3efa728e789155983fb">Nbudget</a>.<a class="code" href="classbudget.html#a47bfa9740186f2be18a10dd3423a5eea">AddOutput</a>(StorageN.n+StrawN.n);                    <span class="comment">// Budgets</span>
<a name="l00278"></a>00278    <a class="code" href="classcrop.html#a3e5fad944be35152e933b5e50f928f5a">N15budget</a>.<a class="code" href="classbudget.html#a47bfa9740186f2be18a10dd3423a5eea">AddOutput</a>(StorageN.n15+StrawN.n15);                    <span class="comment">// Budgets</span>
<a name="l00279"></a>00279    <a class="code" href="classcrop.html#a46844fd0540eb7627555f21afa8545e8">DMbudget</a>.<a class="code" href="classbudget.html#a47bfa9740186f2be18a10dd3423a5eea">AddOutput</a>(<a class="code" href="classcrop_ryegrass.html#aedd4ae77832a94a71902085022f1eb88">GiveDryMatterVegTop</a>()*RatioStrawCut+<a class="code" href="classcrop.html#a4a2803c0618d2f662abfa8d230c811df">DryMatterStorage</a>);
<a name="l00280"></a>00280 
<a name="l00281"></a>00281    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;4;i++)
<a name="l00282"></a>00282         <a class="code" href="classcrop_ryegrass.html#ae9641d6c7c5459eb6053cb421df4e8d0">AgeClassTop</a>[i] -= RatioStrawCut*<a class="code" href="classcrop_ryegrass.html#ae9641d6c7c5459eb6053cb421df4e8d0">AgeClassTop</a>[i];
<a name="l00283"></a>00283         <a class="code" href="classcrop.html#a4a2803c0618d2f662abfa8d230c811df">DryMatterStorage</a>   = 0.0;
<a name="l00284"></a>00284         <a class="code" href="classcrop.html#a2691a60a48a5166469df5da0e0e824fb">GreenCropAreaIndex</a> = 0.1;
<a name="l00285"></a>00285         <a class="code" href="classcrop.html#a7acb3fa412808c819f4d9b662cc2148c">YellowCropAreaIndex</a>= 0.2;
<a name="l00286"></a>00286    <a class="code" href="classcrop.html#a3f40980535ac184d9cced18aff1a0f8c">PlantHeight</a>        = 0.1;                      <span class="comment">// Modify to real cutting height!!!!!</span>
<a name="l00287"></a>00287         <a class="code" href="classcrop.html#a4a8b0a766947fe8b0dfc6a59a24b9bef">topMatter</a>          = NULL;
<a name="l00288"></a>00288 
<a name="l00289"></a>00289    <span class="keywordtype">double</span> NRemain, DMRemain;
<a name="l00290"></a>00290    <a class="code" href="classcrop_ryegrass.html#a5bb3f7b2ad5805e527bea21bbb71531c">EndBudget</a>(&amp;NRemain,&amp;DMRemain);
<a name="l00291"></a>00291    <a class="code" href="classcrop.html#a38f05d3f77cfc67ff755eb8c0d79e301">Phenology</a>-&gt;<a class="code" href="classphenology.html#aca23c5511f877cde110a2ee69f98463d">SetDSAfterCut</a>();
<a name="l00292"></a>00292    <a class="code" href="classcrop_ryegrass.html#affc800f21a3c26e2277a8e5679c27204">HasBeenCut</a> = <span class="keyword">true</span>;
<a name="l00293"></a>00293 }
<a name="l00294"></a>00294 <span class="comment">/****************************************************************************\</span>
<a name="l00295"></a>00295 <span class="comment">Ripe senescence including DS setback and loss of grains to topmatter</span>
<a name="l00296"></a>00296 <span class="comment">\****************************************************************************/</span>
<a name="l00297"></a><a class="code" href="classcrop_ryegrass.html#a65e6d648842b070c8dfe343d548dee1c">00297</a> <span class="keywordtype">void</span> <a class="code" href="classcrop_ryegrass.html#a65e6d648842b070c8dfe343d548dee1c">cropRyegrass::RipeSenescence</a>()
<a name="l00298"></a>00298 {
<a name="l00299"></a>00299    <a class="code" href="classcrop.html#a38f05d3f77cfc67ff755eb8c0d79e301">Phenology</a>-&gt;<a class="code" href="classphenology.html#aca23c5511f877cde110a2ee69f98463d">SetDSAfterCut</a>();
<a name="l00300"></a>00300    <span class="keywordflow">if</span> (<a class="code" href="classcrop.html#a4a2803c0618d2f662abfa8d230c811df">DryMatterStorage</a>&gt; 0.0)
<a name="l00301"></a>00301    {
<a name="l00302"></a>00302         <a class="code" href="classnitrogen.html">nitrogen</a> aNitrogenInStorage = <a class="code" href="classcrop.html#a4f4f31c68a905ef3fef26b9d7456cb36">NitrogenInStorage</a>();
<a name="l00303"></a>00303       <span class="keywordtype">double</span> aDryMatterStorage = <a class="code" href="classcrop.html#ab8db7f88fbd260a4e8b7dbb735490753">GiveDryMatterStorage</a>();
<a name="l00304"></a>00304                 <span class="keywordtype">double</span> RSeneStorage=min(<a class="code" href="classcrop_ryegrass.html#ad38b65aa16d9136baee37d9f6faff1a0">RateOfRipeReSeed</a>*<a class="code" href="classcrop.html#af01aa0fd15613a9e2fcb2a23ca089d5f">TemperatureEffect</a>(<a class="code" href="classcrop.html#abfc8df1469f20d8084f744da461d1df5">temp</a>)*aDryMatterStorage,aDryMatterStorage);
<a name="l00305"></a>00305 
<a name="l00306"></a>00306         <span class="keywordflow">if</span> (RSeneStorage&gt;0.0)
<a name="l00307"></a>00307         {
<a name="l00308"></a>00308 
<a name="l00309"></a>00309         <a class="code" href="classcrop.html#a4a2803c0618d2f662abfa8d230c811df">DryMatterStorage</a> -= RSeneStorage;
<a name="l00310"></a>00310 
<a name="l00311"></a>00311         <span class="comment">// Transfer DM to ReSeedDM</span>
<a name="l00312"></a>00312          <a class="code" href="classcrop_ryegrass.html#a20afe6ee954c51fafe8d0c184c395c65">ReSeedDM</a> += RSeneStorage;
<a name="l00313"></a>00313        }
<a name="l00314"></a>00314    }
<a name="l00315"></a>00315 
<a name="l00316"></a>00316       <span class="comment">//Hvad mere??</span>
<a name="l00317"></a>00317 }
<a name="l00318"></a>00318 <span class="comment">/****************************************************************************\</span>
<a name="l00319"></a>00319 <span class="comment">\****************************************************************************/</span>
<a name="l00320"></a><a class="code" href="classcrop_ryegrass.html#a7b2e92086e8aa5ae0d41c5b7e7678181">00320</a> <span class="keywordtype">void</span> <a class="code" href="classcrop_ryegrass.html#a7b2e92086e8aa5ae0d41c5b7e7678181">cropRyegrass::RootDecay</a>(<span class="keywordtype">double</span> RootTranslocation)
<a name="l00321"></a>00321 {
<a name="l00322"></a>00322    <a class="code" href="classcrop_ryegrass.html#a7b2e92086e8aa5ae0d41c5b7e7678181">crop::RootDecay</a>(RootTranslocation);
<a name="l00323"></a>00323    <a class="code" href="classcrop.html#ab27528bd7fd066f3c4e028de1fbc70e1">RootRespiration</a> = 0;
<a name="l00324"></a>00324 
<a name="l00325"></a>00325    <span class="comment">// Root respiration</span>
<a name="l00326"></a>00326    <span class="keywordflow">if</span> (<a class="code" href="classcrop.html#a3c5f4942cf46d45168caf4da80b79537">DryMatterRoot</a>&gt;0 &amp;&amp; <a class="code" href="classcrop.html#abfc8df1469f20d8084f744da461d1df5">temp</a>&gt;0)
<a name="l00327"></a>00327    {
<a name="l00328"></a>00328       <span class="keywordtype">double</span> SoilTemp=<a class="code" href="classcrop.html#aaf7bdd66e714b1ad4057bad5a46e6772">aSoil</a>-&gt;<a class="code" href="classsoil.html#a30a2ef147290c60895e4c389ad3c72b8" title="returns the temperature at a given depth in the profile">GetTemperature</a>(200);
<a name="l00329"></a>00329       <a class="code" href="classcrop.html#ab27528bd7fd066f3c4e028de1fbc70e1">RootRespiration</a>  = <a class="code" href="classcrop.html#a3c5f4942cf46d45168caf4da80b79537">DryMatterRoot</a>*<a class="code" href="classcrop_ryegrass.html#aebf442425c9fe0662ad5f60a61792500">RespirationRoot</a>*<a class="code" href="classcrop.html#af01aa0fd15613a9e2fcb2a23ca089d5f">TemperatureEffect</a>(SoilTemp);
<a name="l00330"></a>00330       <a class="code" href="classcrop.html#a3c5f4942cf46d45168caf4da80b79537">DryMatterRoot</a> -= <a class="code" href="classcrop.html#ab27528bd7fd066f3c4e028de1fbc70e1">RootRespiration</a>;
<a name="l00331"></a>00331       <a class="code" href="classcrop.html#a46844fd0540eb7627555f21afa8545e8">DMbudget</a>.<a class="code" href="classbudget.html#a47bfa9740186f2be18a10dd3423a5eea">AddOutput</a>(<a class="code" href="classcrop.html#ab27528bd7fd066f3c4e028de1fbc70e1">RootRespiration</a>);
<a name="l00332"></a>00332       <a class="code" href="classcrop.html#a9342a07dc579e1e3169eba7060741339">AccumulatedRootRespiration</a> += <a class="code" href="classcrop.html#ab27528bd7fd066f3c4e028de1fbc70e1">RootRespiration</a>;
<a name="l00333"></a>00333       <a class="code" href="classcrop.html#ac9e8384797116e758558faff120ae56d">AccumulatedDMProduction</a> -= <a class="code" href="classcrop.html#ab27528bd7fd066f3c4e028de1fbc70e1">RootRespiration</a>;         <span class="comment">// Respiration are not included in this budget!</span>
<a name="l00334"></a>00334       RootTranslocation -=  <a class="code" href="classcrop.html#ab27528bd7fd066f3c4e028de1fbc70e1">RootRespiration</a>;
<a name="l00335"></a>00335    }
<a name="l00336"></a>00336    <span class="comment">//MEL 2009</span>
<a name="l00337"></a>00337    <span class="keywordtype">double</span> minimumN = <a class="code" href="classcrop.html#adc9f2a384dfd4be26746b822c4324f37">Nmin</a>();
<a name="l00338"></a>00338    <span class="keywordtype">double</span> maximumN = <a class="code" href="classcrop_ryegrass.html#aac89498ebd762c28e8bed76ec7c78db0">Nmax</a>();
<a name="l00339"></a>00339    <span class="keywordflow">if</span> ((<a class="code" href="classcrop.html#a4a2803c0618d2f662abfa8d230c811df">DryMatterStorage</a> + <a class="code" href="classcrop.html#a3c5f4942cf46d45168caf4da80b79537">DryMatterRoot</a> + <a class="code" href="classcrop.html#a755b12e801a538bb34a8c7b829047e76">DryMatterVegTop</a> &gt; 0.0) &amp;&amp; (<a class="code" href="classcrop.html#adabbdde8753e5ae0ecd238e221429d88" title="How much Nitrogen that is in the plant.">Nitrogen</a>.<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a> &gt; 0.5))
<a name="l00340"></a>00340    {
<a name="l00341"></a>00341         <span class="keywordflow">if</span> (minimumN &gt; <a class="code" href="classcrop.html#adabbdde8753e5ae0ecd238e221429d88" title="How much Nitrogen that is in the plant.">Nitrogen</a>.<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a> * 1.25)
<a name="l00342"></a>00342       {
<a name="l00343"></a>00343         cout &lt;&lt; <a class="code" href="classbase.html#aae39ec3da4311af6b93e424d29b2c66a">GetLongName</a>() &lt;&lt; endl;
<a name="l00344"></a>00344                 <a class="code" href="message_8h.html#a8ad29009121a629982c6ade0bd332470">theMessage</a>-&gt;<a class="code" href="classmessage.html#afed66d0552f90b4385c5169cf5929907">WarningWithDisplay</a>(<span class="stringliteral">&quot;crop::RootDecay - not enough nitrogen in plant&quot;</span>);
<a name="l00345"></a>00345         }
<a name="l00346"></a>00346         <span class="keywordflow">if</span> (maximumN &lt; <a class="code" href="classcrop.html#adabbdde8753e5ae0ecd238e221429d88" title="How much Nitrogen that is in the plant.">Nitrogen</a>.<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a> * 0.75)
<a name="l00347"></a>00347         {
<a name="l00348"></a>00348         cout &lt;&lt; <a class="code" href="classbase.html#aae39ec3da4311af6b93e424d29b2c66a">GetLongName</a>() &lt;&lt; endl;
<a name="l00349"></a>00349                 <a class="code" href="message_8h.html#a8ad29009121a629982c6ade0bd332470">theMessage</a>-&gt;<a class="code" href="classmessage.html#afed66d0552f90b4385c5169cf5929907">WarningWithDisplay</a>(<span class="stringliteral">&quot;crop::RootDecay - too much nitrogen in plant&quot;</span>);
<a name="l00350"></a>00350       }
<a name="l00351"></a>00351    }
<a name="l00352"></a>00352 
<a name="l00353"></a>00353 }
<a name="l00354"></a>00354 
<a name="l00355"></a>00355 
<a name="l00356"></a>00356 <span class="comment">/****************************************************************************\</span>
<a name="l00357"></a>00357 <span class="comment">\****************************************************************************/</span>
<a name="l00358"></a><a class="code" href="classcrop_ryegrass.html#a81ee410c4677a88854065d2cbcecf4fc">00358</a> <span class="keywordtype">double</span> <a class="code" href="classcrop_ryegrass.html#a81ee410c4677a88854065d2cbcecf4fc">cropRyegrass::TopRespiration</a>()
<a name="l00359"></a>00359 {
<a name="l00360"></a>00360    <span class="keywordtype">double</span> topRespiration=0.0;
<a name="l00361"></a>00361    <span class="keywordtype">double</span> RespirationClass[] = {1.0,1.0,0.75,0.5};      <span class="comment">// respiration dependent on class number according to thornley p. 38</span>
<a name="l00362"></a>00362         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;4;i++)
<a name="l00363"></a>00363    {
<a name="l00364"></a>00364 
<a name="l00365"></a>00365       <span class="keywordtype">double</span> RespCoeff = RespirationClass[i]*<a class="code" href="classcrop_ryegrass.html#a28d4c2eb58e04a840f3be6277a13e51b">RespirationTop</a>*<a class="code" href="classcrop.html#af01aa0fd15613a9e2fcb2a23ca089d5f">TemperatureEffect</a>(<a class="code" href="classcrop.html#abfc8df1469f20d8084f744da461d1df5">temp</a>);
<a name="l00366"></a>00366       <span class="keywordtype">double</span> r=<a class="code" href="classcrop_ryegrass.html#ae9641d6c7c5459eb6053cb421df4e8d0">AgeClassTop</a>[i]*RespCoeff;
<a name="l00367"></a>00367 
<a name="l00368"></a>00368       <a class="code" href="classcrop_ryegrass.html#ae9641d6c7c5459eb6053cb421df4e8d0">AgeClassTop</a>[i] -= r;
<a name="l00369"></a>00369       topRespiration += r;
<a name="l00370"></a>00370    }
<a name="l00371"></a>00371    <a class="code" href="classcrop.html#a46844fd0540eb7627555f21afa8545e8">DMbudget</a>.<a class="code" href="classbudget.html#a47bfa9740186f2be18a10dd3423a5eea">AddOutput</a>(topRespiration);
<a name="l00372"></a>00372    <a class="code" href="classcrop.html#ac9e8384797116e758558faff120ae56d">AccumulatedDMProduction</a> -= topRespiration;
<a name="l00373"></a>00373 
<a name="l00374"></a>00374    <span class="comment">//Test nitrogen MEL 2009</span>
<a name="l00375"></a>00375    <span class="keywordtype">double</span> minimumN = <a class="code" href="classcrop.html#adc9f2a384dfd4be26746b822c4324f37">Nmin</a>();
<a name="l00376"></a>00376    <span class="keywordtype">double</span> maximumN = <a class="code" href="classcrop_ryegrass.html#aac89498ebd762c28e8bed76ec7c78db0">Nmax</a>();
<a name="l00377"></a>00377    <span class="keywordflow">if</span> ((<a class="code" href="classcrop.html#a4a2803c0618d2f662abfa8d230c811df">DryMatterStorage</a> + <a class="code" href="classcrop.html#a3c5f4942cf46d45168caf4da80b79537">DryMatterRoot</a> + <a class="code" href="classcrop.html#a755b12e801a538bb34a8c7b829047e76">DryMatterVegTop</a> &gt; 0.0) &amp;&amp; (<a class="code" href="classcrop.html#adabbdde8753e5ae0ecd238e221429d88" title="How much Nitrogen that is in the plant.">Nitrogen</a>.<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a> &gt; 0.5))
<a name="l00378"></a>00378    {
<a name="l00379"></a>00379         <span class="keywordflow">if</span> (minimumN &gt; <a class="code" href="classcrop.html#adabbdde8753e5ae0ecd238e221429d88" title="How much Nitrogen that is in the plant.">Nitrogen</a>.<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a> * 1.25)
<a name="l00380"></a>00380         {
<a name="l00381"></a>00381                 cout &lt;&lt; <a class="code" href="classbase.html#aae39ec3da4311af6b93e424d29b2c66a">GetLongName</a>() &lt;&lt; endl;
<a name="l00382"></a>00382         <a class="code" href="message_8h.html#a8ad29009121a629982c6ade0bd332470">theMessage</a>-&gt;<a class="code" href="classmessage.html#afed66d0552f90b4385c5169cf5929907">WarningWithDisplay</a>(<span class="stringliteral">&quot;crop::TopRespiration - not enough nitrogen in plant&quot;</span>);
<a name="l00383"></a>00383         }
<a name="l00384"></a>00384         <span class="keywordflow">if</span> (maximumN &lt; <a class="code" href="classcrop.html#adabbdde8753e5ae0ecd238e221429d88" title="How much Nitrogen that is in the plant.">Nitrogen</a>.<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a> * 0.75)
<a name="l00385"></a>00385         {
<a name="l00386"></a>00386                 cout &lt;&lt; <a class="code" href="classbase.html#aae39ec3da4311af6b93e424d29b2c66a">GetLongName</a>() &lt;&lt; endl;
<a name="l00387"></a>00387                 <a class="code" href="message_8h.html#a8ad29009121a629982c6ade0bd332470">theMessage</a>-&gt;<a class="code" href="classmessage.html#afed66d0552f90b4385c5169cf5929907">WarningWithDisplay</a>(<span class="stringliteral">&quot;crop::TopRespiration - too much nitrogen in plant&quot;</span>);
<a name="l00388"></a>00388         }
<a name="l00389"></a>00389    }
<a name="l00390"></a>00390 
<a name="l00391"></a>00391    <span class="keywordflow">return</span> topRespiration;
<a name="l00392"></a>00392 }
<a name="l00393"></a>00393 
<a name="l00394"></a>00394 <span class="comment">/****************************************************************************\</span>
<a name="l00395"></a>00395 <span class="comment">\****************************************************************************/</span>
<a name="l00396"></a><a class="code" href="classcrop_ryegrass.html#a0e2ec4857ca4630c5a9df02e8cd72b72">00396</a> <span class="keywordtype">double</span> <a class="code" href="classcrop_ryegrass.html#a0e2ec4857ca4630c5a9df02e8cd72b72">cropRyegrass::UpdateAgeClasses</a>(<span class="keywordtype">double</span> deltaDryMatt)
<a name="l00397"></a>00397 {
<a name="l00398"></a>00398    <span class="keywordtype">double</span> N,DM;
<a name="l00399"></a>00399 <span class="comment">//   EndBudget(&amp;N,&amp;DM);</span>
<a name="l00400"></a>00400    <span class="keywordtype">double</span> ReducFac = 1.0;
<a name="l00401"></a>00401    <a class="code" href="classcrop_ryegrass.html#aebfc7e7f1e48269a0b41f08c27072b61">grazableDM</a> =<a class="code" href="classcrop_ryegrass.html#a786315f2c2b87cc9777d7f2df5418a94">GetAvailableDM</a>(0.0);
<a name="l00402"></a>00402    <span class="keywordflow">if</span> (<a class="code" href="classcrop_ryegrass.html#aebfc7e7f1e48269a0b41f08c27072b61">grazableDM</a>&gt;0.0)
<a name="l00403"></a>00403         <a class="code" href="classcrop_ryegrass.html#a6fd909e402b37a89599cef6d026671c0">grazableN</a> = <a class="code" href="classcrop_ryegrass.html#af6affcb746b98c982f16ccb6da904010">GetAvailableN</a>(0.0);
<a name="l00404"></a>00404    <span class="keywordflow">else</span>
<a name="l00405"></a>00405       <a class="code" href="classcrop_ryegrass.html#a6fd909e402b37a89599cef6d026671c0">grazableN</a>=0.0;
<a name="l00406"></a>00406    <span class="keywordflow">if</span> (<a class="code" href="classcrop.html#a7acb3fa412808c819f4d9b662cc2148c">YellowCropAreaIndex</a>+<a class="code" href="classcrop.html#a2691a60a48a5166469df5da0e0e824fb">GreenCropAreaIndex</a> &gt; 0.0)
<a name="l00407"></a>00407         ReducFac = (<a class="code" href="classcrop.html#a0bbe1011a2b6d4224bd986f26d5a1d39">ReducedNInYellow</a>*<a class="code" href="classcrop.html#a7acb3fa412808c819f4d9b662cc2148c">YellowCropAreaIndex</a>+<a class="code" href="classcrop.html#a2691a60a48a5166469df5da0e0e824fb">GreenCropAreaIndex</a>)/
<a name="l00408"></a>00408                         (<a class="code" href="classcrop.html#a7acb3fa412808c819f4d9b662cc2148c">YellowCropAreaIndex</a>+<a class="code" href="classcrop.html#a2691a60a48a5166469df5da0e0e824fb">GreenCropAreaIndex</a>);
<a name="l00409"></a>00409    <a class="code" href="classnitrogen.html">nitrogen</a> aNitrogenInVegTop = <a class="code" href="classcrop.html#a82bef6e98553aa173173b0ea454a3e0a">NitrogenInVegTop</a>();
<a name="l00410"></a>00410    <span class="keywordtype">double</span> aDryMatterVegTop = <a class="code" href="classcrop_ryegrass.html#aedd4ae77832a94a71902085022f1eb88">GiveDryMatterVegTop</a>();
<a name="l00411"></a>00411         <span class="keywordflow">if</span> (<a class="code" href="classcrop.html#a4a8b0a766947fe8b0dfc6a59a24b9bef">topMatter</a>!=NULL)
<a name="l00412"></a>00412    {
<a name="l00413"></a>00413       <span class="keyword">delete</span> <a class="code" href="classcrop.html#a4a8b0a766947fe8b0dfc6a59a24b9bef">topMatter</a>;
<a name="l00414"></a>00414       <a class="code" href="classcrop.html#a4a8b0a766947fe8b0dfc6a59a24b9bef">topMatter</a>=NULL;
<a name="l00415"></a>00415    }
<a name="l00416"></a>00416    <span class="keywordtype">double</span> transfer[4];
<a name="l00417"></a>00417    <span class="keywordtype">double</span> T=<a class="code" href="classcrop_ryegrass.html#ae11486448ac560cb05033e804aea5316">TransferRate</a>*<a class="code" href="classcrop.html#af01aa0fd15613a9e2fcb2a23ca089d5f">TemperatureEffect</a>(<a class="code" href="classcrop.html#abfc8df1469f20d8084f744da461d1df5">temp</a>);
<a name="l00418"></a>00418    transfer[0]=deltaDryMatt;
<a name="l00419"></a>00419    transfer[1]=2.0*T*<a class="code" href="classcrop_ryegrass.html#ae9641d6c7c5459eb6053cb421df4e8d0">AgeClassTop</a>[0];
<a name="l00420"></a>00420    transfer[2]=T*AgeClassTop[1];
<a name="l00421"></a>00421    transfer[3]=T*AgeClassTop[2];
<a name="l00422"></a>00422 
<a name="l00423"></a>00423    <span class="keywordtype">double</span> RF = <a class="code" href="classcrop_ryegrass.html#a425c715cfd92033db6af5b091903af98">RecycleFraction</a>;
<a name="l00424"></a>00424    <span class="keywordflow">if</span>(<a class="code" href="classcrop.html#a38f05d3f77cfc67ff755eb8c0d79e301">Phenology</a>-&gt;<a class="code" href="classphenology.html#a9f571608ca2e2eaf7d1a79715afa8e0c" title="return true if crop has reached anthesis">Anthesis</a>())
<a name="l00425"></a>00425       RF = 0.5*<a class="code" href="classcrop_ryegrass.html#a425c715cfd92033db6af5b091903af98">RecycleFraction</a>;
<a name="l00426"></a>00426 
<a name="l00427"></a>00427    <span class="keywordtype">double</span> senescenceDM;
<a name="l00428"></a>00428    senescenceDM=(1.0-RF)*T*AgeClassTop[3];
<a name="l00429"></a>00429    <span class="keywordflow">if</span> (<a class="code" href="classcrop.html#a38f05d3f77cfc67ff755eb8c0d79e301">Phenology</a>-&gt;<a class="code" href="classphenology.html#afdc8ea11c9fcb90491341ed8e70d2927" title="development stage">DS</a> &gt; 1.5)
<a name="l00430"></a>00430         senescenceDM = T*<a class="code" href="classcrop_ryegrass.html#aedd4ae77832a94a71902085022f1eb88">GiveDryMatterVegTop</a>();
<a name="l00431"></a>00431    <span class="keywordtype">double</span> recycledDM=RF*T*AgeClassTop[3];
<a name="l00432"></a>00432 
<a name="l00433"></a>00433         transfer[0]+=recycledDM;
<a name="l00434"></a>00434 
<a name="l00435"></a>00435    <a class="code" href="classnitrogen.html">nitrogen</a> senescenceN;
<a name="l00436"></a>00436    <a class="code" href="classnitrogen.html">nitrogen</a> grazedN;
<a name="l00437"></a>00437    <span class="keywordflow">if</span> (senescenceDM&gt;0.0)
<a name="l00438"></a>00438    {
<a name="l00439"></a>00439         <span class="keywordtype">double</span> NConcentrationInYellow = <a class="code" href="classcrop.html#a0bbe1011a2b6d4224bd986f26d5a1d39">ReducedNInYellow</a>*aNitrogenInVegTop.<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a>/aDryMatterVegTop/ReducFac;   <span class="comment">//MEL 2009</span>
<a name="l00440"></a>00440 <span class="comment">//              double TotalLostN = NConcentrationInYellow*(1.0-RF)*senescenceDM;</span>
<a name="l00441"></a>00441                 <span class="keywordtype">double</span> TotalLostN = NConcentrationInYellow*senescenceDM;
<a name="l00442"></a>00442        senescenceN.<a class="code" href="classnitrogen.html#a49bebcba4c40f3c0a6abb24f590b2c8c">SetBoth</a>(TotalLostN*(1.0-<a class="code" href="classcrop.html#adabbdde8753e5ae0ecd238e221429d88" title="How much Nitrogen that is in the plant.">Nitrogen</a>.<a class="code" href="classnitrogen.html#ac97f3ebad4801a13a7c444bab3b3a886">Get15NRatio</a>()),TotalLostN*<a class="code" href="classcrop.html#adabbdde8753e5ae0ecd238e221429d88" title="How much Nitrogen that is in the plant.">Nitrogen</a>.<a class="code" href="classnitrogen.html#ac97f3ebad4801a13a7c444bab3b3a886">Get15NRatio</a>());
<a name="l00443"></a>00443       <span class="keywordflow">if</span> (senescenceN.<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a>&lt;0.0)
<a name="l00444"></a>00444         {
<a name="l00445"></a>00445         <a class="code" href="message_8h.html#a8ad29009121a629982c6ade0bd332470">theMessage</a>-&gt;<a class="code" href="classmessage.html#aacaa1466698a349689502491cf089f72">Warning</a>(<span class="stringliteral">&quot;cropRyeGrass:: negative N loss&quot;</span>);
<a name="l00446"></a>00446          senescenceN.<a class="code" href="classnitrogen.html#a706b101d934ddb44c4bff07761c8dfef">Clear</a>();
<a name="l00447"></a>00447       }
<a name="l00448"></a>00448 
<a name="l00449"></a>00449       <span class="comment">// Transfer DM and N senesced to &quot;topMatter&quot;</span>
<a name="l00450"></a>00450       <a class="code" href="classcrop.html#a4a8b0a766947fe8b0dfc6a59a24b9bef">topMatter</a>=<span class="keyword">new</span> <a class="code" href="classdecomposable.html">decomposable</a>;
<a name="l00451"></a>00451       <a class="code" href="classcrop.html#a4a8b0a766947fe8b0dfc6a59a24b9bef">topMatter</a>-&gt;<a class="code" href="classproduct.html#a0219cde65dc26376f3371a0138199ba8">Setname</a>(<span class="stringliteral">&quot;RYEGRASS&quot;</span>);
<a name="l00452"></a>00452       <a class="code" href="_new_main_8cpp.html#af1019990138497f1f18cc7294737d140">theProducts</a>-&gt;<a class="code" href="classproducts.html#a8bd239aabc0a167741c02882e305d65d">GiveProductInformation</a>(<a class="code" href="classcrop.html#a4a8b0a766947fe8b0dfc6a59a24b9bef">topMatter</a>);
<a name="l00453"></a>00453         <a class="code" href="classcrop.html#a4a8b0a766947fe8b0dfc6a59a24b9bef">topMatter</a>-&gt;<a class="code" href="classproduct.html#a18ec2e96f1d9b7cef74c4b2800ebdca1">Setamount</a>(0.01*senescenceDM/<a class="code" href="classcrop.html#a4a8b0a766947fe8b0dfc6a59a24b9bef">topMatter</a>-&gt;<a class="code" href="classlive_matter.html#ad3d05f1e8ceedc99e214adca94638de0">GetdryMatter</a>()); <span class="comment">// Conversion from g/m2 to t/ha</span>
<a name="l00454"></a>00454       <a class="code" href="classcrop.html#a4a8b0a766947fe8b0dfc6a59a24b9bef">topMatter</a>-&gt;<a class="code" href="classlive_matter.html#adbb45be219dd863cfad2b5e97cde1508">SetorgN_content</a>(senescenceN/(senescenceDM/<a class="code" href="classcrop.html#a4a8b0a766947fe8b0dfc6a59a24b9bef">topMatter</a>-&gt;<a class="code" href="classlive_matter.html#ad3d05f1e8ceedc99e214adca94638de0">GetdryMatter</a>()));
<a name="l00455"></a>00455 
<a name="l00456"></a>00456       <a class="code" href="classcrop.html#a9bf4f47a0a193df878aa15b364dbec14">AccumulatedTopDeposit</a> += senescenceDM;     <span class="comment">// Accumulated top deposition (state variable)</span>
<a name="l00457"></a>00457         <a class="code" href="classcrop.html#ad9583ee2f76a5141a1a54ebea83627fe" title="How much Nitrogen that the plant gives to the ground via dead leafs.">AccumulatedTopNDeposit</a> = <a class="code" href="classcrop.html#ad9583ee2f76a5141a1a54ebea83627fe" title="How much Nitrogen that the plant gives to the ground via dead leafs.">AccumulatedTopNDeposit</a> + senescenceN;
<a name="l00458"></a>00458    }
<a name="l00459"></a>00459 
<a name="l00460"></a>00460    AgeClassTop[0]+=transfer[0]-transfer[1] - <a class="code" href="classcrop_ryegrass.html#a60b9ccc77a862693545200a71d113608">grazedDM</a>[0];
<a name="l00461"></a>00461    <span class="keywordflow">if</span> (AgeClassTop[0]&lt;0.0)
<a name="l00462"></a>00462    {
<a name="l00463"></a>00463       <a class="code" href="message_8h.html#a8ad29009121a629982c6ade0bd332470">theMessage</a>-&gt;<a class="code" href="classmessage.html#aacaa1466698a349689502491cf089f72">Warning</a>(<span class="stringliteral">&quot;cropRyeGrass::UpdateAgeClasses - grazing (or transfer) has resultet in negative DM in age class 0&quot;</span>);
<a name="l00464"></a>00464       AgeClassTop[0]=1.0; <span class="comment">// Hack to get movin&#39; !!!</span>
<a name="l00465"></a>00465    }
<a name="l00466"></a>00466    AgeClassTop[1]+=transfer[1]-transfer[2] - grazedDM[1];
<a name="l00467"></a>00467    <span class="keywordflow">if</span> (AgeClassTop[1]&lt;0.0)
<a name="l00468"></a>00468    {
<a name="l00469"></a>00469       <a class="code" href="message_8h.html#a8ad29009121a629982c6ade0bd332470">theMessage</a>-&gt;<a class="code" href="classmessage.html#aacaa1466698a349689502491cf089f72">Warning</a>(<span class="stringliteral">&quot;cropRyeGrass::UpdateAgeClasses - grazing (or transfer) has resultet in negative DM in age class 1&quot;</span>);
<a name="l00470"></a>00470       AgeClassTop[1]=1.0; <span class="comment">// Hack to get movin&#39; !!!</span>
<a name="l00471"></a>00471    }
<a name="l00472"></a>00472    AgeClassTop[2]+=transfer[2]-transfer[3] - grazedDM[2];
<a name="l00473"></a>00473    <span class="keywordflow">if</span> (AgeClassTop[2]&lt;0.0)
<a name="l00474"></a>00474    {
<a name="l00475"></a>00475       <a class="code" href="message_8h.html#a8ad29009121a629982c6ade0bd332470">theMessage</a>-&gt;<a class="code" href="classmessage.html#aacaa1466698a349689502491cf089f72">Warning</a>(<span class="stringliteral">&quot;cropRyeGrass::UpdateAgeClasses - grazing (or transfer) has resultet in negative DM in age class 2&quot;</span>);
<a name="l00476"></a>00476       AgeClassTop[2]=1.0; <span class="comment">// Hack to get movin&#39; !!!</span>
<a name="l00477"></a>00477    }
<a name="l00478"></a>00478    AgeClassTop[3]+=transfer[3];
<a name="l00479"></a>00479    <span class="keywordtype">double</span> transferFromAgeClasses = recycledDM + senescenceDM + grazedDM[3];
<a name="l00480"></a>00480    <span class="keywordflow">if</span> (transferFromAgeClasses&gt;0.0)
<a name="l00481"></a>00481         <a class="code" href="classcrop_ryegrass.html#aa5b4bfccf6d06ebf0058b3348255e840">RemoveDMFromOldestAgeClass</a>(transferFromAgeClasses);
<a name="l00482"></a>00482 
<a name="l00483"></a>00483    <span class="keywordflow">if</span> (AgeClassTop[3]&lt;0.0)
<a name="l00484"></a>00484    {
<a name="l00485"></a>00485       <a class="code" href="message_8h.html#a8ad29009121a629982c6ade0bd332470">theMessage</a>-&gt;<a class="code" href="classmessage.html#afed66d0552f90b4385c5169cf5929907">WarningWithDisplay</a>(<span class="stringliteral">&quot;cropRyeGrass::UpdateAgeClasses - grazing (or transfer) has resultet in negative DM in age class 3&quot;</span>);
<a name="l00486"></a>00486       AgeClassTop[3]=1.0; <span class="comment">// Hack to get movin&#39; !!!</span>
<a name="l00487"></a>00487    }
<a name="l00488"></a>00488    <span class="comment">//Budget for grazing losses - NJH 13.12.2000</span>
<a name="l00489"></a>00489         <span class="keywordtype">double</span> totDMGrazed = grazedDM[0] + grazedDM[1] + grazedDM[2] + grazedDM[3];
<a name="l00490"></a>00490    <span class="keywordtype">double</span> NC = 0.0;
<a name="l00491"></a>00491    <span class="keywordflow">if</span> (<a class="code" href="classcrop_ryegrass.html#aebfc7e7f1e48269a0b41f08c27072b61">grazableDM</a>&gt;1E-3) <span class="comment">// Changed BMP!!!</span>
<a name="l00492"></a>00492    {
<a name="l00493"></a>00493       NC = <a class="code" href="classcrop_ryegrass.html#a6fd909e402b37a89599cef6d026671c0">grazableN</a>/<a class="code" href="classcrop_ryegrass.html#aebfc7e7f1e48269a0b41f08c27072b61">grazableDM</a>;
<a name="l00494"></a>00494    }
<a name="l00495"></a>00495    <span class="keywordtype">double</span> TotalgrazedN = NC*totDMGrazed; <span class="comment">// To correct for changed conditions relative to corresponding prior step</span>
<a name="l00496"></a>00496    grazedN.<a class="code" href="classnitrogen.html#a49bebcba4c40f3c0a6abb24f590b2c8c">SetBoth</a>(TotalgrazedN*(1.0-<a class="code" href="classcrop.html#adabbdde8753e5ae0ecd238e221429d88" title="How much Nitrogen that is in the plant.">Nitrogen</a>.<a class="code" href="classnitrogen.html#ac97f3ebad4801a13a7c444bab3b3a886">Get15NRatio</a>()),TotalgrazedN*<a class="code" href="classcrop.html#adabbdde8753e5ae0ecd238e221429d88" title="How much Nitrogen that is in the plant.">Nitrogen</a>.<a class="code" href="classnitrogen.html#ac97f3ebad4801a13a7c444bab3b3a886">Get15NRatio</a>());
<a name="l00497"></a>00497    <a class="code" href="classnitrogen.html">nitrogen</a> lostN=senescenceN + grazedN;
<a name="l00498"></a>00498    <span class="keywordtype">double</span> lostDM=senescenceDM + totDMGrazed;
<a name="l00499"></a>00499    <a class="code" href="classcrop.html#adabbdde8753e5ae0ecd238e221429d88" title="How much Nitrogen that is in the plant.">Nitrogen</a> = <a class="code" href="classcrop.html#adabbdde8753e5ae0ecd238e221429d88" title="How much Nitrogen that is in the plant.">Nitrogen</a> - lostN;
<a name="l00500"></a>00500    <a class="code" href="classcrop.html#af7ae14fac12af3efa728e789155983fb">Nbudget</a>.<a class="code" href="classbudget.html#a47bfa9740186f2be18a10dd3423a5eea">AddOutput</a>(lostN.n);                                                                          <span class="comment">// budgets</span>
<a name="l00501"></a>00501         <a class="code" href="classcrop.html#a3e5fad944be35152e933b5e50f928f5a">N15budget</a>.<a class="code" href="classbudget.html#a47bfa9740186f2be18a10dd3423a5eea">AddOutput</a>(lostN.n15);                                                                         <span class="comment">// budgets</span>
<a name="l00502"></a>00502    <a class="code" href="classcrop.html#a46844fd0540eb7627555f21afa8545e8">DMbudget</a>.<a class="code" href="classbudget.html#a47bfa9740186f2be18a10dd3423a5eea">AddOutput</a>(lostDM);
<a name="l00503"></a>00503 
<a name="l00504"></a>00504    <span class="keywordflow">if</span> (<a class="code" href="classcrop.html#adabbdde8753e5ae0ecd238e221429d88" title="How much Nitrogen that is in the plant.">Nitrogen</a>.<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a>&lt;0.0)
<a name="l00505"></a>00505    {
<a name="l00506"></a>00506       <a class="code" href="message_8h.html#a8ad29009121a629982c6ade0bd332470">theMessage</a>-&gt;<a class="code" href="classmessage.html#aacaa1466698a349689502491cf089f72">Warning</a>(<span class="stringliteral">&quot;cropRyeGrass::UpdateAgeClasses - grazing has resultet in negative N&quot;</span>);
<a name="l00507"></a>00507       <a class="code" href="classcrop.html#adabbdde8753e5ae0ecd238e221429d88" title="How much Nitrogen that is in the plant.">Nitrogen</a>.<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a>=0.1; <span class="comment">// Hack to get movin&#39; !!!</span>
<a name="l00508"></a>00508    }
<a name="l00509"></a>00509    <span class="comment">/*zero grazedDM and grazedN @@@</span>
<a name="l00510"></a>00510 <span class="comment">   Now reset in ClearTemporaryVariables, called from grazing_manager_class</span>
<a name="l00511"></a>00511 <span class="comment">   for(int i=0;i&lt;4;i++)</span>
<a name="l00512"></a>00512 <span class="comment">      grazedDM[i]=0.0;</span>
<a name="l00513"></a>00513 <span class="comment">   */</span>
<a name="l00514"></a>00514 <span class="comment">//   cout &lt;&lt; theTime &lt;&lt; &quot; gDM &quot; &lt;&lt; grazableDM &lt;&lt; &quot; gN &quot; &lt;&lt; grazableN &lt;&lt; &quot; Nitrogen &quot; &lt;&lt;  Nitrogen.n &lt;&lt; endl;</span>
<a name="l00515"></a>00515    <a class="code" href="classcrop_ryegrass.html#a5bb3f7b2ad5805e527bea21bbb71531c">EndBudget</a>(&amp;N,&amp;DM);
<a name="l00516"></a>00516    <span class="keywordflow">return</span> deltaDryMatt-lostDM;
<a name="l00517"></a>00517 }
<a name="l00518"></a>00518 
<a name="l00519"></a>00519 <span class="comment">/****************************************************************************\</span>
<a name="l00520"></a>00520 <span class="comment">\****************************************************************************/</span>
<a name="l00521"></a><a class="code" href="classcrop_ryegrass.html#aedd4ae77832a94a71902085022f1eb88">00521</a> <span class="keywordtype">double</span> <a class="code" href="classcrop_ryegrass.html#aedd4ae77832a94a71902085022f1eb88">cropRyegrass::GiveDryMatterVegTop</a>()
<a name="l00522"></a>00522 {
<a name="l00523"></a>00523    <span class="keywordtype">double</span> retVal=0.0;
<a name="l00524"></a>00524    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;4;i++)
<a name="l00525"></a>00525       retVal+=<a class="code" href="classcrop_ryegrass.html#ae9641d6c7c5459eb6053cb421df4e8d0">AgeClassTop</a>[i];
<a name="l00526"></a>00526    <span class="keywordflow">if</span> (retVal&lt;0.0)
<a name="l00527"></a>00527       <a class="code" href="message_8h.html#a8ad29009121a629982c6ade0bd332470">theMessage</a>-&gt;<a class="code" href="classmessage.html#afed66d0552f90b4385c5169cf5929907">WarningWithDisplay</a>(<span class="stringliteral">&quot;cropRyegrass::GiveDryMatterVegTop - negative dry matter&quot;</span>);
<a name="l00528"></a>00528    <span class="keywordflow">return</span> retVal;
<a name="l00529"></a>00529 }
<a name="l00530"></a>00530 
<a name="l00531"></a>00531 <span class="comment">/****************************************************************************\</span>
<a name="l00532"></a>00532 <span class="comment">\****************************************************************************/</span>
<a name="l00533"></a><a class="code" href="classcrop_ryegrass.html#aebf12683e5eb4d3a672808a2e3ab147c">00533</a> <span class="keywordtype">double</span> <a class="code" href="classcrop_ryegrass.html#aebf12683e5eb4d3a672808a2e3ab147c">cropRyegrass::DeadDMTop</a>()
<a name="l00534"></a>00534 {
<a name="l00535"></a>00535         <span class="keywordtype">double</span> retval = 0.5*<a class="code" href="classcrop_ryegrass.html#ae9641d6c7c5459eb6053cb421df4e8d0">AgeClassTop</a>[3];
<a name="l00536"></a>00536 <span class="comment">//   if (Phenology-&gt;Anthesis())</span>
<a name="l00537"></a>00537 <span class="comment">//   retval = (0.25*(Phenology-&gt;DS) )*  GiveDryMatterVegTop();</span>
<a name="l00538"></a>00538    <span class="keywordflow">return</span> retval;
<a name="l00539"></a>00539 }
<a name="l00540"></a>00540 
<a name="l00541"></a>00541 <span class="comment">/****************************************************************************\</span>
<a name="l00542"></a>00542 <span class="comment">\****************************************************************************/</span>
<a name="l00543"></a><a class="code" href="classcrop_ryegrass.html#a573d23b1d622e156001cae5c45203bc0">00543</a> <span class="keywordtype">void</span> <a class="code" href="classcrop_ryegrass.html#a573d23b1d622e156001cae5c45203bc0">cropRyegrass::CalcLeafAreaIndices</a>()
<a name="l00544"></a>00544 {
<a name="l00545"></a>00545    <span class="keywordflow">if</span> (<a class="code" href="classcrop.html#a38f05d3f77cfc67ff755eb8c0d79e301">Phenology</a>-&gt;<a class="code" href="classphenology.html#a514ca53b35d3dfc3e8dc1b4841d221cf" title="return true if crop has emerged">Emerged</a>() &amp;&amp; ((<a class="code" href="classcrop_ryegrass.html#aedd4ae77832a94a71902085022f1eb88">GiveDryMatterVegTop</a>()-<a class="code" href="classcrop_ryegrass.html#aebf12683e5eb4d3a672808a2e3ab147c">DeadDMTop</a>())&gt;0))
<a name="l00546"></a>00546         {
<a name="l00547"></a>00547            <span class="keywordflow">if</span> (<a class="code" href="classcrop.html#a38f05d3f77cfc67ff755eb8c0d79e301">Phenology</a>-&gt;<a class="code" href="classphenology.html#ac59e649ce2b4cede632496fbc6de53e1" title="Temperature sum for leaf expansion (used in linear growth)">TempSumForLeaf</a>&lt;=<a class="code" href="classcrop.html#a38f05d3f77cfc67ff755eb8c0d79e301">Phenology</a>-&gt;<a class="code" href="classphenology.html#a88c5292d2d713236a2403cb0a100655c" title="Growth phase for linear leaf growth (related to TempSumForLeaf!)">LinearLeafPhase</a>)
<a name="l00548"></a>00548         <a class="code" href="classcrop.html#a2691a60a48a5166469df5da0e0e824fb">GreenCropAreaIndex</a> =  <a class="code" href="classcrop.html#af3aac84af1f2d62509c26dfe15d1756c">InitialCAI</a>*<a class="code" href="classcrop.html#aa4666fdd11920e05003bfeefc5518ddf">RelativeDensity</a>*(<a class="code" href="classcrop.html#a38f05d3f77cfc67ff755eb8c0d79e301">Phenology</a>-&gt;<a class="code" href="classphenology.html#ac59e649ce2b4cede632496fbc6de53e1" title="Temperature sum for leaf expansion (used in linear growth)">TempSumForLeaf</a>/<a class="code" href="classcrop.html#a38f05d3f77cfc67ff755eb8c0d79e301">Phenology</a>-&gt;<a class="code" href="classphenology.html#a88c5292d2d713236a2403cb0a100655c" title="Growth phase for linear leaf growth (related to TempSumForLeaf!)">LinearLeafPhase</a>);      <span class="comment">// value from Porter ....</span>
<a name="l00549"></a>00549       <span class="keywordflow">else</span>
<a name="l00550"></a>00550       {
<a name="l00551"></a>00551         <span class="keywordflow">if</span> ((<a class="code" href="classcrop_ryegrass.html#affc800f21a3c26e2277a8e5679c27204">HasBeenCut</a>) || (<a class="code" href="classcrop.html#a6af7b95c4e451b425aeed60156151e9d">UnderSown</a>))  <span class="comment">// if the grass has not been cut and is not undersown =&gt; more vigorous growth</span>
<a name="l00552"></a>00552                 <a class="code" href="classcrop.html#a2691a60a48a5166469df5da0e0e824fb">GreenCropAreaIndex</a>  = pow(<a class="code" href="classcrop.html#ac84c4bfe32722d43f1edf0f3954bf6d9">LAIDMRatio</a>*(<a class="code" href="classcrop_ryegrass.html#aedd4ae77832a94a71902085022f1eb88">GiveDryMatterVegTop</a>()-<a class="code" href="classcrop_ryegrass.html#aebf12683e5eb4d3a672808a2e3ab147c">DeadDMTop</a>()),0.726);     <span class="comment">//this power is from Lemaire: Diagnosis of the n status in crops pp65.</span>
<a name="l00553"></a>00553          <span class="keywordflow">else</span>                              <span class="comment">// if the grass has not been cut and is not undersown =&gt; more vigorous growth</span>
<a name="l00554"></a>00554             <a class="code" href="classcrop.html#a2691a60a48a5166469df5da0e0e824fb">GreenCropAreaIndex</a>  = <a class="code" href="classcrop_ryegrass.html#ababb5c5bbefcf437f81ac636fbbf3805">InitialLAIIncrease</a>*pow(<a class="code" href="classcrop.html#ac84c4bfe32722d43f1edf0f3954bf6d9">LAIDMRatio</a>*(<a class="code" href="classcrop_ryegrass.html#aedd4ae77832a94a71902085022f1eb88">GiveDryMatterVegTop</a>()-<a class="code" href="classcrop_ryegrass.html#aebf12683e5eb4d3a672808a2e3ab147c">DeadDMTop</a>()),0.726);     <span class="comment">// estimate</span>
<a name="l00555"></a>00555       }
<a name="l00556"></a>00556    }
<a name="l00557"></a>00557 
<a name="l00558"></a>00558    <span class="keywordflow">else</span>
<a name="l00559"></a>00559            <a class="code" href="classcrop.html#a2691a60a48a5166469df5da0e0e824fb">GreenCropAreaIndex</a> = 0.0;
<a name="l00560"></a>00560    <span class="comment">// JB removed the out-commenting of the cut delay</span>
<a name="l00561"></a>00561    <span class="keywordflow">if</span> (TemperatureSumAfterCut&lt;CutDelay &amp;&amp; DryMatterTotalStandVegTop&gt;0)
<a name="l00562"></a>00562         <a class="code" href="classcrop.html#a2691a60a48a5166469df5da0e0e824fb">GreenCropAreaIndex</a> = 0.5*<a class="code" href="classcrop_ryegrass.html#a3f0d73c30fb6fe15198a3beca5a68a6e">TemperatureSumAfterCut</a>/<a class="code" href="classcrop_ryegrass.html#a75af628b7d7bb576d4c9285391d292b2">CutDelay</a>*<a class="code" href="classcrop_ryegrass.html#aedd4ae77832a94a71902085022f1eb88">GiveDryMatterVegTop</a>()/<a class="code" href="classcrop.html#ae5c58459f879a52a543bc517918513fd">DryMatterTotalStandVegTop</a>;
<a name="l00563"></a>00563    <a class="code" href="classcrop.html#a7acb3fa412808c819f4d9b662cc2148c">YellowCropAreaIndex</a> = <a class="code" href="classcrop.html#ac84c4bfe32722d43f1edf0f3954bf6d9">LAIDMRatio</a>*<a class="code" href="classcrop_ryegrass.html#aebf12683e5eb4d3a672808a2e3ab147c">DeadDMTop</a>();
<a name="l00564"></a>00564 }
<a name="l00565"></a>00565 
<a name="l00566"></a>00566 <span class="comment">/****************************************************************************\</span>
<a name="l00567"></a>00567 <span class="comment">\****************************************************************************/</span>
<a name="l00568"></a><a class="code" href="classcrop_ryegrass.html#a6785773151146d1e49ec5bb5c75636aa">00568</a> <span class="keywordtype">double</span> <a class="code" href="classcrop_ryegrass.html#a6785773151146d1e49ec5bb5c75636aa">cropRyegrass::Update</a>(<span class="keywordtype">double</span> ActivePar)
<a name="l00569"></a>00569 {
<a name="l00570"></a>00570    <span class="keywordtype">double</span> DailyDMGrowth = 0.0;
<a name="l00571"></a>00571 <span class="comment">//   rootMatter = NULL;    NJH pinged this out March 2009</span>
<a name="l00572"></a>00572         <a class="code" href="classcrop.html#a089361fdbd7eedb3b84e501ebc4f7221">Rg</a>      = ActivePar;
<a name="l00573"></a>00573    <a class="code" href="classcrop.html#abfc8df1469f20d8084f744da461d1df5">temp</a> = <a class="code" href="climate_8h.html#ad05fb99191dc4a9cb94e7f8c99280389">theClimate</a>-&gt;<a class="code" href="classclimate.html#a679acf82733860fad71dac0769ae16be">tmean</a>;
<a name="l00574"></a>00574 
<a name="l00575"></a>00575         <span class="keywordflow">if</span> (<a class="code" href="classcrop.html#a38f05d3f77cfc67ff755eb8c0d79e301">Phenology</a>-&gt;<a class="code" href="classphenology.html#aa4986dd79d0fc195c3f1c21833171906" title="return true if the crop is sown">Sown</a>())                              <span class="comment">// Never stops</span>
<a name="l00576"></a>00576    {
<a name="l00577"></a>00577       <span class="keywordflow">if</span> (<a class="code" href="classcrop.html#aaf7bdd66e714b1ad4057bad5a46e6772">aSoil</a>==NULL)
<a name="l00578"></a>00578          <a class="code" href="message_8h.html#a8ad29009121a629982c6ade0bd332470">theMessage</a>-&gt;<a class="code" href="classmessage.html#af9891cb7111375e6a36363afffb09d63">FatalError</a>(<span class="stringliteral">&quot;cropRyegrass::Update - Invalid soil pointer&quot;</span>);
<a name="l00579"></a>00579         <span class="keywordtype">double</span> soilTemp=<a class="code" href="classcrop.html#aaf7bdd66e714b1ad4057bad5a46e6772">aSoil</a>-&gt;<a class="code" href="classsoil.html#a30a2ef147290c60895e4c389ad3c72b8" title="returns the temperature at a given depth in the profile">GetTemperature</a>(20);
<a name="l00580"></a>00580       <span class="keywordtype">double</span> DayLength = <a class="code" href="climate_8h.html#ad05fb99191dc4a9cb94e7f8c99280389">theClimate</a>-&gt;<a class="code" href="classclimate.html#a2a5a0fd4f393d95c69ecf170d06513fb">PhotoPeriod</a>();
<a name="l00581"></a>00581  <span class="comment">//     if ((!Phenology -&gt; Anthesis()) || (!UnderSown))</span>
<a name="l00582"></a>00582         <a class="code" href="classcrop.html#a38f05d3f77cfc67ff755eb8c0d79e301">Phenology</a>-&gt;<a class="code" href="classphenology.html#a2e385ad05ba01687483faa3ec7de127c">Update</a>(<a class="code" href="classcrop.html#abfc8df1469f20d8084f744da461d1df5">temp</a>,soilTemp,DayLength);      <span class="comment">// updates phenology</span>
<a name="l00583"></a>00583 
<a name="l00584"></a>00584 
<a name="l00585"></a>00585                 <a class="code" href="classcrop.html#a362d42d586668dca552ec4d8cd381b68">TempSumRoot</a> += max(0.0,<a class="code" href="classcrop.html#abfc8df1469f20d8084f744da461d1df5">temp</a>);
<a name="l00586"></a>00586       <a class="code" href="classcrop_ryegrass.html#a3f0d73c30fb6fe15198a3beca5a68a6e">TemperatureSumAfterCut</a> += max(0.0,<a class="code" href="classcrop.html#abfc8df1469f20d8084f744da461d1df5">temp</a>);
<a name="l00587"></a>00587                 <a class="code" href="classcrop_ryegrass.html#a73b6ee5b772c6748d37be7d006a092c6">UpdateHeight</a>();
<a name="l00588"></a>00588       <span class="keywordtype">double</span> deltaDryMatt=<a class="code" href="classcrop.html#a2dbc56666f949042e5d0c80dbbd66325">DeltaDryMatter</a>();
<a name="l00589"></a>00589       DailyDMGrowth = deltaDryMatt;
<a name="l00590"></a>00590 
<a name="l00591"></a>00591         <a class="code" href="classcrop.html#a46844fd0540eb7627555f21afa8545e8">DMbudget</a>.<a class="code" href="classbudget.html#ad619d773e77931df0435e8c08314f68e">AddInput</a>(deltaDryMatt);              <span class="comment">// Budgets</span>
<a name="l00592"></a>00592       <a class="code" href="classcrop.html#ac9e8384797116e758558faff120ae56d">AccumulatedDMProduction</a> += deltaDryMatt;
<a name="l00593"></a>00593 
<a name="l00594"></a>00594       <span class="keywordflow">if</span> (<a class="code" href="classcrop.html#a38f05d3f77cfc67ff755eb8c0d79e301">Phenology</a>-&gt;<a class="code" href="classphenology.html#ac59e649ce2b4cede632496fbc6de53e1" title="Temperature sum for leaf expansion (used in linear growth)">TempSumForLeaf</a>&lt;=200)
<a name="l00595"></a>00595       {
<a name="l00596"></a>00596          <span class="keywordtype">double</span> DMTransfer=2.0*<a class="code" href="classcrop.html#a158a4f00952108fdc19727bdc90765f9">TopFraction</a>*<a class="code" href="classcrop.html#a86aa841b9bfef88701e24c3a1922bba5">InitialSeedDM</a>*(max(0.0,<a class="code" href="classcrop.html#abfc8df1469f20d8084f744da461d1df5">temp</a>)/<a class="code" href="classcrop.html#a38f05d3f77cfc67ff755eb8c0d79e301">Phenology</a>-&gt;<a class="code" href="classphenology.html#a88c5292d2d713236a2403cb0a100655c" title="Growth phase for linear leaf growth (related to TempSumForLeaf!)">LinearLeafPhase</a>);
<a name="l00597"></a>00597          DMTransfer = min(DMTransfer,<a class="code" href="classcrop.html#a2dfb21c27aff36f3049be9a39e7c6538">SeedDM</a>);
<a name="l00598"></a>00598          <a class="code" href="classcrop.html#a2dfb21c27aff36f3049be9a39e7c6538">SeedDM</a> -= DMTransfer;
<a name="l00599"></a>00599          <span class="keywordflow">if</span> (<a class="code" href="classcrop_ryegrass.html#a20afe6ee954c51fafe8d0c184c395c65">ReSeedDM</a> &gt;0.0)
<a name="l00600"></a>00600          {
<a name="l00601"></a>00601                 <span class="keywordtype">double</span> ReSeedDMTransfer = 2.0*<a class="code" href="classcrop.html#a158a4f00952108fdc19727bdc90765f9">TopFraction</a>*<a class="code" href="classcrop.html#a86aa841b9bfef88701e24c3a1922bba5">InitialSeedDM</a>*(max(0.0,<a class="code" href="classcrop.html#abfc8df1469f20d8084f744da461d1df5">temp</a>)/<a class="code" href="classcrop.html#a38f05d3f77cfc67ff755eb8c0d79e301">Phenology</a>-&gt;<a class="code" href="classphenology.html#a88c5292d2d713236a2403cb0a100655c" title="Growth phase for linear leaf growth (related to TempSumForLeaf!)">LinearLeafPhase</a>);
<a name="l00602"></a>00602                 ReSeedDMTransfer = min(ReSeedDMTransfer,<a class="code" href="classcrop_ryegrass.html#a20afe6ee954c51fafe8d0c184c395c65">ReSeedDM</a>);
<a name="l00603"></a>00603             DMTransfer += ReSeedDMTransfer;
<a name="l00604"></a>00604 
<a name="l00605"></a>00605          }
<a name="l00606"></a>00606          <a class="code" href="classcrop_ryegrass.html#ae9641d6c7c5459eb6053cb421df4e8d0">AgeClassTop</a>[0] += 0.5*(DMTransfer);
<a name="l00607"></a>00607          <a class="code" href="classcrop.html#a3c5f4942cf46d45168caf4da80b79537">DryMatterRoot</a>  += 0.5*(DMTransfer);
<a name="l00608"></a>00608       }
<a name="l00609"></a>00609 
<a name="l00610"></a>00610       <a class="code" href="classcrop.html#aeb0993f2a6d2f21d30a5c24bbd46833e">TransferDryMatterToRoot</a>(&amp;deltaDryMatt);
<a name="l00611"></a>00611       <a class="code" href="classcrop.html#a022c14d2c183c8d21c622c225bb763d8">CalcRootGrowth</a>();
<a name="l00612"></a>00612         <a class="code" href="classcrop_ryegrass.html#a41ff7bdc52b0466a4598e104b4723572">TransferDryMatterToStorage</a>(&amp;deltaDryMatt);
<a name="l00613"></a>00613       <a class="code" href="classcrop.html#a0491b172b4874adcd1b3930cb3be00fe">DeltaDMTop</a> = <a class="code" href="classcrop_ryegrass.html#a0e2ec4857ca4630c5a9df02e8cd72b72">UpdateAgeClasses</a>(deltaDryMatt);
<a name="l00614"></a>00614 
<a name="l00615"></a>00615       <span class="keywordtype">double</span> Respiration = <a class="code" href="classcrop_ryegrass.html#a81ee410c4677a88854065d2cbcecf4fc">TopRespiration</a>();
<a name="l00616"></a>00616       <a class="code" href="classcrop.html#a0491b172b4874adcd1b3930cb3be00fe">DeltaDMTop</a> -= Respiration;
<a name="l00617"></a>00617       DailyDMGrowth -= Respiration;
<a name="l00618"></a>00618       <a class="code" href="classcrop.html#a755b12e801a538bb34a8c7b829047e76">DryMatterVegTop</a>=<a class="code" href="classcrop_ryegrass.html#aedd4ae77832a94a71902085022f1eb88">GiveDryMatterVegTop</a>();
<a name="l00619"></a>00619       <span class="keywordflow">if</span> (<a class="code" href="classcrop.html#a38f05d3f77cfc67ff755eb8c0d79e301">Phenology</a>-&gt;<a class="code" href="classphenology.html#a906583e45eeda4d8a6e1cec487a272cc" title="return true if planed is ready to be ripped">Ripe</a>() || DayLength &lt; <a class="code" href="classcrop_ryegrass.html#ad0c31787525448d29e932a5d05476978">MinDayLength</a>)
<a name="l00620"></a>00620         <a class="code" href="classcrop_ryegrass.html#a65e6d648842b070c8dfe343d548dee1c">RipeSenescence</a>();    <span class="comment">// Still some debugging to do!!!!!!!!!!!!!!!!!!!!!!!</span>
<a name="l00621"></a>00621       <a class="code" href="classcrop_ryegrass.html#a573d23b1d622e156001cae5c45203bc0">CalcLeafAreaIndices</a>();
<a name="l00622"></a>00622 <span class="comment">//      cout &lt;&lt; theTime &lt;&lt; &quot; DM veg top &quot; &lt;&lt; GiveDryMatterVegTop() &lt;&lt; endl;</span>
<a name="l00623"></a>00623         }
<a name="l00624"></a>00624    <span class="keywordflow">return</span> DailyDMGrowth;
<a name="l00625"></a>00625 }
<a name="l00626"></a>00626 <span class="comment">/****************************************************************************\</span>
<a name="l00627"></a>00627 <span class="comment">MEL 2009: Removes DM from oldest ageclass</span>
<a name="l00628"></a>00628 <span class="comment">\****************************************************************************/</span>
<a name="l00629"></a><a class="code" href="classcrop_ryegrass.html#aa5b4bfccf6d06ebf0058b3348255e840">00629</a> <span class="keywordtype">void</span> <a class="code" href="classcrop_ryegrass.html#aa5b4bfccf6d06ebf0058b3348255e840">cropRyegrass::RemoveDMFromOldestAgeClass</a>(<span class="keywordtype">double</span> transferFromAgeClass)
<a name="l00630"></a>00630 {
<a name="l00631"></a>00631         <span class="keywordtype">double</span> <span class="keyword">remove</span>=0.0;
<a name="l00632"></a>00632         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;4;i++)
<a name="l00633"></a>00633    {
<a name="l00634"></a>00634         <span class="keyword">remove</span>=min(<a class="code" href="classcrop_ryegrass.html#ae9641d6c7c5459eb6053cb421df4e8d0">AgeClassTop</a>[3-i],transferFromAgeClass);
<a name="l00635"></a>00635       <a class="code" href="classcrop_ryegrass.html#ae9641d6c7c5459eb6053cb421df4e8d0">AgeClassTop</a>[3-i] -= <span class="keyword">remove</span>;
<a name="l00636"></a>00636       transferFromAgeClass -= <span class="keyword">remove</span>;
<a name="l00637"></a>00637    }
<a name="l00638"></a>00638 
<a name="l00639"></a>00639 }
<a name="l00645"></a><a class="code" href="classcrop_ryegrass.html#a41ff7bdc52b0466a4598e104b4723572">00645</a> <span class="keywordtype">void</span> <a class="code" href="classcrop_ryegrass.html#a41ff7bdc52b0466a4598e104b4723572">cropRyegrass::TransferDryMatterToStorage</a>(<span class="keywordtype">double</span> * dDryMatt)
<a name="l00646"></a>00646 {
<a name="l00647"></a>00647         <span class="keywordflow">if</span> (<a class="code" href="classcrop.html#a38f05d3f77cfc67ff755eb8c0d79e301">Phenology</a>-&gt;<a class="code" href="classphenology.html#a9f571608ca2e2eaf7d1a79715afa8e0c" title="return true if crop has reached anthesis">Anthesis</a>() &amp;&amp; <a class="code" href="classcrop.html#ac85050f76b5416047499dcdc854d6f41" title="Describe if a plan can fill.">FillFlag</a>==0)
<a name="l00648"></a>00648    {
<a name="l00649"></a>00649         <span class="keywordflow">if</span> (<a class="code" href="classcrop.html#a0c55583d4613cc09bb912de3078aae49">TransferableStorage</a>&lt;1E-8)
<a name="l00650"></a>00650         <a class="code" href="classcrop.html#a0c55583d4613cc09bb912de3078aae49">TransferableStorage</a> = <a class="code" href="classcrop_ryegrass.html#aedd4ae77832a94a71902085022f1eb88">GiveDryMatterVegTop</a>()*<a class="code" href="classcrop.html#adf0da70c2a7dc063b5bcb09730e155c6">StoreForFilling</a>;
<a name="l00651"></a>00651       <a class="code" href="classcrop.html#a0c55583d4613cc09bb912de3078aae49">TransferableStorage</a> += *dDryMatt*<a class="code" href="classcrop.html#ab94a62632b347617f4f62b317a16ff73">FillFactor</a>;
<a name="l00652"></a>00652       <a class="code" href="classcrop.html#ab1133e34965bc17531d6bbf675cfa240">TransferedDMToStorage</a> = <a class="code" href="classcrop.html#a0c55583d4613cc09bb912de3078aae49">TransferableStorage</a>;
<a name="l00653"></a>00653    }
<a name="l00654"></a>00654    <span class="comment">// MEL 2009</span>
<a name="l00655"></a>00655    <span class="keywordflow">if</span> (<a class="code" href="classcrop.html#a38f05d3f77cfc67ff755eb8c0d79e301">Phenology</a>-&gt;<a class="code" href="classphenology.html#a8cae850ebecaff9242a27d529ab72e09" title="return true if the grain has started to develop">GrainFillStart</a>())
<a name="l00656"></a>00656    {
<a name="l00657"></a>00657         <a class="code" href="classcrop.html#ac85050f76b5416047499dcdc854d6f41" title="Describe if a plan can fill.">FillFlag</a> = 1;
<a name="l00658"></a>00658       <span class="keywordflow">if</span> (<a class="code" href="classcrop.html#a602622ac2c0de6432e6b9438dbbb646b">fNitrogen</a>() &gt; 0.0)
<a name="l00659"></a>00659       {
<a name="l00660"></a>00660         <span class="keywordtype">double</span> transfer = max(0.0,<a class="code" href="classcrop.html#a0c55583d4613cc09bb912de3078aae49">TransferableStorage</a>*<a class="code" href="classcrop.html#a38f05d3f77cfc67ff755eb8c0d79e301">Phenology</a>-&gt;<a class="code" href="classphenology.html#ae1e41d673ae323dc45240665b167b14e">GetFractionOfGrainFill</a>());     <span class="comment">// linear fill of DM stored during lag phase</span>
<a name="l00661"></a>00661          <a class="code" href="classcrop_ryegrass.html#aa5b4bfccf6d06ebf0058b3348255e840">RemoveDMFromOldestAgeClass</a>(transfer);
<a name="l00662"></a>00662          <a class="code" href="classcrop.html#a4a2803c0618d2f662abfa8d230c811df">DryMatterStorage</a> += transfer+*dDryMatt*<a class="code" href="classcrop.html#ab94a62632b347617f4f62b317a16ff73">FillFactor</a>*<a class="code" href="classcrop.html#ab60ba190cccea48dbc2b7112b663545e">ConversionCoefficient</a>;
<a name="l00663"></a>00663 
<a name="l00664"></a>00664 
<a name="l00665"></a>00665                 <span class="keywordtype">double</span> minimumN = <a class="code" href="classcrop.html#adc9f2a384dfd4be26746b822c4324f37">Nmin</a>();
<a name="l00666"></a>00666                 <span class="keywordtype">double</span> maximumN = <a class="code" href="classcrop_ryegrass.html#aac89498ebd762c28e8bed76ec7c78db0">Nmax</a>();
<a name="l00667"></a>00667         <span class="keywordflow">if</span> (minimumN &gt; <a class="code" href="classcrop.html#adabbdde8753e5ae0ecd238e221429d88" title="How much Nitrogen that is in the plant.">Nitrogen</a>.<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a> + 0.01)    <span class="comment">//Check nitrogen status and transfer back</span>
<a name="l00668"></a>00668          {
<a name="l00669"></a>00669             <span class="keywordtype">double</span> transferBack = max(0.0,min(transfer,(minimumN - <a class="code" href="classcrop.html#adabbdde8753e5ae0ecd238e221429d88" title="How much Nitrogen that is in the plant.">Nitrogen</a>.<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a>)/<a class="code" href="classcrop.html#a3a411cb751e18aaf088d266ee47c9420">MinN_Store</a>));
<a name="l00670"></a>00670                 <a class="code" href="classcrop_ryegrass.html#aa5b4bfccf6d06ebf0058b3348255e840">RemoveDMFromOldestAgeClass</a>(-transferBack);
<a name="l00671"></a>00671                 <a class="code" href="classcrop.html#a4a2803c0618d2f662abfa8d230c811df">DryMatterStorage</a> -= transferBack;
<a name="l00672"></a>00672                 transfer = transfer - transferBack;
<a name="l00673"></a>00673          }
<a name="l00674"></a>00674                 <span class="keywordflow">if</span> (maximumN &lt; <a class="code" href="classcrop.html#adabbdde8753e5ae0ecd238e221429d88" title="How much Nitrogen that is in the plant.">Nitrogen</a>.<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a> - 0.01)     <span class="comment">//Check nitrogen status and transfer back</span>
<a name="l00675"></a>00675                 {
<a name="l00676"></a>00676             <span class="keywordtype">double</span> transferBack = max(0.0,min(transfer,(<a class="code" href="classcrop.html#adabbdde8753e5ae0ecd238e221429d88" title="How much Nitrogen that is in the plant.">Nitrogen</a>.<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a> - maximumN)/<a class="code" href="classcrop.html#a9f5ab366fce6f1259588cf5087cdb4c2">MaxN_Store</a>));
<a name="l00677"></a>00677                 <a class="code" href="classcrop_ryegrass.html#aa5b4bfccf6d06ebf0058b3348255e840">RemoveDMFromOldestAgeClass</a>(-transferBack);
<a name="l00678"></a>00678                 <a class="code" href="classcrop.html#a4a2803c0618d2f662abfa8d230c811df">DryMatterStorage</a> -= transferBack;
<a name="l00679"></a>00679                 transfer = transfer - transferBack;
<a name="l00680"></a>00680                 }
<a name="l00681"></a>00681 
<a name="l00682"></a>00682          <a class="code" href="classcrop.html#a46844fd0540eb7627555f21afa8545e8">DMbudget</a>.<a class="code" href="classbudget.html#a47bfa9740186f2be18a10dd3423a5eea">AddOutput</a>((*dDryMatt*<a class="code" href="classcrop.html#ab94a62632b347617f4f62b317a16ff73">FillFactor</a>)*(1-ConversionCoefficient));
<a name="l00683"></a>00683          *dDryMatt = *dDryMatt*(1-<a class="code" href="classcrop.html#ab94a62632b347617f4f62b317a16ff73">FillFactor</a>);
<a name="l00684"></a>00684          <a class="code" href="classcrop.html#ab1133e34965bc17531d6bbf675cfa240">TransferedDMToStorage</a> -= transfer;
<a name="l00685"></a>00685       }
<a name="l00686"></a>00686    }
<a name="l00687"></a>00687    <span class="keywordflow">if</span> (<a class="code" href="classcrop.html#a38f05d3f77cfc67ff755eb8c0d79e301">Phenology</a>-&gt;<a class="code" href="classphenology.html#aa2966766123b0b7b2d948fd74ecd057b" title="return true if the grains is fully developed">GrainFillEnd</a>() &amp;&amp; <a class="code" href="classcrop.html#ab1133e34965bc17531d6bbf675cfa240">TransferedDMToStorage</a>&gt;0)             <span class="comment">// Check to see if all transferable storage is transfered</span>
<a name="l00688"></a>00688    {
<a name="l00689"></a>00689       <span class="keywordtype">double</span> transfer=max(0.0,<a class="code" href="classcrop.html#ab1133e34965bc17531d6bbf675cfa240">TransferedDMToStorage</a>);
<a name="l00690"></a>00690         <a class="code" href="classcrop.html#a4a2803c0618d2f662abfa8d230c811df">DryMatterStorage</a> += transfer;
<a name="l00691"></a>00691       <a class="code" href="classcrop_ryegrass.html#aa5b4bfccf6d06ebf0058b3348255e840">RemoveDMFromOldestAgeClass</a>(transfer);
<a name="l00692"></a>00692       <span class="keywordtype">double</span> minimumN = <a class="code" href="classcrop.html#adc9f2a384dfd4be26746b822c4324f37">Nmin</a>();
<a name="l00693"></a>00693         <span class="keywordtype">double</span> maximumN = <a class="code" href="classcrop_ryegrass.html#aac89498ebd762c28e8bed76ec7c78db0">Nmax</a>();
<a name="l00694"></a>00694       <span class="keywordflow">if</span> (minimumN &gt; <a class="code" href="classcrop.html#adabbdde8753e5ae0ecd238e221429d88" title="How much Nitrogen that is in the plant.">Nitrogen</a>.<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a> + 0.01)       <span class="comment">//Check nitrogen status and transfer back</span>
<a name="l00695"></a>00695       {
<a name="l00696"></a>00696          <span class="keywordtype">double</span> transferBack = max(0.0,min(transfer,(minimumN - <a class="code" href="classcrop.html#adabbdde8753e5ae0ecd238e221429d88" title="How much Nitrogen that is in the plant.">Nitrogen</a>.<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a>)/<a class="code" href="classcrop.html#a3a411cb751e18aaf088d266ee47c9420">MinN_Store</a>));
<a name="l00697"></a>00697         <a class="code" href="classcrop_ryegrass.html#aa5b4bfccf6d06ebf0058b3348255e840">RemoveDMFromOldestAgeClass</a>(-transferBack);
<a name="l00698"></a>00698                 <a class="code" href="classcrop.html#a4a2803c0618d2f662abfa8d230c811df">DryMatterStorage</a> -= transferBack;
<a name="l00699"></a>00699          transfer = transfer - transferBack;
<a name="l00700"></a>00700       }
<a name="l00701"></a>00701         <span class="keywordflow">if</span> (maximumN &lt; <a class="code" href="classcrop.html#adabbdde8753e5ae0ecd238e221429d88" title="How much Nitrogen that is in the plant.">Nitrogen</a>.<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a> - 0.01)    <span class="comment">//Check nitrogen status and transfer back</span>
<a name="l00702"></a>00702         {
<a name="l00703"></a>00703          <span class="keywordtype">double</span> transferBack = max(0.0,min(transfer,(<a class="code" href="classcrop.html#adabbdde8753e5ae0ecd238e221429d88" title="How much Nitrogen that is in the plant.">Nitrogen</a>.<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a> - maximumN)/<a class="code" href="classcrop.html#a9f5ab366fce6f1259588cf5087cdb4c2">MaxN_Store</a>));
<a name="l00704"></a>00704         <a class="code" href="classcrop_ryegrass.html#aa5b4bfccf6d06ebf0058b3348255e840">RemoveDMFromOldestAgeClass</a>(-transferBack);
<a name="l00705"></a>00705                 <a class="code" href="classcrop.html#a4a2803c0618d2f662abfa8d230c811df">DryMatterStorage</a> -= transferBack;
<a name="l00706"></a>00706          transfer = transfer - transferBack;
<a name="l00707"></a>00707       }
<a name="l00708"></a>00708       <a class="code" href="classcrop.html#ab1133e34965bc17531d6bbf675cfa240">TransferedDMToStorage</a> = 0.0;
<a name="l00709"></a>00709    }
<a name="l00710"></a>00710 }
<a name="l00711"></a>00711 
<a name="l00712"></a>00712 <span class="comment">/****************************************************************************\</span>
<a name="l00713"></a>00713 <span class="comment">\****************************************************************************/</span>
<a name="l00714"></a><a class="code" href="classcrop_ryegrass.html#a73b6ee5b772c6748d37be7d006a092c6">00714</a> <span class="keywordtype">void</span> <a class="code" href="classcrop_ryegrass.html#a73b6ee5b772c6748d37be7d006a092c6">cropRyegrass::UpdateHeight</a>()
<a name="l00715"></a>00715 {
<a name="l00716"></a>00716         <span class="keywordflow">if</span> (<a class="code" href="classcrop.html#a38f05d3f77cfc67ff755eb8c0d79e301">Phenology</a>-&gt;<a class="code" href="classphenology.html#a514ca53b35d3dfc3e8dc1b4841d221cf" title="return true if crop has emerged">Emerged</a>())
<a name="l00717"></a>00717            <a class="code" href="classcrop.html#a3f40980535ac184d9cced18aff1a0f8c">PlantHeight</a> += max(0.0,<a class="code" href="classcrop.html#abfc8df1469f20d8084f744da461d1df5">temp</a>)/1000.0*<a class="code" href="classcrop.html#a211a8242464133985cb2f26964b0f782">MaxPlantHeight</a>; <span class="comment">// JBE&#39;s original formulation, seems to work very well with undersown crops</span>
<a name="l00718"></a>00718    <span class="keywordflow">else</span>
<a name="l00719"></a>00719         <a class="code" href="classcrop.html#a3f40980535ac184d9cced18aff1a0f8c">PlantHeight</a> = 0.0;
<a name="l00720"></a>00720    <a class="code" href="classcrop.html#a3f40980535ac184d9cced18aff1a0f8c">PlantHeight</a> = min(min(<a class="code" href="classcrop.html#a3f40980535ac184d9cced18aff1a0f8c">PlantHeight</a>,<a class="code" href="classcrop.html#a211a8242464133985cb2f26964b0f782">MaxPlantHeight</a>),<a class="code" href="classcrop.html#ae5c58459f879a52a543bc517918513fd">DryMatterTotalStandVegTop</a>/<a class="code" href="classcrop_ryegrass.html#a851332fb794a51440e3930cb53f03802">BulkDensity</a>); <span class="comment">// But modifiy if DM becomes limiting</span>
<a name="l00721"></a>00721    <span class="comment">// Transitions between undersown crops and removal of previous main crop might need later attention !!!</span>
<a name="l00722"></a>00722 }
<a name="l00723"></a>00723 
<a name="l00724"></a>00724 <span class="comment">/****************************************************************************\</span>
<a name="l00725"></a>00725 <span class="comment">\****************************************************************************/</span>
<a name="l00726"></a><a class="code" href="classcrop_ryegrass.html#a8c82f3380064d4351d60aada56820cf4">00726</a> <span class="keywordtype">double</span> <a class="code" href="classcrop_ryegrass.html#a8c82f3380064d4351d60aada56820cf4">cropRyegrass::GiveEvapFactor</a>()
<a name="l00727"></a>00727 {
<a name="l00728"></a>00728    <span class="keywordflow">return</span> 1.0;
<a name="l00729"></a>00729 }
<a name="l00730"></a>00730 
<a name="l00731"></a>00731 <span class="comment">/****************************************************************************\</span>
<a name="l00732"></a>00732 <span class="comment">Cut and return a plantItem     NJH March 2001</span>
<a name="l00733"></a>00733 <span class="comment">returns cut material in g/sq metre</span>
<a name="l00734"></a>00734 <span class="comment">\****************************************************************************/</span>
<a name="l00735"></a><a class="code" href="classcrop_ryegrass.html#a35e69a6dea6f87f1adb3060e456290ba">00735</a> <span class="keywordtype">void</span> <a class="code" href="classcrop_ryegrass.html#a35e69a6dea6f87f1adb3060e456290ba" title="harvest vegetation above a certain height. Is used for forage crops. Not currently used...">cropRyegrass::Cut</a>(<a class="code" href="classplant_item.html">plantItem</a> * cutPlantMaterial, <span class="keywordtype">double</span> cut_height)
<a name="l00736"></a>00736 {
<a name="l00737"></a>00737    <span class="keywordflow">if</span> (cut_height&lt;0.0)
<a name="l00738"></a>00738       cut_height=0.01;
<a name="l00739"></a>00739    <span class="keywordflow">if</span> (<a class="code" href="classcrop_ryegrass.html#aedd4ae77832a94a71902085022f1eb88">GiveDryMatterVegTop</a>()&lt;=0.0)
<a name="l00740"></a>00740       <a class="code" href="message_8h.html#a8ad29009121a629982c6ade0bd332470">theMessage</a>-&gt;<a class="code" href="classmessage.html#afed66d0552f90b4385c5169cf5929907">WarningWithDisplay</a>(<span class="stringliteral">&quot;cropRyegrass::Cut - vegetative top must be bigger than zero here&quot;</span>);
<a name="l00741"></a>00741 <span class="comment">/*-------------------------------</span>
<a name="l00742"></a>00742 <span class="comment">   double temp_height, tempDM, proportionCut;</span>
<a name="l00743"></a>00743 <span class="comment">   grazableDM = 0.0;</span>
<a name="l00744"></a>00744 <span class="comment">   for(int i=0;i&lt;4;i++)</span>
<a name="l00745"></a>00745 <span class="comment">   {</span>
<a name="l00746"></a>00746 <span class="comment">      temp_height=PlantHeight;</span>
<a name="l00747"></a>00747 <span class="comment">      double cutH=max(cutHeight,0.01);</span>
<a name="l00748"></a>00748 <span class="comment">      if (temp_height&gt;cutH)</span>
<a name="l00749"></a>00749 <span class="comment">        proportionCut=(temp_height - cutH)/temp_height;</span>
<a name="l00750"></a>00750 <span class="comment">      else</span>
<a name="l00751"></a>00751 <span class="comment">        proportionCut = 0.0;</span>
<a name="l00752"></a>00752 <span class="comment">      tempDM=proportionCut * AgeClassTop[i] * uptakeWeight[i];</span>
<a name="l00753"></a>00753 <span class="comment">           grazableDM +=tempDM;</span>
<a name="l00754"></a>00754 <span class="comment">   }</span>
<a name="l00755"></a>00755 <span class="comment">   return grazableDM;</span>
<a name="l00756"></a>00756 <span class="comment">-------------------------------*/</span>
<a name="l00757"></a>00757    <span class="keywordflow">if</span> (cutPlantMaterial-&gt;<a class="code" href="classbase.html#a5b4079d3eb535e704fcaed3016c76ecb">GetName</a>()[0]==<span class="charliteral">&#39;\0&#39;</span>) <span class="comment">// This might need expansion in the future. For FarmN purpose this will probably do. !!!</span>
<a name="l00758"></a>00758    {
<a name="l00759"></a>00759       cutPlantMaterial-&gt;<a class="code" href="classproduct.html#a0219cde65dc26376f3371a0138199ba8">Setname</a>(<a class="code" href="classcrop.html#af982befddb79f8aedfa207bce540c47a">PlantItemName</a>);
<a name="l00760"></a>00760       <a class="code" href="_new_main_8cpp.html#af1019990138497f1f18cc7294737d140">theProducts</a>-&gt;<a class="code" href="classproducts.html#a8bd239aabc0a167741c02882e305d65d">GiveProductInformation</a>(cutPlantMaterial);
<a name="l00761"></a>00761    }
<a name="l00762"></a>00762    <span class="keywordtype">double</span> temp_height, tempDM, proportionCut;
<a name="l00763"></a>00763    <span class="keywordtype">double</span> cutDM = 0.0;
<a name="l00764"></a>00764    <a class="code" href="classnitrogen.html">nitrogen</a> cutN = 0.0;
<a name="l00765"></a>00765    <span class="keywordtype">double</span> initialDM=<a class="code" href="classcrop_ryegrass.html#aedd4ae77832a94a71902085022f1eb88">GiveDryMatterVegTop</a>();
<a name="l00766"></a>00766    <a class="code" href="classnitrogen.html">nitrogen</a>  aNitrogenInVegTop = <a class="code" href="classcrop.html#a82bef6e98553aa173173b0ea454a3e0a">NitrogenInVegTop</a>();
<a name="l00767"></a>00767    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;4;i++)
<a name="l00768"></a>00768    {
<a name="l00769"></a>00769       temp_height=<a class="code" href="classcrop.html#a3f40980535ac184d9cced18aff1a0f8c">PlantHeight</a>;
<a name="l00770"></a>00770       <span class="keywordflow">if</span> (temp_height&gt;cut_height)
<a name="l00771"></a>00771         proportionCut = (temp_height-cut_height)/temp_height;
<a name="l00772"></a>00772       <span class="keywordflow">else</span>
<a name="l00773"></a>00773         proportionCut = 0.0;
<a name="l00774"></a>00774 
<a name="l00775"></a>00775       tempDM = proportionCut*<a class="code" href="classcrop_ryegrass.html#ae9641d6c7c5459eb6053cb421df4e8d0">AgeClassTop</a>[i];
<a name="l00776"></a>00776       AgeClassTop[i]-= tempDM;   <span class="comment">//cut material</span>
<a name="l00777"></a>00777            cutDM += tempDM;
<a name="l00778"></a>00778    }
<a name="l00779"></a>00779    <span class="keywordflow">if</span> (cutDM&gt;0)
<a name="l00780"></a>00780         {
<a name="l00781"></a>00781       cutN = aNitrogenInVegTop*cutDM/initialDM;
<a name="l00782"></a>00782       <a class="code" href="classcrop.html#adabbdde8753e5ae0ecd238e221429d88" title="How much Nitrogen that is in the plant.">Nitrogen</a> = <a class="code" href="classcrop.html#adabbdde8753e5ae0ecd238e221429d88" title="How much Nitrogen that is in the plant.">Nitrogen</a>-cutN;
<a name="l00783"></a>00783    }
<a name="l00784"></a>00784    <span class="keywordflow">if</span> (<a class="code" href="classcrop.html#a4a2803c0618d2f662abfa8d230c811df">DryMatterStorage</a> &gt; 0.0)
<a name="l00785"></a>00785    {
<a name="l00786"></a>00786         <a class="code" href="classnitrogen.html">nitrogen</a> aNitrogenInStorage=<a class="code" href="classcrop.html#a4f4f31c68a905ef3fef26b9d7456cb36">NitrogenInStorage</a>().<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a>;
<a name="l00787"></a>00787       cutDM += <a class="code" href="classcrop.html#a4a2803c0618d2f662abfa8d230c811df">DryMatterStorage</a>;
<a name="l00788"></a>00788       cutN.<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a> += aNitrogenInStorage.<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a>;
<a name="l00789"></a>00789       <a class="code" href="classcrop.html#a4a2803c0618d2f662abfa8d230c811df">DryMatterStorage</a>=0.0;
<a name="l00790"></a>00790       <a class="code" href="classcrop.html#adabbdde8753e5ae0ecd238e221429d88" title="How much Nitrogen that is in the plant.">Nitrogen</a>.<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a> -=  aNitrogenInStorage.<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a>;
<a name="l00791"></a>00791    }
<a name="l00792"></a>00792 
<a name="l00793"></a>00793    <span class="keywordflow">if</span> (cutPlantMaterial-&gt;<a class="code" href="classlive_matter.html#ad3d05f1e8ceedc99e214adca94638de0">GetdryMatter</a>()&lt;0.01)
<a name="l00794"></a>00794    {
<a name="l00795"></a>00795       <a class="code" href="message_8h.html#a8ad29009121a629982c6ade0bd332470">theMessage</a>-&gt;<a class="code" href="classmessage.html#af9891cb7111375e6a36363afffb09d63">FatalError</a>(<span class="stringliteral">&quot;cropRyegrass::Cut - dry matter content is below 1 %&quot;</span>);
<a name="l00796"></a>00796       cutPlantMaterial-&gt;<a class="code" href="classlive_matter.html#aee8cb3a1d73625321b1b73dd285dffb4">SetDryMatter</a>(0.10); <span class="comment">// In order to be able to debug</span>
<a name="l00797"></a>00797    }
<a name="l00798"></a>00798    cutPlantMaterial-&gt;<a class="code" href="classproduct.html#a18ec2e96f1d9b7cef74c4b2800ebdca1">Setamount</a>(cutDM/cutPlantMaterial-&gt;<a class="code" href="classlive_matter.html#ad3d05f1e8ceedc99e214adca94638de0">GetdryMatter</a>());     <span class="comment">//adjust for DM content</span>
<a name="l00799"></a>00799    <span class="keywordflow">if</span> (cutPlantMaterial-&gt;<a class="code" href="classproduct.html#a021ebef2da57e1d977cfe57e62c6e38b">GetAmount</a>()&gt;0.0)
<a name="l00800"></a>00800            cutPlantMaterial-&gt;<a class="code" href="classlive_matter.html#adbb45be219dd863cfad2b5e97cde1508">SetorgN_content</a>(cutN/cutPlantMaterial-&gt;<a class="code" href="classproduct.html#a021ebef2da57e1d977cfe57e62c6e38b">GetAmount</a>());
<a name="l00801"></a>00801    <a class="code" href="classcrop.html#af7ae14fac12af3efa728e789155983fb">Nbudget</a>.<a class="code" href="classbudget.html#a47bfa9740186f2be18a10dd3423a5eea">AddOutput</a>(cutN.<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a>);                    <span class="comment">// Budgets</span>
<a name="l00802"></a>00802    <a class="code" href="classcrop.html#a46844fd0540eb7627555f21afa8545e8">DMbudget</a>.<a class="code" href="classbudget.html#a47bfa9740186f2be18a10dd3423a5eea">AddOutput</a>(cutDM);
<a name="l00803"></a>00803    <span class="keywordflow">if</span> (<a class="code" href="classcrop_ryegrass.html#aedd4ae77832a94a71902085022f1eb88">GiveDryMatterVegTop</a>()&lt;=0.0)
<a name="l00804"></a>00804       <a class="code" href="message_8h.html#a8ad29009121a629982c6ade0bd332470">theMessage</a>-&gt;<a class="code" href="classmessage.html#afed66d0552f90b4385c5169cf5929907">WarningWithDisplay</a>(<span class="stringliteral">&quot;cropRyegrass::Cut - zero or negative amount of dry matter in veg. top&quot;</span>);
<a name="l00805"></a>00805    <a class="code" href="classcrop_ryegrass.html#affc800f21a3c26e2277a8e5679c27204">HasBeenCut</a> = <span class="keyword">true</span>;
<a name="l00806"></a>00806    <a class="code" href="classcrop.html#a38f05d3f77cfc67ff755eb8c0d79e301">Phenology</a>-&gt;<a class="code" href="classphenology.html#aca23c5511f877cde110a2ee69f98463d">SetDSAfterCut</a>();
<a name="l00807"></a>00807 }
<a name="l00808"></a>00808 
<a name="l00809"></a>00809 <span class="comment">/****************************************************************************\</span>
<a name="l00810"></a>00810 <span class="comment">\****************************************************************************/</span>
<a name="l00811"></a><a class="code" href="classcrop_ryegrass.html#aac89498ebd762c28e8bed76ec7c78db0">00811</a> <span class="keywordtype">double</span> <a class="code" href="classcrop_ryegrass.html#aac89498ebd762c28e8bed76ec7c78db0">cropRyegrass::Nmax</a>()
<a name="l00812"></a>00812 {
<a name="l00813"></a>00813    <span class="keywordtype">double</span> StdNmax = <a class="code" href="classcrop_ryegrass.html#aac89498ebd762c28e8bed76ec7c78db0">crop::Nmax</a>();
<a name="l00814"></a>00814 <span class="comment">//   if (!CutOrHarvested)</span>
<a name="l00815"></a>00815 <span class="comment">//      StdNmax = RelativeDensity*StdNmax;  Deleted MEL 2009!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</span>
<a name="l00816"></a>00816    <span class="keywordflow">return</span> StdNmax;
<a name="l00817"></a>00817 }
<a name="l00818"></a>00818 
<a name="l00819"></a>00819 <span class="comment">/****************************************************************************\</span>
<a name="l00820"></a>00820 <span class="comment">\****************************************************************************/</span>
<a name="l00821"></a><a class="code" href="classcrop_ryegrass.html#ad5e9c54a99aa929e1ecab9c7146b6b09">00821</a> <span class="keywordtype">double</span> <a class="code" href="classcrop_ryegrass.html#ad5e9c54a99aa929e1ecab9c7146b6b09">cropRyegrass::GiveCropHeight</a>()
<a name="l00822"></a>00822 {
<a name="l00823"></a>00823    <span class="keywordflow">return</span> <a class="code" href="classcrop.html#a3f40980535ac184d9cced18aff1a0f8c">PlantHeight</a>;
<a name="l00824"></a>00824 }
<a name="l00825"></a>00825 
<a name="l00826"></a>00826 <span class="comment">/****************************************************************************\</span>
<a name="l00827"></a>00827 <span class="comment">Calculates grazable DM, N,C</span>
<a name="l00828"></a>00828 <span class="comment">Loads information on the available material into myProduct</span>
<a name="l00829"></a>00829 <span class="comment">Returns amount in g fresh weight/sq metre</span>
<a name="l00830"></a>00830 <span class="comment">\****************************************************************************/</span>
<a name="l00831"></a><a class="code" href="classcrop_ryegrass.html#a3907b56b9f463da7667d89f726543ef5">00831</a> <a class="code" href="classfeed_item.html">feedItem</a> *  <a class="code" href="classcrop_ryegrass.html#a3907b56b9f463da7667d89f726543ef5">cropRyegrass::GetAvailability</a>(<span class="keywordtype">double</span> cutHeight, <span class="keywordtype">int</span> animalType)
<a name="l00832"></a>00832 {
<a name="l00833"></a>00833         <a class="code" href="classfeed_item.html">feedItem</a> *myProduct = <span class="keyword">new</span> <a class="code" href="classfeed_item.html">feedItem</a>(*(<a class="code" href="classfeed_item.html">feedItem</a> *)<a class="code" href="_new_main_8cpp.html#af1019990138497f1f18cc7294737d140">theProducts</a>-&gt;<a class="code" href="classproducts.html#a974a21684ae848c86b4b5a607f2e054a">GetProductElement</a>(465));  <span class="comment">//set product to grass, 100kgN, cut after 2 weeks (N content will be modified)</span>
<a name="l00834"></a>00834         myProduct-&gt;<a class="code" href="classproduct.html#a18ec2e96f1d9b7cef74c4b2800ebdca1">Setamount</a>(0.0);
<a name="l00835"></a>00835    <span class="keywordtype">double</span> OMD=0;
<a name="l00836"></a>00836    <span class="keywordtype">double</span> tempDigest = 0.0;
<a name="l00837"></a>00837    <a class="code" href="classcrop_ryegrass.html#aebfc7e7f1e48269a0b41f08c27072b61">grazableDM</a> = 0.0;
<a name="l00838"></a>00838    <a class="code" href="classcrop_ryegrass.html#a6fd909e402b37a89599cef6d026671c0">grazableN</a> = 0.0;
<a name="l00839"></a>00839 
<a name="l00840"></a>00840    <span class="keywordtype">double</span> N_conc = <a class="code" href="classcrop.html#a82bef6e98553aa173173b0ea454a3e0a">NitrogenInVegTop</a>().<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a>/<a class="code" href="classcrop_ryegrass.html#aedd4ae77832a94a71902085022f1eb88">GiveDryMatterVegTop</a>();
<a name="l00841"></a>00841    <a class="code" href="classcrop_ryegrass.html#a0b667252165fc134819df04548618d56">liveOMD</a> = 0.4 + 15.4 * (N_conc-0.006);
<a name="l00842"></a>00842    <span class="keywordflow">if</span> (<a class="code" href="classcrop_ryegrass.html#a0b667252165fc134819df04548618d56">liveOMD</a>&gt;0.8)
<a name="l00843"></a>00843         <a class="code" href="classcrop_ryegrass.html#a0b667252165fc134819df04548618d56">liveOMD</a> = 0.8;
<a name="l00844"></a>00844    <span class="keywordflow">if</span> (<a class="code" href="classcrop_ryegrass.html#a0b667252165fc134819df04548618d56">liveOMD</a>&lt;<a class="code" href="classcrop_ryegrass.html#aad215af4abecd60bf33e223aafec8e6c">deadOMD</a>)
<a name="l00845"></a>00845         <a class="code" href="classcrop_ryegrass.html#a0b667252165fc134819df04548618d56">liveOMD</a> = <a class="code" href="classcrop_ryegrass.html#aad215af4abecd60bf33e223aafec8e6c">deadOMD</a>;
<a name="l00846"></a>00846    <a class="code" href="classcrop_ryegrass.html#aebfc7e7f1e48269a0b41f08c27072b61">grazableDM</a>=<a class="code" href="classcrop_ryegrass.html#a786315f2c2b87cc9777d7f2df5418a94">GetAvailableDM</a>(0.0);
<a name="l00847"></a>00847    tempDigest= <a class="code" href="classcrop_ryegrass.html#a3381e4ddcee9b9442e6c408bed6912eb">GetAvailableDigestibleDM</a>(0.0);
<a name="l00848"></a>00848 
<a name="l00849"></a>00849    <span class="keywordflow">if</span> (<a class="code" href="classcrop_ryegrass.html#aebfc7e7f1e48269a0b41f08c27072b61">grazableDM</a>&gt;0)
<a name="l00850"></a>00850         {
<a name="l00851"></a>00851          <a class="code" href="classcrop_ryegrass.html#a6fd909e402b37a89599cef6d026671c0">grazableN</a> =<a class="code" href="classcrop_ryegrass.html#af6affcb746b98c982f16ccb6da904010">GetAvailableN</a>(0.0);
<a name="l00852"></a>00852          myProduct-&gt;<a class="code" href="classproduct.html#a18ec2e96f1d9b7cef74c4b2800ebdca1">Setamount</a>(<a class="code" href="classcrop_ryegrass.html#aebfc7e7f1e48269a0b41f08c27072b61">grazableDM</a>/myProduct-&gt;<a class="code" href="classlive_matter.html#ad3d05f1e8ceedc99e214adca94638de0">GetdryMatter</a>());
<a name="l00853"></a>00853          myProduct-&gt;<a class="code" href="classlive_matter.html#adbb45be219dd863cfad2b5e97cde1508">SetorgN_content</a>(<a class="code" href="classcrop_ryegrass.html#a6fd909e402b37a89599cef6d026671c0">grazableN</a>/myProduct-&gt;<a class="code" href="classproduct.html#a021ebef2da57e1d977cfe57e62c6e38b">GetAmount</a>());
<a name="l00854"></a>00854          <span class="keywordflow">switch</span> (animalType)
<a name="l00855"></a>00855          {
<a name="l00856"></a>00856             <span class="keywordflow">case</span> 1:
<a name="l00857"></a>00857             {
<a name="l00858"></a>00858                OMD=tempDigest/<a class="code" href="classcrop_ryegrass.html#aebfc7e7f1e48269a0b41f08c27072b61">grazableDM</a>;
<a name="l00859"></a>00859                <span class="comment">// FUDGE!!!------------------------------------------------------</span>
<a name="l00860"></a>00860                <span class="comment">/*</span>
<a name="l00861"></a>00861 <span class="comment">               OMD=0.73+grazableDM*0.0001;</span>
<a name="l00862"></a>00862 <span class="comment">               if (OMD&gt;0.77)</span>
<a name="l00863"></a>00863 <span class="comment">                  OMD=0.77+grazableDM*0.000001; // Worst hack&#39; ever made (since the last time at least) !!!</span>
<a name="l00864"></a>00864 <span class="comment">               if (OMD&gt;0.78)</span>
<a name="l00865"></a>00865 <span class="comment">                  OMD=0.78;</span>
<a name="l00866"></a>00866 <span class="comment">               */</span>
<a name="l00867"></a>00867                <span class="comment">// --------------------------------------------------------------</span>
<a name="l00868"></a>00868                myProduct-&gt;<a class="code" href="classfeed_item.html#a18ed185e5691256001dbe832b2acea08">SetOMD</a>(OMD);
<a name="l00869"></a>00869                myProduct-&gt;<a class="code" href="classfeed_item.html#a65b1eff694520848d90bcecad5f1c317">CalcME</a>();
<a name="l00870"></a>00870                myProduct-&gt;<a class="code" href="classfeed_item.html#a638c45c2e59d81f7e21cd92b511db906">CalcFE</a>();
<a name="l00871"></a>00871                myProduct-&gt;<a class="code" href="classfeed_item.html#a1df09eb5f68546dac21b1088cee22cea">CalcFill</a>(2);
<a name="l00872"></a>00872                <span class="keywordtype">double</span> MEPerKg = 0.16*myProduct-&gt;<a class="code" href="classfeed_item.html#a94fa874b2d66b1443fc2ebc26d4529aa">GetOMD</a>()*100.0 - 1.8;  <span class="comment">// from SCA 1990</span>
<a name="l00873"></a>00873                myProduct-&gt;<a class="code" href="classfeed_item.html#a524a9bf0c873bd9a420c3d66f837d005">SetME</a>(MEPerKg * myProduct-&gt;<a class="code" href="classlive_matter.html#ad3d05f1e8ceedc99e214adca94638de0">GetdryMatter</a>());
<a name="l00874"></a>00874                <span class="keywordflow">break</span>;
<a name="l00875"></a>00875             }
<a name="l00876"></a>00876             <span class="keywordflow">default</span>:
<a name="l00877"></a>00877             {
<a name="l00878"></a>00878                <a class="code" href="message_8h.html#a8ad29009121a629982c6ade0bd332470">theMessage</a>-&gt;<a class="code" href="classmessage.html#af9891cb7111375e6a36363afffb09d63">FatalError</a>(<span class="stringliteral">&quot;cropRyegrass::GetAvailability - not an allowed animal type&quot;</span>);
<a name="l00879"></a>00879                <span class="keywordflow">break</span>;
<a name="l00880"></a>00880             }
<a name="l00881"></a>00881          }
<a name="l00882"></a>00882       }
<a name="l00883"></a>00883         <span class="keywordflow">return</span> myProduct;
<a name="l00884"></a>00884 }
<a name="l00885"></a>00885 
<a name="l00886"></a>00886 <span class="comment">/****************************************************************************\</span>
<a name="l00887"></a>00887 <span class="comment">Returns DM above the &#39;cut height&#39;</span>
<a name="l00888"></a>00888 <span class="comment">\****************************************************************************/</span>
<a name="l00889"></a><a class="code" href="classcrop_ryegrass.html#a4bf3812ba96c183f5ff8b671d8ee9d85">00889</a> <span class="keywordtype">double</span> <a class="code" href="classcrop_ryegrass.html#a4bf3812ba96c183f5ff8b671d8ee9d85">cropRyegrass::GetAvailableStandingDM</a>(<span class="keywordtype">double</span> cutHeight,<span class="keywordtype">bool</span> useUptakeWeight)
<a name="l00890"></a>00890 {
<a name="l00891"></a>00891    <span class="keywordtype">double</span> temp_height, tempDM, proportionCut;
<a name="l00892"></a>00892    <a class="code" href="classcrop_ryegrass.html#aebfc7e7f1e48269a0b41f08c27072b61">grazableDM</a> = 0.0;
<a name="l00893"></a>00893    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;4;i++)
<a name="l00894"></a>00894    {
<a name="l00895"></a>00895       temp_height=<a class="code" href="classcrop.html#a3f40980535ac184d9cced18aff1a0f8c">PlantHeight</a>;
<a name="l00896"></a>00896       <span class="keywordtype">double</span> cutH=max(cutHeight,0.01);
<a name="l00897"></a>00897       <span class="keywordflow">if</span> (temp_height&gt;cutH)
<a name="l00898"></a>00898         proportionCut=(temp_height - cutH)/temp_height;
<a name="l00899"></a>00899       <span class="keywordflow">else</span>
<a name="l00900"></a>00900         proportionCut = 0.0;
<a name="l00901"></a>00901       <span class="keywordtype">double</span> w=1.0;
<a name="l00902"></a>00902       <span class="keywordflow">if</span> (useUptakeWeight)
<a name="l00903"></a>00903          w=<a class="code" href="classcrop_ryegrass.html#a445c84d8258d5047e62dcd3d222cf8bd">uptakeWeight</a>[i];
<a name="l00904"></a>00904       tempDM=proportionCut * <a class="code" href="classcrop_ryegrass.html#ae9641d6c7c5459eb6053cb421df4e8d0">AgeClassTop</a>[i] * w;
<a name="l00905"></a>00905            <a class="code" href="classcrop_ryegrass.html#aebfc7e7f1e48269a0b41f08c27072b61">grazableDM</a> +=tempDM;
<a name="l00906"></a>00906    }
<a name="l00907"></a>00907    <span class="keywordflow">return</span> <a class="code" href="classcrop_ryegrass.html#aebfc7e7f1e48269a0b41f08c27072b61">grazableDM</a>;
<a name="l00908"></a>00908 
<a name="l00909"></a>00909    <span class="comment">/* NJH code @@@</span>
<a name="l00910"></a>00910 <span class="comment">   double cropHeight = GiveCropHeight();</span>
<a name="l00911"></a>00911 <span class="comment">   double availableDM = 0.0;</span>
<a name="l00912"></a>00912 <span class="comment">   if (cropHeight&gt;cutHeight)</span>
<a name="l00913"></a>00913 <span class="comment">        availableDM=(1.0-(cutHeight/cropHeight))*DryMatterTotalStand;</span>
<a name="l00914"></a>00914 <span class="comment">   return availableDM;</span>
<a name="l00915"></a>00915 <span class="comment">   */</span>
<a name="l00916"></a>00916 
<a name="l00917"></a>00917 }
<a name="l00918"></a>00918 
<a name="l00919"></a>00919 <span class="comment">/****************************************************************************\</span>
<a name="l00920"></a>00920 <span class="comment">Adds an animal&#39;s contribution to the patch&#39;s grazed material</span>
<a name="l00921"></a>00921 <span class="comment">Each animal calls this routine if it grazes this patch</span>
<a name="l00922"></a>00922 <span class="comment">\****************************************************************************/</span>
<a name="l00923"></a><a class="code" href="classcrop_ryegrass.html#a64930de42e02d7aa99becc169c5a8b19">00923</a> <span class="keywordtype">void</span> <a class="code" href="classcrop_ryegrass.html#a64930de42e02d7aa99becc169c5a8b19">cropRyegrass::SetGrazed</a>(<span class="keywordtype">double</span> grazing_height, <span class="keywordtype">double</span> DMGrazed)
<a name="l00924"></a>00924 {
<a name="l00925"></a>00925    <a class="code" href="classcrop_ryegrass.html#aebfc7e7f1e48269a0b41f08c27072b61">grazableDM</a> = <a class="code" href="classcrop_ryegrass.html#a786315f2c2b87cc9777d7f2df5418a94">GetAvailableDM</a>(0.0);
<a name="l00926"></a>00926    <span class="keywordtype">double</span> proportionCut=DMGrazed/<a class="code" href="classcrop_ryegrass.html#aebfc7e7f1e48269a0b41f08c27072b61">grazableDM</a>;
<a name="l00927"></a>00927 <span class="comment">//   cout &lt;&lt; theTime &lt;&lt; &quot; DMGrazed &quot; &lt;&lt; DMGrazed &lt;&lt; &quot; grazing_height &quot; &lt;&lt; grazing_height &lt;&lt; &quot; Nitrogen &quot; &lt;&lt; Nitrogen.n &lt;&lt; endl;</span>
<a name="l00928"></a>00928    <span class="keywordtype">double</span> checkDM=0.0;
<a name="l00929"></a>00929    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;4;i++)
<a name="l00930"></a>00930    {
<a name="l00931"></a>00931                 <span class="comment">// Material is removed by grazing in proportion to its contribution to grazable DM</span>
<a name="l00932"></a>00932       <span class="keywordflow">if</span> (<a class="code" href="classcrop_ryegrass.html#aebfc7e7f1e48269a0b41f08c27072b61">grazableDM</a>&gt;0.0)
<a name="l00933"></a>00933       {
<a name="l00934"></a>00934         <a class="code" href="classcrop_ryegrass.html#a60b9ccc77a862693545200a71d113608">grazedDM</a>[i]+=proportionCut * <a class="code" href="classcrop_ryegrass.html#ae9641d6c7c5459eb6053cb421df4e8d0">AgeClassTop</a>[i] * <a class="code" href="classcrop_ryegrass.html#a445c84d8258d5047e62dcd3d222cf8bd">uptakeWeight</a>[i];
<a name="l00935"></a>00935          checkDM+=<a class="code" href="classcrop_ryegrass.html#a60b9ccc77a862693545200a71d113608">grazedDM</a>[i];
<a name="l00936"></a>00936 <span class="comment">//            cout &lt;&lt; theTime &lt;&lt; &quot; i &quot; &lt;&lt; i &lt;&lt; &quot; grazedDM &quot;  &lt;&lt; grazedDM[i] &lt;&lt; endl;</span>
<a name="l00937"></a>00937       }
<a name="l00938"></a>00938    }
<a name="l00939"></a>00939 }
<a name="l00940"></a>00940 
<a name="l00941"></a>00941 
<a name="l00942"></a>00942 <span class="comment">/****************************************************************************\</span>
<a name="l00943"></a>00943 <span class="comment">NJH - Aug 2001 - as for crop.cpp but checks to make sure grazing has not</span>
<a name="l00944"></a>00944 <span class="comment">occurred on the day of ploughing</span>
<a name="l00945"></a>00945 <span class="comment">\****************************************************************************/</span>
<a name="l00946"></a><a class="code" href="classcrop_ryegrass.html#a9a97cb45a3f91020ccf85f6fabcc532a">00946</a> <span class="keywordtype">void</span> <a class="code" href="classcrop_ryegrass.html#a9a97cb45a3f91020ccf85f6fabcc532a" title="kills the crop">cropRyegrass::Terminate</a>(<a class="code" href="classdecomposable.html">decomposable</a>* Straw,<a class="code" href="classdecomposable.html">decomposable</a>* DeadRoot,<span class="keywordtype">double</span> *&amp; RootLengthList)
<a name="l00947"></a>00947 {
<a name="l00948"></a>00948    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;4;i++)
<a name="l00949"></a>00949       <span class="keywordflow">if</span> (<a class="code" href="classcrop_ryegrass.html#a60b9ccc77a862693545200a71d113608">grazedDM</a>[i]&gt;0)
<a name="l00950"></a>00950          <a class="code" href="message_8h.html#a8ad29009121a629982c6ade0bd332470">theMessage</a>-&gt;<a class="code" href="classmessage.html#af9891cb7111375e6a36363afffb09d63">FatalError</a>(<span class="stringliteral">&quot;cropRyegrass::Terminate - terminating a crop on same day as it was grazed&quot;</span>);
<a name="l00951"></a>00951    <a class="code" href="classcrop.html#a3c5f4942cf46d45168caf4da80b79537">DryMatterRoot</a> += <a class="code" href="classcrop_ryegrass.html#a20afe6ee954c51fafe8d0c184c395c65">ReSeedDM</a>;
<a name="l00952"></a>00952    <a class="code" href="classcrop_ryegrass.html#a20afe6ee954c51fafe8d0c184c395c65">ReSeedDM</a> = 0.0;
<a name="l00953"></a>00953 <span class="comment">/*   Nitrogen = Nitrogen + ReSeedN;</span>
<a name="l00954"></a>00954 <span class="comment">   ReSeedN.SetBoth(0.0,0.0);     */</span>
<a name="l00955"></a>00955    <a class="code" href="classcrop_ryegrass.html#a9a97cb45a3f91020ccf85f6fabcc532a" title="kills the crop">crop::Terminate</a>(Straw,DeadRoot,RootLengthList);
<a name="l00956"></a>00956 }
<a name="l00957"></a>00957 
<a name="l00958"></a>00958 <span class="comment">/****************************************************************************\</span>
<a name="l00959"></a>00959 <span class="comment">NJH 2005 return the amount of DM grazed during the last period, then zero the values</span>
<a name="l00960"></a>00960 <span class="comment">\****************************************************************************/</span>
<a name="l00961"></a><a class="code" href="classcrop_ryegrass.html#a02c5bec33e0f0a6240c34dde03a09e01">00961</a> <span class="keywordtype">double</span> <a class="code" href="classcrop_ryegrass.html#a02c5bec33e0f0a6240c34dde03a09e01" title="return 0">cropRyegrass::GetGrazedDM</a>()
<a name="l00962"></a>00962 {
<a name="l00963"></a>00963         <span class="keywordtype">double</span> ret_val=0.0;
<a name="l00964"></a>00964    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;4;i++)
<a name="l00965"></a>00965    {
<a name="l00966"></a>00966       ret_val+=<a class="code" href="classcrop_ryegrass.html#a60b9ccc77a862693545200a71d113608">grazedDM</a>[i];
<a name="l00967"></a>00967 <span class="comment">//      grazedDM[i]=0.0;</span>
<a name="l00968"></a>00968    }
<a name="l00969"></a>00969    <span class="keywordflow">return</span> ret_val;
<a name="l00970"></a>00970 }
<a name="l00971"></a>00971 
<a name="l00972"></a>00972 <span class="comment">/****************************************************************************\</span>
<a name="l00973"></a>00973 <span class="comment">\****************************************************************************/</span>
<a name="l00974"></a><a class="code" href="classcrop_ryegrass.html#a8c524dccd76c81476124974e3e486a33">00974</a> <span class="keywordtype">void</span> <a class="code" href="classcrop_ryegrass.html#a8c524dccd76c81476124974e3e486a33" title="does nothing">cropRyegrass::ClearTemporaryVariables</a>()
<a name="l00975"></a>00975 {
<a name="l00976"></a>00976    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;4;i++)
<a name="l00977"></a>00977       <a class="code" href="classcrop_ryegrass.html#a60b9ccc77a862693545200a71d113608">grazedDM</a>[i]=0.0;
<a name="l00978"></a>00978 }
<a name="l00979"></a>00979 <span class="comment">/****************************************************************************\</span>
<a name="l00980"></a>00980 <span class="comment">\****************************************************************************/</span>
<a name="l00981"></a><a class="code" href="classcrop_ryegrass.html#a5bb3f7b2ad5805e527bea21bbb71531c">00981</a> <span class="keywordtype">bool</span> <a class="code" href="classcrop_ryegrass.html#a5bb3f7b2ad5805e527bea21bbb71531c">cropRyegrass::EndBudget</a>(<span class="keywordtype">double</span> * NRemain, <span class="keywordtype">double</span> * DMRemain)
<a name="l00982"></a>00982 {
<a name="l00983"></a>00983         <span class="keywordtype">bool</span> retVal=<span class="keyword">true</span>;
<a name="l00984"></a>00984         *NRemain=<a class="code" href="classcrop.html#adabbdde8753e5ae0ecd238e221429d88" title="How much Nitrogen that is in the plant.">Nitrogen</a>.<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a>;
<a name="l00985"></a>00985         *DMRemain=<a class="code" href="classcrop_ryegrass.html#aedd4ae77832a94a71902085022f1eb88">GiveDryMatterVegTop</a>()+<a class="code" href="classcrop.html#a3c5f4942cf46d45168caf4da80b79537">DryMatterRoot</a>+<a class="code" href="classcrop.html#a4a2803c0618d2f662abfa8d230c811df">DryMatterStorage</a>+<a class="code" href="classcrop.html#a2dfb21c27aff36f3049be9a39e7c6538">SeedDM</a>+<a class="code" href="classcrop_ryegrass.html#a20afe6ee954c51fafe8d0c184c395c65">ReSeedDM</a>;
<a name="l00986"></a>00986    <span class="keywordflow">if</span> (!<a class="code" href="classcrop.html#af7ae14fac12af3efa728e789155983fb">Nbudget</a>.<a class="code" href="classbudget.html#a2814c71d2d504462defc2c85f2cd86b2">Balance</a>(*NRemain))
<a name="l00987"></a>00987         retVal=<span class="keyword">false</span>;
<a name="l00988"></a>00988    <span class="keywordflow">if</span> (!<a class="code" href="classcrop.html#a46844fd0540eb7627555f21afa8545e8">DMbudget</a>.<a class="code" href="classbudget.html#a2814c71d2d504462defc2c85f2cd86b2">Balance</a>(*DMRemain))
<a name="l00989"></a>00989    {
<a name="l00990"></a>00990         retVal=<span class="keyword">false</span>;
<a name="l00991"></a>00991       cout &lt;&lt; <span class="stringliteral">&quot;Dry matter &quot;</span> &lt;&lt; <a class="code" href="classcrop_ryegrass.html#aedd4ae77832a94a71902085022f1eb88">GiveDryMatterVegTop</a>() &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="classcrop.html#a3c5f4942cf46d45168caf4da80b79537">DryMatterRoot</a>
<a name="l00992"></a>00992            &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="classcrop.html#a4a2803c0618d2f662abfa8d230c811df">DryMatterStorage</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="classcrop.html#a2dfb21c27aff36f3049be9a39e7c6538">SeedDM</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span>  &lt;&lt; ReSeedDM &lt;&lt; endl; <span class="comment">// !!!!!!</span>
<a name="l00993"></a>00993       cout &lt;&lt; <span class="stringliteral">&quot;&quot;</span>;
<a name="l00994"></a>00994    }
<a name="l00995"></a>00995    <span class="keywordtype">double</span> N15Remain = <a class="code" href="classcrop.html#adabbdde8753e5ae0ecd238e221429d88" title="How much Nitrogen that is in the plant.">Nitrogen</a>.<a class="code" href="classnitrogen.html#a2d537cc848da50f09b7580539f261dfc">n15</a>;
<a name="l00996"></a>00996    <span class="keywordflow">if</span> (!<a class="code" href="classcrop.html#a3e5fad944be35152e933b5e50f928f5a">N15budget</a>.<a class="code" href="classbudget.html#a2814c71d2d504462defc2c85f2cd86b2">Balance</a>(N15Remain))
<a name="l00997"></a>00997         retVal=<span class="keyword">false</span>;
<a name="l00998"></a>00998    <span class="keywordflow">return</span> retVal;
<a name="l00999"></a>00999 }
<a name="l01000"></a>01000 
<a name="l01001"></a><a class="code" href="classcrop_ryegrass.html#a703a0dfb57d64605ee2e0268a46d34ed">01001</a> <span class="keywordtype">void</span> <a class="code" href="classcrop_ryegrass.html#a703a0dfb57d64605ee2e0268a46d34ed" title="Used when the amount grazed has been determined externally and the grazed material needs to be remove...">cropRyegrass::Grazing</a>(<span class="keywordtype">double</span> grazedDM)
<a name="l01002"></a>01002 {
<a name="l01003"></a>01003            <span class="keywordtype">double</span> tempDM, proportionCut;
<a name="l01004"></a>01004            <a class="code" href="classnitrogen.html">nitrogen</a> cutN = 0.0;
<a name="l01005"></a>01005            <span class="keywordtype">double</span> initialDM=<a class="code" href="classcrop_ryegrass.html#aedd4ae77832a94a71902085022f1eb88">GiveDryMatterVegTop</a>()+<a class="code" href="classcrop.html#a4a2803c0618d2f662abfa8d230c811df">DryMatterStorage</a>;
<a name="l01006"></a>01006            proportionCut = grazedDM/initialDM;
<a name="l01007"></a>01007            <span class="keywordflow">if</span> (proportionCut&gt;1.0)
<a name="l01008"></a>01008                    <a class="code" href="message_8h.html#a8ad29009121a629982c6ade0bd332470">theMessage</a>-&gt;<a class="code" href="classmessage.html#af9891cb7111375e6a36363afffb09d63">FatalError</a>(<span class="stringliteral">&quot;cropRyegrass::Grazing - Proportion cut &gt; 1.0&quot;</span>);
<a name="l01009"></a>01009            <a class="code" href="classnitrogen.html">nitrogen</a>  aNitrogenInVegTop = <a class="code" href="classcrop.html#a82bef6e98553aa173173b0ea454a3e0a">NitrogenInVegTop</a>();
<a name="l01010"></a>01010            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;4;i++)
<a name="l01011"></a>01011            {
<a name="l01012"></a>01012               tempDM = proportionCut*<a class="code" href="classcrop_ryegrass.html#ae9641d6c7c5459eb6053cb421df4e8d0">AgeClassTop</a>[i];
<a name="l01013"></a>01013               AgeClassTop[i]-= tempDM;   <span class="comment">//cut material</span>
<a name="l01014"></a>01014            }
<a name="l01015"></a>01015       cutN = aNitrogenInVegTop*proportionCut;
<a name="l01016"></a>01016       <a class="code" href="classcrop.html#adabbdde8753e5ae0ecd238e221429d88" title="How much Nitrogen that is in the plant.">Nitrogen</a> = <a class="code" href="classcrop.html#adabbdde8753e5ae0ecd238e221429d88" title="How much Nitrogen that is in the plant.">Nitrogen</a>-cutN;
<a name="l01017"></a>01017            <span class="keywordflow">if</span> (<a class="code" href="classcrop.html#a4a2803c0618d2f662abfa8d230c811df">DryMatterStorage</a> &gt; 0.0)
<a name="l01018"></a>01018            {
<a name="l01019"></a>01019                   <a class="code" href="classnitrogen.html">nitrogen</a> aNitrogenInStorage=<a class="code" href="classcrop.html#a4f4f31c68a905ef3fef26b9d7456cb36">NitrogenInStorage</a>().<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a>;
<a name="l01020"></a>01020                   <a class="code" href="classcrop.html#a4a2803c0618d2f662abfa8d230c811df">DryMatterStorage</a>*=(1-proportionCut);
<a name="l01021"></a>01021               aNitrogenInStorage.<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a>*=(1-proportionCut);
<a name="l01022"></a>01022               <a class="code" href="classcrop.html#adabbdde8753e5ae0ecd238e221429d88" title="How much Nitrogen that is in the plant.">Nitrogen</a>.<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a> -=  aNitrogenInStorage.<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a>;
<a name="l01023"></a>01023            }
<a name="l01024"></a>01024 
<a name="l01025"></a>01025 }
<a name="l01026"></a>01026 
<a name="l01027"></a><a class="code" href="classcrop_ryegrass.html#a786315f2c2b87cc9777d7f2df5418a94">01027</a> <span class="keywordtype">double</span> <a class="code" href="classcrop_ryegrass.html#a786315f2c2b87cc9777d7f2df5418a94">cropRyegrass::GetAvailableDM</a>(<span class="keywordtype">double</span> residualDM)
<a name="l01028"></a>01028 {
<a name="l01029"></a>01029         <span class="keywordtype">double</span> retVal=0.0;
<a name="l01030"></a>01030    residualDM/=4.0;
<a name="l01031"></a>01031    <span class="keywordtype">double</span> tempDM=0.0;
<a name="l01032"></a>01032    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;4;i++)
<a name="l01033"></a>01033    {
<a name="l01034"></a>01034         tempDM=<a class="code" href="classcrop_ryegrass.html#ae9641d6c7c5459eb6053cb421df4e8d0">AgeClassTop</a>[i] * <a class="code" href="classcrop_ryegrass.html#a445c84d8258d5047e62dcd3d222cf8bd">uptakeWeight</a>[i] - residualDM;
<a name="l01035"></a>01035         <span class="keywordflow">if</span> (tempDM&gt;0.0)
<a name="l01036"></a>01036               retVal+=tempDM;
<a name="l01037"></a>01037    }
<a name="l01038"></a>01038    <span class="keywordflow">return</span> retVal;
<a name="l01039"></a>01039 }
<a name="l01040"></a><a class="code" href="classcrop_ryegrass.html#a3381e4ddcee9b9442e6c408bed6912eb">01040</a> <span class="keywordtype">double</span> <a class="code" href="classcrop_ryegrass.html#a3381e4ddcee9b9442e6c408bed6912eb">cropRyegrass::GetAvailableDigestibleDM</a>(<span class="keywordtype">double</span> residualDM)
<a name="l01041"></a>01041 {
<a name="l01042"></a>01042         <span class="keywordtype">double</span> retVal=0.0;
<a name="l01043"></a>01043    residualDM/=4.0;
<a name="l01044"></a>01044    <span class="keywordtype">double</span> tempDM=0.0;
<a name="l01045"></a>01045    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;4;i++)
<a name="l01046"></a>01046    {
<a name="l01047"></a>01047         tempDM=<a class="code" href="classcrop_ryegrass.html#ae9641d6c7c5459eb6053cb421df4e8d0">AgeClassTop</a>[i] * <a class="code" href="classcrop_ryegrass.html#a445c84d8258d5047e62dcd3d222cf8bd">uptakeWeight</a>[i] - residualDM;
<a name="l01048"></a>01048         <span class="keywordflow">if</span> (tempDM&gt;0.0)
<a name="l01049"></a>01049       {
<a name="l01050"></a>01050          <span class="keywordflow">if</span> (i&lt;3)
<a name="l01051"></a>01051             retVal += tempDM * <a class="code" href="classcrop_ryegrass.html#a0b667252165fc134819df04548618d56">liveOMD</a>;
<a name="l01052"></a>01052          <span class="keywordflow">else</span>
<a name="l01053"></a>01053             retVal += tempDM * <a class="code" href="classcrop_ryegrass.html#aad215af4abecd60bf33e223aafec8e6c">deadOMD</a>;
<a name="l01054"></a>01054       }
<a name="l01055"></a>01055    }
<a name="l01056"></a>01056    <span class="keywordflow">return</span> retVal;
<a name="l01057"></a>01057 }
<a name="l01058"></a>01058 
<a name="l01059"></a><a class="code" href="classcrop_ryegrass.html#af6affcb746b98c982f16ccb6da904010">01059</a> <span class="keywordtype">double</span> <a class="code" href="classcrop_ryegrass.html#af6affcb746b98c982f16ccb6da904010">cropRyegrass::GetAvailableN</a>(<span class="keywordtype">double</span> residualDM)
<a name="l01060"></a>01060 {
<a name="l01061"></a>01061         <span class="keywordtype">double</span> retVal=0.0;
<a name="l01062"></a>01062    <span class="keywordtype">double</span> availDM = <a class="code" href="classcrop_ryegrass.html#a786315f2c2b87cc9777d7f2df5418a94">GetAvailableDM</a>(residualDM);
<a name="l01063"></a>01063         retVal = (availDM/<a class="code" href="classcrop_ryegrass.html#aedd4ae77832a94a71902085022f1eb88">GiveDryMatterVegTop</a>())* <a class="code" href="classcrop.html#a4f4f31c68a905ef3fef26b9d7456cb36">NitrogenInStorage</a>().<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a> + <a class="code" href="classcrop.html#a82bef6e98553aa173173b0ea454a3e0a">NitrogenInVegTop</a>().<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a>;
<a name="l01064"></a>01064    <span class="keywordflow">return</span> retVal;
<a name="l01065"></a>01065 };
<a name="l01066"></a>01066 
</pre></div></div>
</div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address class="footer"><small>Generated on Mon Aug 22 2011 10:28:57 for Fasset by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
