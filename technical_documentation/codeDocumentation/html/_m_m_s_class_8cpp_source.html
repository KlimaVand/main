<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/>
<title>fasset: C:/main/trunk/src/Nitroscape/MMSClass.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.6.0 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <img id="MSearchSelect" src="search/search.png"
             onmouseover="return searchBox.OnSearchSelectShow()"
             onmouseout="return searchBox.OnSearchSelectHide()"
             alt=""/>
        <input type="text" id="MSearchField" value="Search" accesskey="S"
             onfocus="searchBox.OnSearchFieldFocus(true)" 
             onblur="searchBox.OnSearchFieldFocus(false)" 
             onkeyup="searchBox.OnSearchFieldChange(event)"/>
        <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
        </div>
      </li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    </ul>
  </div>
<h1>C:/main/trunk/src/Nitroscape/MMSClass.cpp</h1><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/****************************************************************************\</span>
<a name="l00002"></a>00002 <span class="comment"> $URL$</span>
<a name="l00003"></a>00003 <span class="comment"> $LastChangedDate$</span>
<a name="l00004"></a>00004 <span class="comment"> $LastChangedRevision$</span>
<a name="l00005"></a>00005 <span class="comment"> $LastChangedBy$</span>
<a name="l00006"></a>00006 <span class="comment">\****************************************************************************/</span>
<a name="l00007"></a>00007 <span class="preprocessor">#include &quot;../Nitroscape/MMSClass.h&quot;</span>
<a name="l00008"></a>00008 <span class="preprocessor">#include &quot;../Nitroscape/harvInfoClass.h&quot;</span>
<a name="l00009"></a>00009 <span class="preprocessor">#include &quot;../base/timeUse.h&quot;</span>
<a name="l00010"></a>00010 <span class="preprocessor">#include &quot;../data/systemData.h&quot;</span>
<a name="l00011"></a>00011 
<a name="l00012"></a>00012 <span class="preprocessor">#include &lt;string.h&gt;</span>
<a name="l00013"></a>00013 <span class="preprocessor">#include &lt;errno.h&gt;</span>
<a name="l00014"></a>00014 <span class="preprocessor">#include &lt;sys/stat.h&gt;</span>
<a name="l00015"></a>00015 <span class="preprocessor">#include &lt;sys/types.h&gt;</span>
<a name="l00016"></a>00016 
<a name="l00017"></a>00017 
<a name="l00018"></a><a class="code" href="class_m_m_s_class.html#a5fbe8cd0e5e37a2770694c63ce042da3">00018</a> <span class="keywordtype">int</span> <a class="code" href="class_m_m_s_class.html#a5fbe8cd0e5e37a2770694c63ce042da3" title="returns number of patches on the farm">MMSClass::GetNumOfPatches</a>()
<a name="l00019"></a>00019 {
<a name="l00020"></a>00020  <span class="keywordtype">int</span> aVal=theInterfacePatches-&gt;<a class="code" href="classlink_list.html#aee3f890e4e8f48db1518e5114d5bcca8" title="Returned total number of nodes.">NumOfNodes</a>();
<a name="l00021"></a>00021  <span class="keywordflow">return</span> aVal;
<a name="l00022"></a>00022 }
<a name="l00023"></a>00023 
<a name="l00024"></a><a class="code" href="class_m_m_s_class.html#acdbfef61f2562067975629532d0da4bf">00024</a> <span class="keywordtype">void</span> <a class="code" href="class_m_m_s_class.html#acdbfef61f2562067975629532d0da4bf" title="connects patches to the patch interfaces">MMSClass::InitialiseInterface</a>(<a class="code" href="classevent_control.html">eventControl</a> *aEventControl)
<a name="l00025"></a>00025 {
<a name="l00026"></a>00026         theInterfacePatches = <span class="keyword">new</span> <a class="code" href="classlink_list.html">linkList&lt;patchInterfaceClass&gt;</a>;
<a name="l00027"></a>00027    <span class="keywordtype">int</span> numFields = aEventControl-&gt;GettheCropRotation()-&gt;GetFields()-&gt;<a class="code" href="classlink_list.html#aee3f890e4e8f48db1518e5114d5bcca8" title="Returned total number of nodes.">NumOfNodes</a>();
<a name="l00028"></a>00028    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;numFields;j++)
<a name="l00029"></a>00029    {
<a name="l00030"></a>00030       <a class="code" href="classfield.html">field</a> *aField = aEventControl-&gt;GettheCropRotation()-&gt;GetFields()-&gt;<a class="code" href="classlink_list.html#a5735a6e54a2eed841bdf1fdb52aed03f" title="Return the address of the node with a given logical number in the list.">ElementAtNumber</a>(j);
<a name="l00031"></a>00031       <span class="keywordtype">int</span> numPatches = aField-&gt;GetNumOfPatches();
<a name="l00032"></a>00032 
<a name="l00033"></a>00033       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;numPatches;i++)
<a name="l00034"></a>00034          theInterfacePatches-&gt;<a class="code" href="classlink_list.html#a5ef6013a096b9065c2c362fcd5113413" title="Inserts a new node at the end of the list.">InsertLast</a>(aField-&gt;GetPatch(i)-&gt;GetthePatchInterface());
<a name="l00035"></a>00035 
<a name="l00036"></a>00036    }
<a name="l00037"></a>00037 }
<a name="l00038"></a>00038 
<a name="l00039"></a>00039 <span class="keywordtype">void</span> MMSClass::zeroPatchOutputVariables()
<a name="l00040"></a>00040 {
<a name="l00041"></a>00041    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;theInterfacePatches-&gt;<a class="code" href="classlink_list.html#aee3f890e4e8f48db1518e5114d5bcca8" title="Returned total number of nodes.">NumOfNodes</a>(); i++)
<a name="l00042"></a>00042    {
<a name="l00043"></a>00043                 <a class="code" href="classpatch_interface_class.html" title="Stores the data describing a. the status of the ecosystem model liked to the patch...">patchInterfaceClass</a> * apatchInterfaceClass  = theInterfacePatches-&gt;<a class="code" href="classlink_list.html#a5735a6e54a2eed841bdf1fdb52aed03f" title="Return the address of the node with a given logical number in the list.">ElementAtNumber</a>(i);
<a name="l00044"></a>00044       apatchInterfaceClass-&gt;<a class="code" href="classpatch_interface_class.html#a5ba5cbe194b9e76f7dab382e1504be39" title="zeros all output variables">zeroOutputVariables</a>();
<a name="l00045"></a>00045    }
<a name="l00046"></a>00046 }
<a name="l00047"></a>00047 
<a name="l00048"></a><a class="code" href="class_m_m_s_class.html#a4e86f78741f81b1fd9532da0cf77748c">00048</a> <span class="keywordtype">void</span> <a class="code" href="class_m_m_s_class.html#a4e86f78741f81b1fd9532da0cf77748c" title="Zero is all farm-scale variables.">MMSClass::zeroFarmOutputVariables</a>()
<a name="l00049"></a>00049 {
<a name="l00050"></a>00050    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;theBuildings-&gt;GettheStables()-&gt;<a class="code" href="classlink_list.html#aee3f890e4e8f48db1518e5114d5bcca8" title="Returned total number of nodes.">NumOfNodes</a>(); i++)
<a name="l00051"></a>00051         houseNH3Emission[i]=0.0;
<a name="l00052"></a>00052 }
<a name="l00053"></a>00053 
<a name="l00054"></a>00054 
<a name="l00055"></a><a class="code" href="class_m_m_s_class.html#a618f8d059a46ed238e0ef8d58207722e">00055</a> <span class="keywordtype">void</span> <a class="code" href="class_m_m_s_class.html#a618f8d059a46ed238e0ef8d58207722e" title="logs the status of an ecosystem">MMSClass::SetEcoStatus</a>(<span class="keywordtype">int</span> patchNo, <span class="keywordtype">double</span> ReadyForHarvestOrLater,
<a name="l00056"></a>00056       <span class="keywordtype">double</span> IrrigationDemand, <a class="code" href="classlink_list.html">linkList &lt;harvInfoClass&gt;</a> *theHarvestProducts)
<a name="l00057"></a>00057 
<a name="l00058"></a>00058 {
<a name="l00059"></a>00059         <a class="code" href="classpatch_interface_class.html" title="Stores the data describing a. the status of the ecosystem model liked to the patch...">patchInterfaceClass</a> * apatchInterfaceClass  = theInterfacePatches-&gt;<a class="code" href="classlink_list.html#a5735a6e54a2eed841bdf1fdb52aed03f" title="Return the address of the node with a given logical number in the list.">ElementAtNumber</a>(patchNo);
<a name="l00060"></a>00060    apatchInterfaceClass-&gt;<a class="code" href="classpatch_interface_class.html#a277f24bc24c945c48b8bd0982c74bdcd" title="logs the status of an ecosystem">SetEcoStatus</a>(ReadyForHarvestOrLater,IrrigationDemand,
<a name="l00061"></a>00061            theHarvestProducts);
<a name="l00062"></a>00062 }
<a name="l00063"></a>00063 
<a name="l00064"></a><a class="code" href="class_m_m_s_class.html#af0fdf59e2254ae73b27cbb61500a076f">00064</a> <span class="keywordtype">bool</span> <a class="code" href="class_m_m_s_class.html#af0fdf59e2254ae73b27cbb61500a076f" title="checks whether a tillage operation should be performed. If so returns true">MMSClass::GetMMSTillage</a>(<span class="keywordtype">int</span> patchNo, <span class="keywordtype">double</span> *theType, <span class="keywordtype">double</span> *theDepth, <span class="keywordtype">double</span> *theFractionIncorporated)
<a name="l00065"></a>00065 {
<a name="l00066"></a>00066         <a class="code" href="classpatch_interface_class.html" title="Stores the data describing a. the status of the ecosystem model liked to the patch...">patchInterfaceClass</a> * apatchInterfaceClass  = theInterfacePatches-&gt;<a class="code" href="classlink_list.html#a5735a6e54a2eed841bdf1fdb52aed03f" title="Return the address of the node with a given logical number in the list.">ElementAtNumber</a>(patchNo);
<a name="l00067"></a>00067         *theType=apatchInterfaceClass-&gt;<a class="code" href="classpatch_interface_class.html#aa464d78a4163d8dde5b7deccd01079df" title="retrieve value">GettheType</a>()+1.0;
<a name="l00068"></a>00068    *theDepth=apatchInterfaceClass-&gt;<a class="code" href="classpatch_interface_class.html#a96efba308b79b05eee8d2545a5e446b4" title="retrieve value">GettheDepth</a>();
<a name="l00069"></a>00069    *theFractionIncorporated = apatchInterfaceClass-&gt;<a class="code" href="classpatch_interface_class.html#acb566078fd5c753aff6631b9a7dd5b63" title="retrieve value">GettheFractionIncorporated</a>();
<a name="l00070"></a>00070    apatchInterfaceClass-&gt;<a class="code" href="classpatch_interface_class.html#a2be7164993aef326ceb9678a0363dc4a" title="set value">SettheType</a>(-1);
<a name="l00071"></a>00071    <span class="keywordflow">if</span> (*theType&gt;0.0)
<a name="l00072"></a>00072            <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00073"></a>00073    <span class="keywordflow">else</span>
<a name="l00074"></a>00074            <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00075"></a>00075 }
<a name="l00076"></a>00076 
<a name="l00077"></a><a class="code" href="class_m_m_s_class.html#a4ebfe5cbd23fa7d45df7ca9ddb226fe2">00077</a> <span class="keywordtype">bool</span> <a class="code" href="class_m_m_s_class.html#a4ebfe5cbd23fa7d45df7ca9ddb226fe2" title="checks whether either manure or plant residues should be applied to the soil. If...">MMSClass::GetMMSAddOrganic</a>(<span class="keywordtype">int</span> patchNo, <span class="keywordtype">double</span> *theType, <span class="keywordtype">double</span> *theamount, <span class="keywordtype">double</span> *theDepth, <span class="keywordtype">double</span> *theTotalN, <span class="keywordtype">double</span> *theNH4N,
<a name="l00078"></a>00078                 <span class="keywordtype">double</span> *theNO3N, <span class="keywordtype">double</span> *thepercentDM, <span class="keywordtype">double</span> *theC)
<a name="l00079"></a>00079 {
<a name="l00080"></a>00080         *theType=0.0;  *theamount=0.0; *theDepth=0.0; *theTotalN=0.0; *theNH4N=0.0; *theNO3N=0.0;*theC=0.0;
<a name="l00081"></a>00081         <a class="code" href="classpatch_interface_class.html" title="Stores the data describing a. the status of the ecosystem model liked to the patch...">patchInterfaceClass</a> * apatchInterfaceClass  = theInterfacePatches-&gt;<a class="code" href="classlink_list.html#a5735a6e54a2eed841bdf1fdb52aed03f" title="Return the address of the node with a given logical number in the list.">ElementAtNumber</a>(patchNo);
<a name="l00082"></a>00082    <span class="keywordflow">if</span> (apatchInterfaceClass-&gt;<a class="code" href="classpatch_interface_class.html#acf19842fe4f4e22afeef2f9311f80844" title="retrieve value">GetdecompAmount</a>()&gt;0.0)
<a name="l00083"></a>00083    {
<a name="l00084"></a>00084                 *theamount = apatchInterfaceClass-&gt;<a class="code" href="classpatch_interface_class.html#acf19842fe4f4e22afeef2f9311f80844" title="retrieve value">GetdecompAmount</a>();
<a name="l00085"></a>00085            *theDepth=0.0; <span class="comment">//apatchInterfaceClass-&gt;GettheDepth();</span>
<a name="l00086"></a>00086                 *theNH4N = apatchInterfaceClass-&gt;<a class="code" href="classpatch_interface_class.html#aa50f7e747e12b3b2aceff2ceacbf0fd6" title="retrieve value">GetdecompNH4_N</a>();
<a name="l00087"></a>00087                 *theNO3N = apatchInterfaceClass-&gt;<a class="code" href="classpatch_interface_class.html#a004f7335353f2dee7762fd7b6eb70d94" title="retrieve value">GetdecompNO3_N</a>();
<a name="l00088"></a>00088                 *theTotalN = *theNH4N + *theNO3N + apatchInterfaceClass-&gt;<a class="code" href="classpatch_interface_class.html#a3a675bc14d9ac52b29a852209b591c5f" title="retrieve value">GetdecompOrg_N</a>();
<a name="l00089"></a>00089                 *theC = apatchInterfaceClass-&gt;<a class="code" href="classpatch_interface_class.html#a77ece4c3fefc61b3582f209a6972e145" title="retrieve value">GetdecompC</a>();
<a name="l00090"></a>00090                 *thepercentDM = apatchInterfaceClass-&gt;GetdecompPercentDM();
<a name="l00091"></a>00091       *theType = apatchInterfaceClass-&gt;<a class="code" href="classpatch_interface_class.html#a1c3b47083e9d253938866de196e4a32f" title="retrieve value">GetdecompType</a>();
<a name="l00092"></a>00092       apatchInterfaceClass-&gt;<a class="code" href="classpatch_interface_class.html#aa9d2da459f2fc40f4a9cae8dbe41cba6" title="set value">SetdecompAmount</a>(0.0);
<a name="l00093"></a>00093    }
<a name="l00094"></a>00094    <span class="keywordflow">if</span> (*theamount&gt;0.0)
<a name="l00095"></a>00095            <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00096"></a>00096    <span class="keywordflow">else</span>
<a name="l00097"></a>00097            <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00098"></a>00098 }
<a name="l00099"></a>00099 
<a name="l00100"></a><a class="code" href="class_m_m_s_class.html#af4ca114efc64eb0fc38e9bb00f1d880b">00100</a> <span class="keywordtype">bool</span> <a class="code" href="class_m_m_s_class.html#af4ca114efc64eb0fc38e9bb00f1d880b" title="checks whether mineral nitrogen fertiliser should be applied to the soil. If so returns...">MMSClass::GetMMSDoFertilisation</a>(<span class="keywordtype">int</span> patchNo, <span class="keywordtype">double</span> *theNH4N, <span class="keywordtype">double</span> *theNO3N)
<a name="l00101"></a>00101 {
<a name="l00102"></a>00102         <a class="code" href="classpatch_interface_class.html" title="Stores the data describing a. the status of the ecosystem model liked to the patch...">patchInterfaceClass</a> * apatchInterfaceClass  = theInterfacePatches-&gt;<a class="code" href="classlink_list.html#a5735a6e54a2eed841bdf1fdb52aed03f" title="Return the address of the node with a given logical number in the list.">ElementAtNumber</a>(patchNo);
<a name="l00103"></a>00103         *theNO3N = apatchInterfaceClass-&gt;<a class="code" href="classpatch_interface_class.html#a90d39b2fb7130f2631285a362fffe5b4" title="retrieve value">GettheNitrate</a>();
<a name="l00104"></a>00104    *theNH4N = apatchInterfaceClass-&gt;<a class="code" href="classpatch_interface_class.html#a322c770b108657a636cc2e06b73963e9" title="retrieve value">GettheAmmonium</a>();
<a name="l00105"></a>00105    <span class="keywordflow">if</span> ((*theNO3N&gt;0.0)||(*theNH4N&gt;0.0))
<a name="l00106"></a>00106            <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00107"></a>00107    <span class="keywordflow">else</span>
<a name="l00108"></a>00108            <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00109"></a>00109 }
<a name="l00110"></a>00110 
<a name="l00111"></a><a class="code" href="class_m_m_s_class.html#aa525cef9cc6ca7af74abed81f5bcf40e">00111</a> <span class="keywordtype">bool</span> <a class="code" href="class_m_m_s_class.html#aa525cef9cc6ca7af74abed81f5bcf40e" title="checks whether a crop should be sown. If so, returns true">MMSClass::GetMMSDoSowing</a>(<span class="keywordtype">int</span> patchNo, <span class="keywordtype">double</span> *theSeedCode, <span class="keywordtype">double</span> *theSeedDM, <span class="keywordtype">double</span> *theSeedN)
<a name="l00112"></a>00112 {
<a name="l00113"></a>00113         <a class="code" href="classpatch_interface_class.html" title="Stores the data describing a. the status of the ecosystem model liked to the patch...">patchInterfaceClass</a> * apatchInterfaceClass  = theInterfacePatches-&gt;<a class="code" href="classlink_list.html#a5735a6e54a2eed841bdf1fdb52aed03f" title="Return the address of the node with a given logical number in the list.">ElementAtNumber</a>(patchNo);
<a name="l00114"></a>00114         *theSeedCode = (double) apatchInterfaceClass-&gt;<a class="code" href="classpatch_interface_class.html#a84224ea36bd61be5e8c25c4fcdc2d350" title="retrieve value">GetthecropID</a>();
<a name="l00115"></a>00115    *theSeedDM=apatchInterfaceClass-&gt;<a class="code" href="classpatch_interface_class.html#a49a343736a61c4f719aee6285086726c" title="retrieve value">GetamountSeedDM</a>();
<a name="l00116"></a>00116    *theSeedN = apatchInterfaceClass-&gt;<a class="code" href="classpatch_interface_class.html#a94ec9c977c97d369b6538a7f7fd2efa5" title="retrieve value">GetseedN</a>();
<a name="l00117"></a>00117    apatchInterfaceClass-&gt;<a class="code" href="classpatch_interface_class.html#a265236cfd0782d2d4bc3284a6ad95ba9" title="set value">SetamountSeedDM</a>(0.0);
<a name="l00118"></a>00118    <span class="keywordflow">if</span> (*theSeedDM&gt;0.0)
<a name="l00119"></a>00119            <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00120"></a>00120    <span class="keywordflow">else</span>
<a name="l00121"></a>00121            <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00122"></a>00122 }
<a name="l00123"></a>00123 
<a name="l00124"></a><a class="code" href="class_m_m_s_class.html#aa95d9e26d6a4ea7fc754aecd19d8a2bb">00124</a> <span class="keywordtype">bool</span> <a class="code" href="class_m_m_s_class.html#aa95d9e26d6a4ea7fc754aecd19d8a2bb" title="checks whether a harvesting operation should be performed. If so, returns true">MMSClass::GetMMSDoHarvesting</a>(<span class="keywordtype">int</span> patchNo, <span class="keywordtype">double</span> *theharvestCode, <span class="keywordtype">double</span> *thepropGrainHarvested, <span class="keywordtype">double</span> *thepropStrawHarvested)
<a name="l00125"></a>00125 {
<a name="l00126"></a>00126         <a class="code" href="classpatch_interface_class.html" title="Stores the data describing a. the status of the ecosystem model liked to the patch...">patchInterfaceClass</a> * apatchInterfaceClass  = theInterfacePatches-&gt;<a class="code" href="classlink_list.html#a5735a6e54a2eed841bdf1fdb52aed03f" title="Return the address of the node with a given logical number in the list.">ElementAtNumber</a>(patchNo);
<a name="l00127"></a>00127         *theharvestCode = (double) apatchInterfaceClass-&gt;<a class="code" href="classpatch_interface_class.html#afced3ff48390bad8f8867247f36b6d0d" title="retrieve value">GetharvestCode</a>();
<a name="l00128"></a>00128    *thepropGrainHarvested=apatchInterfaceClass-&gt;<a class="code" href="classpatch_interface_class.html#a209ae68a78f632e7724dc8aba7c30959" title="retrieve value">GetpropGrainHarvested</a>();
<a name="l00129"></a>00129    *thepropStrawHarvested = apatchInterfaceClass-&gt;<a class="code" href="classpatch_interface_class.html#ae34dc1ee39f2f8d66fc540fb17c01fe3" title="retrieve value">GetpropStrawHarvested</a>();
<a name="l00130"></a>00130    apatchInterfaceClass-&gt;<a class="code" href="classpatch_interface_class.html#a789ced4ff646d1424b7771a51d86d69f" title="set value">SetharvestCode</a>(0);
<a name="l00131"></a>00131    <span class="keywordflow">if</span> (*theharvestCode&gt;0.0)
<a name="l00132"></a>00132            <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00133"></a>00133    <span class="keywordflow">else</span>
<a name="l00134"></a>00134            <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00135"></a>00135 }
<a name="l00136"></a>00136 
<a name="l00137"></a><a class="code" href="class_m_m_s_class.html#a8e68d4735ebf3127f1efa6fec7d6c6c9">00137</a> <span class="keywordtype">double</span> <a class="code" href="class_m_m_s_class.html#a8e68d4735ebf3127f1efa6fec7d6c6c9" title="Returns the ammonia emission from fertiliser and manure applied to a particular patch...">MMSClass::GetMMSPatchAmmonia</a>(<span class="keywordtype">int</span> patchNo)
<a name="l00138"></a>00138 {
<a name="l00139"></a>00139         <span class="keywordtype">double</span> ret_val=0.0;
<a name="l00140"></a>00140         <a class="code" href="classpatch_interface_class.html" title="Stores the data describing a. the status of the ecosystem model liked to the patch...">patchInterfaceClass</a> * apatchInterfaceClass  = theInterfacePatches-&gt;<a class="code" href="classlink_list.html#a5735a6e54a2eed841bdf1fdb52aed03f" title="Return the address of the node with a given logical number in the list.">ElementAtNumber</a>(patchNo);
<a name="l00141"></a>00141    ret_val = apatchInterfaceClass-&gt;GetNH3Emission();
<a name="l00142"></a>00142         <span class="keywordflow">return</span> ret_val;
<a name="l00143"></a>00143 }
<a name="l00144"></a>00144 
<a name="l00145"></a><a class="code" href="class_m_m_s_class.html#a3f8f600885ab389f35329527a720caa5">00145</a> <span class="keywordtype">double</span> <a class="code" href="class_m_m_s_class.html#a3f8f600885ab389f35329527a720caa5" title="Returns the ammonia emission from fertiliser and manure applied to fields (kilograms...">MMSClass::GetMMSSpreadAmmonia</a>()
<a name="l00146"></a>00146 {
<a name="l00147"></a>00147         <span class="keywordtype">double</span> ret_val=0.0;
<a name="l00148"></a>00148    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;theInterfacePatches-&gt;<a class="code" href="classlink_list.html#aee3f890e4e8f48db1518e5114d5bcca8" title="Returned total number of nodes.">NumOfNodes</a>();i++)
<a name="l00149"></a>00149    {
<a name="l00150"></a>00150       <a class="code" href="classpatch_interface_class.html" title="Stores the data describing a. the status of the ecosystem model liked to the patch...">patchInterfaceClass</a> * apatchInterfaceClass  = theInterfacePatches-&gt;<a class="code" href="classlink_list.html#a5735a6e54a2eed841bdf1fdb52aed03f" title="Return the address of the node with a given logical number in the list.">ElementAtNumber</a>(i);
<a name="l00151"></a>00151       ret_val += apatchInterfaceClass-&gt;GetNH3Emission();
<a name="l00152"></a>00152         }
<a name="l00153"></a>00153         <span class="keywordflow">return</span> ret_val;
<a name="l00154"></a>00154 }
<a name="l00155"></a>00155 
<a name="l00156"></a>00156 
<a name="l00157"></a><a class="code" href="class_m_m_s_class.html#ab77575e35a1fcd15b454f96287cfbc4d">00157</a> <span class="keywordtype">double</span> <a class="code" href="class_m_m_s_class.html#aef61b9a68eb4cc9df284b162516b282a" title="Returns the ammonia emission from all animal houses (kilograms N per day).">MMSClass::GetMMSHouseAmmonia</a>(<span class="keywordtype">int</span> houseNo)
<a name="l00158"></a>00158 {
<a name="l00159"></a>00159         <a class="code" href="class_m_m_s_class.html#a9cfb93d7cb67ba68a0a37d5bbea8fb4b" title="sets global variables to point to local classes">SetMMSGlobals</a>();
<a name="l00160"></a>00160         <span class="keywordtype">double</span> retVal=0.0;
<a name="l00161"></a>00161    retVal=theBuildings-&gt;GettheStables()-&gt;<a class="code" href="classlink_list.html#a5735a6e54a2eed841bdf1fdb52aed03f" title="Return the address of the node with a given logical number in the list.">ElementAtNumber</a>(houseNo)-&gt;GetvolatAmmonia()*1000.0;
<a name="l00162"></a>00162         <span class="keywordflow">return</span> retVal;
<a name="l00163"></a>00163 }
<a name="l00164"></a>00164 
<a name="l00165"></a><a class="code" href="class_m_m_s_class.html#aef61b9a68eb4cc9df284b162516b282a">00165</a> <span class="keywordtype">double</span> <a class="code" href="class_m_m_s_class.html#aef61b9a68eb4cc9df284b162516b282a" title="Returns the ammonia emission from all animal houses (kilograms N per day).">MMSClass::GetMMSHouseAmmonia</a>()
<a name="l00166"></a>00166 {
<a name="l00167"></a>00167         <span class="keywordtype">double</span> ret_val=0.0;
<a name="l00168"></a>00168    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;myBuildings-&gt;GettheStables()-&gt;<a class="code" href="classlink_list.html#aee3f890e4e8f48db1518e5114d5bcca8" title="Returned total number of nodes.">NumOfNodes</a>();i++)
<a name="l00169"></a>00169    {
<a name="l00170"></a>00170       <a class="code" href="classstable.html" title="parent class for animal housing">stable</a>* astore= theBuildings-&gt;GettheStables()-&gt;<a class="code" href="classlink_list.html#a5735a6e54a2eed841bdf1fdb52aed03f" title="Return the address of the node with a given logical number in the list.">ElementAtNumber</a>(i);
<a name="l00171"></a>00171       ret_val += astore-&gt;GetvolatAmmonia();
<a name="l00172"></a>00172         }
<a name="l00173"></a>00173         <span class="keywordflow">return</span> ret_val*1000.0;
<a name="l00174"></a>00174 }
<a name="l00175"></a>00175 
<a name="l00176"></a><a class="code" href="class_m_m_s_class.html#a4792c66bdc3f9b80a947d9ad83c6f708">00176</a> <span class="keywordtype">double</span> <a class="code" href="class_m_m_s_class.html#a9681bb2179235730d1c4fb14e4616b42" title="Returns the ammonia emission from all manure stores (kilograms N per day).">MMSClass::GetMMSStoreAmmonia</a>(<span class="keywordtype">int</span> storeNo)
<a name="l00177"></a>00177 {
<a name="l00178"></a>00178         <a class="code" href="class_m_m_s_class.html#a9cfb93d7cb67ba68a0a37d5bbea8fb4b" title="sets global variables to point to local classes">SetMMSGlobals</a>();
<a name="l00179"></a>00179         <span class="keywordtype">double</span> retVal=0.0;
<a name="l00180"></a>00180    retVal=myBuildings-&gt;GettheManurestores()-&gt;<a class="code" href="classlink_list.html#a5735a6e54a2eed841bdf1fdb52aed03f" title="Return the address of the node with a given logical number in the list.">ElementAtNumber</a>(storeNo)-&gt;GetvolatAmmonia();
<a name="l00181"></a>00181         <span class="keywordflow">return</span> retVal*1000.0;
<a name="l00182"></a>00182 }
<a name="l00183"></a>00183 
<a name="l00184"></a><a class="code" href="class_m_m_s_class.html#a9681bb2179235730d1c4fb14e4616b42">00184</a> <span class="keywordtype">double</span> <a class="code" href="class_m_m_s_class.html#a9681bb2179235730d1c4fb14e4616b42" title="Returns the ammonia emission from all manure stores (kilograms N per day).">MMSClass::GetMMSStoreAmmonia</a>()
<a name="l00185"></a>00185 {
<a name="l00186"></a>00186         <span class="keywordtype">double</span> ret_val=0.0;
<a name="l00187"></a>00187    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;myBuildings-&gt;GettheManurestores()-&gt;<a class="code" href="classlink_list.html#aee3f890e4e8f48db1518e5114d5bcca8" title="Returned total number of nodes.">NumOfNodes</a>();i++)
<a name="l00188"></a>00188    {
<a name="l00189"></a>00189       <a class="code" href="classmanurestore.html">manurestore</a>* astore= theBuildings-&gt;GettheManurestores()-&gt;<a class="code" href="classlink_list.html#a5735a6e54a2eed841bdf1fdb52aed03f" title="Return the address of the node with a given logical number in the list.">ElementAtNumber</a>(i);
<a name="l00190"></a>00190       ret_val += astore-&gt;GetvolatAmmonia();
<a name="l00191"></a>00191         }
<a name="l00192"></a>00192         <span class="keywordflow">return</span> ret_val*1000.0;
<a name="l00193"></a>00193 }
<a name="l00194"></a>00194 
<a name="l00195"></a>00195 <span class="comment">/****************************************************************************\</span>
<a name="l00196"></a>00196 <span class="comment">\****************************************************************************/</span>
<a name="l00197"></a>00197 <span class="comment">//void MMSClass::initialise_MMS(string inputDirectory, string climateDirectory, string climateFileName, int climateFileType, string outputDirectory)</span>
<a name="l00198"></a><a class="code" href="class_m_m_s_class.html#abf02bcf9d78d35dddf2867d390f87adb">00198</a> <span class="keywordtype">void</span> <a class="code" href="class_m_m_s_class.html#abf02bcf9d78d35dddf2867d390f87adb" title="initialises the manure management system model">MMSClass::initialise_MMS</a>(<a class="code" href="classsystem_run_data.html">systemRunData</a> aRunData)
<a name="l00199"></a>00199 {
<a name="l00200"></a>00200 
<a name="l00201"></a>00201    mySystemData = <span class="keyword">new</span> <a class="code" href="classsystem_data.html">systemData</a>(<span class="keyword">false</span>);
<a name="l00202"></a>00202    mySystemData-&gt;SetSystemRunData(aRunData);
<a name="l00203"></a>00203   <span class="comment">// cout&lt;&lt;aRunData.getAirToSoilTemperature();</span>
<a name="l00204"></a>00204 <span class="comment">/*   mySystemData-&gt;setInputDirectory(inputDirectory);</span>
<a name="l00205"></a>00205 <span class="comment">   mySystemData-&gt;setClimateDirectory(climateDirectory);</span>
<a name="l00206"></a>00206 <span class="comment">   mySystemData-&gt;setClimateFileName(climateFileName);</span>
<a name="l00207"></a>00207 <span class="comment">   mySystemData-&gt;setOutputDirectory(outputDirectory);</span>
<a name="l00208"></a>00208 <span class="comment">*/</span>
<a name="l00209"></a>00209         strcpy(myInputDirectory,mySystemData-&gt;getInputDirectory().c_str());
<a name="l00210"></a>00210         strcpy(myOutputDirectory,mySystemData-&gt;getOutputDirectory().c_str());
<a name="l00211"></a>00211    strcpy(myClimateDirectory,mySystemData-&gt;getClimateDirectory().c_str());
<a name="l00212"></a>00212    strcpy(myClimateFileName,mySystemData-&gt;getClimateFileName().c_str());
<a name="l00213"></a>00213    myOutputData = <span class="keyword">new</span> <a class="code" href="classoutput_data.html">outputData</a>();
<a name="l00214"></a>00214    myFarmData = <span class="keyword">new</span> <a class="code" href="classfarm_data.html">farmData</a>();
<a name="l00215"></a>00215    myEnvironData = <span class="keyword">new</span> <a class="code" href="classenviron_data.html">environData</a>();;
<a name="l00216"></a>00216 
<a name="l00217"></a>00217    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;20; i++)
<a name="l00218"></a>00218    {
<a name="l00219"></a>00219                 houseNH3Emission[i]=0.0;
<a name="l00220"></a>00220                 storeNH3Emission[i]=0.0;
<a name="l00221"></a>00221    }
<a name="l00222"></a>00222 
<a name="l00223"></a>00223    std::string
<a name="l00224"></a>00224    InputDirectory,
<a name="l00225"></a>00225    OutputDirectory,
<a name="l00226"></a>00226    ClimateDirectory,
<a name="l00227"></a>00227    ClimateFileName,
<a name="l00228"></a>00228    baseOutputDir;
<a name="l00229"></a>00229    std::string EconomicIndicatorDate=<span class="stringliteral">&quot;1/1&quot;</span>;
<a name="l00230"></a>00230    std::string EnvironmentalIndicatorDate=<span class="stringliteral">&quot;1/1&quot;</span>;
<a name="l00231"></a>00231    std::string WaterFlowMethod=<span class="stringliteral">&quot;&quot;</span>;
<a name="l00232"></a>00232 
<a name="l00233"></a>00233    <span class="keywordtype">int</span> ClimateFileType = mySystemData-&gt;getClimateFileType();
<a name="l00234"></a>00234    <span class="keywordtype">int</span> EpotCalculationMethod = 0;
<a name="l00235"></a>00235 
<a name="l00236"></a>00236    <span class="keywordtype">int</span> VolatModel=0;
<a name="l00237"></a>00237    <span class="keywordtype">int</span> singleField=-1;
<a name="l00238"></a>00238    <span class="keywordtype">int</span> fertiliserUnit=0;
<a name="l00239"></a>00239         myTime = <span class="keyword">new</span> <a class="code" href="classbs_time.html">bsTime</a>(1, 8, mySystemData-&gt;getStartYear());
<a name="l00240"></a>00240    stopTime.SetTime(31,7,mySystemData-&gt;getStartYear());
<a name="l00241"></a>00241    simYear =0;
<a name="l00242"></a>00242    <span class="comment">//  bool SellPlantProducts=false;</span>
<a name="l00243"></a>00243    <span class="keywordtype">bool</span>
<a name="l00244"></a>00244    UseReductionParameters=<span class="keyword">false</span>,                 <span class="comment">// Default determined by theControlParameters</span>
<a name="l00245"></a>00245    MeasuredSoilTemperature=<span class="keyword">false</span>,       <span class="comment">// Default determined by theControlParameters</span>
<a name="l00246"></a>00246    WriteSoilTemperature=<span class="keyword">false</span>,
<a name="l00247"></a>00247    SimpleTemperatureModel=<span class="keyword">false</span>,        <span class="comment">// Default determined by theControlParameters</span>
<a name="l00248"></a>00248    <span class="comment">// WriteDetails,                  // Default determined by theControlParameters</span>
<a name="l00249"></a>00249    GrassWeed=<span class="keyword">false</span>,                     <span class="comment">// Default determined by theControlParameters</span>
<a name="l00250"></a>00250    Organic=<span class="keyword">false</span>,                                                <span class="comment">// Default determined by theControlParameters</span>
<a name="l00251"></a>00251    ForcedOperations=<span class="keyword">false</span>,              <span class="comment">// Default determined by theControlParameters</span>
<a name="l00252"></a>00252    ForcedHarvest=<span class="keyword">false</span>,
<a name="l00253"></a>00253    fieldsFlexSize=<span class="keyword">false</span>,                <span class="comment">// When true, fields are allowed to shrimp or expand</span>
<a name="l00254"></a>00254    uniSizeFields=<span class="keyword">false</span>;                 <span class="comment">// When true, all fields are 1 ha big</span>
<a name="l00255"></a>00255 
<a name="l00256"></a>00256 
<a name="l00257"></a>00257    myControlParameters = <span class="keyword">new</span> <a class="code" href="classcontrol_parameters.html">controlParameters</a>;
<a name="l00258"></a>00258    EnvironmentalIndicatorDate=mySystemData-&gt;getEnvironmentalIndicator();<span class="comment">// aBase.GetParameter(&quot;EnvironmentalIndicator&quot;,EnvironmentalIndicatorDate);</span>
<a name="l00259"></a>00259 
<a name="l00260"></a>00260    EpotCalculationMethod=mySystemData-&gt;getEpotCalculationMethod();
<a name="l00261"></a>00261 
<a name="l00262"></a>00262    myControlParameters-&gt;SetvolatModel(VolatModel);
<a name="l00263"></a>00263    <span class="keywordtype">int</span> wfm=mySystemData-&gt;getWaterFlowMethodInt();
<a name="l00264"></a>00264    myControlParameters-&gt;SetWaterFlowMethod(wfm);
<a name="l00265"></a>00265    <span class="keywordflow">if</span>(mySystemData-&gt;getSimpleTemperatureModelFile()==<span class="keyword">true</span>)
<a name="l00266"></a>00266    {
<a name="l00267"></a>00267       SimpleTemperatureModel=mySystemData-&gt;getSimpleTemperatureModel();
<a name="l00268"></a>00268       myControlParameters-&gt;SetSimpleTemperatureModel(SimpleTemperatureModel);
<a name="l00269"></a>00269    }
<a name="l00270"></a>00270    <span class="keywordflow">if</span>(mySystemData-&gt;getuniSizeFieldsFile()==<span class="keyword">true</span>)
<a name="l00271"></a>00271    {
<a name="l00272"></a>00272       uniSizeFields=mySystemData-&gt;getuniSizeFields();
<a name="l00273"></a>00273       myControlParameters-&gt;SetFieldsUniSize(uniSizeFields);
<a name="l00274"></a>00274    }
<a name="l00275"></a>00275    <span class="keywordflow">if</span>(mySystemData-&gt;getuniSizeFieldsFile()==<span class="keyword">true</span>)
<a name="l00276"></a>00276    {
<a name="l00277"></a>00277       fieldsFlexSize=mySystemData-&gt;getFieldsFlexSize();
<a name="l00278"></a>00278       myControlParameters-&gt;SetFieldsFlexSize(fieldsFlexSize);
<a name="l00279"></a>00279    }
<a name="l00280"></a>00280    singleField=mySystemData-&gt;getsingleField();
<a name="l00281"></a>00281    <span class="keywordflow">if</span>(mySystemData-&gt;getsingleFieldFile()==<span class="keyword">true</span>)
<a name="l00282"></a>00282    {
<a name="l00283"></a>00283       myControlParameters-&gt;SetSingleField(singleField);
<a name="l00284"></a>00284       myOutputData-&gt;DetailsData.setPlantDetails(<span class="keyword">true</span>);
<a name="l00285"></a>00285       myOutputData-&gt;DetailsData.setSoilDetails(<span class="keyword">true</span>);
<a name="l00286"></a>00286    }
<a name="l00287"></a>00287    <span class="keywordflow">if</span>(mySystemData-&gt;getfertiliserUnitFile()==<span class="keyword">true</span>)
<a name="l00288"></a>00288    {
<a name="l00289"></a>00289       fertiliserUnit=mySystemData-&gt;getfertiliserUnit();
<a name="l00290"></a>00290    myControlParameters-&gt;SetFertiliserUnit(fertiliserUnit);
<a name="l00291"></a>00291    }
<a name="l00292"></a>00292    <span class="keywordflow">if</span>(mySystemData-&gt;getMeasuredSoilTemperatureFile()==<span class="keyword">true</span>)
<a name="l00293"></a>00293    {
<a name="l00294"></a>00294       MeasuredSoilTemperature=mySystemData-&gt;getMeasuredSoilTemperature();
<a name="l00295"></a>00295       myControlParameters-&gt;SetMeasuredSoilTemperature(MeasuredSoilTemperature);
<a name="l00296"></a>00296 
<a name="l00297"></a>00297    }
<a name="l00298"></a>00298 
<a name="l00299"></a>00299 
<a name="l00300"></a>00300    <span class="keywordflow">if</span>(mySystemData-&gt;getMeasuredSoilTemperatureFile()==<span class="keyword">true</span>)
<a name="l00301"></a>00301    {
<a name="l00302"></a>00302    WriteSoilTemperature=mySystemData-&gt;getWriteSoilTemperature();
<a name="l00303"></a>00303    myControlParameters-&gt;SetWriteSoilTemperature(WriteSoilTemperature);
<a name="l00304"></a>00304    }
<a name="l00305"></a>00305    <span class="keywordflow">if</span> (mySystemData-&gt;getForcedOperationsFile()==<span class="keyword">true</span>)
<a name="l00306"></a>00306    {
<a name="l00307"></a>00307       ForcedOperations=mySystemData-&gt;getForcedOperations();
<a name="l00308"></a>00308    myControlParameters-&gt;SetForcedOperations(ForcedOperations);
<a name="l00309"></a>00309    }
<a name="l00310"></a>00310 
<a name="l00311"></a>00311    ForcedHarvest =mySystemData-&gt;getForcedHarvest();
<a name="l00312"></a>00312    myControlParameters-&gt;SetForcedHarvest(ForcedHarvest);
<a name="l00313"></a>00313    <span class="keywordtype">double</span> HarvestWaste=0.05;
<a name="l00314"></a>00314    HarvestWaste=mySystemData-&gt;getHarvestWaste();
<a name="l00315"></a>00315    <span class="keywordflow">if</span>(mySystemData-&gt;getHarvestWasteFile()==<span class="keyword">true</span>)
<a name="l00316"></a>00316    {
<a name="l00317"></a>00317     myControlParameters-&gt;SetHarvestWaste(HarvestWaste); <span class="comment">// 0.05 - 0.10 may be a sensible range</span>
<a name="l00318"></a>00318    }
<a name="l00319"></a>00319 
<a name="l00320"></a>00320 
<a name="l00321"></a>00321    <span class="keywordtype">double</span> StrawLeft= mySystemData-&gt;getStrawLeft();
<a name="l00322"></a>00322    myControlParameters-&gt;SetStrawLeft(StrawLeft);
<a name="l00323"></a>00323    <span class="keywordflow">if</span> (mySystemData-&gt;getForcedOperationsFile()==<span class="keyword">true</span>)
<a name="l00324"></a>00324       myControlParameters-&gt;SetUseReductionParameters(UseReductionParameters);
<a name="l00325"></a>00325    <span class="keywordflow">if</span> (mySystemData-&gt;getForcedOperationsFile()==<span class="keyword">true</span>)
<a name="l00326"></a>00326       myControlParameters-&gt;SetGrassWeed(GrassWeed);
<a name="l00327"></a>00327    <span class="keywordflow">if</span> (mySystemData-&gt;getForcedOperationsFile()==<span class="keyword">true</span>)
<a name="l00328"></a>00328       myControlParameters-&gt;SetOrganicFarm(Organic);
<a name="l00329"></a>00329    baseOutputDir=baseOutputDir+OutputDirectory;
<a name="l00330"></a>00330 
<a name="l00331"></a>00331 
<a name="l00332"></a>00332 
<a name="l00333"></a>00333    <span class="keywordtype">char</span> FN1[100],FN2[100], FN3[100], FN4[100], FN5[100];
<a name="l00334"></a>00334    <span class="comment">//               chdir(OutputDirectory);</span>
<a name="l00335"></a>00335    strcpy(FN1,OutputDirectory.c_str());
<a name="l00336"></a>00336    strcat(FN1,<span class="stringliteral">&quot;warnings.txt&quot;</span>);
<a name="l00337"></a>00337    strcpy(FN2,OutputDirectory.c_str());
<a name="l00338"></a>00338    strcat(FN2,<span class="stringliteral">&quot;logfile.txt&quot;</span>);
<a name="l00339"></a>00339    strcpy(FN3,OutputDirectory.c_str());
<a name="l00340"></a>00340    strcat(FN3,<span class="stringliteral">&quot;debug.txt&quot;</span>);      <span class="comment">//debug file name</span>
<a name="l00341"></a>00341    strcpy(FN4,OutputDirectory.c_str());
<a name="l00342"></a>00342    strcat(FN4,<span class="stringliteral">&quot;fieldfile1.txt&quot;</span>);
<a name="l00343"></a>00343    strcpy(FN5,OutputDirectory.c_str());
<a name="l00344"></a>00344    strcat(FN5,<span class="stringliteral">&quot;fieldfile2.txt&quot;</span>);
<a name="l00345"></a>00345 
<a name="l00346"></a>00346    <span class="keywordtype">char</span> string80[80];
<a name="l00347"></a>00347     strcpy(string80, OutputDirectory.c_str());
<a name="l00348"></a>00348 
<a name="l00349"></a>00349 
<a name="l00350"></a>00350    myProducts                  = <span class="keyword">new</span> <a class="code" href="classproducts.html">products</a>;
<a name="l00351"></a>00351    myOutput                    = <span class="keyword">new</span> <a class="code" href="class_indicator_output.html">IndicatorOutput</a>;
<a name="l00352"></a>00352    myMessage                   = <span class="keyword">new</span> <a class="code" href="classmessage.html">message</a>;
<a name="l00353"></a>00353    timeConsumption              = <span class="keyword">new</span> <a class="code" href="classtime_use.html">timeUse</a>;
<a name="l00354"></a>00354    myLegislation               = <span class="keyword">new</span> <a class="code" href="classlegislate.html">legislate</a>;
<a name="l00355"></a>00355    myTechnics                  = <span class="keyword">new</span> <a class="code" href="classtechnics.html">technics</a>(<span class="stringliteral">&quot;technics&quot;</span>,0); <span class="comment">// BMP</span>
<a name="l00356"></a>00356    myClimate                   = <span class="keyword">new</span> <a class="code" href="classclimate.html">climate</a>(ClimateFileType,EpotCalculationMethod);
<a name="l00357"></a>00357    myBuildings                  = <span class="keyword">new</span> <a class="code" href="classbuildings.html">buildings</a>;
<a name="l00358"></a>00358    myManure_manager            = <span class="keyword">new</span> <a class="code" href="classmanure_manager.html">manureManager</a>();
<a name="l00359"></a>00359    myEventControl = <span class="keyword">new</span> <a class="code" href="classevent_control.html">eventControl</a>();
<a name="l00360"></a>00360    <a class="code" href="class_m_m_s_class.html#a9cfb93d7cb67ba68a0a37d5bbea8fb4b" title="sets global variables to point to local classes">SetMMSGlobals</a>();
<a name="l00361"></a>00361 
<a name="l00362"></a>00362    myMessage-&gt;InitMessage(FN1,FN2,FN3,FN4,FN5);
<a name="l00363"></a>00363 <span class="comment">/*   cout &lt;&lt; &quot;Input directory    &quot; &lt;&lt; inputDirectory &lt;&lt; endl;</span>
<a name="l00364"></a>00364 <span class="comment">   cout &lt;&lt; &quot;Output directory   &quot; &lt;&lt; outputDirectory &lt;&lt; endl;</span>
<a name="l00365"></a>00365 <span class="comment">   cout &lt;&lt; &quot;Climate directory  &quot; &lt;&lt; climateDirectory &lt;&lt; endl;</span>
<a name="l00366"></a>00366 <span class="comment">   cout &lt;&lt; &quot;Climate file       &quot; &lt;&lt; climateFileName &lt;&lt; endl;*/</span>
<a name="l00367"></a>00367 
<a name="l00368"></a>00368    <span class="keywordflow">if</span> (chdir(myOutputDirectory)!=0)
<a name="l00369"></a>00369 <span class="preprocessor">#ifndef __BCplusplus__</span>
<a name="l00370"></a>00370 <span class="preprocessor"></span><span class="preprocessor">        #ifdef BUILDER</span>
<a name="l00371"></a>00371 <span class="preprocessor"></span>          mkdir(myOutputDirectory);
<a name="l00372"></a>00372 <span class="preprocessor">        #endif</span>
<a name="l00373"></a>00373 <span class="preprocessor"></span><span class="preprocessor">        #ifdef UNIX</span>
<a name="l00374"></a>00374 <span class="preprocessor"></span>          mkdir(myOutputDirectory,<span class="stringliteral">&apos;-p&apos;</span>);
<a name="l00375"></a>00375 <span class="preprocessor">        #endif</span>
<a name="l00376"></a>00376 <span class="preprocessor"></span><span class="preprocessor">#ifdef CYGWIN</span>
<a name="l00377"></a>00377 <span class="preprocessor"></span>          mkdir(myOutputDirectory,<span class="stringliteral">&apos;-p&apos;</span>);
<a name="l00378"></a>00378 <span class="preprocessor">#endif</span>
<a name="l00379"></a>00379 <span class="preprocessor"></span><span class="preprocessor">#ifdef __BCplusplus__</span>
<a name="l00380"></a>00380 <span class="preprocessor"></span>          mkdir(myOutputDirectory);
<a name="l00381"></a>00381 <span class="preprocessor">        #endif                                                                  // make output directory if not present</span>
<a name="l00382"></a>00382 <span class="preprocessor"></span><span class="preprocessor">#else</span>
<a name="l00383"></a>00383 <span class="preprocessor"></span><span class="comment">//      #ifdef BUILDER</span>
<a name="l00384"></a>00384           mkdir(myOutputDirectory);
<a name="l00385"></a>00385 <span class="comment">/*      #else</span>
<a name="l00386"></a>00386 <span class="comment">          cout &lt;&lt; &quot;Error - directory not found &quot; &lt;&lt; endl;</span>
<a name="l00387"></a>00387 <span class="comment">          cout &lt;&lt; errno &lt;&lt; endl;</span>
<a name="l00388"></a>00388 <span class="comment">          cout &lt;&lt; &quot;Press any key to exit &quot; &lt;&lt; endl;</span>
<a name="l00389"></a>00389 <span class="comment">          char dum;</span>
<a name="l00390"></a>00390 <span class="comment">          cin &gt;&gt; dum;</span>
<a name="l00391"></a>00391 <span class="comment">          exit(99);</span>
<a name="l00392"></a>00392 <span class="comment">        #endif*/</span>
<a name="l00393"></a>00393 <span class="preprocessor">#endif</span>
<a name="l00394"></a>00394 <span class="preprocessor"></span>   <span class="keywordflow">if</span> (chdir(myInputDirectory)!=0)
<a name="l00395"></a>00395                 myMessage-&gt;FatalError(<span class="stringliteral">&quot;Event:: input directory &quot;</span>,myInputDirectory,<span class="stringliteral">&quot; not found!&quot;</span>);
<a name="l00396"></a>00396         myEventControl-&gt;Initialize(&amp;stopTime,(<span class="keywordtype">char</span>*)&amp;myInputDirectory,(<span class="keywordtype">char</span>*)&amp;myClimateDirectory,(<span class="keywordtype">char</span>*)&amp;myClimateFileName,(<span class="keywordtype">char</span>*)&amp;myOutputDirectory);
<a name="l00397"></a>00397         <a class="code" href="class_m_m_s_class.html#acdbfef61f2562067975629532d0da4bf" title="connects patches to the patch interfaces">InitialiseInterface</a>(myEventControl);
<a name="l00398"></a>00398 }
<a name="l00399"></a>00399 
<a name="l00400"></a><a class="code" href="class_m_m_s_class.html#a1876166aaad56d81c6144ddf53bab15c">00400</a> <span class="keywordtype">void</span> <a class="code" href="class_m_m_s_class.html#a1876166aaad56d81c6144ddf53bab15c" title="calls the daily routine of the manure management system model">MMSClass::DoMMSDaily</a>()
<a name="l00401"></a>00401 {
<a name="l00402"></a>00402         <a class="code" href="class_m_m_s_class.html#a9cfb93d7cb67ba68a0a37d5bbea8fb4b" title="sets global variables to point to local classes">SetMMSGlobals</a>();
<a name="l00403"></a>00403    chdir(myInputDirectory);
<a name="l00404"></a>00404         zeroPatchOutputVariables();
<a name="l00405"></a>00405    <span class="keywordflow">if</span> ((theTime.GetDay()==1)&amp;&amp;(theTime.GetMonth()==8))
<a name="l00406"></a>00406    {
<a name="l00407"></a>00407       <span class="keywordtype">char</span> fileExtension[4];
<a name="l00408"></a>00408       fileExtension[0] = <span class="charliteral">&apos;\0&apos;</span>;
<a name="l00409"></a>00409       <span class="keywordflow">if</span> (simYear&lt;100)
<a name="l00410"></a>00410          sprintf(fileExtension,<span class="stringliteral">&quot;f%02d&quot;</span>,simYear);
<a name="l00411"></a>00411       <span class="keywordflow">else</span>
<a name="l00412"></a>00412          sprintf(fileExtension,<span class="stringliteral">&quot;f%03d&quot;</span>,simYear);
<a name="l00413"></a>00413       myEventControl-&gt;ReceivePlan(fileExtension,myInputDirectory);
<a name="l00414"></a>00414       simYear++;
<a name="l00415"></a>00415    }
<a name="l00416"></a>00416    myEventControl-&gt;<a class="code" href="classevent_control.html#a8fedd9f0953e05cbd39009bdd0b80387">DailyUpdate</a>();
<a name="l00417"></a>00417    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;myBuildings-&gt;GettheStables()-&gt;<a class="code" href="classlink_list.html#aee3f890e4e8f48db1518e5114d5bcca8" title="Returned total number of nodes.">NumOfNodes</a>(); i++)
<a name="l00418"></a>00418         houseNH3Emission[i]=myBuildings-&gt;GetStable(i)-&gt;GetvolatAmmonia();
<a name="l00419"></a>00419    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;myBuildings-&gt;GettheManurestores()-&gt;<a class="code" href="classlink_list.html#aee3f890e4e8f48db1518e5114d5bcca8" title="Returned total number of nodes.">NumOfNodes</a>(); i++)
<a name="l00420"></a>00420         storeNH3Emission[i]=myBuildings-&gt;GetManurestore(i)-&gt;GetvolatAmmonia();
<a name="l00421"></a>00421    myTime-&gt;AddOneDay();
<a name="l00422"></a>00422 }
<a name="l00423"></a>00423 
<a name="l00424"></a><a class="code" href="class_m_m_s_class.html#a78c62051e79fbcc96544b37f71d19852">00424</a> <span class="keywordtype">void</span> <a class="code" href="class_m_m_s_class.html#a78c62051e79fbcc96544b37f71d19852" title="cleans up the memory occupied by the manure management system">MMSClass::Destroy_MMS</a>()
<a name="l00425"></a>00425 {
<a name="l00426"></a>00426    <span class="keyword">delete</span> myProducts;
<a name="l00427"></a>00427    <span class="keyword">delete</span> myOutput;
<a name="l00428"></a>00428    <span class="keyword">delete</span> myMessage;
<a name="l00429"></a>00429    <span class="keyword">delete</span> myLegislation;
<a name="l00430"></a>00430    <span class="keyword">delete</span> myTechnics;
<a name="l00431"></a>00431    <span class="keyword">delete</span> myClimate;
<a name="l00432"></a>00432    <span class="keyword">delete</span> myBuildings;
<a name="l00433"></a>00433    <span class="keyword">delete</span> myManure_manager;
<a name="l00434"></a>00434    <span class="keyword">delete</span> myEventControl;
<a name="l00435"></a>00435    <span class="keyword">delete</span> myOutputData;
<a name="l00436"></a>00436    <span class="keyword">delete</span> myTime;
<a name="l00437"></a>00437 }
<a name="l00438"></a>00438 
<a name="l00439"></a><a class="code" href="class_m_m_s_class.html#a9cfb93d7cb67ba68a0a37d5bbea8fb4b">00439</a> <span class="keywordtype">void</span> <a class="code" href="class_m_m_s_class.html#a9cfb93d7cb67ba68a0a37d5bbea8fb4b" title="sets global variables to point to local classes">MMSClass::SetMMSGlobals</a>()
<a name="l00440"></a>00440 {
<a name="l00441"></a>00441    theProducts = myProducts;
<a name="l00442"></a>00442         theMessage      = myMessage;
<a name="l00443"></a>00443 <span class="comment">//      thetimeConsumption* mytimeConsumption;</span>
<a name="l00444"></a>00444         theOutput       = myOutput;
<a name="l00445"></a>00445         theLegislation = myLegislation;
<a name="l00446"></a>00446         theTechnics     = myTechnics;
<a name="l00447"></a>00447         theBuildings    = myBuildings;
<a name="l00448"></a>00448         theClimate = myClimate;
<a name="l00449"></a>00449         theControlParameters = myControlParameters;
<a name="l00450"></a>00450    theOutput = myOutput;
<a name="l00451"></a>00451         theManure_manager       = myManure_manager;
<a name="l00452"></a>00452    theOutputData = myOutputData;
<a name="l00453"></a>00453  <span class="comment">//  theSystemData = mySystemData;</span>
<a name="l00454"></a>00454    theEnvironData = myEnvironData;
<a name="l00455"></a>00455    theFarmData = myFarmData;
<a name="l00456"></a>00456    theTime = *myTime;
<a name="l00457"></a>00457 }
<a name="l00458"></a>00458 
</pre></div></div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Friends</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr size="1"/><address style="text-align: right;"><small>Generated on Mon Jun 21 13:17:41 2010 for fasset by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.0 </small></address>
</body>
</html>
