<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Fasset: C:/main/trunk/src/fields/field.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.4 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Fasset</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">C:/main/trunk/src/fields/field.cpp</div>  </div>
</div>
<div class="contents">
<a href="field_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/****************************************************************************\</span>
<a name="l00002"></a>00002 <span class="comment"> $URL$</span>
<a name="l00003"></a>00003 <span class="comment"> $LastChangedDate$</span>
<a name="l00004"></a>00004 <span class="comment"> $LastChangedRevision$</span>
<a name="l00005"></a>00005 <span class="comment"> $LastChangedBy$</span>
<a name="l00006"></a>00006 <span class="comment">\****************************************************************************/</span>
<a name="l00007"></a>00007 <span class="preprocessor">#include &quot;../base/common.h&quot;</span>
<a name="l00008"></a>00008 <span class="preprocessor">#include &quot;../data/outputData.h&quot;</span>
<a name="l00009"></a>00009 <span class="preprocessor">#include &quot;../data/systemData.h&quot;</span>
<a name="l00010"></a>00010 <span class="preprocessor">#include &quot;<a class="code" href="field_8h.html">field.h</a>&quot;</span>
<a name="l00011"></a>00011 <span class="preprocessor">#include &quot;../base/unix_util.h&quot;</span>
<a name="l00012"></a>00012 <span class="preprocessor">#include &quot;<a class="code" href="field_operation_fields_8h.html">fieldOperation/fieldOperationFields.h</a>&quot;</span>
<a name="l00013"></a>00013 <span class="preprocessor">#include &quot;<a class="code" href="animal_fert_fields_8h.html">fieldOperation/animalFertFields.h</a>&quot;</span>
<a name="l00014"></a>00014 <span class="preprocessor">#include &quot;<a class="code" href="harvest_fields_8h.html">fieldOperation/harvestFields.h</a>&quot;</span>
<a name="l00015"></a>00015 <span class="preprocessor">#include &quot;<a class="code" href="irrigate_fields_8h.html">fieldOperation/irrigateFields.h</a>&quot;</span>
<a name="l00016"></a>00016 <span class="preprocessor">#include &quot;<a class="code" href="mineral_fert_fields_8h.html">fieldOperation/mineralFertFields.h</a>&quot;</span>
<a name="l00017"></a>00017 <span class="preprocessor">#include &quot;<a class="code" href="manual_labour_fields_8h.html">fieldOperation/manualLabourFields.h</a>&quot;</span>
<a name="l00018"></a>00018 <span class="preprocessor">#include &quot;<a class="code" href="sow_fields_8h.html">fieldOperation/sowFields.h</a>&quot;</span>
<a name="l00019"></a>00019 <span class="preprocessor">#include &quot;<a class="code" href="soil_treat_fields_8h.html">fieldOperation/soilTreatFields.h</a>&quot;</span>
<a name="l00020"></a>00020 <span class="preprocessor">#include &quot;<a class="code" href="plant_care_fields_8h.html">fieldOperation/plantCareFields.h</a>&quot;</span>
<a name="l00021"></a>00021 <span class="preprocessor">#include &quot;<a class="code" href="field_order_8h.html">fieldOrder.h</a>&quot;</span>
<a name="l00022"></a>00022 <span class="preprocessor">#include &quot;../base/message.h&quot;</span>
<a name="l00023"></a>00023 <span class="preprocessor">#include &quot;../technics/technics.h&quot;</span>
<a name="l00024"></a>00024 <span class="preprocessor">#include &quot;../base/IndicatorOutput.h&quot;</span>
<a name="l00025"></a>00025 <span class="preprocessor">#include &quot;../building/thebuild.h&quot;</span>
<a name="l00026"></a>00026 
<a name="l00027"></a>00027 <span class="preprocessor">#include &quot;../base/controlParameters.h&quot;</span>
<a name="l00028"></a>00028 
<a name="l00029"></a>00029 <span class="comment">/****************************************************************************\</span>
<a name="l00030"></a>00030 <span class="comment">Constructor with arguments</span>
<a name="l00031"></a>00031 <span class="comment">\****************************************************************************/</span>
<a name="l00032"></a><a class="code" href="classfield.html#aba5192e37ab34e3da4561bd79c23c9ec">00032</a> field::field(<span class="keyword">const</span> <span class="keywordtype">char</span> * aName, <span class="keyword">const</span> <span class="keywordtype">int</span> aIndex, <span class="keyword">const</span> <a class="code" href="classbase.html">base</a> * aOwner)
<a name="l00033"></a>00033    :<a class="code" href="classbase.html">base</a>(aName,aIndex,aOwner)
<a name="l00034"></a>00034 {
<a name="l00035"></a>00035 
<a name="l00036"></a>00036         <a class="code" href="classfield.html#a06360b6852f2e8f6348924d7bb3564b2">Lfutr</a>                      =<span class="keyword">new</span> <a class="code" href="classclone_list.html">cloneList&lt;plan&gt;</a>;
<a name="l00037"></a>00037         <a class="code" href="classfield.html#ad9aa754f50edcc609d69051ade821958">crrPlan</a>                    =NULL;
<a name="l00038"></a>00038    <a class="code" href="classfield.html#a4a4d06d397563e9bd4031f92acaaacc6">thePatches</a>                 =<span class="keyword">new</span> <a class="code" href="classclone_list.html">cloneList&lt;patch&gt;</a>;
<a name="l00039"></a>00039    <a class="code" href="classfield.html#a8821f9d047c11b19d393c8ae2b6f2028">Minimum</a>                    =0.00001;
<a name="l00040"></a>00040 
<a name="l00041"></a>00041    <a class="code" href="classfield.html#a07969cf234c23a6f05d6a2f81b424917">NoFixCrops</a>                 =0;
<a name="l00042"></a>00042 
<a name="l00043"></a>00043    <a class="code" href="classfield.html#ae283dc67495fb9dd0056d9a88b6f69c1">JBNO</a>                       =0;
<a name="l00044"></a>00044    <a class="code" href="classfield.html#acfff5382da945e06998c1f1c73b516e9">daysSinceIrrigation</a>        =0;
<a name="l00045"></a>00045         <a class="code" href="classfield.html#aa279abd93bccb07f247dbc84f4320d94">daysSinceIrrigationRequest</a> =0;
<a name="l00046"></a>00046    <a class="code" href="classfield.html#a5a67b4783694d4ba4cf87270306b910b">fingerFlow</a>                                 =0;
<a name="l00047"></a>00047    <a class="code" href="classfield.html#ab9cb5bab1f200cff668744cbf39c3a71">daysBetweenIrrigation</a>      =0;
<a name="l00048"></a>00048    <a class="code" href="classfield.html#a44f394bfa9a2924bde0653645b5a3182">irrigationDelay</a>            =0;
<a name="l00049"></a>00049         <a class="code" href="classfield.html#a477599b3c8ed6a953d27dc2d2db2cfcc">distance</a>                   =0.0;
<a name="l00050"></a>00050    <a class="code" href="classfield.html#a500a3007e7d5ce1b18e950abbe4c7a21">area</a>                       =0.0;
<a name="l00051"></a>00051    <a class="code" href="classfield.html#adf9545309af5dd5c46b1059e66abe714">active</a>                     =<span class="keyword">true</span>;
<a name="l00052"></a>00052    <a class="code" href="classfield.html#a70e2c5be4735304e735cd79230e0fe5a">monitorPatches</a>             =<span class="keyword">false</span>; <span class="comment">// !!! Read from some file later!!!</span>
<a name="l00053"></a>00053 <span class="preprocessor">#ifdef TUPLE</span>
<a name="l00054"></a>00054 <span class="preprocessor"></span>   writeTuples                =<span class="keyword">false</span>;
<a name="l00055"></a>00055    tuple_file_open            =<span class="keyword">false</span>;
<a name="l00056"></a>00056 <span class="preprocessor">#endif</span>
<a name="l00057"></a>00057 <span class="preprocessor"></span>
<a name="l00058"></a>00058 
<a name="l00059"></a>00059    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;<a class="code" href="typer_8h.html#abc6126af1d45847bc59afa0aa3216b04a77839917df0939cf87a42beb671106e8">BackScope</a>;i++)
<a name="l00060"></a>00060    {
<a name="l00061"></a>00061       <a class="code" href="classfield.html#a9caa57c3cef343f9110d4c70a758def7">History</a>[i]=<span class="stringliteral">&quot;w1&quot;</span>;
<a name="l00062"></a>00062    }
<a name="l00063"></a>00063 
<a name="l00064"></a>00064    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;<a class="code" href="typer_8h.html#abc6126af1d45847bc59afa0aa3216b04a77839917df0939cf87a42beb671106e8">BackScope</a>;i++)
<a name="l00065"></a>00065    {
<a name="l00066"></a>00066       <a class="code" href="classfield.html#aad91c5b34d09b1eceee5fd72cfce99bb">FixedCrop</a>[i]=NULL;
<a name="l00067"></a>00067       <a class="code" href="classfield.html#a99578e6e2a62c40659e95a97b4812543">FixedSize</a>[i]=0.0;
<a name="l00068"></a>00068    }
<a name="l00069"></a>00069 
<a name="l00070"></a>00070    <span class="keywordflow">if</span> (<a class="code" href="classfield.html#a70e2c5be4735304e735cd79230e0fe5a">monitorPatches</a>)
<a name="l00071"></a>00071    {
<a name="l00072"></a>00072       <span class="keywordtype">char</span> filename[40];
<a name="l00073"></a>00073       <span class="keywordtype">char</span> leader[200];
<a name="l00074"></a>00074       sprintf(leader,<a class="code" href="system_data_8h.html#a76e0b93133ea900729e1fa09c9ad6d5c">theSystemData</a>-&gt;<a class="code" href="classsystem_data.html#a836f74ba0df2cec8f0768226595953c0">getOutputDirectory</a>().c_str());
<a name="l00075"></a>00075 
<a name="l00076"></a>00076       sprintf(filename,<span class="stringliteral">&quot;patches%d1.xls&quot;</span>,<a class="code" href="classbase.html#afa59aaa1a0201700640234eb13a03aae">Index</a>);
<a name="l00077"></a>00077       strcat(leader,filename);
<a name="l00078"></a>00078       <a class="code" href="classfield.html#aa966c76aed1a50e17cdc88537b58f2bd">fPatch1</a>.open(leader,ios::out);
<a name="l00079"></a>00079       <a class="code" href="classfield.html#aa966c76aed1a50e17cdc88537b58f2bd">fPatch1</a>.precision(8);
<a name="l00080"></a>00080       <a class="code" href="classfield.html#aa966c76aed1a50e17cdc88537b58f2bd">fPatch1</a> &lt;&lt; <span class="stringliteral">&quot;Date\t&quot;</span>;
<a name="l00081"></a>00081       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;<a class="code" href="classfield.html#a5352787586faad0caffbdec799425413a72cd17de1f06f30df4f9cd0efa5bcd0c">MaxWritePatches</a>;i++)
<a name="l00082"></a>00082          <a class="code" href="classfield.html#aa966c76aed1a50e17cdc88537b58f2bd">fPatch1</a> &lt;&lt; <span class="stringliteral">&quot;Area&quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span>;
<a name="l00083"></a>00083 
<a name="l00084"></a>00084 
<a name="l00085"></a>00085       sprintf(leader,<a class="code" href="system_data_8h.html#a76e0b93133ea900729e1fa09c9ad6d5c">theSystemData</a>-&gt;<a class="code" href="classsystem_data.html#a836f74ba0df2cec8f0768226595953c0">getOutputDirectory</a>().c_str());
<a name="l00086"></a>00086            sprintf(filename,<span class="stringliteral">&quot;patches%d2.xls&quot;</span>,<a class="code" href="classbase.html#afa59aaa1a0201700640234eb13a03aae">Index</a>);
<a name="l00087"></a>00087       strcat(leader,filename);
<a name="l00088"></a>00088       <a class="code" href="classfield.html#af93145dbed4cbdeaadfdae78c51893f9">fPatch2</a>.open(leader,ios::out);
<a name="l00089"></a>00089       <a class="code" href="classfield.html#af93145dbed4cbdeaadfdae78c51893f9">fPatch2</a>.precision(8);
<a name="l00090"></a>00090       <a class="code" href="classfield.html#af93145dbed4cbdeaadfdae78c51893f9">fPatch2</a> &lt;&lt; <span class="stringliteral">&quot;Date\t&quot;</span>;
<a name="l00091"></a>00091       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;<a class="code" href="classfield.html#a5352787586faad0caffbdec799425413a72cd17de1f06f30df4f9cd0efa5bcd0c">MaxWritePatches</a>;i++)
<a name="l00092"></a>00092          <a class="code" href="classfield.html#af93145dbed4cbdeaadfdae78c51893f9">fPatch2</a> &lt;&lt; <span class="stringliteral">&quot;Area&quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span>;
<a name="l00093"></a>00093 
<a name="l00094"></a>00094       <a class="code" href="classfield.html#aa966c76aed1a50e17cdc88537b58f2bd">fPatch1</a> &lt;&lt; <span class="stringliteral">&quot;Date\t&quot;</span>;
<a name="l00095"></a>00095       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;<a class="code" href="classfield.html#a5352787586faad0caffbdec799425413a72cd17de1f06f30df4f9cd0efa5bcd0c">MaxWritePatches</a>;i++)
<a name="l00096"></a>00096          <a class="code" href="classfield.html#aa966c76aed1a50e17cdc88537b58f2bd">fPatch1</a> &lt;&lt; <span class="stringliteral">&quot;N-leach&quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span>;
<a name="l00097"></a>00097       <a class="code" href="classfield.html#aa966c76aed1a50e17cdc88537b58f2bd">fPatch1</a> &lt;&lt; <span class="stringliteral">&quot;Date\t&quot;</span>;
<a name="l00098"></a>00098       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;<a class="code" href="classfield.html#a5352787586faad0caffbdec799425413a72cd17de1f06f30df4f9cd0efa5bcd0c">MaxWritePatches</a>;i++)
<a name="l00099"></a>00099          <a class="code" href="classfield.html#aa966c76aed1a50e17cdc88537b58f2bd">fPatch1</a> &lt;&lt; <span class="stringliteral">&quot;Denit-&quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span>;
<a name="l00100"></a>00100       <a class="code" href="classfield.html#aa966c76aed1a50e17cdc88537b58f2bd">fPatch1</a> &lt;&lt; <span class="stringliteral">&quot;Date\t&quot;</span>;
<a name="l00101"></a>00101       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;<a class="code" href="classfield.html#a5352787586faad0caffbdec799425413a72cd17de1f06f30df4f9cd0efa5bcd0c">MaxWritePatches</a>;i++)
<a name="l00102"></a>00102          <a class="code" href="classfield.html#aa966c76aed1a50e17cdc88537b58f2bd">fPatch1</a> &lt;&lt; <span class="stringliteral">&quot;N2O-&quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span>;
<a name="l00103"></a>00103       <a class="code" href="classfield.html#aa966c76aed1a50e17cdc88537b58f2bd">fPatch1</a> &lt;&lt; endl;
<a name="l00104"></a>00104 
<a name="l00105"></a>00105 
<a name="l00106"></a>00106       <a class="code" href="classfield.html#af93145dbed4cbdeaadfdae78c51893f9">fPatch2</a> &lt;&lt; <span class="stringliteral">&quot;Date\t&quot;</span>;
<a name="l00107"></a>00107       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;<a class="code" href="classfield.html#a5352787586faad0caffbdec799425413a72cd17de1f06f30df4f9cd0efa5bcd0c">MaxWritePatches</a>;i++)
<a name="l00108"></a>00108          <a class="code" href="classfield.html#af93145dbed4cbdeaadfdae78c51893f9">fPatch2</a> &lt;&lt; <span class="stringliteral">&quot;DM&quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span>;
<a name="l00109"></a>00109       <a class="code" href="classfield.html#af93145dbed4cbdeaadfdae78c51893f9">fPatch2</a> &lt;&lt; <span class="stringliteral">&quot;Date\t&quot;</span>;
<a name="l00110"></a>00110       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;<a class="code" href="classfield.html#a5352787586faad0caffbdec799425413a72cd17de1f06f30df4f9cd0efa5bcd0c">MaxWritePatches</a>;i++)
<a name="l00111"></a>00111          <a class="code" href="classfield.html#af93145dbed4cbdeaadfdae78c51893f9">fPatch2</a> &lt;&lt; <span class="stringliteral">&quot;LAI&quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span>;
<a name="l00112"></a>00112       <a class="code" href="classfield.html#af93145dbed4cbdeaadfdae78c51893f9">fPatch2</a> &lt;&lt; <span class="stringliteral">&quot;Date\t&quot;</span>;
<a name="l00113"></a>00113       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;<a class="code" href="classfield.html#a5352787586faad0caffbdec799425413a72cd17de1f06f30df4f9cd0efa5bcd0c">MaxWritePatches</a>;i++)
<a name="l00114"></a>00114          <a class="code" href="classfield.html#af93145dbed4cbdeaadfdae78c51893f9">fPatch2</a> &lt;&lt; <span class="stringliteral">&quot;OFFT&quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span>;
<a name="l00115"></a>00115       <a class="code" href="classfield.html#af93145dbed4cbdeaadfdae78c51893f9">fPatch2</a> &lt;&lt; endl;
<a name="l00116"></a>00116    }
<a name="l00117"></a>00117 
<a name="l00118"></a>00118    <span class="keywordflow">if</span> (<a class="code" href="output_data_8h.html#aadc9d3b76fa69bf28c5ab340dd810e20">theOutputData</a>-&gt;<a class="code" href="classoutput_data.html#ae50b979972f6c57c3881edd6a7dd96b4">DetailsData</a>.<a class="code" href="classoutput_details.html#a8016daa0937dbb46a90a81a93daa6517">getPlantDetails</a>()==<span class="keyword">true</span>)
<a name="l00119"></a>00119    {
<a name="l00120"></a>00120       <span class="keywordtype">char</span> filename[40];
<a name="l00121"></a>00121       <span class="keywordtype">char</span> leader[200];
<a name="l00122"></a>00122 
<a name="l00123"></a>00123       sprintf(leader,<a class="code" href="system_data_8h.html#a76e0b93133ea900729e1fa09c9ad6d5c">theSystemData</a>-&gt;<a class="code" href="classsystem_data.html#a836f74ba0df2cec8f0768226595953c0">getOutputDirectory</a>().c_str());
<a name="l00124"></a>00124       sprintf(filename,<span class="stringliteral">&quot;field%d.xls&quot;</span>,<a class="code" href="classbase.html#afa59aaa1a0201700640234eb13a03aae">Index</a>);
<a name="l00125"></a>00125 
<a name="l00126"></a>00126       strcat(leader,filename);
<a name="l00127"></a>00127 
<a name="l00128"></a>00128       <a class="code" href="classfield.html#a2d250d63f6438e6ebdfd1e4c4bf1292e">f</a>.open(leader,ios::out);
<a name="l00129"></a>00129       <a class="code" href="classfield.html#a2d250d63f6438e6ebdfd1e4c4bf1292e">f</a>.precision(4);
<a name="l00130"></a>00130                 <a class="code" href="classfield.html#a15884755ee5efe058ae4dd8feb64594b">OutputPlantDetails</a>(<span class="keyword">true</span>);
<a name="l00131"></a>00131    }
<a name="l00132"></a>00132    <a class="code" href="classfield.html#a001ff179927c8ead0f12d1dc04628ead">InitVariables</a>();
<a name="l00133"></a>00133 }
<a name="l00134"></a>00134 
<a name="l00135"></a>00135 <span class="comment">/****************************************************************************\</span>
<a name="l00136"></a>00136 <span class="comment">Copy constructor</span>
<a name="l00137"></a>00137 <span class="comment">Dung, urine and their areas presently ignored !!!</span>
<a name="l00138"></a>00138 <span class="comment">\****************************************************************************/</span>
<a name="l00139"></a><a class="code" href="classfield.html#aa173f413fc94d3ffc5aeb68d453dc700">00139</a> field::field(<span class="keyword">const</span> <a class="code" href="classfield.html">field</a>&amp; fl) : <a class="code" href="classbase.html">base</a>(fl)
<a name="l00140"></a>00140 {
<a name="l00141"></a>00141    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;<a class="code" href="classfield.html#afef17b90c0e88f3b864e92fd1d0becd0ae55908c767f059fc8071dd960b9b63c9">MaxFixedCrops</a>;i++)
<a name="l00142"></a>00142    {
<a name="l00143"></a>00143       <a class="code" href="classfield.html#aad91c5b34d09b1eceee5fd72cfce99bb">FixedCrop</a>[i]=fl.<a class="code" href="classfield.html#aad91c5b34d09b1eceee5fd72cfce99bb">FixedCrop</a>[i]; <span class="comment">// OK because reference does not change</span>
<a name="l00144"></a>00144       <a class="code" href="classfield.html#a99578e6e2a62c40659e95a97b4812543">FixedSize</a>[i]=fl.<a class="code" href="classfield.html#a99578e6e2a62c40659e95a97b4812543">FixedSize</a>[i];
<a name="l00145"></a>00145    }
<a name="l00146"></a>00146    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;<a class="code" href="typer_8h.html#abc6126af1d45847bc59afa0aa3216b04a77839917df0939cf87a42beb671106e8">BackScope</a>;i++)
<a name="l00147"></a>00147            <a class="code" href="classfield.html#a9caa57c3cef343f9110d4c70a758def7">History</a>[i]=fl.<a class="code" href="classfield.html#a9caa57c3cef343f9110d4c70a758def7">History</a>[i];
<a name="l00148"></a>00148    <a class="code" href="classfield.html#a4a4d06d397563e9bd4031f92acaaacc6">thePatches</a>=fl.<a class="code" href="classfield.html#a4a4d06d397563e9bd4031f92acaaacc6">thePatches</a>-&gt;<a class="code" href="classclone_list.html#ac5e49d0132613e2bc1b5d148e83b22c7">clone</a>();
<a name="l00149"></a>00149    <span class="keywordflow">if</span> (fl.<a class="code" href="classfield.html#ad9aa754f50edcc609d69051ade821958">crrPlan</a>)
<a name="l00150"></a>00150            <a class="code" href="classfield.html#ad9aa754f50edcc609d69051ade821958">crrPlan</a>=fl.<a class="code" href="classfield.html#ad9aa754f50edcc609d69051ade821958">crrPlan</a>-&gt;<a class="code" href="classplan.html#a1734515ada7c0e24914487ddf59268dc">clone</a>();
<a name="l00151"></a>00151    <span class="keywordflow">else</span>
<a name="l00152"></a>00152       <a class="code" href="classfield.html#ad9aa754f50edcc609d69051ade821958">crrPlan</a>=NULL;
<a name="l00153"></a>00153    <span class="keywordflow">if</span> (fl.<a class="code" href="classfield.html#a06360b6852f2e8f6348924d7bb3564b2">Lfutr</a>)
<a name="l00154"></a>00154       <a class="code" href="classfield.html#a06360b6852f2e8f6348924d7bb3564b2">Lfutr</a>=fl.<a class="code" href="classfield.html#a06360b6852f2e8f6348924d7bb3564b2">Lfutr</a>-&gt;<a class="code" href="classclone_list.html#ac5e49d0132613e2bc1b5d148e83b22c7">clone</a>();
<a name="l00155"></a>00155    <span class="keywordflow">else</span>
<a name="l00156"></a>00156       <a class="code" href="classfield.html#a06360b6852f2e8f6348924d7bb3564b2">Lfutr</a>=NULL;
<a name="l00157"></a>00157    <a class="code" href="classfield.html#a8821f9d047c11b19d393c8ae2b6f2028">Minimum</a>=fl.<a class="code" href="classfield.html#a8821f9d047c11b19d393c8ae2b6f2028">Minimum</a>;
<a name="l00158"></a>00158    <a class="code" href="classfield.html#a500a3007e7d5ce1b18e950abbe4c7a21">area</a>=fl.<a class="code" href="classfield.html#a500a3007e7d5ce1b18e950abbe4c7a21">area</a>;
<a name="l00159"></a>00159 
<a name="l00160"></a>00160    <a class="code" href="classfield.html#a477599b3c8ed6a953d27dc2d2db2cfcc">distance</a>=fl.<a class="code" href="classfield.html#a477599b3c8ed6a953d27dc2d2db2cfcc">distance</a>;
<a name="l00161"></a>00161 
<a name="l00162"></a>00162    <a class="code" href="classfield.html#ae283dc67495fb9dd0056d9a88b6f69c1">JBNO</a>=fl.<a class="code" href="classfield.html#ae283dc67495fb9dd0056d9a88b6f69c1">JBNO</a>;
<a name="l00163"></a>00163    <a class="code" href="classfield.html#acfff5382da945e06998c1f1c73b516e9">daysSinceIrrigation</a>=fl.<a class="code" href="classfield.html#acfff5382da945e06998c1f1c73b516e9">daysSinceIrrigation</a>;
<a name="l00164"></a>00164    <a class="code" href="classfield.html#aa279abd93bccb07f247dbc84f4320d94">daysSinceIrrigationRequest</a>=fl.<a class="code" href="classfield.html#aa279abd93bccb07f247dbc84f4320d94">daysSinceIrrigationRequest</a>;
<a name="l00165"></a>00165    <a class="code" href="classfield.html#ab9cb5bab1f200cff668744cbf39c3a71">daysBetweenIrrigation</a>=fl.<a class="code" href="classfield.html#ab9cb5bab1f200cff668744cbf39c3a71">daysBetweenIrrigation</a>;
<a name="l00166"></a>00166    <a class="code" href="classfield.html#a5a67b4783694d4ba4cf87270306b910b">fingerFlow</a>=fl.<a class="code" href="classfield.html#a5a67b4783694d4ba4cf87270306b910b">fingerFlow</a>;
<a name="l00167"></a>00167         <a class="code" href="classfield.html#a44f394bfa9a2924bde0653645b5a3182">irrigationDelay</a>=fl.<a class="code" href="classfield.html#a44f394bfa9a2924bde0653645b5a3182">irrigationDelay</a>;
<a name="l00168"></a>00168         <a class="code" href="classfield.html#a07969cf234c23a6f05d6a2f81b424917">NoFixCrops</a>=fl.<a class="code" href="classfield.html#a07969cf234c23a6f05d6a2f81b424917">NoFixCrops</a>;
<a name="l00169"></a>00169    <a class="code" href="classfield.html#adf9545309af5dd5c46b1059e66abe714">active</a>=fl.<a class="code" href="classfield.html#adf9545309af5dd5c46b1059e66abe714">active</a>;
<a name="l00170"></a>00170 
<a name="l00171"></a>00171    <a class="code" href="classfield.html#a3af1a5461fe52c5fb81cc339809666b9">grazingPossible</a>=fl.<a class="code" href="classfield.html#a3af1a5461fe52c5fb81cc339809666b9">grazingPossible</a>;
<a name="l00172"></a>00172    <span class="keywordflow">if</span> (<a class="code" href="output_data_8h.html#aadc9d3b76fa69bf28c5ab340dd810e20">theOutputData</a>-&gt;<a class="code" href="classoutput_data.html#ae50b979972f6c57c3881edd6a7dd96b4">DetailsData</a>.<a class="code" href="classoutput_details.html#a8016daa0937dbb46a90a81a93daa6517">getPlantDetails</a>()==<span class="keyword">true</span>)
<a name="l00173"></a>00173    {
<a name="l00174"></a>00174       <span class="keywordtype">char</span> filename[40];
<a name="l00175"></a>00175       sprintf(filename,<span class="stringliteral">&quot;\\fasset\\field%d.xls&quot;</span>,<a class="code" href="classbase.html#afa59aaa1a0201700640234eb13a03aae">Index</a>);
<a name="l00176"></a>00176 
<a name="l00177"></a>00177       <a class="code" href="classfield.html#a2d250d63f6438e6ebdfd1e4c4bf1292e">f</a>.open(filename,ios::app);
<a name="l00178"></a>00178       <a class="code" href="classfield.html#a2d250d63f6438e6ebdfd1e4c4bf1292e">f</a>.precision(4);
<a name="l00179"></a>00179    }
<a name="l00180"></a>00180 <span class="preprocessor">#ifdef TUPLE</span>
<a name="l00181"></a>00181 <span class="preprocessor"></span>   writeTuples=fl.writeTuples;
<a name="l00182"></a>00182 <span class="preprocessor">#endif</span>
<a name="l00183"></a>00183 <span class="preprocessor"></span><span class="preprocessor">#ifdef ARLAS</span>
<a name="l00184"></a>00184 <span class="preprocessor"></span>   FieldID=fl.FieldID;
<a name="l00185"></a>00185 <span class="preprocessor">#endif</span>
<a name="l00186"></a>00186 <span class="preprocessor"></span>}
<a name="l00187"></a>00187 
<a name="l00188"></a>00188 <span class="comment">/****************************************************************************\</span>
<a name="l00189"></a>00189 <span class="comment">Destructor</span>
<a name="l00190"></a>00190 <span class="comment">\****************************************************************************/</span>
<a name="l00191"></a><a class="code" href="classfield.html#a600cf76c8c366764a8e0e6a48e43d0fd">00191</a> <a class="code" href="classfield.html#a600cf76c8c366764a8e0e6a48e43d0fd">field::~field</a>()
<a name="l00192"></a>00192 {
<a name="l00193"></a>00193    <span class="keywordflow">if</span> (<a class="code" href="output_data_8h.html#aadc9d3b76fa69bf28c5ab340dd810e20">theOutputData</a>-&gt;<a class="code" href="classoutput_data.html#ae50b979972f6c57c3881edd6a7dd96b4">DetailsData</a>.<a class="code" href="classoutput_details.html#a8016daa0937dbb46a90a81a93daa6517">getPlantDetails</a>()==<span class="keyword">true</span>)
<a name="l00194"></a>00194       <a class="code" href="classfield.html#a2d250d63f6438e6ebdfd1e4c4bf1292e">f</a>.close();
<a name="l00195"></a>00195    <span class="keywordflow">if</span> (<a class="code" href="classfield.html#a70e2c5be4735304e735cd79230e0fe5a">monitorPatches</a>)
<a name="l00196"></a>00196    {
<a name="l00197"></a>00197       <a class="code" href="classfield.html#aa966c76aed1a50e17cdc88537b58f2bd">fPatch1</a>.close();
<a name="l00198"></a>00198       <a class="code" href="classfield.html#af93145dbed4cbdeaadfdae78c51893f9">fPatch2</a>.close();
<a name="l00199"></a>00199    }
<a name="l00200"></a>00200    <span class="keywordflow">if</span> (<a class="code" href="classfield.html#a06360b6852f2e8f6348924d7bb3564b2">Lfutr</a>)
<a name="l00201"></a>00201         <span class="keyword">delete</span> <a class="code" href="classfield.html#a06360b6852f2e8f6348924d7bb3564b2">Lfutr</a>;
<a name="l00202"></a>00202         <span class="keywordflow">if</span> (<a class="code" href="classfield.html#ad9aa754f50edcc609d69051ade821958">crrPlan</a>)
<a name="l00203"></a>00203       <span class="keyword">delete</span> <a class="code" href="classfield.html#ad9aa754f50edcc609d69051ade821958">crrPlan</a>;
<a name="l00204"></a>00204    <span class="keywordflow">if</span> (<a class="code" href="classfield.html#a4a4d06d397563e9bd4031f92acaaacc6">thePatches</a>)
<a name="l00205"></a>00205       <span class="keyword">delete</span> <a class="code" href="classfield.html#a4a4d06d397563e9bd4031f92acaaacc6">thePatches</a>;
<a name="l00206"></a>00206 
<a name="l00207"></a>00207 }
<a name="l00208"></a>00208 
<a name="l00209"></a>00209 <span class="comment">/****************************************************************************\</span>
<a name="l00210"></a>00210 <span class="comment">\****************************************************************************/</span>
<a name="l00211"></a><a class="code" href="classfield.html#a001ff179927c8ead0f12d1dc04628ead">00211</a> <span class="keywordtype">void</span> <a class="code" href="classfield.html#a001ff179927c8ead0f12d1dc04628ead">field::InitVariables</a>()
<a name="l00212"></a>00212 {
<a name="l00213"></a>00213    <a class="code" href="classfield.html#a500a3007e7d5ce1b18e950abbe4c7a21">area</a>                                 = 0.0;
<a name="l00214"></a>00214    <a class="code" href="classfield.html#a3af1a5461fe52c5fb81cc339809666b9">grazingPossible</a>   = <span class="keyword">false</span>;
<a name="l00215"></a>00215 
<a name="l00216"></a>00216    <a class="code" href="classfield.html#a70e2c5be4735304e735cd79230e0fe5a">monitorPatches</a>=<span class="keyword">false</span>;
<a name="l00217"></a>00217    <a class="code" href="classfield.html#a290e1b803f7299cb7cf7054ef02027e3">grazingShutDown</a>   = <span class="keyword">true</span>;
<a name="l00218"></a>00218 <span class="comment">/*</span>
<a name="l00219"></a>00219 <span class="comment">   expectedCumulativeGrowth[0]=0.0; //@@@!!!???</span>
<a name="l00220"></a>00220 <span class="comment">   expectedCumulativeGrowth[1]=0.0; //@@@!!!???</span>
<a name="l00221"></a>00221 <span class="comment">*/</span>
<a name="l00222"></a>00222 }
<a name="l00223"></a>00223 
<a name="l00224"></a>00224 <span class="preprocessor">#ifdef NITROSCAPE</span>
<a name="l00225"></a>00225 <span class="preprocessor"></span><span class="keywordtype">void</span> field::UpdatePatch(<span class="keywordtype">int</span> farmNo)
<a name="l00226"></a>00226 {
<a name="l00227"></a>00227 <span class="comment">//      pixiData thePixiData;</span>
<a name="l00228"></a>00228 
<a name="l00229"></a>00229 <span class="comment">//      int NumberOfPatches= thePatches-&gt;NumOfNodes();</span>
<a name="l00230"></a>00230    <a class="code" href="classpatch.html">patch</a> * patchVariable;
<a name="l00231"></a>00231         <span class="keywordtype">int</span> NumberOfPatches=thePixiData-&gt;getNumberOfEco(farmNo,<a class="code" href="classbase.html#afa59aaa1a0201700640234eb13a03aae">Index</a>);
<a name="l00232"></a>00232    <span class="keywordtype">double</span> areaPerPatch = <a class="code" href="classfield.html#a500a3007e7d5ce1b18e950abbe4c7a21">area</a>/NumberOfPatches;
<a name="l00233"></a>00233    <span class="keywordtype">string</span> soilFileName;
<a name="l00234"></a>00234         <span class="keywordflow">if</span> (NumberOfPatches&gt;0)
<a name="l00235"></a>00235         {
<a name="l00236"></a>00236                 patchVariable=<a class="code" href="classfield.html#a4a4d06d397563e9bd4031f92acaaacc6">thePatches</a>-&gt;<a class="code" href="classclone_list.html#a761c3700fcf12c3f48b3c34d2a0aef7f">ElementAtNumber</a>(0);
<a name="l00237"></a>00237         soilFileName += patchVariable-&gt;getSoilFileName();
<a name="l00238"></a>00238         patchVariable-&gt;<a class="code" href="classpatch.html#aa6e819a227c7d5aeceda53afad1de51f" title="set the area of patch*/">SetArea</a>(areaPerPatch);
<a name="l00239"></a>00239         }
<a name="l00240"></a>00240         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;NumberOfPatches;i++)
<a name="l00241"></a>00241         {
<a name="l00242"></a>00242                 cout&lt;&lt; <span class="stringliteral">&quot;Farm No &quot;</span> &lt;&lt; farmNo&lt;&lt;<span class="stringliteral">&quot; Field no &quot;</span>&lt;&lt;<a class="code" href="classbase.html#afa59aaa1a0201700640234eb13a03aae">Index</a>&lt;&lt;<span class="stringliteral">&quot; patch no &quot;</span> &lt;&lt; i&lt;&lt;endl;
<a name="l00243"></a>00243                 <span class="keywordflow">if</span>(thePixiData-&gt;getNumberOfFarms()&lt;farmNo)
<a name="l00244"></a>00244                 {
<a name="l00245"></a>00245                         cout&lt;&lt;<span class="stringliteral">&quot;field::UpdatePatch: farm does not exist in fasset.dist&quot;</span>&lt;&lt;endl;
<a name="l00246"></a>00246                         cout &lt;&lt; <span class="stringliteral">&quot;Farm number = &quot;</span> &lt;&lt; farmNo &lt;&lt; <span class="stringliteral">&quot; number in fasset.dist &quot;</span> &lt;&lt; thePixiData-&gt;getNumberOfFarms() &lt;&lt; endl;
<a name="l00247"></a>00247          cin.get();
<a name="l00248"></a>00248                         exit(99);
<a name="l00249"></a>00249                 }
<a name="l00250"></a>00250                 <span class="keywordflow">if</span>(thePixiData-&gt;getNumberOfFields(farmNo)&lt;=<a class="code" href="classbase.html#afa59aaa1a0201700640234eb13a03aae">Index</a>)
<a name="l00251"></a>00251                 {
<a name="l00252"></a>00252                         cout&lt;&lt;<span class="stringliteral">&quot;field::UpdatePatch: fields does not exist in fasset.dist&quot;</span>&lt;&lt;endl;
<a name="l00253"></a>00253          cin.get();
<a name="l00254"></a>00254                         exit(99);
<a name="l00255"></a>00255                 }
<a name="l00256"></a>00256                 <span class="keywordflow">if</span>(thePixiData-&gt;getNumberOfEco(farmNo,<a class="code" href="classbase.html#afa59aaa1a0201700640234eb13a03aae">Index</a>)&lt;=i)
<a name="l00257"></a>00257                 {
<a name="l00258"></a>00258                                         cout&lt;&lt;<span class="stringliteral">&quot;field::UpdatePatch: patch does not exist in fasset.dist&quot;</span>&lt;&lt;endl;
<a name="l00259"></a>00259                         cin.get();
<a name="l00260"></a>00260                                         exit(99);
<a name="l00261"></a>00261                 }
<a name="l00262"></a>00262                 <span class="keywordtype">int</span> EcosystemNumber=thePixiData-&gt;getEco(farmNo,<a class="code" href="classbase.html#afa59aaa1a0201700640234eb13a03aae">Index</a>, i);
<a name="l00263"></a>00263                 cout&lt;&lt; <span class="stringliteral">&quot;Farm No &quot;</span> &lt;&lt; farmNo&lt;&lt;<span class="stringliteral">&quot; Field no &quot;</span>&lt;&lt;<a class="code" href="classbase.html#afa59aaa1a0201700640234eb13a03aae">Index</a>&lt;&lt;<span class="stringliteral">&quot; patch no &quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot; ecosys no &quot;</span> &lt;&lt; EcosystemNumber &lt;&lt;endl;
<a name="l00264"></a>00264       <span class="keywordflow">if</span> (i&gt;0)
<a name="l00265"></a>00265       {
<a name="l00266"></a>00266          patchVariable =<span class="keyword">new</span> <a class="code" href="classpatch.html">patch</a>(<span class="stringliteral">&quot;patch&quot;</span>,<a class="code" href="classbase.html#afa59aaa1a0201700640234eb13a03aae">Index</a>,<span class="keyword">this</span>);
<a name="l00267"></a>00267          patchVariable-&gt;<a class="code" href="classpatch.html#a3ba1e993f93b7abf64a812eaad8e1e09">Initialise</a>(soilFileName,i,areaPerPatch);
<a name="l00268"></a>00268          <a class="code" href="classfield.html#a4a4d06d397563e9bd4031f92acaaacc6">thePatches</a>-&gt;<a class="code" href="classclone_list.html#a14b4adf5b6e8ca8e6d262afcdb3cc42b">InsertLast</a>(patchVariable);
<a name="l00269"></a>00269       }
<a name="l00270"></a>00270 <span class="comment">//              patch * patchVariable=thePatches-&gt;ElementAtNumber(i);</span>
<a name="l00271"></a>00271                 patchVariable-&gt;setEcoModel(EcosystemNumber);
<a name="l00272"></a>00272         }
<a name="l00273"></a>00273 }
<a name="l00274"></a>00274 <span class="preprocessor">#endif</span>
<a name="l00275"></a>00275 <span class="preprocessor"></span><span class="comment">/****************************************************************************\</span>
<a name="l00276"></a>00276 <span class="comment">\****************************************************************************/</span>
<a name="l00277"></a><a class="code" href="classfield.html#a7eb47d106515b522ec6a8c117ab19db9">00277</a> <span class="keywordtype">void</span> <a class="code" href="classfield.html#a7eb47d106515b522ec6a8c117ab19db9">field::ReadPatchParameters</a>(<a class="code" href="classpatch.html">patch</a> *p)
<a name="l00278"></a>00278 {
<a name="l00279"></a>00279 <span class="keywordtype">char</span> soilFileName[50];
<a name="l00280"></a>00280    <span class="keywordtype">char</span> number[3];
<a name="l00281"></a>00281    <span class="keywordtype">double</span> patchArea;
<a name="l00282"></a>00282    <a class="code" href="classbase.html#a80052a7eeb8bce90247aedd358cc1cf6">SetCritical</a>();
<a name="l00283"></a>00283    <a class="code" href="classbase.html#aff0b96b92d78c345fd60335cece99d08">GetParameter</a>(<span class="stringliteral">&quot;JBNO&quot;</span>,&amp;<a class="code" href="classfield.html#ae283dc67495fb9dd0056d9a88b6f69c1">JBNO</a>);
<a name="l00284"></a>00284    <a class="code" href="classbase.html#a5c9e361dfd9a7804a33b7baa8f5a4b1f">UnsetCritical</a>();
<a name="l00285"></a>00285    <span class="keywordflow">if</span> (!<a class="code" href="classbase.html#aff0b96b92d78c345fd60335cece99d08">GetParameter</a>(<span class="stringliteral">&quot;soilFile&quot;</span>,soilFileName))
<a name="l00286"></a>00286    {
<a name="l00287"></a>00287       <a class="code" href="unix__util_8cpp.html#a00ea99b1d0c58f944eb61235ad1c903f">itoa</a>(<a class="code" href="classfield.html#ae283dc67495fb9dd0056d9a88b6f69c1">JBNO</a>,number,10);
<a name="l00288"></a>00288       strcpy(soilFileName,<span class="stringliteral">&quot;JB&quot;</span>);
<a name="l00289"></a>00289       strcat(soilFileName,number);
<a name="l00290"></a>00290       strcat(soilFileName,<span class="stringliteral">&quot;-M.dat&quot;</span>);
<a name="l00291"></a>00291    }
<a name="l00292"></a>00292    <a class="code" href="classbase.html#aff0b96b92d78c345fd60335cece99d08">GetParameter</a>(<span class="stringliteral">&quot;area&quot;</span>,&amp;patchArea);
<a name="l00293"></a>00293    <a class="code" href="classfield.html#a500a3007e7d5ce1b18e950abbe4c7a21">area</a>+=patchArea;
<a name="l00294"></a>00294    <span class="keywordflow">if</span> (<a class="code" href="classfield.html#a500a3007e7d5ce1b18e950abbe4c7a21">area</a>&lt;=0.0)
<a name="l00295"></a>00295          <a class="code" href="message_8h.html#a8ad29009121a629982c6ade0bd332470">theMessage</a>-&gt;<a class="code" href="classmessage.html#af9891cb7111375e6a36363afffb09d63">FatalError</a>(<span class="stringliteral">&quot;field::ReadParameters - field area cannot be zero&quot;</span>);
<a name="l00296"></a>00296    p-&gt;<a class="code" href="classpatch.html#a3ba1e993f93b7abf64a812eaad8e1e09">Initialise</a>(soilFileName,0,patchArea);
<a name="l00297"></a>00297 }
<a name="l00298"></a>00298 
<a name="l00299"></a>00299 <span class="preprocessor">#ifdef NITROSCAPE</span>
<a name="l00300"></a>00300 <span class="preprocessor"></span><span class="keywordtype">void</span> field::zeroOutputVariables()
<a name="l00301"></a>00301 {
<a name="l00302"></a>00302 
<a name="l00303"></a>00303         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;&lt;<a class="code" href="classfield.html#a4a4d06d397563e9bd4031f92acaaacc6">thePatches</a>-&gt;<a class="code" href="classclone_list.html#a8f54a13007e33d1a1f08f77a0bd70927">NumOfNodes</a>();i++)
<a name="l00304"></a>00304         {
<a name="l00305"></a>00305                 <a class="code" href="classfield.html#a4a4d06d397563e9bd4031f92acaaacc6">thePatches</a>-&gt;<a class="code" href="classclone_list.html#a761c3700fcf12c3f48b3c34d2a0aef7f">ElementAtNumber</a>(i)-&gt;zeroOutputVariables();
<a name="l00306"></a>00306         }
<a name="l00307"></a>00307 }
<a name="l00308"></a>00308 <span class="preprocessor">#endif</span>
<a name="l00309"></a>00309 <span class="preprocessor"></span><span class="comment">/****************************************************************************\</span>
<a name="l00310"></a>00310 <span class="comment">\****************************************************************************/</span>
<a name="l00311"></a><a class="code" href="classfield.html#a52be92c175965887ed3f016cb7c683fe">00311</a> <span class="keywordtype">void</span> <a class="code" href="classfield.html#a52be92c175965887ed3f016cb7c683fe">field::ReadParameters</a>(fstream * file)
<a name="l00312"></a>00312 {
<a name="l00313"></a>00313    <span class="keywordflow">if</span> (<a class="code" href="classfield.html#a4a4d06d397563e9bd4031f92acaaacc6">thePatches</a>-&gt;<a class="code" href="classclone_list.html#a8f54a13007e33d1a1f08f77a0bd70927">NumOfNodes</a>()&gt;1)
<a name="l00314"></a>00314       <a class="code" href="message_8h.html#a8ad29009121a629982c6ade0bd332470">theMessage</a>-&gt;<a class="code" href="classmessage.html#af9891cb7111375e6a36363afffb09d63">FatalError</a>(<span class="stringliteral">&quot;field::ReadParameters - only one patch allowed here&quot;</span>);
<a name="l00315"></a>00315    <a class="code" href="classbase.html#a3cb378050dc4ced8420f41dcd7292239">Setfile</a>(file);
<a name="l00316"></a>00316    <a class="code" href="classbase.html#a80052a7eeb8bce90247aedd358cc1cf6">SetCritical</a>();
<a name="l00317"></a>00317    <span class="keywordflow">if</span> (<a class="code" href="classbase.html#a88e41ff60ffb7e707312a09f20457e73">FindSection</a>(<a class="code" href="classbase.html#abd8f99d007cb1914c0837488829974ec">Name</a>,<a class="code" href="classbase.html#afa59aaa1a0201700640234eb13a03aae">Index</a>))
<a name="l00318"></a>00318    {
<a name="l00319"></a>00319       <a class="code" href="classbase.html#a5c9e361dfd9a7804a33b7baa8f5a4b1f">UnsetCritical</a>();
<a name="l00320"></a>00320       <span class="keywordtype">int</span> <a class="code" href="typer_8h.html#a74e289adaa38a655bd68482967f86cfdaa4500e61db092c2e1719b5d68b047ec3">first</a>,num;
<a name="l00321"></a>00321       <span class="keywordtype">string</span> namestr;
<a name="l00322"></a>00322       <span class="keywordtype">char</span> Indexstr[10];
<a name="l00323"></a>00323       sprintf(Indexstr,<span class="stringliteral">&quot;(%d)&quot;</span>,<a class="code" href="classbase.html#afa59aaa1a0201700640234eb13a03aae">Index</a>);
<a name="l00324"></a>00324       namestr=(string) <span class="stringliteral">&quot;field&quot;</span> +Indexstr+<span class="stringliteral">&quot;.&quot;</span>+<span class="stringliteral">&quot;patch&quot;</span>;
<a name="l00325"></a>00325       <a class="code" href="classbase.html#a4f63fec241f5857f3fe28b43f85d0fa5">GetSectionNumbers</a>((<span class="keywordtype">char</span>*) namestr.c_str(),&amp;<a class="code" href="typer_8h.html#a74e289adaa38a655bd68482967f86cfdaa4500e61db092c2e1719b5d68b047ec3">first</a>,&amp;num);  <span class="comment">//count the number of patches</span>
<a name="l00326"></a>00326 <span class="preprocessor">#ifndef NITROSCAPE</span>
<a name="l00327"></a>00327 <span class="preprocessor"></span>      <span class="keywordflow">if</span> (num&gt;0) <span class="comment">//may be more than one patch per field</span>
<a name="l00328"></a>00328       {
<a name="l00329"></a>00329               <a class="code" href="classbase.html#a95e051f408e6a94d4f78fbacbace1363">Setcur_pos</a>(0);
<a name="l00330"></a>00330          <span class="keywordflow">for</span>(<span class="keywordtype">int</span> inx=first;inx&lt;(first+num);inx++)
<a name="l00331"></a>00331          {
<a name="l00332"></a>00332           <a class="code" href="classbase.html#a88e41ff60ffb7e707312a09f20457e73">FindSection</a>((<span class="keywordtype">char</span>*) namestr.c_str(),inx);  <span class="comment">// find the correct place in the input file</span>
<a name="l00333"></a>00333           <a class="code" href="classpatch.html">patch</a> * p =<span class="keyword">new</span> <a class="code" href="classpatch.html">patch</a>((<span class="keywordtype">char</span> *)namestr.c_str(),inx,<span class="keyword">this</span>);
<a name="l00334"></a>00334           <a class="code" href="classfield.html#a7eb47d106515b522ec6a8c117ab19db9">ReadPatchParameters</a>(p);
<a name="l00335"></a>00335           <a class="code" href="classfield.html#a4a4d06d397563e9bd4031f92acaaacc6">thePatches</a>-&gt;<a class="code" href="classclone_list.html#a14b4adf5b6e8ca8e6d262afcdb3cc42b">InsertLast</a>(p);
<a name="l00336"></a>00336          }
<a name="l00337"></a>00337                 }
<a name="l00338"></a>00338       <span class="keywordflow">else</span>   <span class="comment">//one patch per field</span>
<a name="l00339"></a>00339       {
<a name="l00340"></a>00340               <a class="code" href="classpatch.html">patch</a> * p =<span class="keyword">new</span> <a class="code" href="classpatch.html">patch</a>(<span class="stringliteral">&quot;patch&quot;</span>,<a class="code" href="classbase.html#afa59aaa1a0201700640234eb13a03aae">Index</a>,<span class="keyword">this</span>);
<a name="l00341"></a>00341          <a class="code" href="classfield.html#a7eb47d106515b522ec6a8c117ab19db9">ReadPatchParameters</a>(p);
<a name="l00342"></a>00342            <a class="code" href="classfield.html#a4a4d06d397563e9bd4031f92acaaacc6">thePatches</a>-&gt;<a class="code" href="classclone_list.html#a14b4adf5b6e8ca8e6d262afcdb3cc42b">InsertLast</a>(p);
<a name="l00343"></a>00343                 }
<a name="l00344"></a>00344 
<a name="l00345"></a>00345 <span class="preprocessor">#else</span>
<a name="l00346"></a>00346 <span class="preprocessor"></span>
<a name="l00347"></a>00347 <span class="comment">/*      if (num&gt;0) //may be more than one patch per field</span>
<a name="l00348"></a>00348 <span class="comment">      {</span>
<a name="l00349"></a>00349 <span class="comment">                  for(int inx=first;inx&lt;(first+num);inx++)</span>
<a name="l00350"></a>00350 <span class="comment">                  { Setcur_pos(0);</span>
<a name="l00351"></a>00351 <span class="comment">                          FindSection((char*) namestr.c_str(),inx);  // find the correct place in the input file</span>
<a name="l00352"></a>00352 <span class="comment">                          ReadPatchParameters(thePatches-&gt;ElementAtNumber(inx));</span>
<a name="l00353"></a>00353 <span class="comment">                  }</span>
<a name="l00354"></a>00354 <span class="comment">      }</span>
<a name="l00355"></a>00355 <span class="comment">      else   //one patch per field</span>
<a name="l00356"></a>00356 <span class="comment">         {*/</span>
<a name="l00357"></a>00357                 <a class="code" href="classpatch.html">patch</a> * p =<span class="keyword">new</span> <a class="code" href="classpatch.html">patch</a>(<span class="stringliteral">&quot;patch&quot;</span>,<a class="code" href="classbase.html#afa59aaa1a0201700640234eb13a03aae">Index</a>,<span class="keyword">this</span>);
<a name="l00358"></a>00358                 <a class="code" href="classfield.html#a7eb47d106515b522ec6a8c117ab19db9">ReadPatchParameters</a>(p);
<a name="l00359"></a>00359                 <a class="code" href="classfield.html#a4a4d06d397563e9bd4031f92acaaacc6">thePatches</a>-&gt;<a class="code" href="classclone_list.html#a14b4adf5b6e8ca8e6d262afcdb3cc42b">InsertLast</a>(p);
<a name="l00360"></a>00360         <span class="comment">//}</span>
<a name="l00361"></a>00361 
<a name="l00362"></a>00362 <span class="preprocessor">#endif</span>
<a name="l00363"></a>00363 <span class="preprocessor"></span>
<a name="l00364"></a>00364         <span class="keywordtype">char</span> number[3];
<a name="l00365"></a>00365       <span class="keywordtype">char</span> s[21];
<a name="l00366"></a>00366       <span class="keywordflow">if</span> (<a class="code" href="control_parameters_8h.html#a5f2fa76e64eab2ae2d13f038d69004aa">theControlParameters</a>-&gt;<a class="code" href="classcontrol_parameters.html#a1c35d1b5f556e75782eb0aa4fb87d063">GetUniSizeFields</a>())
<a name="l00367"></a>00367          <a class="code" href="classfield.html#a500a3007e7d5ce1b18e950abbe4c7a21">area</a>=1.0; <span class="comment">// For testing purposes!</span>
<a name="l00368"></a>00368                 <a class="code" href="classbase.html#aff0b96b92d78c345fd60335cece99d08">GetParameter</a>(<span class="stringliteral">&quot;distance&quot;</span>,&amp;<a class="code" href="classfield.html#a477599b3c8ed6a953d27dc2d2db2cfcc">distance</a>);
<a name="l00369"></a>00369 
<a name="l00370"></a>00370 
<a name="l00371"></a>00371       <span class="keywordtype">int</span> k;
<a name="l00372"></a>00372                 <span class="keywordflow">for</span> (k=0;k&lt;<a class="code" href="typer_8h.html#abc6126af1d45847bc59afa0aa3216b04a77839917df0939cf87a42beb671106e8">BackScope</a>;k++)
<a name="l00373"></a>00373                 {
<a name="l00374"></a>00374                         <a class="code" href="unix__util_8cpp.html#a00ea99b1d0c58f944eb61235ad1c903f">itoa</a>(k,number,10);
<a name="l00375"></a>00375                         strcpy(s,<span class="stringliteral">&quot;CROP&quot;</span>);
<a name="l00376"></a>00376                         strcat(s,number);
<a name="l00377"></a>00377                         <a class="code" href="classbase.html#aff0b96b92d78c345fd60335cece99d08">GetParameter</a>(s,&amp;<a class="code" href="classfield.html#a9caa57c3cef343f9110d4c70a758def7">History</a>[k]);
<a name="l00378"></a>00378                 }
<a name="l00379"></a>00379 
<a name="l00380"></a>00380    }
<a name="l00381"></a>00381    <span class="keywordflow">else</span>
<a name="l00382"></a>00382       <a class="code" href="message_8h.html#a8ad29009121a629982c6ade0bd332470">theMessage</a>-&gt;<a class="code" href="classmessage.html#af9891cb7111375e6a36363afffb09d63">FatalError</a>(<span class="stringliteral">&quot;field::ReadParameters - section not found&quot;</span>);
<a name="l00383"></a>00383    <a class="code" href="classbase.html#a3cb378050dc4ced8420f41dcd7292239">Setfile</a>(NULL);
<a name="l00384"></a>00384    <span class="comment">//if we wish to simulate patches with different soil types, this will have to be modified</span>
<a name="l00385"></a>00385 <span class="comment">//   cloneList&lt;patch&gt;::PS P;</span>
<a name="l00386"></a>00386 <span class="comment">//   thePatches-&gt;PeekHead(P);</span>
<a name="l00387"></a>00387 <span class="comment">//   P-&gt;element-&gt;Initialise(soilFileName,Index,area);</span>
<a name="l00388"></a>00388 }
<a name="l00389"></a>00389 
<a name="l00390"></a>00390 <span class="comment">/****************************************************************************\</span>
<a name="l00391"></a>00391 <span class="comment">Updates cropping history when a new crop is initiated</span>
<a name="l00392"></a>00392 <span class="comment">Parameters:</span>
<a name="l00393"></a>00393 <span class="comment">   fP        pointer to new field</span>
<a name="l00394"></a>00394 <span class="comment">   crop_id   id of new crop</span>
<a name="l00395"></a>00395 <span class="comment">\****************************************************************************/</span>
<a name="l00396"></a><a class="code" href="classfield.html#a51e15b1581712c50d383f2c64a3cc203">00396</a> <span class="keywordtype">void</span> <a class="code" href="classfield.html#a51e15b1581712c50d383f2c64a3cc203">field::PushHistory</a>(<a class="code" href="classfield.html">field</a> * fP,str * crop_id)
<a name="l00397"></a>00397 {
<a name="l00398"></a>00398         fP-&gt;<a class="code" href="classfield.html#a9caa57c3cef343f9110d4c70a758def7">History</a>[0]=<a class="code" href="classfield.html#a9caa57c3cef343f9110d4c70a758def7">History</a>[1];
<a name="l00399"></a>00399         fP-&gt;<a class="code" href="classfield.html#a9caa57c3cef343f9110d4c70a758def7">History</a>[1]=<a class="code" href="classfield.html#a9caa57c3cef343f9110d4c70a758def7">History</a>[2];
<a name="l00400"></a>00400         fP-&gt;<a class="code" href="classfield.html#a9caa57c3cef343f9110d4c70a758def7">History</a>[2]=<a class="code" href="classfield.html#a9caa57c3cef343f9110d4c70a758def7">History</a>[3];
<a name="l00401"></a>00401         fP-&gt;<a class="code" href="classfield.html#a9caa57c3cef343f9110d4c70a758def7">History</a>[3]=*crop_id;
<a name="l00402"></a>00402 
<a name="l00403"></a>00403 }
<a name="l00404"></a>00404 
<a name="l00405"></a>00405 <span class="comment">/****************************************************************************\</span>
<a name="l00406"></a>00406 <span class="comment">\****************************************************************************/</span>
<a name="l00407"></a><a class="code" href="classfield.html#a4d3c3f8c50e61befbbda998cc4a7437d">00407</a> <a class="code" href="classfield.html">field</a>* <a class="code" href="classfield.html#a4d3c3f8c50e61befbbda998cc4a7437d">field::MakeNewField</a>()
<a name="l00408"></a>00408 {
<a name="l00409"></a>00409         <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="classfield.html">field</a>(<a class="code" href="classbase.html#abd8f99d007cb1914c0837488829974ec">Name</a>,<a class="code" href="classbase.html#afa59aaa1a0201700640234eb13a03aae">Index</a>,<a class="code" href="classbase.html#a907869971a8ad022d6292922b1ff3bb5">Owner</a>);
<a name="l00410"></a>00410 }
<a name="l00411"></a>00411 
<a name="l00412"></a>00412 <span class="comment">/****************************************************************************\</span>
<a name="l00413"></a>00413 <span class="comment">\****************************************************************************/</span>
<a name="l00414"></a><a class="code" href="classfield.html#a7e446412f0c24c7a58401dab58c10a40">00414</a> <span class="keywordtype">void</span> <a class="code" href="classfield.html#a7e446412f0c24c7a58401dab58c10a40">field::AdjustPatchAreas</a>(<span class="keywordtype">double</span> adjust,<span class="keywordtype">bool</span> balance)
<a name="l00415"></a>00415 {
<a name="l00416"></a>00416    <span class="keywordflow">if</span> (adjust &lt;0.0)
<a name="l00417"></a>00417       <a class="code" href="message_8h.html#a8ad29009121a629982c6ade0bd332470">theMessage</a>-&gt;<a class="code" href="classmessage.html#af9891cb7111375e6a36363afffb09d63">FatalError</a>(<span class="stringliteral">&quot;field::AjustPatchAreas - call parameter must be above zero&quot;</span>);
<a name="l00418"></a>00418    <span class="keywordflow">if</span> (adjust&gt;1.0 &amp;&amp; !balance)
<a name="l00419"></a>00419       <a class="code" href="message_8h.html#a8ad29009121a629982c6ade0bd332470">theMessage</a>-&gt;<a class="code" href="classmessage.html#af9891cb7111375e6a36363afffb09d63">FatalError</a>(<span class="stringliteral">&quot;field::AjustPatchAreas - call parameter must be not exceed one in this mode&quot;</span>);
<a name="l00420"></a>00420 
<a name="l00421"></a>00421    <span class="keywordtype">double</span> Nbefore=0.0;
<a name="l00422"></a>00422    <span class="keywordtype">double</span> NcropBefore=0.0;
<a name="l00423"></a>00423    <span class="keywordtype">double</span> NsoilBefore=0.0;
<a name="l00424"></a>00424         <span class="keywordflow">if</span> (<a class="code" href="classfield.html#a4a4d06d397563e9bd4031f92acaaacc6">thePatches</a>)
<a name="l00425"></a>00425    {
<a name="l00426"></a>00426         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;<a class="code" href="classfield.html#a4a4d06d397563e9bd4031f92acaaacc6">thePatches</a>-&gt;<a class="code" href="classclone_list.html#a8f54a13007e33d1a1f08f77a0bd70927">NumOfNodes</a>();i++)
<a name="l00427"></a>00427       {
<a name="l00428"></a>00428          NcropBefore+=<a class="code" href="classfield.html#a4a4d06d397563e9bd4031f92acaaacc6">thePatches</a>-&gt;<a class="code" href="classclone_list.html#a761c3700fcf12c3f48b3c34d2a0aef7f">ElementAtNumber</a>(i)-&gt;<a class="code" href="classpatch.html#ae9173a337c4a025669947a8cd64f5d2e" title="return the total amount of nitrogen in the crops">NitrogenInCrops</a>();
<a name="l00429"></a>00429          NsoilBefore+=<a class="code" href="classfield.html#a4a4d06d397563e9bd4031f92acaaacc6">thePatches</a>-&gt;<a class="code" href="classclone_list.html#a761c3700fcf12c3f48b3c34d2a0aef7f">ElementAtNumber</a>(i)-&gt;<a class="code" href="classpatch.html#adcb1581cac2687cd3d610faec438d935" title="return the total amount of nitrogen in the soil">NitrogenInSoil</a>();
<a name="l00430"></a>00430          Nbefore+=<a class="code" href="classfield.html#a4a4d06d397563e9bd4031f92acaaacc6">thePatches</a>-&gt;<a class="code" href="classclone_list.html#a761c3700fcf12c3f48b3c34d2a0aef7f">ElementAtNumber</a>(i)-&gt;<a class="code" href="classpatch.html#a9c12288512a19b8e44eb15f532f34a4d" title="return the total amount of nitrogen in the patch">NitrogenInSystem</a>();
<a name="l00431"></a>00431                 <a class="code" href="classfield.html#a4a4d06d397563e9bd4031f92acaaacc6">thePatches</a>-&gt;<a class="code" href="classclone_list.html#a761c3700fcf12c3f48b3c34d2a0aef7f">ElementAtNumber</a>(i)-&gt;<a class="code" href="classpatch.html#a4258aa2c074432be7603578ac1397e26" title="adjust the area of the patch">AdjustArea</a>(adjust);
<a name="l00432"></a>00432       }
<a name="l00433"></a>00433    }
<a name="l00434"></a>00434    <span class="keywordflow">else</span>
<a name="l00435"></a>00435       <a class="code" href="message_8h.html#a8ad29009121a629982c6ade0bd332470">theMessage</a>-&gt;<a class="code" href="classmessage.html#af9891cb7111375e6a36363afffb09d63">FatalError</a>(<span class="stringliteral">&quot;field::AjustPatchAreas - attempt to divide uninitialised field&quot;</span>);
<a name="l00436"></a>00436 
<a name="l00437"></a>00437    <span class="keywordtype">double</span> Nafter=0.0;
<a name="l00438"></a>00438    <span class="keywordtype">double</span> NcropAfter=0.0;
<a name="l00439"></a>00439    <span class="keywordtype">double</span> NsoilAfter=0.0;
<a name="l00440"></a>00440    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;<a class="code" href="classfield.html#a4a4d06d397563e9bd4031f92acaaacc6">thePatches</a>-&gt;<a class="code" href="classclone_list.html#a8f54a13007e33d1a1f08f77a0bd70927">NumOfNodes</a>();i++)
<a name="l00441"></a>00441    {
<a name="l00442"></a>00442       NcropAfter+=<a class="code" href="classfield.html#a4a4d06d397563e9bd4031f92acaaacc6">thePatches</a>-&gt;<a class="code" href="classclone_list.html#a761c3700fcf12c3f48b3c34d2a0aef7f">ElementAtNumber</a>(i)-&gt;<a class="code" href="classpatch.html#ae9173a337c4a025669947a8cd64f5d2e" title="return the total amount of nitrogen in the crops">NitrogenInCrops</a>();
<a name="l00443"></a>00443       NsoilAfter+=<a class="code" href="classfield.html#a4a4d06d397563e9bd4031f92acaaacc6">thePatches</a>-&gt;<a class="code" href="classclone_list.html#a761c3700fcf12c3f48b3c34d2a0aef7f">ElementAtNumber</a>(i)-&gt;<a class="code" href="classpatch.html#adcb1581cac2687cd3d610faec438d935" title="return the total amount of nitrogen in the soil">NitrogenInSoil</a>();
<a name="l00444"></a>00444       Nafter+=<a class="code" href="classfield.html#a4a4d06d397563e9bd4031f92acaaacc6">thePatches</a>-&gt;<a class="code" href="classclone_list.html#a761c3700fcf12c3f48b3c34d2a0aef7f">ElementAtNumber</a>(i)-&gt;<a class="code" href="classpatch.html#a9c12288512a19b8e44eb15f532f34a4d" title="return the total amount of nitrogen in the patch">NitrogenInSystem</a>();
<a name="l00445"></a>00445    }
<a name="l00446"></a>00446 
<a name="l00447"></a>00447    <span class="keywordflow">if</span> (balance)
<a name="l00448"></a>00448    {
<a name="l00449"></a>00449       <span class="comment">// Adjust C and water in indicators later</span>
<a name="l00450"></a>00450       <a class="code" href="_indicator_output_8h.html#a699f3cd60e9f14693c64869fd86745c5">theOutput</a>-&gt;<a class="code" href="class_indicator_output.html#a50aa53ae58d243f6eef65a360e1196c8">AddIndicator</a>(<a class="code" href="typer_8h.html#af7c21877c7448b813184ececcc1af13ca7361be8d586650bac7f248153f94f6f2">environmentalIndicator</a>,<span class="stringliteral">&quot;37.00 N difference from area adjustment&quot;</span>,<span class="stringliteral">&quot;kg N&quot;</span>,Nbefore-Nafter);
<a name="l00451"></a>00451       <a class="code" href="_indicator_output_8h.html#a699f3cd60e9f14693c64869fd86745c5">theOutput</a>-&gt;<a class="code" href="class_indicator_output.html#a50aa53ae58d243f6eef65a360e1196c8">AddIndicator</a>(<a class="code" href="typer_8h.html#af7c21877c7448b813184ececcc1af13ca7361be8d586650bac7f248153f94f6f2">environmentalIndicator</a>,<span class="stringliteral">&quot;37.01 N crop difference from area adjustment&quot;</span>,<span class="stringliteral">&quot;kg N&quot;</span>,NcropBefore-NcropAfter);
<a name="l00452"></a>00452       <a class="code" href="_indicator_output_8h.html#a699f3cd60e9f14693c64869fd86745c5">theOutput</a>-&gt;<a class="code" href="class_indicator_output.html#a50aa53ae58d243f6eef65a360e1196c8">AddIndicator</a>(<a class="code" href="typer_8h.html#af7c21877c7448b813184ececcc1af13ca7361be8d586650bac7f248153f94f6f2">environmentalIndicator</a>,<span class="stringliteral">&quot;37.02 N soil difference from area adjustment&quot;</span>,<span class="stringliteral">&quot;kg N&quot;</span>,NsoilBefore-NsoilAfter);
<a name="l00453"></a>00453    }
<a name="l00454"></a>00454 }
<a name="l00455"></a>00455 
<a name="l00456"></a>00456 <span class="comment">/****************************************************************************\</span>
<a name="l00457"></a>00457 <span class="comment">\****************************************************************************/</span>
<a name="l00458"></a><a class="code" href="classfield.html#adde20822cfc7a99c9ed35b831353bcbb">00458</a> <span class="keywordtype">void</span> <a class="code" href="classfield.html#adde20822cfc7a99c9ed35b831353bcbb">field::AdjustFieldArea</a>(<span class="keywordtype">double</span> newArea)
<a name="l00459"></a>00459 {
<a name="l00460"></a>00460    <span class="comment">// cout &lt;&lt; &quot;Adjusting area on field no &quot; &lt;&lt; Index &lt;&lt; &quot; from &quot; &lt;&lt; area &lt;&lt; &quot; ha to &quot; &lt;&lt; newArea &lt;&lt; &quot; ha &quot; &lt;&lt; theTime &lt;&lt; endl;</span>
<a name="l00461"></a>00461    <a class="code" href="classfield.html#a7e446412f0c24c7a58401dab58c10a40">AdjustPatchAreas</a>(newArea/<a class="code" href="classfield.html#a500a3007e7d5ce1b18e950abbe4c7a21">area</a>,<span class="keyword">true</span>);
<a name="l00462"></a>00462    <a class="code" href="classfield.html#a500a3007e7d5ce1b18e950abbe4c7a21">area</a>=newArea;
<a name="l00463"></a>00463 }
<a name="l00464"></a>00464 
<a name="l00465"></a>00465 <span class="comment">/****************************************************************************\</span>
<a name="l00466"></a>00466 <span class="comment">Divides the present instance of the field.</span>
<a name="l00467"></a>00467 <span class="comment">Copy constuctor can not be made, as &quot;linkList&quot; can not have a copy</span>
<a name="l00468"></a>00468 <span class="comment">constructor.</span>
<a name="l00469"></a>00469 <span class="comment">Parameters:</span>
<a name="l00470"></a>00470 <span class="comment">   fP   pointer to new field</span>
<a name="l00471"></a>00471 <span class="comment">   Pl   new plan of field operations</span>
<a name="l00472"></a>00472 <span class="comment">\****************************************************************************/</span>
<a name="l00473"></a><a class="code" href="classfield.html#ad2d1131c9c208b90868ab13d9f87ceed">00473</a> <span class="keywordtype">void</span> <a class="code" href="classfield.html#ad2d1131c9c208b90868ab13d9f87ceed">field::DivideThisInstance</a>(<a class="code" href="classfield.html">field</a> * &amp;fP,<a class="code" href="classplan.html">plan</a> * Pl)
<a name="l00474"></a>00474 {
<a name="l00475"></a>00475    fP=<a class="code" href="classfield.html#a4d3c3f8c50e61befbbda998cc4a7437d">MakeNewField</a>();                             <span class="comment">// to cope with derived fields</span>
<a name="l00476"></a>00476    <span class="keywordflow">if</span> (fP-&gt;<a class="code" href="classfield.html#a4a4d06d397563e9bd4031f92acaaacc6">thePatches</a>)
<a name="l00477"></a>00477       <span class="keyword">delete</span> fP-&gt;<a class="code" href="classfield.html#a4a4d06d397563e9bd4031f92acaaacc6">thePatches</a>;
<a name="l00478"></a>00478         fP-&gt;<a class="code" href="classfield.html#a4a4d06d397563e9bd4031f92acaaacc6">thePatches</a>=<a class="code" href="classfield.html#a4a4d06d397563e9bd4031f92acaaacc6">thePatches</a>-&gt;<a class="code" href="classclone_list.html#ac5e49d0132613e2bc1b5d148e83b22c7">clone</a>();
<a name="l00479"></a>00479         fP-&gt;<a class="code" href="classfield.html#ad9aa754f50edcc609d69051ade821958">crrPlan</a> = Pl;
<a name="l00480"></a>00480    fP-&gt;<a class="code" href="classbase.html#afa59aaa1a0201700640234eb13a03aae">Index</a>=Pl-&gt;<a class="code" href="classplan.html#a8cd7e925bf86d2d2350a962b0392ae74">GetFutureNumber</a>();
<a name="l00481"></a>00481         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;<a class="code" href="typer_8h.html#abc6126af1d45847bc59afa0aa3216b04a77839917df0939cf87a42beb671106e8">BackScope</a>;i++)
<a name="l00482"></a>00482                 fP-&gt;<a class="code" href="classfield.html#a9caa57c3cef343f9110d4c70a758def7">History</a>[i] = <a class="code" href="classfield.html#a9caa57c3cef343f9110d4c70a758def7">History</a>[i];
<a name="l00483"></a>00483         <a class="code" href="classfield.html#a6f1744c3ac290d5fc0ef66302c0ec632">str</a> cid;
<a name="l00484"></a>00484         Pl-&gt;<a class="code" href="classplan.html#a46ca446bb7d23eff9d7f39d36b56d58b">GiveCrop</a>(&amp;cid);
<a name="l00485"></a>00485         <a class="code" href="classfield.html#a51e15b1581712c50d383f2c64a3cc203">PushHistory</a>(fP,&amp;cid);
<a name="l00486"></a>00486         fP-&gt;<a class="code" href="classfield.html#a500a3007e7d5ce1b18e950abbe4c7a21">area</a>=Pl-&gt;<a class="code" href="classplan.html#a69ef07aba789edb9d649427e73dcc19c">GiveArea</a>();
<a name="l00487"></a>00487         fP-&gt;<a class="code" href="classfield.html#a477599b3c8ed6a953d27dc2d2db2cfcc">distance</a>=<a class="code" href="classfield.html#a477599b3c8ed6a953d27dc2d2db2cfcc">distance</a>;
<a name="l00488"></a>00488 
<a name="l00489"></a>00489    fP-&gt;<a class="code" href="classfield.html#acfff5382da945e06998c1f1c73b516e9">daysSinceIrrigation</a>=<a class="code" href="classfield.html#acfff5382da945e06998c1f1c73b516e9">daysSinceIrrigation</a>;
<a name="l00490"></a>00490         fP-&gt;<a class="code" href="classfield.html#aa279abd93bccb07f247dbc84f4320d94">daysSinceIrrigationRequest</a>=<a class="code" href="classfield.html#aa279abd93bccb07f247dbc84f4320d94">daysSinceIrrigationRequest</a>;
<a name="l00491"></a>00491    fP-&gt;<a class="code" href="classfield.html#ab9cb5bab1f200cff668744cbf39c3a71">daysBetweenIrrigation</a>=<a class="code" href="classfield.html#ab9cb5bab1f200cff668744cbf39c3a71">daysBetweenIrrigation</a>;
<a name="l00492"></a>00492    fP-&gt;<a class="code" href="classfield.html#a44f394bfa9a2924bde0653645b5a3182">irrigationDelay</a>=<a class="code" href="classfield.html#a44f394bfa9a2924bde0653645b5a3182">irrigationDelay</a>;
<a name="l00493"></a>00493    fP-&gt;<a class="code" href="classfield.html#a5a67b4783694d4ba4cf87270306b910b">fingerFlow</a>=<a class="code" href="classfield.html#a5a67b4783694d4ba4cf87270306b910b">fingerFlow</a>;
<a name="l00494"></a>00494 
<a name="l00495"></a>00495         fP-&gt;<a class="code" href="classfield.html#ae283dc67495fb9dd0056d9a88b6f69c1">JBNO</a>=<a class="code" href="classfield.html#ae283dc67495fb9dd0056d9a88b6f69c1">JBNO</a>;
<a name="l00496"></a>00496         ofstream * fstr=<a class="code" href="message_8h.html#a8ad29009121a629982c6ade0bd332470">theMessage</a>-&gt;<a class="code" href="classmessage.html#a9c4d08163cff8ee8dba9eb8b6317a8b9">GiveHandle</a>();
<a name="l00497"></a>00497         *fstr &lt;&lt; <span class="stringliteral">&quot;Divided. Area &#39;mother&#39;: &quot;</span> &lt;&lt; <a class="code" href="classfield.html#a500a3007e7d5ce1b18e950abbe4c7a21">area</a> &lt;&lt; <span class="stringliteral">&quot;ha. Area &#39;child&#39;: &quot;</span> &lt;&lt; Pl-&gt;<a class="code" href="classplan.html#a69ef07aba789edb9d649427e73dcc19c">GiveArea</a>() &lt;&lt; <span class="stringliteral">&quot; ha&quot;</span> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;
<a name="l00498"></a>00498 
<a name="l00499"></a>00499    <span class="comment">//Adjust areas</span>
<a name="l00500"></a>00500    fP-&gt;<a class="code" href="classfield.html#a7e446412f0c24c7a58401dab58c10a40">AdjustPatchAreas</a>(fP-&gt;<a class="code" href="classfield.html#a500a3007e7d5ce1b18e950abbe4c7a21">area</a>/<a class="code" href="classfield.html#a500a3007e7d5ce1b18e950abbe4c7a21">area</a>,<span class="keyword">false</span>);
<a name="l00501"></a>00501    <a class="code" href="classfield.html#a7e446412f0c24c7a58401dab58c10a40">AdjustPatchAreas</a>((<a class="code" href="classfield.html#a500a3007e7d5ce1b18e950abbe4c7a21">area</a>-Pl-&gt;<a class="code" href="classplan.html#a69ef07aba789edb9d649427e73dcc19c">GiveArea</a>())/<a class="code" href="classfield.html#a500a3007e7d5ce1b18e950abbe4c7a21">area</a>,<span class="keyword">false</span>);
<a name="l00502"></a>00502         <a class="code" href="classfield.html#a500a3007e7d5ce1b18e950abbe4c7a21">area</a>=<a class="code" href="classfield.html#a500a3007e7d5ce1b18e950abbe4c7a21">area</a>-Pl-&gt;<a class="code" href="classplan.html#a69ef07aba789edb9d649427e73dcc19c">GiveArea</a>();
<a name="l00503"></a>00503    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="classfield.html#a07969cf234c23a6f05d6a2f81b424917">NoFixCrops</a>;i++)
<a name="l00504"></a>00504    {
<a name="l00505"></a>00505         fP-&gt;<a class="code" href="classfield.html#aad91c5b34d09b1eceee5fd72cfce99bb">FixedCrop</a>[i] = <a class="code" href="classfield.html#aad91c5b34d09b1eceee5fd72cfce99bb">FixedCrop</a>[i];
<a name="l00506"></a>00506       fP-&gt;<a class="code" href="classfield.html#a99578e6e2a62c40659e95a97b4812543">FixedSize</a>[i] = <a class="code" href="classfield.html#a99578e6e2a62c40659e95a97b4812543">FixedSize</a>[i];
<a name="l00507"></a>00507    }
<a name="l00508"></a>00508 }
<a name="l00509"></a>00509 
<a name="l00510"></a>00510 <span class="comment">/****************************************************************************\</span>
<a name="l00511"></a>00511 <span class="comment">Renew or divide field</span>
<a name="l00512"></a>00512 <span class="comment">Parameters:</span>
<a name="l00513"></a>00513 <span class="comment">   fP   pointer to new instance of field</span>
<a name="l00514"></a>00514 <span class="comment">   Pl   new plan of field operations</span>
<a name="l00515"></a>00515 <span class="comment">\****************************************************************************/</span>
<a name="l00516"></a><a class="code" href="classfield.html#aa5c556bd1ec5b80a42441d0ac4a65f4c">00516</a> <span class="keywordtype">void</span> <a class="code" href="classfield.html#aa5c556bd1ec5b80a42441d0ac4a65f4c">field::MakeInstance</a>(<a class="code" href="classfield.html">field</a> * &amp;fP,<a class="code" href="classplan.html">plan</a> * Pl)
<a name="l00517"></a>00517 {
<a name="l00518"></a>00518         ofstream * fstr;
<a name="l00519"></a>00519         <span class="keywordtype">double</span> Ar=Pl-&gt;<a class="code" href="classplan.html#a69ef07aba789edb9d649427e73dcc19c">GiveArea</a>();
<a name="l00520"></a>00520         <a class="code" href="classfield.html#a6f1744c3ac290d5fc0ef66302c0ec632">str</a> cid;
<a name="l00521"></a>00521         Pl-&gt;<a class="code" href="classplan.html#a46ca446bb7d23eff9d7f39d36b56d58b">GiveCrop</a>(&amp;cid);
<a name="l00522"></a>00522    <span class="keywordflow">if</span> (<a class="code" href="classfield.html#a500a3007e7d5ce1b18e950abbe4c7a21">area</a>==0.0)
<a name="l00523"></a>00523                 <a class="code" href="message_8h.html#a8ad29009121a629982c6ade0bd332470">theMessage</a>-&gt;<a class="code" href="classmessage.html#afed66d0552f90b4385c5169cf5929907">WarningWithDisplay</a>(<span class="stringliteral">&quot;field::MakeInstance - attempt to divide a field with an area of zero&quot;</span>);
<a name="l00524"></a>00524         <span class="keywordflow">if</span> (Ar==0.0)
<a name="l00525"></a>00525                 <a class="code" href="message_8h.html#a8ad29009121a629982c6ade0bd332470">theMessage</a>-&gt;<a class="code" href="classmessage.html#afed66d0552f90b4385c5169cf5929907">WarningWithDisplay</a>(<span class="stringliteral">&quot;field::MakeInstance - attempt to divide a field with request of an area of zero&quot;</span>);
<a name="l00526"></a>00526 
<a name="l00527"></a>00527         <span class="keywordflow">if</span> (Ar&gt;<a class="code" href="classfield.html#a500a3007e7d5ce1b18e950abbe4c7a21">area</a>)
<a name="l00528"></a>00528    {
<a name="l00529"></a>00529                 <span class="keywordflow">if</span> (Ar&gt;(<a class="code" href="classfield.html#a500a3007e7d5ce1b18e950abbe4c7a21">area</a>+<a class="code" href="classfield.html#a8821f9d047c11b19d393c8ae2b6f2028">Minimum</a>)) <span class="comment">// Handles rounding-erors</span>
<a name="l00530"></a>00530                 {
<a name="l00531"></a>00531          <span class="keywordflow">if</span> (<a class="code" href="control_parameters_8h.html#a5f2fa76e64eab2ae2d13f038d69004aa">theControlParameters</a>-&gt;<a class="code" href="classcontrol_parameters.html#a24ac14f6b6a328d5fef572a44d005b46">GetFlexSizeFields</a>())
<a name="l00532"></a>00532             <a class="code" href="classfield.html#adde20822cfc7a99c9ed35b831353bcbb">AdjustFieldArea</a>(Ar);
<a name="l00533"></a>00533          <span class="keywordflow">else</span>
<a name="l00534"></a>00534                         <a class="code" href="message_8h.html#a8ad29009121a629982c6ade0bd332470">theMessage</a>-&gt;<a class="code" href="classmessage.html#af9891cb7111375e6a36363afffb09d63">FatalError</a>(<span class="stringliteral">&quot;field::MakeInstance - attempt to divide a field with request of an area bigger than that of the field&quot;</span>);
<a name="l00535"></a>00535                 }
<a name="l00536"></a>00536                 Ar=<a class="code" href="classfield.html#a500a3007e7d5ce1b18e950abbe4c7a21">area</a>;
<a name="l00537"></a>00537         }
<a name="l00538"></a>00538         <span class="keywordflow">if</span> (<a class="code" href="classfield.html#a500a3007e7d5ce1b18e950abbe4c7a21">area</a>&gt;0.0)
<a name="l00539"></a>00539    {
<a name="l00540"></a>00540                 <span class="keywordflow">if</span> (<a class="code" href="classfield.html#a500a3007e7d5ce1b18e950abbe4c7a21">area</a> &gt; Ar &amp;&amp; <a class="code" href="control_parameters_8h.html#a5f2fa76e64eab2ae2d13f038d69004aa">theControlParameters</a>-&gt;<a class="code" href="classcontrol_parameters.html#a24ac14f6b6a328d5fef572a44d005b46">GetFlexSizeFields</a>()) <span class="comment">// Test if field size should be adjusted</span>
<a name="l00541"></a>00541          <a class="code" href="classfield.html#adde20822cfc7a99c9ed35b831353bcbb">AdjustFieldArea</a>(Ar);
<a name="l00542"></a>00542                 <span class="keywordflow">if</span> (<a class="code" href="classfield.html#a500a3007e7d5ce1b18e950abbe4c7a21">area</a> &gt; (Ar+<a class="code" href="classfield.html#a8821f9d047c11b19d393c8ae2b6f2028">Minimum</a>)) <span class="comment">// Handles rounding-erors</span>
<a name="l00543"></a>00543         <a class="code" href="classfield.html#ad2d1131c9c208b90868ab13d9f87ceed">DivideThisInstance</a>(fP,Pl);
<a name="l00544"></a>00544                 <span class="keywordflow">else</span>
<a name="l00545"></a>00545       { <span class="comment">// The field is not to be divided, but renewed</span>
<a name="l00546"></a>00546                         <span class="keywordflow">if</span> ((<a class="code" href="classfield.html#a06360b6852f2e8f6348924d7bb3564b2">Lfutr</a>-&gt;<a class="code" href="classclone_list.html#a8f54a13007e33d1a1f08f77a0bd70927">NumOfNodes</a>())&gt;1)
<a name="l00547"></a>00547                                 <a class="code" href="message_8h.html#a8ad29009121a629982c6ade0bd332470">theMessage</a>-&gt;<a class="code" href="classmessage.html#afed66d0552f90b4385c5169cf5929907">WarningWithDisplay</a>(<span class="stringliteral">&quot;field::MakeInstance - error in list of future plans&quot;</span>);
<a name="l00548"></a>00548                         <span class="keywordflow">if</span> (Pl-&gt;<a class="code" href="classplan.html#a8cd7e925bf86d2d2350a962b0392ae74">GetFutureNumber</a>()!=<a class="code" href="classbase.html#afa59aaa1a0201700640234eb13a03aae">Index</a>)
<a name="l00549"></a>00549          {
<a name="l00550"></a>00550             cout &lt;&lt; Pl-&gt;<a class="code" href="classplan.html#a8cd7e925bf86d2d2350a962b0392ae74">GetFutureNumber</a>() &lt;&lt; endl;
<a name="l00551"></a>00551                                 <a class="code" href="message_8h.html#a8ad29009121a629982c6ade0bd332470">theMessage</a>-&gt;<a class="code" href="classmessage.html#af9891cb7111375e6a36363afffb09d63">FatalError</a>(<span class="stringliteral">&quot;field::MakeInstance - inconsistence in indices&quot;</span>);
<a name="l00552"></a>00552          }
<a name="l00553"></a>00553                         <span class="keywordflow">if</span> (<a class="code" href="classfield.html#ad9aa754f50edcc609d69051ade821958">crrPlan</a>)
<a name="l00554"></a>00554                                 <span class="keyword">delete</span> <a class="code" href="classfield.html#ad9aa754f50edcc609d69051ade821958">crrPlan</a>;
<a name="l00555"></a>00555                         <a class="code" href="classfield.html#ad9aa754f50edcc609d69051ade821958">crrPlan</a>=Pl;
<a name="l00556"></a>00556          <span class="keywordflow">if</span> (<a class="code" href="classfield.html#ad9aa754f50edcc609d69051ade821958">crrPlan</a>-&gt;<a class="code" href="classplan.html#aeac34b2dea2e779cf73477c0f9f263bb">GetAdjustArea</a>()&gt;0)
<a name="l00557"></a>00557             <a class="code" href="classfield.html#adde20822cfc7a99c9ed35b831353bcbb">AdjustFieldArea</a>(<a class="code" href="classfield.html#ad9aa754f50edcc609d69051ade821958">crrPlan</a>-&gt;<a class="code" href="classplan.html#aeac34b2dea2e779cf73477c0f9f263bb">GetAdjustArea</a>());
<a name="l00558"></a>00558 
<a name="l00559"></a>00559                         <a class="code" href="classfield.html#a51e15b1581712c50d383f2c64a3cc203">PushHistory</a>(<span class="keyword">this</span>,&amp;cid);
<a name="l00560"></a>00560                         fstr=<a class="code" href="message_8h.html#a8ad29009121a629982c6ade0bd332470">theMessage</a>-&gt;<a class="code" href="classmessage.html#a9c4d08163cff8ee8dba9eb8b6317a8b9">GiveHandle</a>();
<a name="l00561"></a>00561                         *fstr &lt;&lt; <span class="stringliteral">&quot;Renewed. Size: &quot;</span> &lt;&lt; <a class="code" href="classfield.html#a500a3007e7d5ce1b18e950abbe4c7a21">area</a> &lt;&lt; <span class="stringliteral">&quot; ha&quot;</span> &lt;&lt; endl;
<a name="l00562"></a>00562 
<a name="l00563"></a>00563                 }
<a name="l00564"></a>00564         }
<a name="l00565"></a>00565 <span class="preprocessor">#ifdef TUPLE</span>
<a name="l00566"></a>00566 <span class="preprocessor"></span>   writeTuples=<a class="code" href="control_parameters_8h.html#a5f2fa76e64eab2ae2d13f038d69004aa">theControlParameters</a>-&gt;GetWriteTuples();
<a name="l00567"></a>00567 <span class="preprocessor">#endif</span>
<a name="l00568"></a>00568 <span class="preprocessor"></span>}
<a name="l00569"></a>00569 
<a name="l00570"></a>00570 <span class="comment">/****************************************************************************\</span>
<a name="l00571"></a>00571 <span class="comment">Investigates whether the field should be divided or renewed.</span>
<a name="l00572"></a>00572 <span class="comment">Parameters</span>
<a name="l00573"></a>00573 <span class="comment">   year, month, day</span>
<a name="l00574"></a>00574 <span class="comment">   fP                 Pointer to new instance. NULL if field is undivided.</span>
<a name="l00575"></a>00575 <span class="comment">\****************************************************************************/</span>
<a name="l00576"></a><a class="code" href="classfield.html#ae5c00c9f05eaf3f156bc1e133cff88e9">00576</a> <span class="keywordtype">void</span> <a class="code" href="classfield.html#ae5c00c9f05eaf3f156bc1e133cff88e9">field::SplitMe</a>(<a class="code" href="classfield.html">field</a> * &amp;fP)
<a name="l00577"></a>00577 {
<a name="l00578"></a>00578    <span class="keywordflow">if</span> (<a class="code" href="classfield.html#adf9545309af5dd5c46b1059e66abe714">active</a>)
<a name="l00579"></a>00579    {
<a name="l00580"></a>00580            ofstream * fstr;
<a name="l00581"></a>00581       fP=NULL;
<a name="l00582"></a>00582       <span class="keywordflow">if</span> ((<a class="code" href="classfield.html#ad9aa754f50edcc609d69051ade821958">crrPlan</a>==NULL) || (<a class="code" href="classfield.html#ad9aa754f50edcc609d69051ade821958">crrPlan</a>-&gt;<a class="code" href="classplan.html#a336d1b751be876cf584e47d44826d8ac">Finished</a>()))
<a name="l00583"></a>00583       {
<a name="l00584"></a>00584          <a class="code" href="classclone_list.html">cloneList&lt;plan&gt;::PS</a> P;
<a name="l00585"></a>00585          <a class="code" href="classfield.html#a06360b6852f2e8f6348924d7bb3564b2">Lfutr</a>-&gt;<a class="code" href="classclone_list.html#a2780cfb6574e5cd9b8797b1b5c8c9ad6">PeekHead</a>(P);
<a name="l00586"></a>00586          <span class="keywordflow">if</span> (P!=NULL)
<a name="l00587"></a>00587          {
<a name="l00588"></a>00588             <span class="keywordtype">int</span> year = <a class="code" href="bstime_8h.html#ac0dc3834220ee5ae84c115e146194d75">theTime</a>.<a class="code" href="classbs_time.html#afcb5953580c085bce20eb33a4b21e155">GetYear</a>();
<a name="l00589"></a>00589             <span class="keywordtype">int</span> month = <a class="code" href="bstime_8h.html#ac0dc3834220ee5ae84c115e146194d75">theTime</a>.<a class="code" href="classbs_time.html#a777a59c97951688c4b2a67c4b0bca16e">GetMonth</a>();
<a name="l00590"></a>00590             <span class="keywordtype">int</span> <a class="code" href="typer_8h.html#ae4c405e5c68c6ec2c44bb6d6adfc2f6ca0c8f8663af5d02dd407beb7decb7df37">day</a> = <a class="code" href="bstime_8h.html#ac0dc3834220ee5ae84c115e146194d75">theTime</a>.<a class="code" href="classbs_time.html#a3b4126cf9db93be0c2f69549699730d3">GetDay</a>();
<a name="l00591"></a>00591 <span class="preprocessor">#ifdef MEASCOPE</span>
<a name="l00592"></a>00592 <span class="preprocessor"></span>            <span class="keywordflow">if</span> ((P-&gt;element-&gt;FirstOperationToday(year,month,day) &amp;&amp; (<a class="code" href="classfield.html#a7ee560523f2f9f9f12ede3c2fba4b064">OperationCanBePerformed</a>(P-&gt;element,<a class="code" href="classfield.html#a4a4d06d397563e9bd4031f92acaaacc6">thePatches</a>-&gt;<a class="code" href="classclone_list.html#a761c3700fcf12c3f48b3c34d2a0aef7f">ElementAtNumber</a>(0))))
<a name="l00593"></a>00593                         || (P-&gt;element-&gt;NoOpsThisYear(year,month,day)))
<a name="l00594"></a>00594 <span class="preprocessor">#else</span>
<a name="l00595"></a>00595 <span class="preprocessor"></span>            <span class="keywordflow">if</span> (P-&gt;element-&gt;FirstOperationToday(year,month,day) &amp;&amp; (<a class="code" href="classfield.html#a7ee560523f2f9f9f12ede3c2fba4b064">OperationCanBePerformed</a>(P-&gt;element,<a class="code" href="classfield.html#a4a4d06d397563e9bd4031f92acaaacc6">thePatches</a>-&gt;<a class="code" href="classclone_list.html#a761c3700fcf12c3f48b3c34d2a0aef7f">ElementAtNumber</a>(0))))
<a name="l00596"></a>00596 #endif
<a name="l00597"></a>00597             {
<a name="l00598"></a>00598 
<a name="l00599"></a>00599                fstr=<a class="code" href="message_8h.html#a8ad29009121a629982c6ade0bd332470">theMessage</a>-&gt;<a class="code" href="classmessage.html#a9c4d08163cff8ee8dba9eb8b6317a8b9">GiveHandle</a>();
<a name="l00600"></a>00600                *fstr &lt;&lt; <a class="code" href="bstime_8h.html#ac0dc3834220ee5ae84c115e146194d75">theTime</a> &lt;&lt; <span class="stringliteral">&quot; &gt;&gt;&gt; Field no &quot;</span> &lt;&lt; setw(2) &lt;&lt; <a class="code" href="classbase.html#afa59aaa1a0201700640234eb13a03aae">Index</a> &lt;&lt; <span class="stringliteral">&quot;  &quot;</span>;
<a name="l00601"></a>00601 
<a name="l00602"></a>00602                <a class="code" href="classfield.html#aa5c556bd1ec5b80a42441d0ac4a65f4c">MakeInstance</a>(fP,P-&gt;element);
<a name="l00603"></a>00603                <a class="code" href="classfield.html#a06360b6852f2e8f6348924d7bb3564b2">Lfutr</a>-&gt;<a class="code" href="classclone_list.html#a9dd071686629c50a473d691f2de1e0a2">Release</a>(P);
<a name="l00604"></a>00604 
<a name="l00605"></a>00605             }
<a name="l00606"></a>00606          }
<a name="l00607"></a>00607       }
<a name="l00608"></a>00608    }
<a name="l00609"></a>00609 }
<a name="l00610"></a>00610 
<a name="l00611"></a>00611 <span class="comment">/****************************************************************************\</span>
<a name="l00612"></a>00612 <span class="comment">\****************************************************************************/</span>
<a name="l00613"></a><a class="code" href="classfield.html#a1654a805f18f2b50214dcde5dcac2b92">00613</a> <span class="keywordtype">void</span> <a class="code" href="classfield.html#a1654a805f18f2b50214dcde5dcac2b92">field::ImplementFingerFlow</a>()
<a name="l00614"></a>00614 {
<a name="l00615"></a>00615         <span class="keywordflow">if</span> ((<a class="code" href="classfield.html#ae283dc67495fb9dd0056d9a88b6f69c1">JBNO</a>==1) &amp;&amp; <a class="code" href="classfield.html#a5a67b4783694d4ba4cf87270306b910b">fingerFlow</a>)                                     <span class="comment">// irrigation on JB1 implies finger flow on 2/3 of the area and 1/3 do not receive any water!</span>
<a name="l00616"></a>00616    {
<a name="l00617"></a>00617       <span class="keywordflow">if</span> (<a class="code" href="classfield.html#a4a4d06d397563e9bd4031f92acaaacc6">thePatches</a>-&gt;<a class="code" href="classclone_list.html#a8f54a13007e33d1a1f08f77a0bd70927">NumOfNodes</a>()&gt;2)
<a name="l00618"></a>00618         <a class="code" href="message_8h.html#a8ad29009121a629982c6ade0bd332470">theMessage</a>-&gt;<a class="code" href="classmessage.html#afed66d0552f90b4385c5169cf5929907">WarningWithDisplay</a>(<span class="stringliteral">&quot;field::ReadParameters - to many patches on field&quot;</span>);
<a name="l00619"></a>00619 <span class="comment">//      MeltAllPatches();</span>
<a name="l00620"></a>00620 
<a name="l00621"></a>00621         <a class="code" href="classclone_list.html">cloneList&lt;patch&gt;::PS</a> P;
<a name="l00622"></a>00622         <a class="code" href="classfield.html#a4a4d06d397563e9bd4031f92acaaacc6">thePatches</a>-&gt;<a class="code" href="classclone_list.html#a2780cfb6574e5cd9b8797b1b5c8c9ad6">PeekHead</a>(P);
<a name="l00623"></a>00623       <a class="code" href="classpatch.html">patch</a>* P2= P-&gt;element-&gt;<a class="code" href="classclone_list.html#ac5e49d0132613e2bc1b5d148e83b22c7">clone</a>();
<a name="l00624"></a>00624       P2-&gt;<a class="code" href="classpatch.html#aa6e819a227c7d5aeceda53afad1de51f" title="set the area of patch*/">SetArea</a>(<a class="code" href="classfield.html#a500a3007e7d5ce1b18e950abbe4c7a21">area</a>*1.0/3.0);
<a name="l00625"></a>00625 <span class="preprocessor">#ifndef NITROSCAPE</span>
<a name="l00626"></a>00626 <span class="preprocessor"></span>      P2-&gt;<a class="code" href="classpatch.html#a79adbf0a0c1fee340accf581487d8f54">SetFingerFlow</a>(2);
<a name="l00627"></a>00627       P-&gt;element-&gt;SetFingerFlow(1);
<a name="l00628"></a>00628 <span class="preprocessor">#endif</span>
<a name="l00629"></a>00629 <span class="preprocessor"></span>      P-&gt;element-&gt;SetArea(<a class="code" href="classfield.html#a500a3007e7d5ce1b18e950abbe4c7a21">area</a>*2.0/3.0);
<a name="l00630"></a>00630       <a class="code" href="classfield.html#a4a4d06d397563e9bd4031f92acaaacc6">thePatches</a>-&gt;<a class="code" href="classclone_list.html#a14b4adf5b6e8ca8e6d262afcdb3cc42b">InsertLast</a>(P2);
<a name="l00631"></a>00631    }
<a name="l00632"></a>00632    <a class="code" href="classfield.html#aa279abd93bccb07f247dbc84f4320d94">daysSinceIrrigationRequest</a> = 0;
<a name="l00633"></a>00633 }
<a name="l00634"></a>00634 
<a name="l00635"></a>00635 <span class="comment">/****************************************************************************\</span>
<a name="l00636"></a>00636 <span class="comment">Handles a field operation (e.g. sowing)</span>
<a name="l00637"></a>00637 <span class="comment">Parameters:</span>
<a name="l00638"></a>00638 <span class="comment">   FOP                object with operation characteristics</span>
<a name="l00639"></a>00639 <span class="comment">\****************************************************************************/</span>
<a name="l00640"></a><a class="code" href="classfield.html#a0609f721e5761c23529f1f08f785a264">00640</a> <span class="keywordtype">bool</span> <a class="code" href="classfield.html#a0609f721e5761c23529f1f08f785a264">field::HandleOperation</a>(<a class="code" href="classfield_operation_fields.html">fieldOperationFields</a> * FOP)
<a name="l00641"></a>00641 {
<a name="l00642"></a>00642 
<a name="l00643"></a>00643         <span class="keywordflow">if</span>(FOP-&gt;<a class="code" href="classfield_operation_fields.html#a97cc7b523640a81790e9d147331c67da">GetCropName</a>()[1]==1)
<a name="l00644"></a>00644                 cout&lt;&lt;FOP-&gt;<a class="code" href="classfield_operation_fields.html#a97cc7b523640a81790e9d147331c67da">GetCropName</a>()&lt;&lt;<span class="stringliteral">&quot;test 4 &quot;</span>&lt;&lt;FOP-&gt;<a class="code" href="classfield_operation_fields.html#a97cc7b523640a81790e9d147331c67da">GetCropName</a>()[1]&lt;&lt;endl;
<a name="l00645"></a>00645         <span class="keywordtype">bool</span> delayOp = <span class="keyword">false</span>;
<a name="l00646"></a>00646    <span class="comment">//NJH commented out next section because it should be transferred to management class </span>
<a name="l00647"></a>00647 <span class="comment">/*      if ((FOP-&gt;GetOperationId()==ForageHarvesting)||(FOP-&gt;GetOperationId()==Mowing))</span>
<a name="l00648"></a>00648 <span class="comment">   {  //delay cutting if no material would be harvested</span>
<a name="l00649"></a>00649 <span class="comment">        if (GetMaxCropHeight()&lt;=0.03)  //cutting height should come from technics not hardcoded  NJH June 2002</span>
<a name="l00650"></a>00650 <span class="comment">      {</span>
<a name="l00651"></a>00651 <span class="comment">        FOP-&gt;DelayOneDay();</span>
<a name="l00652"></a>00652 <span class="comment">         delayOp=true;</span>
<a name="l00653"></a>00653 <span class="comment">      }</span>
<a name="l00654"></a>00654 <span class="comment">   } */</span>
<a name="l00655"></a>00655    <span class="keywordflow">if</span> (!delayOp)
<a name="l00656"></a>00656    {
<a name="l00657"></a>00657            ofstream * fstr=<a class="code" href="message_8h.html#a8ad29009121a629982c6ade0bd332470">theMessage</a>-&gt;<a class="code" href="classmessage.html#a9c4d08163cff8ee8dba9eb8b6317a8b9">GiveHandle</a>();
<a name="l00658"></a>00658       *fstr
<a name="l00659"></a>00659          &lt;&lt; <a class="code" href="bstime_8h.html#ac0dc3834220ee5ae84c115e146194d75">theTime</a>
<a name="l00660"></a>00660          &lt;&lt; <span class="stringliteral">&quot; Field no &quot;</span>
<a name="l00661"></a>00661          &lt;&lt; setw(2)
<a name="l00662"></a>00662          &lt;&lt; <a class="code" href="classbase.html#afa59aaa1a0201700640234eb13a03aae">Index</a>
<a name="l00663"></a>00663          &lt;&lt; <span class="stringliteral">&quot; &quot;</span>
<a name="l00664"></a>00664          &lt;&lt; setfill(<span class="charliteral">&#39; &#39;</span>)
<a name="l00665"></a>00665          &lt;&lt; setiosflags(ios::left)
<a name="l00666"></a>00666          &lt;&lt; setw(20);
<a name="l00667"></a>00667            fstr-&gt;flush();
<a name="l00668"></a>00668         *fstr
<a name="l00669"></a>00669          &lt;&lt; *FOP;
<a name="l00670"></a>00670 
<a name="l00671"></a>00671 
<a name="l00672"></a>00672       <a class="code" href="classclone_list.html">cloneList&lt;patch&gt;::PS</a> P;
<a name="l00673"></a>00673       <a class="code" href="classfield.html#a4a4d06d397563e9bd4031f92acaaacc6">thePatches</a>-&gt;<a class="code" href="classclone_list.html#a2780cfb6574e5cd9b8797b1b5c8c9ad6">PeekHead</a>(P);
<a name="l00674"></a>00674       <span class="keywordflow">while</span> (P!=NULL)
<a name="l00675"></a>00675       {
<a name="l00676"></a>00676          P-&gt;element-&gt;HandleOp(FOP);
<a name="l00677"></a>00677          <a class="code" href="classfield.html#a4a4d06d397563e9bd4031f92acaaacc6">thePatches</a>-&gt;<a class="code" href="classclone_list.html#a2e89afbba3e4eb248912cc2bd1830e7f">OneStep</a>(P);
<a name="l00678"></a>00678       }
<a name="l00679"></a>00679         }
<a name="l00680"></a>00680    <span class="keywordflow">return</span> !delayOp;
<a name="l00681"></a>00681 }
<a name="l00682"></a>00682 
<a name="l00683"></a>00683 <span class="comment">/****************************************************************************\</span>
<a name="l00684"></a>00684 <span class="comment">Returns whether the soil is trafficable. Presently very simplistic, if</span>
<a name="l00685"></a>00685 <span class="comment">standing water is below a threshold, it returns true.</span>
<a name="l00686"></a>00686 <span class="comment">\****************************************************************************/</span>
<a name="l00687"></a><a class="code" href="classfield.html#aae3221ddc530c2211f8092b00d175c02">00687</a> <span class="keywordtype">bool</span> <a class="code" href="classfield.html#aae3221ddc530c2211f8092b00d175c02">field::SoilIsSuitableForFertilizing</a>()
<a name="l00688"></a>00688 {
<a name="l00689"></a>00689    <span class="keywordtype">double</span> standingWater=0.0;
<a name="l00690"></a>00690    <span class="keywordtype">double</span> areaSum=0.0;
<a name="l00691"></a>00691    <a class="code" href="classclone_list.html">cloneList&lt;patch&gt;::PS</a> P;
<a name="l00692"></a>00692         <a class="code" href="classfield.html#a4a4d06d397563e9bd4031f92acaaacc6">thePatches</a>-&gt;<a class="code" href="classclone_list.html#a2780cfb6574e5cd9b8797b1b5c8c9ad6">PeekHead</a>(P);
<a name="l00693"></a>00693    <span class="keywordflow">while</span> (P!=NULL)
<a name="l00694"></a>00694    {
<a name="l00695"></a>00695       <span class="keywordtype">double</span> <a class="code" href="classfield.html#a500a3007e7d5ce1b18e950abbe4c7a21">area</a>=P-&gt;element-&gt;GetArea();
<a name="l00696"></a>00696       areaSum+=<a class="code" href="classfield.html#a500a3007e7d5ce1b18e950abbe4c7a21">area</a>;
<a name="l00697"></a>00697       standingWater+=P-&gt;element-&gt;StandingWater()*<a class="code" href="classfield.html#a500a3007e7d5ce1b18e950abbe4c7a21">area</a>;
<a name="l00698"></a>00698       <a class="code" href="classfield.html#a4a4d06d397563e9bd4031f92acaaacc6">thePatches</a>-&gt;<a class="code" href="classclone_list.html#a2e89afbba3e4eb248912cc2bd1830e7f">OneStep</a>(P);
<a name="l00699"></a>00699    }
<a name="l00700"></a>00700    standingWater=standingWater/areaSum;
<a name="l00701"></a>00701    <span class="keywordflow">return</span> (standingWater&lt;1.0 || <a class="code" href="bstime_8h.html#ac0dc3834220ee5ae84c115e146194d75">theTime</a>.<a class="code" href="classbs_time.html#a777a59c97951688c4b2a67c4b0bca16e">GetMonth</a>()==5); <span class="comment">// To ensure that fertilizing is possible later</span>
<a name="l00702"></a>00702 }
<a name="l00703"></a>00703 
<a name="l00704"></a>00704 <span class="comment">/****************************************************************************\</span>
<a name="l00705"></a>00705 <span class="comment">Perform irrigation of field</span>
<a name="l00706"></a>00706 <span class="comment">Parameters</span>
<a name="l00707"></a>00707 <span class="comment">   year, month, day</span>
<a name="l00708"></a>00708 <span class="comment">\****************************************************************************/</span>
<a name="l00709"></a><a class="code" href="classfield.html#abd51d3a66f0da4571963d53197e84914">00709</a> <span class="keywordtype">void</span> <a class="code" href="classfield.html#abd51d3a66f0da4571963d53197e84914">field::Irrigate</a>(<span class="keywordtype">int</span> year,<span class="keywordtype">int</span> month,<span class="keywordtype">int</span> <a class="code" href="typer_8h.html#ae4c405e5c68c6ec2c44bb6d6adfc2f6ca0c8f8663af5d02dd407beb7decb7df37">day</a>)
<a name="l00710"></a>00710 {
<a name="l00711"></a>00711    <span class="keywordflow">if</span> (<a class="code" href="classfield.html#acfff5382da945e06998c1f1c73b516e9">daysSinceIrrigation</a>&gt;=<a class="code" href="classfield.html#ab9cb5bab1f200cff668744cbf39c3a71">daysBetweenIrrigation</a>)                        <span class="comment">// Must be redefined to capacity of technics!</span>
<a name="l00712"></a>00712    {
<a name="l00713"></a>00713       <span class="keywordflow">if</span> (<a class="code" href="classfield.html#aa279abd93bccb07f247dbc84f4320d94">daysSinceIrrigationRequest</a>&gt;=<a class="code" href="classfield.html#a44f394bfa9a2924bde0653645b5a3182">irrigationDelay</a>)
<a name="l00714"></a>00714       {
<a name="l00715"></a>00715                 <span class="keywordtype">char</span> * crop_id;
<a name="l00716"></a>00716                         <a class="code" href="classfield.html#ac88e569c5e0854563c505665eba50e24">PresentCrop_</a>(crop_id);
<a name="l00717"></a>00717                         <a class="code" href="classwater.html" title="water class in fasset">water</a> * aWater=<span class="keyword">new</span> <a class="code" href="classwater.html" title="water class in fasset">water</a>;
<a name="l00718"></a>00718                         aWater-&gt;<a class="code" href="classproduct.html#a0219cde65dc26376f3371a0138199ba8">Setname</a>(<span class="stringliteral">&quot;WATER&quot;</span>);
<a name="l00719"></a>00719                         <a class="code" href="_new_main_8cpp.html#af1019990138497f1f18cc7294737d140">theProducts</a>-&gt;<a class="code" href="classproducts.html#a8bd239aabc0a167741c02882e305d65d">GiveProductInformation</a>(aWater);
<a name="l00720"></a>00720                         aWater-&gt;<a class="code" href="classproduct.html#a18ec2e96f1d9b7cef74c4b2800ebdca1">Setamount</a>(30*10); <span class="comment">// 30mm, 1ha</span>
<a name="l00721"></a>00721 <span class="preprocessor">#ifdef ARLAS</span>
<a name="l00722"></a>00722 <span class="preprocessor"></span>                   FieldSuitcase-&gt;AddIndicator(<a class="code" href="typer_8h.html#af7c21877c7448b813184ececcc1af13ca7361be8d586650bac7f248153f94f6f2">environmentalIndicator</a>,<span class="stringliteral">&quot;irrigation&quot;</span>,30.0);
<a name="l00723"></a>00723 <span class="preprocessor">#endif</span>
<a name="l00724"></a>00724 <span class="preprocessor"></span>                        <a class="code" href="classirrigate_fields.html">irrigateFields</a> * FOP=<span class="keyword">new</span> <a class="code" href="classirrigate_fields.html">irrigateFields</a>;
<a name="l00725"></a>00725          FOP-&gt;<a class="code" href="classirrigate_fields.html#ac25be5a54804ed89dd06f30b233240e1">DefineIrrigateFieldsOp</a>(<a class="code" href="operation_names_8h.html#a77d40de6faa131199a5de6df3d9c7e3da4968e3909a9da6d055e08e36815389b9">Irrigating</a>,crop_id,crop_id,year,month,day,<a class="code" href="classfield.html#a06bf7fac158821737ac02588c50008a2">FieldArea_</a>(),0,<a class="code" href="classfield.html#aab17aa694538578ace4f6fc40cc561fc">DistanceToField_</a>(),aWater,<span class="keyword">false</span>);
<a name="l00726"></a>00726                    <a class="code" href="classfield.html#a0609f721e5761c23529f1f08f785a264">HandleOperation</a>(FOP);
<a name="l00727"></a>00727                         <a class="code" href="_new_main_8cpp.html#aaaa020fe9c7d56be2174386a833cdec4">theTechnics</a>-&gt;<a class="code" href="classtechnics.html#ae0675e9047b1367a29954b723afb2494">ExecuteFields</a>(FOP);
<a name="l00728"></a>00728          <span class="keyword">delete</span> FOP;
<a name="l00729"></a>00729                         <span class="keyword">delete</span> aWater;
<a name="l00730"></a>00730               <a class="code" href="classfield.html#acfff5382da945e06998c1f1c73b516e9">daysSinceIrrigation</a>=0;
<a name="l00731"></a>00731          <a class="code" href="classfield.html#aa279abd93bccb07f247dbc84f4320d94">daysSinceIrrigationRequest</a>=0;
<a name="l00732"></a>00732       }
<a name="l00733"></a>00733       <span class="keywordflow">else</span>
<a name="l00734"></a>00734         <a class="code" href="classfield.html#aa279abd93bccb07f247dbc84f4320d94">daysSinceIrrigationRequest</a>++;
<a name="l00735"></a>00735         }
<a name="l00736"></a>00736    <span class="keywordflow">else</span>
<a name="l00737"></a>00737         <a class="code" href="classfield.html#aa279abd93bccb07f247dbc84f4320d94">daysSinceIrrigationRequest</a>=0;
<a name="l00738"></a>00738 }
<a name="l00739"></a>00739 
<a name="l00740"></a>00740 <span class="comment">/****************************************************************************\</span>
<a name="l00741"></a>00741 <span class="comment">Determines if the operation can be performed</span>
<a name="l00742"></a>00742 <span class="comment">Note addition of forage harvest (NJH May 2004)</span>
<a name="l00743"></a>00743 <span class="comment">\****************************************************************************/</span>
<a name="l00744"></a><a class="code" href="classfield.html#a7ee560523f2f9f9f12ede3c2fba4b064">00744</a> <span class="keywordtype">bool</span> <a class="code" href="classfield.html#a7ee560523f2f9f9f12ede3c2fba4b064">field::OperationCanBePerformed</a>(<a class="code" href="classplan.html">plan</a>* aPlan,<a class="code" href="classpatch.html">patch</a>* aPatch)
<a name="l00745"></a>00745 {
<a name="l00746"></a>00746    <span class="keywordflow">if</span> (aPlan!=NULL &amp;&amp; !aPlan-&gt;<a class="code" href="classplan.html#a336d1b751be876cf584e47d44826d8ac">Finished</a>()) <span class="comment">// Last term added 28.02.2007 by BMP for speed and transparency</span>
<a name="l00747"></a>00747         {
<a name="l00748"></a>00748 <span class="preprocessor">#ifndef MEASCOPE</span>
<a name="l00749"></a>00749 <span class="preprocessor"></span>        <span class="keywordtype">bool</span> ReadyForHarvest;
<a name="l00750"></a>00750       <span class="keywordflow">if</span> (<a class="code" href="control_parameters_8h.html#a5f2fa76e64eab2ae2d13f038d69004aa">theControlParameters</a>-&gt;<a class="code" href="classcontrol_parameters.html#aef19039d66ec9aafcc7c668dd7f50e29">GetForcedHarvest</a>())
<a name="l00751"></a>00751         ReadyForHarvest = aPlan-&gt;<a class="code" href="classplan.html#ad3c70afeed1b7ed1d00046ebbe3db961">NextIsHarvestOp</a>() &amp;&amp; (aPatch-&gt;<a class="code" href="classpatch.html#add309282252f1c83d6ad6ff827bd0c23" title="returns true if the main crop is ready for harvesting">ReadyForHarvestOrLater</a>() || aPlan-&gt;<a class="code" href="classplan.html#a5b8c3cccd2e9709b4d64d2910f778f9d">NextIsForcedHarvest</a>());
<a name="l00752"></a>00752       <span class="keywordflow">else</span>
<a name="l00753"></a>00753         ReadyForHarvest = aPlan-&gt;<a class="code" href="classplan.html#aee2a49d25d0d0d0019d0b55465d3e4b1">NextIsForageHarvestOp</a>() || (aPlan-&gt;<a class="code" href="classplan.html#ad3c70afeed1b7ed1d00046ebbe3db961">NextIsHarvestOp</a>() &amp;&amp; aPatch-&gt;<a class="code" href="classpatch.html#add309282252f1c83d6ad6ff827bd0c23" title="returns true if the main crop is ready for harvesting">ReadyForHarvestOrLater</a>());
<a name="l00754"></a>00754       <span class="keywordtype">bool</span> ReadyForFertilizing = aPlan-&gt;<a class="code" href="classplan.html#a0d5099abca46e3a99902a0d333ce8a4d">NextIsFertilizing</a>() &amp;&amp; (<a class="code" href="classfield.html#aae3221ddc530c2211f8092b00d175c02">SoilIsSuitableForFertilizing</a>() || <a class="code" href="control_parameters_8h.html#a5f2fa76e64eab2ae2d13f038d69004aa">theControlParameters</a>-&gt;<a class="code" href="classcontrol_parameters.html#a148298acd1a20a91ddf723cbbea6f02f">GetForcedOperations</a>());
<a name="l00755"></a>00755       <span class="keywordtype">bool</span> ReadyForOtherOp = <a class="code" href="control_parameters_8h.html#a5f2fa76e64eab2ae2d13f038d69004aa">theControlParameters</a>-&gt;<a class="code" href="classcontrol_parameters.html#a148298acd1a20a91ddf723cbbea6f02f">GetForcedOperations</a>() || (!aPlan-&gt;<a class="code" href="classplan.html#ad3c70afeed1b7ed1d00046ebbe3db961">NextIsHarvestOp</a>() &amp;&amp; !aPlan-&gt;<a class="code" href="classplan.html#a0d5099abca46e3a99902a0d333ce8a4d">NextIsFertilizing</a>());
<a name="l00756"></a>00756 
<a name="l00757"></a>00757 <span class="comment">/* from MEL_FASSET</span>
<a name="l00758"></a>00758 <span class="comment">      bool ReadyForOtherOp = false;</span>
<a name="l00759"></a>00759 <span class="comment">      if (!aPlan-&gt;NextIsHarvestOp())</span>
<a name="l00760"></a>00760 <span class="comment">         ReadyForOtherOp = theControlParameters-&gt;GetForcedOperations(); // Everything but harvest, incl. fertilization !!!</span>
<a name="l00761"></a>00761 <span class="comment">*/</span>
<a name="l00762"></a>00762         <span class="keywordflow">return</span> (ReadyForHarvest || ReadyForFertilizing || ReadyForOtherOp);
<a name="l00763"></a>00763 <span class="preprocessor">#else</span>
<a name="l00764"></a>00764 <span class="preprocessor"></span>      <span class="keywordtype">bool</span> OpTrigger = <span class="keyword">false</span>;
<a name="l00765"></a>00765       OpTrigger = aPlan-&gt;CheckIfToDo(0.0);   <span class="comment">//should have real moisture from patch!!!</span>
<a name="l00766"></a>00766       <span class="keywordflow">if</span> ((!OpTrigger)&amp;&amp; aPlan-&gt;CheckIfMustDo())  <span class="comment">//if have reached latest date at which an operation may be performed</span>
<a name="l00767"></a>00767                 OpTrigger = <span class="keyword">true</span>;
<a name="l00768"></a>00768       <span class="keywordflow">return</span> OpTrigger;
<a name="l00769"></a>00769 <span class="preprocessor">#endif</span>
<a name="l00770"></a>00770 <span class="preprocessor"></span>        }
<a name="l00771"></a>00771    <span class="keywordflow">else</span>
<a name="l00772"></a>00772         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00773"></a>00773 }
<a name="l00774"></a>00774 
<a name="l00775"></a>00775 <span class="comment">/****************************************************************************\</span>
<a name="l00776"></a>00776 <span class="comment">Daily update of field state</span>
<a name="l00777"></a>00777 <span class="comment">\****************************************************************************/</span>
<a name="l00778"></a><a class="code" href="classfield.html#a90e670aa48996bbf164c0df85ae5590e">00778</a> <span class="keywordtype">void</span> <a class="code" href="classfield.html#a90e670aa48996bbf164c0df85ae5590e">field::UpdateField</a>()
<a name="l00779"></a>00779 {
<a name="l00780"></a>00780    <span class="keywordtype">int</span> year = <a class="code" href="bstime_8h.html#ac0dc3834220ee5ae84c115e146194d75">theTime</a>.<a class="code" href="classbs_time.html#afcb5953580c085bce20eb33a4b21e155">GetYear</a>();
<a name="l00781"></a>00781    <span class="keywordtype">int</span> month = <a class="code" href="bstime_8h.html#ac0dc3834220ee5ae84c115e146194d75">theTime</a>.<a class="code" href="classbs_time.html#a777a59c97951688c4b2a67c4b0bca16e">GetMonth</a>();
<a name="l00782"></a>00782    <span class="keywordtype">int</span> <a class="code" href="typer_8h.html#ae4c405e5c68c6ec2c44bb6d6adfc2f6ca0c8f8663af5d02dd407beb7decb7df37">day</a> = <a class="code" href="bstime_8h.html#ac0dc3834220ee5ae84c115e146194d75">theTime</a>.<a class="code" href="classbs_time.html#a3b4126cf9db93be0c2f69549699730d3">GetDay</a>();
<a name="l00783"></a>00783  <span class="comment">//  cout &lt;&lt; &quot; &quot; &lt;&lt; GetIndex();</span>
<a name="l00784"></a>00784    <span class="keywordflow">if</span> (<a class="code" href="classfield.html#adf9545309af5dd5c46b1059e66abe714">active</a>)
<a name="l00785"></a>00785    {
<a name="l00786"></a>00786 
<a name="l00787"></a>00787 
<a name="l00788"></a>00788       <a class="code" href="classfield.html#acfff5382da945e06998c1f1c73b516e9">daysSinceIrrigation</a>++;
<a name="l00789"></a>00789       <a class="code" href="classclone_list.html">cloneList&lt;patch&gt;::PS</a> P;
<a name="l00790"></a>00790       <a class="code" href="classfield.html#a4a4d06d397563e9bd4031f92acaaacc6">thePatches</a>-&gt;<a class="code" href="classclone_list.html#a2780cfb6574e5cd9b8797b1b5c8c9ad6">PeekHead</a>(P);
<a name="l00791"></a>00791       <span class="keywordflow">if</span> (P==NULL)
<a name="l00792"></a>00792          <a class="code" href="message_8h.html#a8ad29009121a629982c6ade0bd332470">theMessage</a>-&gt;<a class="code" href="classmessage.html#af9891cb7111375e6a36363afffb09d63">FatalError</a>(<span class="stringliteral">&quot;field::UpdateField - no patches in field&quot;</span>);
<a name="l00793"></a>00793       <span class="keywordflow">if</span> (P-&gt;element==NULL)
<a name="l00794"></a>00794          <a class="code" href="message_8h.html#a8ad29009121a629982c6ade0bd332470">theMessage</a>-&gt;<a class="code" href="classmessage.html#af9891cb7111375e6a36363afffb09d63">FatalError</a>(<span class="stringliteral">&quot;field::UpdateField - pointer error&quot;</span>);
<a name="l00795"></a>00795       <a class="code" href="classfield_operation_fields.html">fieldOperationFields</a> * FOP=NULL;
<a name="l00796"></a>00796       <span class="keywordflow">if</span> (<a class="code" href="classfield.html#ad9aa754f50edcc609d69051ade821958">crrPlan</a>!=NULL &amp;&amp; !<a class="code" href="classfield.html#ad9aa754f50edcc609d69051ade821958">crrPlan</a>-&gt;<a class="code" href="classplan.html#a336d1b751be876cf584e47d44826d8ac">Finished</a>())
<a name="l00797"></a>00797          FOP=<a class="code" href="classfield.html#ad9aa754f50edcc609d69051ade821958">crrPlan</a>-&gt;<a class="code" href="classplan.html#a5bb316264b932ad51c4af2441691b61d">ReturnOperation</a>(year,month,day,<span class="keyword">false</span>);
<a name="l00798"></a>00798       <span class="keywordtype">long</span> <span class="keywordtype">int</span> delay=0;
<a name="l00799"></a>00799       <span class="keywordflow">if</span> (FOP!=NULL)
<a name="l00800"></a>00800       {
<a name="l00801"></a>00801 <span class="preprocessor">#ifndef MEASCOPE</span>
<a name="l00802"></a>00802 <span class="preprocessor"></span>         delay=<a class="code" href="bstime_8h.html#ac0dc3834220ee5ae84c115e146194d75">theTime</a>.<a class="code" href="classbs_time.html#aa0e43b35a00367231c77b49ab93a0700">GetDateValue</a>() - FOP-&gt;<a class="code" href="classfield_operation_fields.html#a31ce7910466fadb0a560eb7e56b001e8">GetOpTime</a>()-&gt;<a class="code" href="classbs_time.html#aa0e43b35a00367231c77b49ab93a0700">GetDateValue</a>();
<a name="l00803"></a>00803          <span class="keywordflow">if</span> (delay&gt;65)
<a name="l00804"></a>00804          {
<a name="l00805"></a>00805             cout &lt;&lt; endl &lt;&lt; <a class="code" href="classbase.html#aae39ec3da4311af6b93e424d29b2c66a">GetLongName</a>();
<a name="l00806"></a>00806             <a class="code" href="message_8h.html#a8ad29009121a629982c6ade0bd332470">theMessage</a>-&gt;<a class="code" href="classmessage.html#af9891cb7111375e6a36363afffb09d63">FatalError</a>(<span class="stringliteral">&quot;field::UpdateField - field operation not performed after more than 65 days delay&quot;</span>);
<a name="l00807"></a>00807          }
<a name="l00808"></a>00808 <span class="preprocessor">#else</span>
<a name="l00809"></a>00809 <span class="preprocessor"></span>         delay=<a class="code" href="bstime_8h.html#ac0dc3834220ee5ae84c115e146194d75">theTime</a>.<a class="code" href="classbs_time.html#aa0e43b35a00367231c77b49ab93a0700">GetDateValue</a>() - FOP-&gt;GetopStart()-&gt;GetDateValue();
<a name="l00810"></a>00810          <span class="keywordflow">if</span> (delay&gt;120)
<a name="l00811"></a>00811          {
<a name="l00812"></a>00812             cout &lt;&lt; endl &lt;&lt; <a class="code" href="classbase.html#aae39ec3da4311af6b93e424d29b2c66a">GetLongName</a>();
<a name="l00813"></a>00813             <a class="code" href="message_8h.html#a8ad29009121a629982c6ade0bd332470">theMessage</a>-&gt;<a class="code" href="classmessage.html#af9891cb7111375e6a36363afffb09d63">FatalError</a>(<span class="stringliteral">&quot;field::UpdateField - field operation not performed after more than 120 days delay&quot;</span>);
<a name="l00814"></a>00814          }
<a name="l00815"></a>00815 <span class="preprocessor">#endif</span>
<a name="l00816"></a>00816 <span class="preprocessor"></span>      }
<a name="l00817"></a>00817       <span class="keywordflow">if</span> (<a class="code" href="classfield.html#a7ee560523f2f9f9f12ede3c2fba4b064">OperationCanBePerformed</a>(<a class="code" href="classfield.html#ad9aa754f50edcc609d69051ade821958">crrPlan</a>,P-&gt;element))
<a name="l00818"></a>00818       {
<a name="l00819"></a>00819          FOP=<a class="code" href="classfield.html#ad9aa754f50edcc609d69051ade821958">crrPlan</a>-&gt;<a class="code" href="classplan.html#a5bb316264b932ad51c4af2441691b61d">ReturnOperation</a>(year,month,day,<span class="keyword">true</span>);
<a name="l00820"></a>00820          <span class="keywordflow">if</span> (FOP!=NULL)
<a name="l00821"></a>00821          {
<a name="l00822"></a>00822             <span class="keywordflow">if</span> (<a class="code" href="classfield.html#ad9aa754f50edcc609d69051ade821958">crrPlan</a>-&gt;<a class="code" href="classplan.html#adee3da0790a24dcf45690ab53482e45f">IsThisTheFirst</a>(FOP) &amp;&amp; <a class="code" href="classfield.html#a5a67b4783694d4ba4cf87270306b910b">fingerFlow</a>)
<a name="l00823"></a>00823                <a class="code" href="classfield.html#a1654a805f18f2b50214dcde5dcac2b92">ImplementFingerFlow</a>();
<a name="l00824"></a>00824             <span class="keywordflow">if</span> (!(FOP-&gt;<a class="code" href="classfield_operation_fields.html#acc173f03d2190f694c9bef2fd1e5a314" title="returning false">IsIrrigationOp</a>() &amp;&amp; <a class="code" href="classfield.html#ad9aa754f50edcc609d69051ade821958">crrPlan</a>-&gt;<a class="code" href="classplan.html#a44d27c54c440253db2ce50369826b3cf">AutomaticIrrigation</a>()))
<a name="l00825"></a>00825             {
<a name="l00826"></a>00826                <span class="keywordflow">if</span> (<a class="code" href="classfield.html#a0609f721e5761c23529f1f08f785a264">HandleOperation</a>(FOP))
<a name="l00827"></a>00827                {
<a name="l00828"></a>00828 <span class="preprocessor">#ifdef MEASCOPE</span>
<a name="l00829"></a>00829 <span class="preprocessor"></span>                                                <span class="keywordflow">if</span> (FOP-&gt;GetopEnd())
<a name="l00830"></a>00830                   {
<a name="l00831"></a>00831                      <span class="keywordflow">if</span> (<a class="code" href="bstime_8h.html#ac0dc3834220ee5ae84c115e146194d75">theTime</a>&gt;=*FOP-&gt;GetopEnd())
<a name="l00832"></a>00832                         <a class="code" href="message_8h.html#a8ad29009121a629982c6ade0bd332470">theMessage</a>-&gt;<a class="code" href="classmessage.html#aacaa1466698a349689502491cf089f72">Warning</a>(<span class="stringliteral">&quot;Operation forced at end date: field no and op name = &quot;</span>,
<a name="l00833"></a>00833                            <a class="code" href="classbase.html#afa59aaa1a0201700640234eb13a03aae">Index</a>,<a class="code" href="operation_names_8h.html#a518a13147b9c1749c26077c6a168a00d">operationNameList</a>[FOP-&gt;<a class="code" href="classfield_operation_fields.html#a8981c417041bf7188a41df2881b244fb">GetOperationId</a>()].c_str());
<a name="l00834"></a>00834                   }
<a name="l00835"></a>00835                   <a class="code" href="classfield.html#ad9aa754f50edcc609d69051ade821958">crrPlan</a>-&gt;CheckIfFinished();
<a name="l00836"></a>00836 <span class="preprocessor">#else</span>
<a name="l00837"></a>00837 <span class="preprocessor"></span>                  <span class="keywordflow">if</span> (delay&gt;20)
<a name="l00838"></a>00838                   {
<a name="l00839"></a>00839                      cout &lt;&lt; endl &lt;&lt; delay &lt;&lt; <span class="stringliteral">&quot; days delay of operation type &quot;</span> &lt;&lt; FOP-&gt;<a class="code" href="classfield_operation_fields.html#a8981c417041bf7188a41df2881b244fb">GetOperationId</a>() &lt;&lt; <span class="stringliteral">&quot; due for &quot;</span> &lt;&lt; *FOP-&gt;<a class="code" href="classfield_operation_fields.html#a31ce7910466fadb0a560eb7e56b001e8">GetOpTime</a>() &lt;&lt; <span class="stringliteral">&quot; on field no &quot;</span> &lt;&lt; <a class="code" href="classbase.html#afa59aaa1a0201700640234eb13a03aae">Index</a> &lt;&lt; endl;
<a name="l00840"></a>00840                      <span class="keywordflow">if</span> (delay&gt;60)
<a name="l00841"></a>00841                         <a class="code" href="message_8h.html#a8ad29009121a629982c6ade0bd332470">theMessage</a>-&gt;<a class="code" href="classmessage.html#afed66d0552f90b4385c5169cf5929907">WarningWithDisplay</a>(<span class="stringliteral">&quot;field::UpdateField - field operation performed after more than 60 days delay&quot;</span>);
<a name="l00842"></a>00842                      <span class="keywordflow">else</span>
<a name="l00843"></a>00843                         <a class="code" href="message_8h.html#a8ad29009121a629982c6ade0bd332470">theMessage</a>-&gt;<a class="code" href="classmessage.html#aacaa1466698a349689502491cf089f72">Warning</a>(<span class="stringliteral">&quot;field::UpdateField - field operation performed after more than 20 days delay&quot;</span>);
<a name="l00844"></a>00844                   }
<a name="l00845"></a>00845 <span class="preprocessor">#endif</span>
<a name="l00846"></a>00846 <span class="preprocessor"></span>                  <a class="code" href="_new_main_8cpp.html#aaaa020fe9c7d56be2174386a833cdec4">theTechnics</a>-&gt;<a class="code" href="classtechnics.html#ae0675e9047b1367a29954b723afb2494">ExecuteFields</a>(FOP);
<a name="l00847"></a>00847                   ofstream * <a class="code" href="classbase.html#a3af52ee9891719d09b8b19b42450b6f6">file</a>=<a class="code" href="message_8h.html#a8ad29009121a629982c6ade0bd332470">theMessage</a>-&gt;<a class="code" href="classmessage.html#a9c4d08163cff8ee8dba9eb8b6317a8b9">GiveHandle</a>();  <span class="comment">// write end of line marker</span>
<a name="l00848"></a>00848                   *file &lt;&lt; endl;
<a name="l00849"></a>00849 
<a name="l00850"></a>00850                }
<a name="l00851"></a>00851             }
<a name="l00852"></a>00852          }
<a name="l00853"></a>00853       }
<a name="l00854"></a>00854       <span class="keywordflow">while</span> (P!=NULL)
<a name="l00855"></a>00855       {
<a name="l00856"></a>00856               <span class="keywordflow">if</span> (P-&gt;element-&gt;IrrigationDemand() &amp;&amp; <a class="code" href="classfield.html#ad9aa754f50edcc609d69051ade821958">crrPlan</a>-&gt;<a class="code" href="classplan.html#a44d27c54c440253db2ce50369826b3cf">AutomaticIrrigation</a>())
<a name="l00857"></a>00857               <a class="code" href="classfield.html#abd51d3a66f0da4571963d53197e84914">Irrigate</a>(year,month,day);
<a name="l00858"></a>00858         <a class="code" href="classfield.html#a4a4d06d397563e9bd4031f92acaaacc6">thePatches</a>-&gt;<a class="code" href="classclone_list.html#a2e89afbba3e4eb248912cc2bd1830e7f">OneStep</a>(P);
<a name="l00859"></a>00859       }
<a name="l00860"></a>00860 
<a name="l00861"></a>00861 <span class="preprocessor">#ifdef TUPLE</span>
<a name="l00862"></a>00862 <span class="preprocessor"></span>      <span class="keywordflow">if</span> (writeTuples)
<a name="l00863"></a>00863       {
<a name="l00864"></a>00864          <a class="code" href="classclone_list.html">cloneList&lt;patch&gt;::PS</a> P;
<a name="l00865"></a>00865          <a class="code" href="classfield.html#a4a4d06d397563e9bd4031f92acaaacc6">thePatches</a>-&gt;<a class="code" href="classclone_list.html#a2780cfb6574e5cd9b8797b1b5c8c9ad6">PeekHead</a>(P);
<a name="l00866"></a>00866          <span class="keywordflow">if</span> (P!=NULL)
<a name="l00867"></a>00867          {
<a name="l00868"></a>00868             fixation_sum+=P-&gt;element-&gt;GetNFixationThisDay();
<a name="l00869"></a>00869             deposition_sum+=0.0411; <span class="comment">// HACK, UPDATE !!!!!!!!!!!!!!!!!!!!!!!!!!!!</span>
<a name="l00870"></a>00870          }
<a name="l00871"></a>00871          <span class="keywordflow">if</span> (day==31 &amp;&amp; month==12)
<a name="l00872"></a>00872          {
<a name="l00873"></a>00873             AddTuple(<a class="code" href="bstime_8h.html#ac0dc3834220ee5ae84c115e146194d75">theTime</a>.<a class="code" href="classbs_time.html#a3573b9448deb1114eb32070d3c179cee">GetString2</a>(),deposition_sum*<a class="code" href="classfield.html#a500a3007e7d5ce1b18e950abbe4c7a21">area</a>,0,<span class="stringliteral">&quot;DEPOSITION&quot;</span>,<span class="stringliteral">&quot;DEPOSITION&quot;</span>,0);
<a name="l00874"></a>00874             AddTuple(<a class="code" href="bstime_8h.html#ac0dc3834220ee5ae84c115e146194d75">theTime</a>.<a class="code" href="classbs_time.html#a3573b9448deb1114eb32070d3c179cee">GetString2</a>(),fixation_sum*<a class="code" href="classfield.html#a500a3007e7d5ce1b18e950abbe4c7a21">area</a>,0,<span class="stringliteral">&quot;FIXATION&quot;</span>,<span class="stringliteral">&quot;FIXATION&quot;</span>,0);
<a name="l00875"></a>00875             deposition_sum=0.0;
<a name="l00876"></a>00876             fixation_sum=0.0;
<a name="l00877"></a>00877          }
<a name="l00878"></a>00878       }
<a name="l00879"></a>00879 <span class="preprocessor">#endif</span>
<a name="l00880"></a>00880 <span class="preprocessor"></span>
<a name="l00881"></a>00881       <a class="code" href="classfield.html#ad57b5d59bb4168a4f642c6490bedc001">UpdatePatches</a>();
<a name="l00882"></a>00882 
<a name="l00883"></a>00883                 <a class="code" href="classfield.html#a5e7c7c8374cf01bc46d7e0c4619b5bd5">GiveIndicators</a>();
<a name="l00884"></a>00884 
<a name="l00885"></a>00885    }
<a name="l00886"></a>00886 }
<a name="l00887"></a>00887 
<a name="l00888"></a>00888 <span class="comment">/****************************************************************************\</span>
<a name="l00889"></a>00889 <span class="comment">\****************************************************************************/</span>
<a name="l00890"></a><a class="code" href="classfield.html#ad57b5d59bb4168a4f642c6490bedc001">00890</a> <span class="keywordtype">void</span> <a class="code" href="classfield.html#ad57b5d59bb4168a4f642c6490bedc001">field::UpdatePatches</a>()
<a name="l00891"></a>00891 {
<a name="l00892"></a>00892    <a class="code" href="classclone_list.html">cloneList&lt;patch&gt;::PS</a> P;
<a name="l00893"></a>00893         <a class="code" href="classfield.html#a4a4d06d397563e9bd4031f92acaaacc6">thePatches</a>-&gt;<a class="code" href="classclone_list.html#a2780cfb6574e5cd9b8797b1b5c8c9ad6">PeekHead</a>(P);
<a name="l00894"></a>00894    <span class="keywordtype">int</span> k=0;
<a name="l00895"></a>00895    <span class="keywordflow">while</span> (P!=NULL)
<a name="l00896"></a>00896    {
<a name="l00897"></a>00897       P-&gt;element-&gt;UpdatePatches();
<a name="l00898"></a>00898       <a class="code" href="classfield.html#a4a4d06d397563e9bd4031f92acaaacc6">thePatches</a>-&gt;<a class="code" href="classclone_list.html#a2e89afbba3e4eb248912cc2bd1830e7f">OneStep</a>(P);
<a name="l00899"></a>00899       k++;
<a name="l00900"></a>00900    }
<a name="l00901"></a>00901    <span class="keywordflow">if</span> (<a class="code" href="output_data_8h.html#aadc9d3b76fa69bf28c5ab340dd810e20">theOutputData</a>-&gt;<a class="code" href="classoutput_data.html#ae50b979972f6c57c3881edd6a7dd96b4">DetailsData</a>.<a class="code" href="classoutput_details.html#a8016daa0937dbb46a90a81a93daa6517">getPlantDetails</a>()==<span class="keyword">true</span>)
<a name="l00902"></a>00902       <a class="code" href="classfield.html#a15884755ee5efe058ae4dd8feb64594b">OutputPlantDetails</a>(<span class="keyword">false</span>);
<a name="l00903"></a>00903 
<a name="l00904"></a>00904 }
<a name="l00905"></a>00905 
<a name="l00906"></a>00906 <span class="comment">/****************************************************************************\</span>
<a name="l00907"></a>00907 <span class="comment">Returns the crop for a previous season</span>
<a name="l00908"></a>00908 <span class="comment">Parameters</span>
<a name="l00909"></a>00909 <span class="comment">   nr        season</span>
<a name="l00910"></a>00910 <span class="comment">   crop_id   reference for the crop id</span>
<a name="l00911"></a>00911 <span class="comment">\****************************************************************************/</span>
<a name="l00912"></a><a class="code" href="classfield.html#a468fc8855c94286509a39dfcd8130c2b">00912</a> <span class="keywordtype">void</span> <a class="code" href="classfield.html#a468fc8855c94286509a39dfcd8130c2b">field::CropHistory</a>(<span class="keywordtype">int</span> nr,<span class="keywordtype">char</span> * &amp;crop_id)
<a name="l00913"></a>00913 {
<a name="l00914"></a>00914    crop_id =<span class="keyword">new</span> <span class="keywordtype">char</span>[3];
<a name="l00915"></a>00915    strcpy(crop_id,<a class="code" href="classfield.html#a9caa57c3cef343f9110d4c70a758def7">History</a>[nr].c_str());
<a name="l00916"></a>00916    <span class="keywordflow">if</span> (!<a class="code" href="classfield.html#adf9545309af5dd5c46b1059e66abe714">active</a>)
<a name="l00917"></a>00917       <a class="code" href="message_8h.html#a8ad29009121a629982c6ade0bd332470">theMessage</a>-&gt;<a class="code" href="classmessage.html#af9891cb7111375e6a36363afffb09d63">FatalError</a>(<span class="stringliteral">&quot;field::CropHistory called for inactive field&quot;</span>);
<a name="l00918"></a>00918 }
<a name="l00919"></a>00919 
<a name="l00920"></a>00920 <span class="comment">/****************************************************************************\</span>
<a name="l00921"></a>00921 <span class="comment">Returns the present crop</span>
<a name="l00922"></a>00922 <span class="comment">\****************************************************************************/</span>
<a name="l00923"></a><a class="code" href="classfield.html#ac88e569c5e0854563c505665eba50e24">00923</a> <span class="keywordtype">void</span> <a class="code" href="classfield.html#ac88e569c5e0854563c505665eba50e24">field::PresentCrop_</a>(<span class="keywordtype">char</span> * &amp;crop_id)
<a name="l00924"></a>00924 {
<a name="l00925"></a>00925         crop_id =<span class="keyword">new</span> <span class="keywordtype">char</span>[5];
<a name="l00926"></a>00926         strcpy(crop_id,<a class="code" href="classfield.html#a9caa57c3cef343f9110d4c70a758def7">History</a>[3].c_str());
<a name="l00927"></a>00927 }
<a name="l00928"></a>00928 
<a name="l00929"></a>00929 <span class="comment">/****************************************************************************\</span>
<a name="l00930"></a>00930 <span class="comment">Returns the distance from farm to field (meters)</span>
<a name="l00931"></a>00931 <span class="comment">\****************************************************************************/</span>
<a name="l00932"></a><a class="code" href="classfield.html#aab17aa694538578ace4f6fc40cc561fc">00932</a> <span class="keywordtype">double</span> <a class="code" href="classfield.html#aab17aa694538578ace4f6fc40cc561fc">field::DistanceToField_</a>()
<a name="l00933"></a>00933 {
<a name="l00934"></a>00934         <span class="keywordflow">return</span> <a class="code" href="classfield.html#a477599b3c8ed6a953d27dc2d2db2cfcc">distance</a>;
<a name="l00935"></a>00935 }
<a name="l00936"></a>00936 
<a name="l00937"></a>00937 
<a name="l00938"></a>00938 
<a name="l00939"></a>00939 <span class="comment">/****************************************************************************\</span>
<a name="l00940"></a>00940 <span class="comment">Returns the area of the field (ha)</span>
<a name="l00941"></a>00941 <span class="comment">\****************************************************************************/</span>
<a name="l00942"></a><a class="code" href="classfield.html#a06bf7fac158821737ac02588c50008a2">00942</a> <span class="keywordtype">double</span> <a class="code" href="classfield.html#a06bf7fac158821737ac02588c50008a2">field::FieldArea_</a>()
<a name="l00943"></a>00943 {
<a name="l00944"></a>00944         <span class="keywordflow">return</span> <a class="code" href="classfield.html#a500a3007e7d5ce1b18e950abbe4c7a21">area</a>;
<a name="l00945"></a>00945 }
<a name="l00946"></a>00946 
<a name="l00947"></a>00947 <span class="comment">/****************************************************************************\</span>
<a name="l00948"></a>00948 <span class="comment">Returns the JB classification number of the soil</span>
<a name="l00949"></a>00949 <span class="comment">\****************************************************************************/</span>
<a name="l00950"></a><a class="code" href="classfield.html#aa93627cc48e5c33da7ce60ef2b06fb91">00950</a> <span class="keywordtype">int</span> <a class="code" href="classfield.html#aa93627cc48e5c33da7ce60ef2b06fb91">field::JBno</a>()
<a name="l00951"></a>00951 {
<a name="l00952"></a>00952         <span class="keywordflow">return</span> <a class="code" href="classfield.html#ae283dc67495fb9dd0056d9a88b6f69c1">JBNO</a>;
<a name="l00953"></a>00953 }
<a name="l00954"></a>00954 
<a name="l00955"></a>00955 
<a name="l00956"></a>00956 
<a name="l00957"></a>00957 <span class="comment">/****************************************************************************\</span>
<a name="l00958"></a>00958 <span class="comment">Inserts the plan in the list of plans for the following growth season</span>
<a name="l00959"></a>00959 <span class="comment">Parmeters:</span>
<a name="l00960"></a>00960 <span class="comment">   OP            plan (list of field operations)</span>
<a name="l00961"></a>00961 <span class="comment">   str crop_id   crop identification</span>
<a name="l00962"></a>00962 <span class="comment">\****************************************************************************/</span>
<a name="l00963"></a><a class="code" href="classfield.html#a2943f6f16de6cd14db847055cf7a6f0e">00963</a> <span class="keywordtype">void</span> <a class="code" href="classfield.html#a2943f6f16de6cd14db847055cf7a6f0e">field::PlanField_</a>(<a class="code" href="classclone_list.html">cloneList&lt;fieldOperationFields&gt;</a> * OP,str crop_id,<span class="keywordtype">int</span> futureNum)
<a name="l00964"></a>00964 {
<a name="l00965"></a>00965         <a class="code" href="classplan.html">plan</a> * pl=<span class="keyword">new</span> <a class="code" href="classplan.html">plan</a>;
<a name="l00966"></a>00966         <a class="code" href="classclone_list.html">cloneList&lt;fieldOperationFields&gt;::PS</a> P;
<a name="l00967"></a>00967         OP-&gt;<a class="code" href="classclone_list.html#a2780cfb6574e5cd9b8797b1b5c8c9ad6">PeekHead</a>(P);
<a name="l00968"></a>00968         pl-&gt;<a class="code" href="classplan.html#ac480e9366949237b6904a397bfb8b57c">HandPlanOver</a>(OP,crop_id,futureNum);
<a name="l00969"></a>00969    <span class="keywordflow">if</span> (pl-&gt;<a class="code" href="classplan.html#a2e5057eb3ec7c4ad4b20ac628f7ad1e9">GiveNumOps</a>()==0)
<a name="l00970"></a>00970         <span class="keyword">delete</span> pl;
<a name="l00971"></a>00971    <span class="keywordflow">else</span>
<a name="l00972"></a>00972    {
<a name="l00973"></a>00973 <span class="preprocessor">#ifdef MEASCOPE</span>
<a name="l00974"></a>00974 <span class="preprocessor"></span>        pl-&gt;CheckOps();
<a name="l00975"></a>00975 <span class="preprocessor">#endif</span>
<a name="l00976"></a>00976 <span class="preprocessor"></span>                <a class="code" href="classfield.html#a06360b6852f2e8f6348924d7bb3564b2">Lfutr</a>-&gt;<a class="code" href="classclone_list.html#a56a0c2c564dd251e6f9db7061370e1dc">InsertFirst</a>(pl);
<a name="l00977"></a>00977    }
<a name="l00978"></a>00978 }
<a name="l00979"></a>00979 
<a name="l00980"></a>00980 
<a name="l00981"></a>00981 
<a name="l00982"></a>00982 
<a name="l00983"></a>00983 <span class="preprocessor">#ifdef TUPLE</span>
<a name="l00984"></a>00984 <span class="preprocessor"></span><span class="comment">/****************************************************************************\</span>
<a name="l00985"></a>00985 <span class="comment">\****************************************************************************/</span>
<a name="l00986"></a>00986 <span class="keywordtype">void</span> field::CloseTupleFile()
<a name="l00987"></a>00987 {
<a name="l00988"></a>00988    <span class="keywordflow">if</span> (tuple_file_open)
<a name="l00989"></a>00989    {
<a name="l00990"></a>00990       tuple.close();
<a name="l00991"></a>00991       tuple_file_open=<span class="keyword">false</span>;
<a name="l00992"></a>00992    }
<a name="l00993"></a>00993 }
<a name="l00994"></a>00994 
<a name="l00995"></a>00995 <span class="comment">/****************************************************************************\</span>
<a name="l00996"></a>00996 <span class="comment">\****************************************************************************/</span>
<a name="l00997"></a>00997 <span class="keywordtype">void</span> field::OpenTupleFile(<span class="keywordtype">string</span> s)
<a name="l00998"></a>00998 {
<a name="l00999"></a>00999    <span class="keywordtype">string</span> s1=<span class="stringliteral">&quot;c:\\fasset_v2\\F_&quot;</span>+s+<span class="stringliteral">&quot;_sim.txt&quot;</span>;
<a name="l01000"></a>01000    <span class="keywordflow">if</span> (<a class="code" href="control_parameters_8h.html#a5f2fa76e64eab2ae2d13f038d69004aa">theControlParameters</a>-&gt;GetSimTupleHasBeenOpened())
<a name="l01001"></a>01001       tuple.open(s1.c_str(),ios::app);
<a name="l01002"></a>01002    <span class="keywordflow">else</span>
<a name="l01003"></a>01003    {
<a name="l01004"></a>01004       tuple.open(s1.c_str(),ios::out);
<a name="l01005"></a>01005       tuple &lt;&lt; <span class="stringliteral">&quot;Key\tFarmId\tFieldno\tDate\tIndex\tMainCrop\tArea\tOperation\tProduct\tN\tAmount\tSFU&quot;</span> &lt;&lt; endl;
<a name="l01006"></a>01006       <a class="code" href="control_parameters_8h.html#a5f2fa76e64eab2ae2d13f038d69004aa">theControlParameters</a>-&gt;SetSimTupleHasBeenOpened(<span class="keyword">true</span>);
<a name="l01007"></a>01007    }
<a name="l01008"></a>01008    tuple_file_open=<span class="keyword">true</span>;
<a name="l01009"></a>01009 }
<a name="l01010"></a>01010 
<a name="l01011"></a>01011 <span class="comment">/****************************************************************************\</span>
<a name="l01012"></a>01012 <span class="comment">Parametre: dato,N,m�ngde,operation,type</span>
<a name="l01013"></a>01013 <span class="comment">N�gle (unik)  Bedrifts-id     Marknummer      Dato    Index (ved flere op. samme dato)        Hovedafgr�de  Areal (ha)      Operation       Produktnavn     H�stet N (kg) M�ngde (kg - ikke sl�t)     H�stet FE</span>
<a name="l01014"></a>01014 <span class="comment">Eksempel: 95023_8_15-08-2001_1_RY       95023   8       15-08-2001      1       RY      6.4     Combineharvesting       RYEGRAIN        478.9   29440   -</span>
<a name="l01015"></a>01015 <span class="comment">\****************************************************************************/</span>
<a name="l01016"></a>01016 <span class="keywordtype">void</span> field::AddTuple(<span class="keywordtype">string</span> date,<span class="keywordtype">double</span> n,<span class="keywordtype">double</span> amount,<span class="keywordtype">string</span> op,<span class="keywordtype">string</span> type,<span class="keywordtype">double</span> SFU)
<a name="l01017"></a>01017 {
<a name="l01018"></a>01018    <span class="keywordflow">if</span> (<a class="code" href="classfield.html#a500a3007e7d5ce1b18e950abbe4c7a21">area</a>&gt;=0.001 &amp;&amp; writeTuples)
<a name="l01019"></a>01019    {
<a name="l01020"></a>01020       <span class="keywordtype">string</span> farmId=<a class="code" href="control_parameters_8h.html#a5f2fa76e64eab2ae2d13f038d69004aa">theControlParameters</a>-&gt;GetFarmID();
<a name="l01021"></a>01021       <span class="keywordflow">if</span> (farmId==<span class="stringliteral">&quot;&quot;</span>)
<a name="l01022"></a>01022          <a class="code" href="message_8h.html#a8ad29009121a629982c6ade0bd332470">theMessage</a>-&gt;<a class="code" href="classmessage.html#af9891cb7111375e6a36363afffb09d63">FatalError</a>(<span class="stringliteral">&quot;fieldOrder::AddTuple - attempt to add tuples but no farm ID specified&quot;</span>);
<a name="l01023"></a>01023       <span class="keywordflow">if</span> (!tuple_file_open)
<a name="l01024"></a>01024          OpenTupleFile(farmId);
<a name="l01025"></a>01025       <span class="keywordtype">int</span> idx = GetOperationIndex(date);
<a name="l01026"></a>01026       tuple &lt;&lt; farmId &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt; <a class="code" href="classbase.html#afa59aaa1a0201700640234eb13a03aae">Index</a> &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt;  date &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt; idx &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt; <a class="code" href="classfield.html#a9caa57c3cef343f9110d4c70a758def7">History</a>[3].crop &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span>;
<a name="l01027"></a>01027       tuple &lt;&lt; farmId &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <a class="code" href="classbase.html#afa59aaa1a0201700640234eb13a03aae">Index</a> &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; date &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; idx &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span>;
<a name="l01028"></a>01028       tuple &lt;&lt; <a class="code" href="classfield.html#a9caa57c3cef343f9110d4c70a758def7">History</a>[3].crop &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <a class="code" href="classfield.html#a500a3007e7d5ce1b18e950abbe4c7a21">area</a> &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; op &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; type &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; n;
<a name="l01029"></a>01029       tuple &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; amount &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; SFU &lt;&lt; endl;
<a name="l01030"></a>01030       CloseTupleFile(); <span class="comment">// Only in field objects</span>
<a name="l01031"></a>01031    }
<a name="l01032"></a>01032 }
<a name="l01033"></a>01033 <span class="preprocessor">#endif</span>
<a name="l01034"></a>01034 <span class="preprocessor"></span>
<a name="l01035"></a>01035 
<a name="l01036"></a>01036 
<a name="l01037"></a>01037 
<a name="l01038"></a>01038 
<a name="l01039"></a>01039 
<a name="l01040"></a>01040 <span class="comment">/****************************************************************************\</span>
<a name="l01041"></a>01041 <span class="comment">*</span>
<a name="l01042"></a>01042 <span class="comment">\****************************************************************************/</span>
<a name="l01043"></a><a class="code" href="classfield.html#a15884755ee5efe058ae4dd8feb64594b">01043</a> <span class="keywordtype">void</span> <a class="code" href="classfield.html#a15884755ee5efe058ae4dd8feb64594b">field::OutputPlantDetails</a>(<span class="keywordtype">bool</span> header)
<a name="l01044"></a>01044 {
<a name="l01045"></a>01045         <span class="keywordflow">if</span> (header)
<a name="l01046"></a>01046         {
<a name="l01047"></a>01047       <a class="code" href="classfield.html#a2d250d63f6438e6ebdfd1e4c4bf1292e">f</a> &lt;&lt; <span class="stringliteral">&quot;date&quot;</span>;
<a name="l01048"></a>01048       <a class="code" href="classfield.html#a2d250d63f6438e6ebdfd1e4c4bf1292e">f</a> &lt;&lt; <span class="stringliteral">&quot;\tcrop number\tpClover&quot;</span>;
<a name="l01049"></a>01049       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;<a class="code" href="typer_8h.html#adc29c2ff13d900c2f185ee95427fb06ca1f37f2cf718636fd4290eea4cbbfaf6d">MaxPlants</a>;i++)
<a name="l01050"></a>01050       {
<a name="l01051"></a>01051 
<a name="l01052"></a>01052                 <a class="code" href="classfield.html#a2d250d63f6438e6ebdfd1e4c4bf1292e">f</a> &lt;&lt; <span class="stringliteral">&quot;\tCropName\tphase\tTempSum\tCO2conc\tGLAI\tYLAI\tDMRoot\tDMRootPL\tDMRootTubers\tDMtop\tDMStorage\tDMTotalTop&quot;</span>;
<a name="l01053"></a>01053                    <a class="code" href="classfield.html#a2d250d63f6438e6ebdfd1e4c4bf1292e">f</a> &lt;&lt; <span class="stringliteral">&quot;\tTranspirationRatio\tIrrigationDemand\tHeight\tRootDepth\tTotalRootLength\tInterceptedRadiation&quot;</span>;
<a name="l01054"></a>01054            <a class="code" href="classfield.html#a2d250d63f6438e6ebdfd1e4c4bf1292e">f</a> &lt;&lt; <span class="stringliteral">&quot;\tNitrogen\tN15\tNmin()\tNmax()\tNStorage\tNTop\tNVegTop\tNRoot\tNRootPL\tNRootTubers\tfNitrogen\tfNitrogenCurve&quot;</span>;
<a name="l01055"></a>01055            <a class="code" href="classfield.html#a2d250d63f6438e6ebdfd1e4c4bf1292e">f</a> &lt;&lt; <span class="stringliteral">&quot;\tRootDeposit\tRootTrans\tNRootDeposit\tTopDeposit\tNTopDeposit&quot;</span>;
<a name="l01056"></a>01056          <a class="code" href="classfield.html#a2d250d63f6438e6ebdfd1e4c4bf1292e">f</a> &lt;&lt; <span class="stringliteral">&quot;\tTopProd\tNUptake\tNfix\tNfixAcc\tdeltaDM\tN15Root\tAccRootResp&quot;</span>;
<a name="l01057"></a>01057          <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0;i&lt;<a class="code" href="output_data_8h.html#aadc9d3b76fa69bf28c5ab340dd810e20">theOutputData</a>-&gt;<a class="code" href="classoutput_data.html#a52a733aa57217c278df4d06e50c48ad8">RootData</a>.size();i++)
<a name="l01058"></a>01058          {
<a name="l01059"></a>01059             <a class="code" href="classfield.html#a2d250d63f6438e6ebdfd1e4c4bf1292e">f</a> &lt;&lt; <span class="stringliteral">&quot;\tRootLength-&quot;</span>&lt;&lt; <a class="code" href="output_data_8h.html#aadc9d3b76fa69bf28c5ab340dd810e20">theOutputData</a>-&gt;<a class="code" href="classoutput_data.html#a52a733aa57217c278df4d06e50c48ad8">RootData</a>[i].getStartDepth() &lt;&lt; <span class="stringliteral">&quot;-&quot;</span>&lt;&lt; <a class="code" href="output_data_8h.html#aadc9d3b76fa69bf28c5ab340dd810e20">theOutputData</a>-&gt;<a class="code" href="classoutput_data.html#a52a733aa57217c278df4d06e50c48ad8">RootData</a>[i].getEndDepth();
<a name="l01060"></a>01060                 <a class="code" href="classfield.html#a2d250d63f6438e6ebdfd1e4c4bf1292e">f</a> &lt;&lt; <span class="stringliteral">&quot;\tRootMass-&quot;</span>&lt;&lt; <a class="code" href="output_data_8h.html#aadc9d3b76fa69bf28c5ab340dd810e20">theOutputData</a>-&gt;<a class="code" href="classoutput_data.html#a52a733aa57217c278df4d06e50c48ad8">RootData</a>[i].getStartDepth() &lt;&lt; <span class="stringliteral">&quot;-&quot;</span>&lt;&lt; <a class="code" href="output_data_8h.html#aadc9d3b76fa69bf28c5ab340dd810e20">theOutputData</a>-&gt;<a class="code" href="classoutput_data.html#a52a733aa57217c278df4d06e50c48ad8">RootData</a>[i].getEndDepth();
<a name="l01061"></a>01061                 <a class="code" href="classfield.html#a2d250d63f6438e6ebdfd1e4c4bf1292e">f</a> &lt;&lt; <span class="stringliteral">&quot;\tRootN-&quot;</span>&lt;&lt; <a class="code" href="output_data_8h.html#aadc9d3b76fa69bf28c5ab340dd810e20">theOutputData</a>-&gt;<a class="code" href="classoutput_data.html#a52a733aa57217c278df4d06e50c48ad8">RootData</a>[i].getStartDepth() &lt;&lt; <span class="stringliteral">&quot;-&quot;</span>&lt;&lt; <a class="code" href="output_data_8h.html#aadc9d3b76fa69bf28c5ab340dd810e20">theOutputData</a>-&gt;<a class="code" href="classoutput_data.html#a52a733aa57217c278df4d06e50c48ad8">RootData</a>[i].getEndDepth();
<a name="l01062"></a>01062         }
<a name="l01063"></a>01063       }
<a name="l01064"></a>01064 
<a name="l01065"></a>01065 
<a name="l01066"></a>01066         }
<a name="l01067"></a>01067    <span class="keywordflow">else</span>
<a name="l01068"></a>01068       <a class="code" href="classfield.html#a2d250d63f6438e6ebdfd1e4c4bf1292e">f</a> &lt;&lt; <a class="code" href="bstime_8h.html#ac0dc3834220ee5ae84c115e146194d75">theTime</a>.<a class="code" href="classbs_time.html#afcb5953580c085bce20eb33a4b21e155">GetYear</a>() &lt;&lt; <span class="stringliteral">&quot;-&quot;</span> &lt;&lt; <a class="code" href="bstime_8h.html#ac0dc3834220ee5ae84c115e146194d75">theTime</a>.<a class="code" href="classbs_time.html#a777a59c97951688c4b2a67c4b0bca16e">GetMonth</a>() &lt;&lt; <span class="stringliteral">&quot;-&quot;</span> &lt;&lt; <a class="code" href="bstime_8h.html#ac0dc3834220ee5ae84c115e146194d75">theTime</a>.<a class="code" href="classbs_time.html#a3b4126cf9db93be0c2f69549699730d3">GetDay</a>();
<a name="l01069"></a>01069 
<a name="l01070"></a>01070    <a class="code" href="classclone_list.html">cloneList&lt;patch&gt;::PS</a> P;
<a name="l01071"></a>01071    <a class="code" href="classfield.html#a4a4d06d397563e9bd4031f92acaaacc6">thePatches</a>-&gt;<a class="code" href="classclone_list.html#a2780cfb6574e5cd9b8797b1b5c8c9ad6">PeekHead</a>(P);
<a name="l01072"></a>01072    <span class="keywordflow">while</span> (P!=NULL)
<a name="l01073"></a>01073    {
<a name="l01074"></a>01074       P-&gt;element-&gt;outputCropDetails(&amp;<a class="code" href="classfield.html#a2d250d63f6438e6ebdfd1e4c4bf1292e">f</a>);
<a name="l01075"></a>01075       <a class="code" href="classfield.html#a4a4d06d397563e9bd4031f92acaaacc6">thePatches</a>-&gt;<a class="code" href="classclone_list.html#a2e89afbba3e4eb248912cc2bd1830e7f">OneStep</a>(P);
<a name="l01076"></a>01076    }
<a name="l01077"></a>01077    <a class="code" href="classfield.html#a2d250d63f6438e6ebdfd1e4c4bf1292e">f</a> &lt;&lt; endl;
<a name="l01078"></a>01078 }
<a name="l01079"></a>01079 
<a name="l01080"></a>01080 <span class="comment">/****************************************************************************\</span>
<a name="l01081"></a>01081 <span class="comment">Initialise budget variables</span>
<a name="l01082"></a>01082 <span class="comment">\****************************************************************************/</span>
<a name="l01083"></a><a class="code" href="classfield.html#a3ee84f37d88779277b69e962346b1a24">01083</a> <span class="keywordtype">void</span> <a class="code" href="classfield.html#a3ee84f37d88779277b69e962346b1a24">field::StartBudget</a>()
<a name="l01084"></a>01084 {
<a name="l01085"></a>01085         <span class="keywordflow">if</span> (<a class="code" href="classfield.html#a4a4d06d397563e9bd4031f92acaaacc6">thePatches</a>)
<a name="l01086"></a>01086         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;<a class="code" href="classfield.html#a4a4d06d397563e9bd4031f92acaaacc6">thePatches</a>-&gt;<a class="code" href="classclone_list.html#a8f54a13007e33d1a1f08f77a0bd70927">NumOfNodes</a>();i++)
<a name="l01087"></a>01087                 <a class="code" href="classfield.html#a4a4d06d397563e9bd4031f92acaaacc6">thePatches</a>-&gt;<a class="code" href="classclone_list.html#a761c3700fcf12c3f48b3c34d2a0aef7f">ElementAtNumber</a>(i)-&gt;<a class="code" href="classpatch.html#a16276b251ebd3f27715ea21be08dfa68" title="initialised the budgets of those elements or compounds that are being budgeted">StartBudget</a>();
<a name="l01088"></a>01088 }
<a name="l01089"></a>01089 
<a name="l01090"></a>01090 <span class="comment">/****************************************************************************\</span>
<a name="l01091"></a>01091 <span class="comment">Test if budget is valid</span>
<a name="l01092"></a>01092 <span class="comment">\****************************************************************************/</span>
<a name="l01093"></a><a class="code" href="classfield.html#a16113f10f06008c8c9c9e117b568b98f">01093</a> <span class="keywordtype">void</span> <a class="code" href="classfield.html#a16113f10f06008c8c9c9e117b568b98f">field::EndBudget</a>()
<a name="l01094"></a>01094 {
<a name="l01095"></a>01095         <span class="keywordtype">bool</span> ret_val=<span class="keyword">true</span>;
<a name="l01096"></a>01096 <span class="comment">//   double N=0;,DM=0;</span>
<a name="l01097"></a>01097    <span class="keywordflow">if</span> (<a class="code" href="classfield.html#a4a4d06d397563e9bd4031f92acaaacc6">thePatches</a>)
<a name="l01098"></a>01098         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;<a class="code" href="classfield.html#a4a4d06d397563e9bd4031f92acaaacc6">thePatches</a>-&gt;<a class="code" href="classclone_list.html#a8f54a13007e33d1a1f08f77a0bd70927">NumOfNodes</a>();i++)
<a name="l01099"></a>01099                 <span class="keywordflow">if</span> (!<a class="code" href="classfield.html#a4a4d06d397563e9bd4031f92acaaacc6">thePatches</a>-&gt;<a class="code" href="classclone_list.html#a761c3700fcf12c3f48b3c34d2a0aef7f">ElementAtNumber</a>(i)-&gt;<a class="code" href="classpatch.html#a081e88d1eef85a499e8f466dbe0bf546" title="check the budgets of those elements or compounds that are being budgeted">EndBudget</a>()) ret_val=<span class="keyword">false</span>;
<a name="l01100"></a>01100    <span class="keywordflow">if</span> (!ret_val)
<a name="l01101"></a>01101    {
<a name="l01102"></a>01102       <a class="code" href="message_8h.html#a8ad29009121a629982c6ade0bd332470">theMessage</a>-&gt;<a class="code" href="classmessage.html#afed66d0552f90b4385c5169cf5929907">WarningWithDisplay</a>(<span class="stringliteral">&quot;Error in budget of field number &quot;</span>, <a class="code" href="classbase.html#a1b4ec2736a9fa992d45fdbac5f964896">GetIndex</a>());
<a name="l01103"></a>01103    }
<a name="l01104"></a>01104 }
<a name="l01105"></a>01105 
<a name="l01106"></a>01106 
<a name="l01107"></a>01107 
<a name="l01108"></a>01108 <span class="comment">/****************************************************************************\</span>
<a name="l01109"></a>01109 <span class="comment">\****************************************************************************/</span>
<a name="l01110"></a><a class="code" href="classfield.html#a5e7c7c8374cf01bc46d7e0c4619b5bd5">01110</a> <span class="keywordtype">void</span> <a class="code" href="classfield.html#a5e7c7c8374cf01bc46d7e0c4619b5bd5">field::GiveIndicators</a>()
<a name="l01111"></a>01111 {
<a name="l01112"></a>01112    <span class="keywordtype">int</span> n=<a class="code" href="classfield.html#a4a4d06d397563e9bd4031f92acaaacc6">thePatches</a>-&gt;<a class="code" href="classclone_list.html#a8f54a13007e33d1a1f08f77a0bd70927">NumOfNodes</a>();
<a name="l01113"></a>01113    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;n;i++)
<a name="l01114"></a>01114    {
<a name="l01115"></a>01115       <a class="code" href="classpatch.html">patch</a> * p = <a class="code" href="classfield.html#a4a4d06d397563e9bd4031f92acaaacc6">thePatches</a>-&gt;<a class="code" href="classclone_list.html#a761c3700fcf12c3f48b3c34d2a0aef7f">ElementAtNumber</a>(i);
<a name="l01116"></a>01116       p-&gt;<a class="code" href="classpatch.html#a264e98a8bd59a3e2268e3edb8e440103">GiveIndicators</a>();
<a name="l01117"></a>01117    }
<a name="l01118"></a>01118 }
<a name="l01119"></a>01119 
<a name="l01120"></a>01120 
<a name="l01121"></a>01121 
<a name="l01122"></a>01122 <span class="comment">/****************************************************************************\</span>
<a name="l01123"></a>01123 <span class="comment">Get total herbage mass in kg</span>
<a name="l01124"></a>01124 <span class="comment">\****************************************************************************/</span>
<a name="l01125"></a><a class="code" href="classfield.html#ad5e1460e730daa874bb7b0fced8ebb5a">01125</a> <span class="keywordtype">double</span> <a class="code" href="classfield.html#ad5e1460e730daa874bb7b0fced8ebb5a">field::GetHerbageMasskg</a>()
<a name="l01126"></a>01126 {
<a name="l01127"></a>01127         <span class="keywordtype">double</span> mass= 0.0;
<a name="l01128"></a>01128    <span class="keywordtype">int</span> n=<a class="code" href="classfield.html#a4a4d06d397563e9bd4031f92acaaacc6">thePatches</a>-&gt;<a class="code" href="classclone_list.html#a8f54a13007e33d1a1f08f77a0bd70927">NumOfNodes</a>();
<a name="l01129"></a>01129    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;n;i++)
<a name="l01130"></a>01130    {
<a name="l01131"></a>01131       <a class="code" href="classpatch.html">patch</a> * p = <a class="code" href="classfield.html#a4a4d06d397563e9bd4031f92acaaacc6">thePatches</a>-&gt;<a class="code" href="classclone_list.html#a761c3700fcf12c3f48b3c34d2a0aef7f">ElementAtNumber</a>(i);
<a name="l01132"></a>01132       mass += p-&gt;<a class="code" href="classpatch.html#a9e9681c8b32bc2638268b3eb9f230772" title="returns the total amount of standing dry matter in the patch, in kilograms">GetPatchStandingDMkg</a>()*p-&gt;<a class="code" href="classpatch.html#ae5ed6219bcd53dc67ca0dbbf33109649" title="return the area of the patch">GetArea</a>();
<a name="l01133"></a>01133    }
<a name="l01134"></a>01134    <span class="keywordflow">return</span> mass;
<a name="l01135"></a>01135 }
<a name="l01136"></a>01136 
<a name="l01137"></a>01137 <span class="comment">/****************************************************************************\</span>
<a name="l01138"></a>01138 <span class="comment">Get herbage mass in kg</span>
<a name="l01139"></a>01139 <span class="comment">\****************************************************************************/</span>
<a name="l01140"></a><a class="code" href="classfield.html#aedfd65c34ae6b67acbd5cdfb2e5d1a9e">01140</a> <span class="keywordtype">double</span> <a class="code" href="classfield.html#aedfd65c34ae6b67acbd5cdfb2e5d1a9e">field::GetHerbageMasskgPerHa</a>()
<a name="l01141"></a>01141 {
<a name="l01142"></a>01142         <span class="keywordtype">double</span> mass= 0.0;
<a name="l01143"></a>01143    <span class="keywordtype">int</span> n=<a class="code" href="classfield.html#a4a4d06d397563e9bd4031f92acaaacc6">thePatches</a>-&gt;<a class="code" href="classclone_list.html#a8f54a13007e33d1a1f08f77a0bd70927">NumOfNodes</a>();
<a name="l01144"></a>01144    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;n;i++)
<a name="l01145"></a>01145    {
<a name="l01146"></a>01146       <a class="code" href="classpatch.html">patch</a> * p = <a class="code" href="classfield.html#a4a4d06d397563e9bd4031f92acaaacc6">thePatches</a>-&gt;<a class="code" href="classclone_list.html#a761c3700fcf12c3f48b3c34d2a0aef7f">ElementAtNumber</a>(i);
<a name="l01147"></a>01147       mass += p-&gt;<a class="code" href="classpatch.html#a9e9681c8b32bc2638268b3eb9f230772" title="returns the total amount of standing dry matter in the patch, in kilograms">GetPatchStandingDMkg</a>()*p-&gt;<a class="code" href="classpatch.html#ae5ed6219bcd53dc67ca0dbbf33109649" title="return the area of the patch">GetArea</a>();
<a name="l01148"></a>01148    }
<a name="l01149"></a>01149    mass/=<a class="code" href="classfield.html#a500a3007e7d5ce1b18e950abbe4c7a21">area</a>;
<a name="l01150"></a>01150    <span class="keywordflow">return</span> mass;
<a name="l01151"></a>01151 }
<a name="l01152"></a>01152 
<a name="l01153"></a>01153 <span class="comment">/****************************************************************************\</span>
<a name="l01154"></a>01154 <span class="comment">Get herbage mass in excess of residual (kgDM/ha),  in kg</span>
<a name="l01155"></a>01155 <span class="comment">\****************************************************************************/</span>
<a name="l01156"></a><a class="code" href="classfield.html#a5faf5dbca7ad4c4a2f33f7104fd3908e">01156</a> <span class="keywordtype">double</span> <a class="code" href="classfield.html#a5faf5dbca7ad4c4a2f33f7104fd3908e">field::GetAvailableHerbageMasskg</a>(<span class="keywordtype">double</span> residualDM)
<a name="l01157"></a>01157 {
<a name="l01158"></a>01158         <span class="keywordtype">double</span> mass= 0.0;
<a name="l01159"></a>01159    <span class="keywordtype">int</span> n=<a class="code" href="classfield.html#a4a4d06d397563e9bd4031f92acaaacc6">thePatches</a>-&gt;<a class="code" href="classclone_list.html#a8f54a13007e33d1a1f08f77a0bd70927">NumOfNodes</a>();
<a name="l01160"></a>01160    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;n;i++)
<a name="l01161"></a>01161    {
<a name="l01162"></a>01162       <a class="code" href="classpatch.html">patch</a> * p = <a class="code" href="classfield.html#a4a4d06d397563e9bd4031f92acaaacc6">thePatches</a>-&gt;<a class="code" href="classclone_list.html#a761c3700fcf12c3f48b3c34d2a0aef7f">ElementAtNumber</a>(i);
<a name="l01163"></a>01163       mass += p-&gt;<a class="code" href="classpatch.html#a5342f2ad23fe50182718b3eeba0cad17" title="Get mass of dry matter (kg DM)of patch that is above a certain cutting or grazing height (m)...">GetAvailablePatchStandingDMkg</a>(residualDM);
<a name="l01164"></a>01164    }
<a name="l01165"></a>01165    <span class="keywordflow">return</span> mass;
<a name="l01166"></a>01166 }
<a name="l01167"></a>01167 
<a name="l01168"></a>01168 <span class="comment">/****************************************************************************\</span>
<a name="l01169"></a>01169 <span class="comment">Get herbage mass above cutting height in kg/ha</span>
<a name="l01170"></a>01170 <span class="comment">\****************************************************************************/</span>
<a name="l01171"></a><a class="code" href="classfield.html#a32c9aa62de35c4671da6b21621eb66ea">01171</a> <span class="keywordtype">double</span> <a class="code" href="classfield.html#a32c9aa62de35c4671da6b21621eb66ea">field::GetAvailableHerbageMasskgPerHa</a>(<span class="keywordtype">double</span> residualDM)
<a name="l01172"></a>01172 {
<a name="l01173"></a>01173         <span class="keywordtype">double</span> mass= 0.0;
<a name="l01174"></a>01174    <span class="keywordtype">int</span> n=<a class="code" href="classfield.html#a4a4d06d397563e9bd4031f92acaaacc6">thePatches</a>-&gt;<a class="code" href="classclone_list.html#a8f54a13007e33d1a1f08f77a0bd70927">NumOfNodes</a>();
<a name="l01175"></a>01175    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;n;i++)
<a name="l01176"></a>01176    {
<a name="l01177"></a>01177       <a class="code" href="classpatch.html">patch</a> * p = <a class="code" href="classfield.html#a4a4d06d397563e9bd4031f92acaaacc6">thePatches</a>-&gt;<a class="code" href="classclone_list.html#a761c3700fcf12c3f48b3c34d2a0aef7f">ElementAtNumber</a>(i);
<a name="l01178"></a>01178       mass += p-&gt;<a class="code" href="classpatch.html#a5342f2ad23fe50182718b3eeba0cad17" title="Get mass of dry matter (kg DM)of patch that is above a certain cutting or grazing height (m)...">GetAvailablePatchStandingDMkg</a>(residualDM)*p-&gt;<a class="code" href="classpatch.html#ae5ed6219bcd53dc67ca0dbbf33109649" title="return the area of the patch">GetArea</a>();
<a name="l01179"></a>01179    }
<a name="l01180"></a>01180    mass/=<a class="code" href="classfield.html#a500a3007e7d5ce1b18e950abbe4c7a21">area</a>;
<a name="l01181"></a>01181    <span class="keywordflow">return</span> mass;
<a name="l01182"></a>01182 }
<a name="l01183"></a>01183 
<a name="l01184"></a>01184 <span class="comment">/****************************************************************************\</span>
<a name="l01185"></a>01185 <span class="comment">\****************************************************************************/</span>
<a name="l01186"></a><a class="code" href="classfield.html#a5b62b48e403a06c3728b246265b7fb57">01186</a> <span class="keywordtype">void</span> <a class="code" href="classfield.html#a5b62b48e403a06c3728b246265b7fb57">field::DepositManure</a>(<a class="code" href="classmanure.html">manure</a> * animal_urine, <a class="code" href="classmanure.html">manure</a> * animal_dung, <span class="keywordtype">double</span> area_ur, <span class="keywordtype">double</span> area_du)
<a name="l01187"></a>01187 {
<a name="l01188"></a>01188 <span class="comment">//needs rewriting for multiple patches</span>
<a name="l01189"></a>01189         <span class="keywordtype">double</span> prop_lost_volat=0.07;
<a name="l01190"></a>01190 
<a name="l01191"></a>01191    <a class="code" href="_indicator_output_8h.html#a699f3cd60e9f14693c64869fd86745c5">theOutput</a>-&gt;<a class="code" href="class_indicator_output.html#a50aa53ae58d243f6eef65a360e1196c8">AddIndicator</a>(<a class="code" href="typer_8h.html#af7c21877c7448b813184ececcc1af13ca7361be8d586650bac7f248153f94f6f2">environmentalIndicator</a>,<span class="stringliteral">&quot;31.08 N in faeces from grazing&quot;</span>,<span class="stringliteral">&quot;kg N&quot;</span>,animal_dung-&gt;<a class="code" href="classproduct.html#a021ebef2da57e1d977cfe57e62c6e38b">GetAmount</a>()*animal_dung-&gt;<a class="code" href="classlive_matter.html#ac2063bf6ed8da618b7b2b2b47defaa12">GetAllN</a>().<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a>*1000.0);
<a name="l01192"></a>01192    <a class="code" href="_indicator_output_8h.html#a699f3cd60e9f14693c64869fd86745c5">theOutput</a>-&gt;<a class="code" href="class_indicator_output.html#a50aa53ae58d243f6eef65a360e1196c8">AddIndicator</a>(<a class="code" href="typer_8h.html#af7c21877c7448b813184ececcc1af13ca7361be8d586650bac7f248153f94f6f2">environmentalIndicator</a>,<span class="stringliteral">&quot;41.09 C in faeces from grazing&quot;</span>,<span class="stringliteral">&quot;kg C&quot;</span>,animal_dung-&gt;<a class="code" href="classproduct.html#a021ebef2da57e1d977cfe57e62c6e38b">GetAmount</a>()*animal_dung-&gt;<a class="code" href="classlive_matter.html#a899102ff3dccbfdc70b79e701c135514">GetC_content</a>()*1000.0);
<a name="l01193"></a>01193 
<a name="l01194"></a>01194 <span class="comment">// new_area_dung+=dung-&gt;GetAmount()*110.0;  //OLD METHOD - area covered per tonne fresh weight from During and Weeda 73, NZJAS</span>
<a name="l01195"></a>01195 
<a name="l01196"></a>01196    <a class="code" href="_indicator_output_8h.html#a699f3cd60e9f14693c64869fd86745c5">theOutput</a>-&gt;<a class="code" href="class_indicator_output.html#a50aa53ae58d243f6eef65a360e1196c8">AddIndicator</a>(<a class="code" href="typer_8h.html#af7c21877c7448b813184ececcc1af13ca7361be8d586650bac7f248153f94f6f2">environmentalIndicator</a>,<span class="stringliteral">&quot;31.07 N in urine from grazing&quot;</span>,<span class="stringliteral">&quot;kg N&quot;</span>,animal_urine-&gt;<a class="code" href="classproduct.html#a021ebef2da57e1d977cfe57e62c6e38b">GetAmount</a>()*animal_urine-&gt;<a class="code" href="classlive_matter.html#ac2063bf6ed8da618b7b2b2b47defaa12">GetAllN</a>().<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a> *1000.0);
<a name="l01197"></a>01197    <a class="code" href="_indicator_output_8h.html#a699f3cd60e9f14693c64869fd86745c5">theOutput</a>-&gt;<a class="code" href="class_indicator_output.html#a50aa53ae58d243f6eef65a360e1196c8">AddIndicator</a>(<a class="code" href="typer_8h.html#af7c21877c7448b813184ececcc1af13ca7361be8d586650bac7f248153f94f6f2">environmentalIndicator</a>,<span class="stringliteral">&quot;41.08 C in urine from grazing&quot;</span>,<span class="stringliteral">&quot;kg C&quot;</span>,animal_urine-&gt;<a class="code" href="classproduct.html#a021ebef2da57e1d977cfe57e62c6e38b">GetAmount</a>()*animal_urine-&gt;<a class="code" href="classlive_matter.html#a899102ff3dccbfdc70b79e701c135514">GetC_content</a>() *1000.0);
<a name="l01198"></a>01198       <span class="comment">// Calculate ammonia volatilisation</span>
<a name="l01199"></a>01199    <a class="code" href="_indicator_output_8h.html#a699f3cd60e9f14693c64869fd86745c5">theOutput</a>-&gt;<a class="code" href="class_indicator_output.html#a50aa53ae58d243f6eef65a360e1196c8">AddIndicator</a>(<a class="code" href="typer_8h.html#af7c21877c7448b813184ececcc1af13ca7361be8d586650bac7f248153f94f6f2">environmentalIndicator</a>,<span class="stringliteral">&quot;31.46 NH3-N loss during grazing&quot;</span>,<span class="stringliteral">&quot;kg N&quot;</span>,prop_lost_volat * animal_urine-&gt;<a class="code" href="classproduct.html#a021ebef2da57e1d977cfe57e62c6e38b">GetAmount</a>()
<a name="l01200"></a>01200                                                  * animal_urine-&gt;<a class="code" href="classlive_matter.html#a461f95ec9e31447ffee31066ea357ab1">GetNH4_content</a>().<a class="code" href="classnitrogen.html#aa708078375ba23f1dd31e08e28269dac">n</a> * 1000.0);
<a name="l01201"></a>01201 
<a name="l01202"></a>01202    <span class="keywordtype">double</span> size=0;
<a name="l01203"></a>01203    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;<a class="code" href="classfield.html#a4a4d06d397563e9bd4031f92acaaacc6">thePatches</a>-&gt;<a class="code" href="classclone_list.html#a8f54a13007e33d1a1f08f77a0bd70927">NumOfNodes</a>();i++)
<a name="l01204"></a>01204    {
<a name="l01205"></a>01205            size+=<a class="code" href="classfield.html#a4a4d06d397563e9bd4031f92acaaacc6">thePatches</a>-&gt;<a class="code" href="classclone_list.html#a761c3700fcf12c3f48b3c34d2a0aef7f">ElementAtNumber</a>(i)-&gt;<a class="code" href="classpatch.html#ae5ed6219bcd53dc67ca0dbbf33109649" title="return the area of the patch">GetArea</a>();
<a name="l01206"></a>01206    }
<a name="l01207"></a>01207    <span class="keywordtype">double</span> totalAmountUrine=animal_urine-&gt;<a class="code" href="classproduct.html#a021ebef2da57e1d977cfe57e62c6e38b">GetAmount</a>();
<a name="l01208"></a>01208    <span class="keywordtype">double</span> totalAmountDung=animal_dung-&gt;<a class="code" href="classproduct.html#a021ebef2da57e1d977cfe57e62c6e38b">GetAmount</a>();
<a name="l01209"></a>01209    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;<a class="code" href="classfield.html#a4a4d06d397563e9bd4031f92acaaacc6">thePatches</a>-&gt;<a class="code" href="classclone_list.html#a8f54a13007e33d1a1f08f77a0bd70927">NumOfNodes</a>();i++)
<a name="l01210"></a>01210    {
<a name="l01211"></a>01211            <span class="keywordtype">double</span> <a class="code" href="typer_8h.html#ae4c405e5c68c6ec2c44bb6d6adfc2f6cab10366ecc76133a0a4a4712a5ee26f65">fraction</a>=<a class="code" href="classfield.html#a4a4d06d397563e9bd4031f92acaaacc6">thePatches</a>-&gt;<a class="code" href="classclone_list.html#a761c3700fcf12c3f48b3c34d2a0aef7f">ElementAtNumber</a>(i)-&gt;<a class="code" href="classpatch.html#ae5ed6219bcd53dc67ca0dbbf33109649" title="return the area of the patch">GetArea</a>()/size;
<a name="l01212"></a>01212            animal_urine-&gt;<a class="code" href="classproduct.html#a18ec2e96f1d9b7cef74c4b2800ebdca1">Setamount</a>(totalAmountUrine*fraction);
<a name="l01213"></a>01213            animal_dung-&gt;<a class="code" href="classproduct.html#a18ec2e96f1d9b7cef74c4b2800ebdca1">Setamount</a>(totalAmountDung*fraction);
<a name="l01214"></a>01214            <a class="code" href="classfield.html#a4a4d06d397563e9bd4031f92acaaacc6">thePatches</a>-&gt;<a class="code" href="classclone_list.html#a761c3700fcf12c3f48b3c34d2a0aef7f">ElementAtNumber</a>(i)-&gt;<a class="code" href="classpatch.html#a710f7413560c8b891d35212341731b02">DepositManure</a>(animal_urine, animal_dung);
<a name="l01215"></a>01215    }
<a name="l01216"></a>01216    animal_urine-&gt;<a class="code" href="classproduct.html#a18ec2e96f1d9b7cef74c4b2800ebdca1">Setamount</a>(totalAmountUrine);
<a name="l01217"></a>01217    animal_dung-&gt;<a class="code" href="classproduct.html#a18ec2e96f1d9b7cef74c4b2800ebdca1">Setamount</a>(totalAmountDung);
<a name="l01218"></a>01218 
<a name="l01219"></a>01219 
<a name="l01220"></a>01220 }
<a name="l01221"></a>01221 
<a name="l01222"></a>01222 
<a name="l01223"></a>01223 <span class="comment">/****************************************************************************\</span>
<a name="l01224"></a>01224 <span class="comment">\****************************************************************************/</span>
<a name="l01225"></a><a class="code" href="classfield.html#aadde0ba8d453394c5e790f7e92c0cb35">01225</a> <span class="keywordtype">bool</span> <a class="code" href="classfield.html#aadde0ba8d453394c5e790f7e92c0cb35">field::GetGrazingPossible</a>()
<a name="l01226"></a>01226 {
<a name="l01227"></a>01227 <span class="comment">//   char *cropId;</span>
<a name="l01228"></a>01228    <span class="keywordtype">bool</span> ret_val=<span class="keyword">true</span>;
<a name="l01229"></a>01229 <span class="comment">/*   patch* mainPatch;</span>
<a name="l01230"></a>01230 <span class="comment">   mainPatch = thePatches-&gt;ElementAtNumber(0);</span>
<a name="l01231"></a>01231 <span class="comment">   if (!mainPatch-&gt;Getgrazable())</span>
<a name="l01232"></a>01232 <span class="comment">     return false;</span>
<a name="l01233"></a>01233 <span class="comment">*/</span>
<a name="l01234"></a>01234         <span class="keywordflow">if</span> (!<a class="code" href="classfield.html#a3af1a5461fe52c5fb81cc339809666b9">grazingPossible</a>)
<a name="l01235"></a>01235         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01236"></a>01236    <span class="comment">// Check to make sure there is no other operation that would stop grazing</span>
<a name="l01237"></a>01237    <span class="keywordtype">int</span> year = <a class="code" href="bstime_8h.html#ac0dc3834220ee5ae84c115e146194d75">theTime</a>.<a class="code" href="classbs_time.html#afcb5953580c085bce20eb33a4b21e155">GetYear</a>();
<a name="l01238"></a>01238    <span class="keywordtype">int</span> month = <a class="code" href="bstime_8h.html#ac0dc3834220ee5ae84c115e146194d75">theTime</a>.<a class="code" href="classbs_time.html#a777a59c97951688c4b2a67c4b0bca16e">GetMonth</a>();
<a name="l01239"></a>01239    <span class="keywordtype">int</span> <a class="code" href="typer_8h.html#ae4c405e5c68c6ec2c44bb6d6adfc2f6ca0c8f8663af5d02dd407beb7decb7df37">day</a> = <a class="code" href="bstime_8h.html#ac0dc3834220ee5ae84c115e146194d75">theTime</a>.<a class="code" href="classbs_time.html#a3b4126cf9db93be0c2f69549699730d3">GetDay</a>();
<a name="l01240"></a>01240    <a class="code" href="classfield_operation_fields.html">fieldOperationFields</a> * FOP=NULL;
<a name="l01241"></a>01241    <span class="keywordflow">if</span> ((<a class="code" href="classfield.html#ad9aa754f50edcc609d69051ade821958">crrPlan</a>==NULL) || (<a class="code" href="classfield.html#ad9aa754f50edcc609d69051ade821958">crrPlan</a>-&gt;<a class="code" href="classplan.html#a336d1b751be876cf584e47d44826d8ac">Finished</a>()))
<a name="l01242"></a>01242    {
<a name="l01243"></a>01243       <a class="code" href="classclone_list.html">cloneList&lt;plan&gt;::PS</a> P;
<a name="l01244"></a>01244       <a class="code" href="classfield.html#a06360b6852f2e8f6348924d7bb3564b2">Lfutr</a>-&gt;<a class="code" href="classclone_list.html#a2780cfb6574e5cd9b8797b1b5c8c9ad6">PeekHead</a>(P);
<a name="l01245"></a>01245       <span class="keywordflow">if</span> (P)
<a name="l01246"></a>01246          FOP=(<a class="code" href="classfield_operation_fields.html">fieldOperationFields</a> *) P-&gt;element-&gt;ReturnOperation(year,month,day,<span class="keyword">false</span>);
<a name="l01247"></a>01247    }
<a name="l01248"></a>01248    <span class="keywordflow">else</span>
<a name="l01249"></a>01249       FOP=<a class="code" href="classfield.html#ad9aa754f50edcc609d69051ade821958">crrPlan</a>-&gt;<a class="code" href="classplan.html#a5bb316264b932ad51c4af2441691b61d">ReturnOperation</a>(year,month,day,<span class="keyword">false</span>);
<a name="l01250"></a>01250 
<a name="l01251"></a>01251    <span class="keywordflow">if</span> (FOP)
<a name="l01252"></a>01252    {
<a name="l01253"></a>01253       <span class="keywordtype">int</span> opID=FOP-&gt;<a class="code" href="classfield_operation_fields.html#a8981c417041bf7188a41df2881b244fb">GetOperationId</a>();
<a name="l01254"></a>01254       <span class="keywordflow">switch</span> (opID)
<a name="l01255"></a>01255       {
<a name="l01256"></a>01256          <span class="keywordflow">case</span> 0:
<a name="l01257"></a>01257          <span class="keywordflow">case</span> 1:
<a name="l01258"></a>01258          <span class="keywordflow">case</span> 2:
<a name="l01259"></a>01259          <span class="keywordflow">case</span> 3:
<a name="l01260"></a>01260          <span class="keywordflow">case</span> 4:
<a name="l01261"></a>01261          <span class="keywordflow">case</span> 5:
<a name="l01262"></a>01262          <span class="keywordflow">case</span> 6:
<a name="l01263"></a>01263          <span class="keywordflow">case</span> 12:
<a name="l01264"></a>01264          <span class="keywordflow">case</span> 13:
<a name="l01265"></a>01265          <span class="keywordflow">case</span> 15:
<a name="l01266"></a>01266          <span class="keywordflow">case</span> 16:
<a name="l01267"></a>01267          <span class="keywordflow">case</span> 17:
<a name="l01268"></a>01268          <span class="keywordflow">case</span> 19:
<a name="l01269"></a>01269          {
<a name="l01270"></a>01270             ret_val=<span class="keyword">false</span>;
<a name="l01271"></a>01271             <a class="code" href="classfield.html#a290e1b803f7299cb7cf7054ef02027e3">grazingShutDown</a>=<span class="keyword">true</span>;
<a name="l01272"></a>01272             <span class="keywordflow">break</span>;
<a name="l01273"></a>01273          }
<a name="l01274"></a>01274          <span class="keywordflow">default</span>:
<a name="l01275"></a>01275          {
<a name="l01276"></a>01276             ret_val=<span class="keyword">true</span>;
<a name="l01277"></a>01277             <span class="keywordflow">break</span>;
<a name="l01278"></a>01278          }
<a name="l01279"></a>01279       }
<a name="l01280"></a>01280    }
<a name="l01281"></a>01281         <span class="keywordflow">return</span> ret_val;
<a name="l01282"></a>01282 }
<a name="l01283"></a>01283 
<a name="l01284"></a>01284 <span class="comment">/****************************************************************************\</span>
<a name="l01285"></a>01285 <span class="comment">Set grazable to true if crop is of type that is grazable</span>
<a name="l01286"></a>01286 <span class="comment">\****************************************************************************/</span>
<a name="l01287"></a><a class="code" href="classfield.html#a62798f048b9b2b4c7c4ba3e5ff6f0694">01287</a> <span class="keywordtype">void</span> <a class="code" href="classfield.html#a62798f048b9b2b4c7c4ba3e5ff6f0694">field::AutoGrazingPossible</a>()
<a name="l01288"></a>01288 {
<a name="l01289"></a>01289    <span class="keywordtype">char</span> *cropId;
<a name="l01290"></a>01290 <span class="comment">//   bool ret_val=false;</span>
<a name="l01291"></a>01291 
<a name="l01292"></a>01292    <a class="code" href="classfield.html#ac88e569c5e0854563c505665eba50e24">PresentCrop_</a>(cropId);
<a name="l01293"></a>01293    <span class="keywordflow">if</span> ((strcmp(<span class="stringliteral">&quot;C1&quot;</span>,cropId)==0) || (strcmp(<span class="stringliteral">&quot;C2&quot;</span>,cropId)==0) || (strcmp(<span class="stringliteral">&quot;G1&quot;</span>,cropId)==0) ||
<a name="l01294"></a>01294       (strcmp(<span class="stringliteral">&quot;G2&quot;</span>,cropId)==0) || (strcmp(<span class="stringliteral">&quot;K1&quot;</span>,cropId)==0) || (strcmp(<span class="stringliteral">&quot;G4&quot;</span>,cropId)==0))
<a name="l01295"></a>01295       {
<a name="l01296"></a>01296            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;<a class="code" href="classfield.html#a4a4d06d397563e9bd4031f92acaaacc6">thePatches</a>-&gt;<a class="code" href="classclone_list.html#a8f54a13007e33d1a1f08f77a0bd70927">NumOfNodes</a>();i++)
<a name="l01297"></a>01297                    <a class="code" href="classfield.html#a4a4d06d397563e9bd4031f92acaaacc6">thePatches</a>-&gt;<a class="code" href="classclone_list.html#a761c3700fcf12c3f48b3c34d2a0aef7f">ElementAtNumber</a>(i)-&gt;<a class="code" href="classpatch.html#a6e95e7ea2fbab3b4dac4747ad2331648" title="set whether patch is grazable">Setgrazable</a>(<span class="keyword">true</span>);
<a name="l01298"></a>01298          <a class="code" href="classfield.html#a3af1a5461fe52c5fb81cc339809666b9">grazingPossible</a>=<span class="keyword">true</span>;
<a name="l01299"></a>01299       }
<a name="l01300"></a>01300    <span class="keywordflow">else</span>
<a name="l01301"></a>01301    {
<a name="l01302"></a>01302            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;<a class="code" href="classfield.html#a4a4d06d397563e9bd4031f92acaaacc6">thePatches</a>-&gt;<a class="code" href="classclone_list.html#a8f54a13007e33d1a1f08f77a0bd70927">NumOfNodes</a>();i++)
<a name="l01303"></a>01303                 <a class="code" href="classfield.html#a4a4d06d397563e9bd4031f92acaaacc6">thePatches</a>-&gt;<a class="code" href="classclone_list.html#a761c3700fcf12c3f48b3c34d2a0aef7f">ElementAtNumber</a>(i)-&gt;<a class="code" href="classpatch.html#a6e95e7ea2fbab3b4dac4747ad2331648" title="set whether patch is grazable">Setgrazable</a>(<span class="keyword">false</span>);
<a name="l01304"></a>01304 
<a name="l01305"></a>01305       <a class="code" href="classfield.html#a3af1a5461fe52c5fb81cc339809666b9">grazingPossible</a>=<span class="keyword">false</span>;
<a name="l01306"></a>01306    }
<a name="l01307"></a>01307 }
<a name="l01308"></a>01308 
<a name="l01309"></a>01309 <span class="comment">/****************************************************************************\</span>
<a name="l01310"></a>01310 <span class="comment">\****************************************************************************/</span>
<a name="l01311"></a><a class="code" href="classfield.html#a2bb1e4784fca6aed504a2ab7d4f200a0">01311</a> <span class="keywordtype">double</span> <a class="code" href="classfield.html#a2bb1e4784fca6aed504a2ab7d4f200a0">field::GetDMGrazed</a>()
<a name="l01312"></a>01312 {
<a name="l01313"></a>01313    <span class="keywordtype">double</span> ret_val = 0.0;
<a name="l01314"></a>01314    <span class="keywordtype">int</span> n=<a class="code" href="classfield.html#a4a4d06d397563e9bd4031f92acaaacc6">thePatches</a>-&gt;<a class="code" href="classclone_list.html#a8f54a13007e33d1a1f08f77a0bd70927">NumOfNodes</a>();
<a name="l01315"></a>01315    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;n;i++)
<a name="l01316"></a>01316    {
<a name="l01317"></a>01317       <a class="code" href="classpatch.html">patch</a> * p = <a class="code" href="classfield.html#a4a4d06d397563e9bd4031f92acaaacc6">thePatches</a>-&gt;<a class="code" href="classclone_list.html#a761c3700fcf12c3f48b3c34d2a0aef7f">ElementAtNumber</a>(i);
<a name="l01318"></a>01318       ret_val+=p-&gt;<a class="code" href="classpatch.html#a84e0930d2c8a6a1e7bf77ae86d6de1ab" title="returns the amount of nitrogen fixed within the patch during the day (in grams per square metre)...">GetGrazedDM</a>();
<a name="l01319"></a>01319    }
<a name="l01320"></a>01320    <span class="keywordflow">return</span> ret_val;
<a name="l01321"></a>01321 }
<a name="l01322"></a>01322 
<a name="l01323"></a>01323 <span class="comment">/****************************************************************************\</span>
<a name="l01324"></a>01324 <span class="comment">Returns above ground crop N in kg/ha</span>
<a name="l01325"></a>01325 <span class="comment">\****************************************************************************/</span>
<a name="l01326"></a><a class="code" href="classfield.html#a106ff033bc0271d52377d1c25b5e297b">01326</a> <span class="keywordtype">double</span> <a class="code" href="classfield.html#a106ff033bc0271d52377d1c25b5e297b">field::GetAbovegroundCropN</a>()
<a name="l01327"></a>01327 {
<a name="l01328"></a>01328    <span class="keywordtype">double</span> ret_val = 0.0;
<a name="l01329"></a>01329    <span class="keywordtype">int</span> n=<a class="code" href="classfield.html#a4a4d06d397563e9bd4031f92acaaacc6">thePatches</a>-&gt;<a class="code" href="classclone_list.html#a8f54a13007e33d1a1f08f77a0bd70927">NumOfNodes</a>();
<a name="l01330"></a>01330    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;n;i++)
<a name="l01331"></a>01331    {
<a name="l01332"></a>01332       <a class="code" href="classpatch.html">patch</a> * p = <a class="code" href="classfield.html#a4a4d06d397563e9bd4031f92acaaacc6">thePatches</a>-&gt;<a class="code" href="classclone_list.html#a761c3700fcf12c3f48b3c34d2a0aef7f">ElementAtNumber</a>(i);
<a name="l01333"></a>01333       ret_val+=p-&gt;<a class="code" href="classpatch.html#aa68d48a5d0a2c8b3a222b141d0d5c276">GetAbovegroundCropN</a>();
<a name="l01334"></a>01334    }
<a name="l01335"></a>01335    <span class="keywordflow">return</span> ret_val;
<a name="l01336"></a>01336 }
<a name="l01337"></a>01337 
<a name="l01338"></a>01338 <span class="comment">/****************************************************************************\</span>
<a name="l01339"></a>01339 <span class="comment">Returns growth in kg DM</span>
<a name="l01340"></a>01340 <span class="comment">\****************************************************************************/</span>
<a name="l01341"></a><a class="code" href="classfield.html#a3b566f2cfcd110bb6acdc6912d3ab3c9">01341</a> <span class="keywordtype">double</span> <a class="code" href="classfield.html#a3b566f2cfcd110bb6acdc6912d3ab3c9">field::GetDailyDMProduction</a>()
<a name="l01342"></a>01342 {
<a name="l01343"></a>01343         <span class="keywordtype">double</span> ret_val=0.0;
<a name="l01344"></a>01344    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;<a class="code" href="classfield.html#a4a4d06d397563e9bd4031f92acaaacc6">thePatches</a>-&gt;<a class="code" href="classclone_list.html#a8f54a13007e33d1a1f08f77a0bd70927">NumOfNodes</a>();i++)
<a name="l01345"></a>01345    {
<a name="l01346"></a>01346       <a class="code" href="classpatch.html">patch</a> * p = <a class="code" href="classfield.html#a4a4d06d397563e9bd4031f92acaaacc6">thePatches</a>-&gt;<a class="code" href="classclone_list.html#a761c3700fcf12c3f48b3c34d2a0aef7f">ElementAtNumber</a>(i);
<a name="l01347"></a>01347       ret_val+=p-&gt;<a class="code" href="classpatch.html#a334f1d4bec7e4b63de7f008255b10904">GetDailyDMProduction</a>();
<a name="l01348"></a>01348    }
<a name="l01349"></a>01349    <span class="keywordflow">return</span> ret_val;
<a name="l01350"></a>01350 }
<a name="l01351"></a>01351 
<a name="l01352"></a>01352 <span class="comment">/****************************************************************************\</span>
<a name="l01353"></a>01353 <span class="comment">Estimate potential daily growth, given radiation and temperature</span>
<a name="l01354"></a>01354 <span class="comment">\****************************************************************************/</span>
<a name="l01355"></a><a class="code" href="classfield.html#ac93fd3654dbd322021fcd0c92475e39b">01355</a> <span class="keywordtype">double</span>   <a class="code" href="classfield.html#ac93fd3654dbd322021fcd0c92475e39b">field::InitExpectedGrowthRate</a>(<span class="keywordtype">double</span> radiation, <span class="keywordtype">double</span> temperature)
<a name="l01356"></a>01356 {
<a name="l01357"></a>01357    <span class="keywordtype">double</span> ret_val = 0.0;
<a name="l01358"></a>01358    <span class="keywordtype">int</span> n=<a class="code" href="classfield.html#a4a4d06d397563e9bd4031f92acaaacc6">thePatches</a>-&gt;<a class="code" href="classclone_list.html#a8f54a13007e33d1a1f08f77a0bd70927">NumOfNodes</a>();
<a name="l01359"></a>01359    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;n;i++)
<a name="l01360"></a>01360    {
<a name="l01361"></a>01361       <a class="code" href="classpatch.html">patch</a> * p = <a class="code" href="classfield.html#a4a4d06d397563e9bd4031f92acaaacc6">thePatches</a>-&gt;<a class="code" href="classclone_list.html#a761c3700fcf12c3f48b3c34d2a0aef7f">ElementAtNumber</a>(i);
<a name="l01362"></a>01362       ret_val+=p-&gt;<a class="code" href="classpatch.html#a1084593c1a741685fc7277569df31516" title="returns the dry matter growth rate of the patch the absence of nutrient or water limitations">GetPotentialGrowthRate</a>(radiation, temperature);
<a name="l01363"></a>01363    }
<a name="l01364"></a>01364    <span class="keywordflow">return</span> ret_val;
<a name="l01365"></a>01365 }
<a name="l01366"></a>01366 
<a name="l01367"></a>01367 
<a name="l01368"></a>01368 
<a name="l01369"></a>01369 <span class="comment">/**************************************************************</span>
<a name="l01370"></a>01370 <span class="comment">This resets the variables that track grazing</span>
<a name="l01371"></a>01371 <span class="comment">Done here cos we might be interested in the variables for debugging</span>
<a name="l01372"></a>01372 <span class="comment">**************************************************************/</span>
<a name="l01373"></a><a class="code" href="classfield.html#ae1b97f96f274b114d6d92c1ce80f3dfd">01373</a> <span class="keywordtype">void</span> <a class="code" href="classfield.html#ae1b97f96f274b114d6d92c1ce80f3dfd">field::ClearTemporaryVariables</a>()
<a name="l01374"></a>01374 {
<a name="l01375"></a>01375    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;<a class="code" href="classfield.html#a4a4d06d397563e9bd4031f92acaaacc6">thePatches</a>-&gt;<a class="code" href="classclone_list.html#a8f54a13007e33d1a1f08f77a0bd70927">NumOfNodes</a>();i++)
<a name="l01376"></a>01376    {
<a name="l01377"></a>01377       <a class="code" href="classpatch.html">patch</a> * p = <a class="code" href="classfield.html#a4a4d06d397563e9bd4031f92acaaacc6">thePatches</a>-&gt;<a class="code" href="classclone_list.html#a761c3700fcf12c3f48b3c34d2a0aef7f">ElementAtNumber</a>(i);
<a name="l01378"></a>01378       p-&gt;<a class="code" href="classpatch.html#a2b2bcc729804b8dac268f097e2a17104">clearPatchRecords</a>();
<a name="l01379"></a>01379    }
<a name="l01380"></a>01380 }
<a name="l01381"></a>01381 
</pre></div></div>
</div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address class="footer"><small>Generated on Mon Aug 22 2011 10:28:58 for Fasset by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
